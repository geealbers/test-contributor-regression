var jO=Object.defineProperty;var Mw=L=>{throw TypeError(L)};var UO=(L,w,g)=>w in L?jO(L,w,{enumerable:!0,configurable:!0,writable:!0,value:g}):L[w]=g;var vr=(L,w,g)=>UO(L,typeof w!="symbol"?w+"":w,g),Lw=(L,w,g)=>w.has(L)||Mw("Cannot "+g);var ha=(L,w,g)=>(Lw(L,w,"read from private field"),g?g.call(L):w.get(L)),$w=(L,w,g)=>w.has(L)?Mw("Cannot add the same private member more than once"):w instanceof WeakSet?w.add(L):w.set(L,g);var Br=(L,w,g)=>(Lw(L,w,"access private method"),g);(function(){const w=document.createElement("link").relList;if(w&&w.supports&&w.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))v(_);new MutationObserver(_=>{for(const P of _)if(P.type==="childList")for(const O of P.addedNodes)O.tagName==="LINK"&&O.rel==="modulepreload"&&v(O)}).observe(document,{childList:!0,subtree:!0});function g(_){const P={};return _.integrity&&(P.integrity=_.integrity),_.referrerPolicy&&(P.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?P.credentials="include":_.crossOrigin==="anonymous"?P.credentials="omit":P.credentials="same-origin",P}function v(_){if(_.ep)return;_.ep=!0;const P=g(_);fetch(_.href,P)}})();var $u=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function DO(L){return L&&L.__esModule&&Object.prototype.hasOwnProperty.call(L,"default")?L.default:L}var Nw={},zw;function WO(){if(zw)return Nw;zw=1,(()=>{var L=Object.create,w=Object.defineProperty,g=Object.defineProperties,v=Object.getOwnPropertyDescriptor,_=Object.getOwnPropertyDescriptors,P=Object.getOwnPropertyNames,O=Object.getOwnPropertySymbols,F=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable,ae=(e,t,i)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,C=(e,t)=>{for(var i in t||(t={}))U.call(t,i)&&ae(e,i,t[i]);if(O)for(var i of O(t))K.call(t,i)&&ae(e,i,t[i]);return e},W=(e,t)=>g(e,_(t)),$e=e=>w(e,"__esModule",{value:!0}),le=(e,t)=>{var i={};for(var r in e)U.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&O)for(var r of O(e))t.indexOf(r)<0&&K.call(e,r)&&(i[r]=e[r]);return i},xt=(e,t)=>()=>(e&&(t=e(e=0)),t),Ge=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),kt=(e,t)=>{for(var i in t)w(e,i,{get:t[i],enumerable:!0})},We=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of P(t))!U.call(e,n)&&(i||n!=="default")&&w(e,n,{get:()=>t[n],enumerable:!(r=v(t,n))||r.enumerable});return e},Ue=(e,t)=>We($e(w(e!=null?L(F(e)):{},"default",!t&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),Zt=(e=>(t,i)=>e&&e.get(t)||(i=We($e({}),t,1),e&&e.set(t,i),i))(typeof WeakMap<"u"?new WeakMap:0),Je=(e,t,i)=>(ae(e,typeof t!="symbol"?t+"":t,i),i);function Bt(e,t){for(var i in t)e[i]=t[i];return e}function bi(e){var t=e.parentNode;t&&t.removeChild(e)}function N(e,t,i){var r,n,a,l={};for(a in t)a=="key"?r=t[a]:a=="ref"?n=t[a]:l[a]=t[a];if(arguments.length>2&&(l.children=arguments.length>3?fa.call(arguments,2):i),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)l[a]===void 0&&(l[a]=e.defaultProps[a]);return Ri(e,l,r,n,null)}function Ri(e,t,i,r,n){var a={type:e,props:t,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:n??++Pf};return n==null&&Ce.vnode!=null&&Ce.vnode(a),a}function br(){return{current:null}}function rt(e){return e.children}function ei(e,t){this.props=e,this.context=t}function Mt(e,t){if(t==null)return e.__?Mt(e.__,e.__.__k.indexOf(e)+1):null;for(var i;t<e.__k.length;t++)if((i=e.__k[t])!=null&&i.__e!=null)return i.__e;return typeof e.type=="function"?Mt(e):null}function Ni(e){var t,i;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((i=e.__k[t])!=null&&i.__e!=null){e.__e=e.__c.base=i.__e;break}return Ni(e)}}function ur(e){(!e.__d&&(e.__d=!0)&&pa.push(e)&&!qi.__r++||Tf!==Ce.debounceRendering)&&((Tf=Ce.debounceRendering)||Cf)(qi)}function qi(){for(var e;qi.__r=pa.length;)e=pa.sort(function(t,i){return t.__v.__b-i.__v.__b}),pa=[],e.some(function(t){var i,r,n,a,l,u;t.__d&&(l=(a=(i=t).__v).__e,(u=i.__P)&&(r=[],(n=Bt({},a)).__v=a.__v+1,wi(u,a,n,i.__n,u.ownerSVGElement!==void 0,a.__h!=null?[l]:null,r,l??Mt(a),a.__h),gt(r,a),a.__e!=l&&Ni(a)))})}function Yi(e,t,i,r,n,a,l,u,c,d){var p,y,x,E,S,k,T,R=r&&r.__k||Qu,A=R.length;for(i.__k=[],p=0;p<t.length;p++)if((E=i.__k[p]=(E=t[p])==null||typeof E=="boolean"?null:typeof E=="string"||typeof E=="number"||typeof E=="bigint"?Ri(null,E,null,null,E):Array.isArray(E)?Ri(rt,{children:E},null,null,null):E.__b>0?Ri(E.type,E.props,E.key,null,E.__v):E)!=null){if(E.__=i,E.__b=i.__b+1,(x=R[p])===null||x&&E.key==x.key&&E.type===x.type)R[p]=void 0;else for(y=0;y<A;y++){if((x=R[y])&&E.key==x.key&&E.type===x.type){R[y]=void 0;break}x=null}wi(e,E,x=x||ga,n,a,l,u,c,d),S=E.__e,(y=E.ref)&&x.ref!=y&&(T||(T=[]),x.ref&&T.push(x.ref,null,E),T.push(y,E.__c||S,E)),S!=null?(k==null&&(k=S),typeof E.type=="function"&&E.__k===x.__k?E.__d=c=hr(E,c,e):c=X(e,E,x,R,S,c),typeof i.type=="function"&&(i.__d=c)):c&&x.__e==c&&c.parentNode!=e&&(c=Mt(x))}for(i.__e=k,p=A;p--;)R[p]!=null&&(typeof i.type=="function"&&R[p].__e!=null&&R[p].__e==i.__d&&(i.__d=Mt(r,p+1)),kf(R[p],R[p]));if(T)for(p=0;p<T.length;p++)_o(T[p],T[++p],T[++p])}function hr(e,t,i){for(var r,n=e.__k,a=0;n&&a<n.length;a++)(r=n[a])&&(r.__=e,t=typeof r.type=="function"?hr(r,t,i):X(i,r,r,n,r.__e,t));return t}function ge(e,t){return t=t||[],e==null||typeof e=="boolean"||(Array.isArray(e)?e.some(function(i){ge(i,t)}):t.push(e)),t}function X(e,t,i,r,n,a){var l,u,c;if(t.__d!==void 0)l=t.__d,t.__d=void 0;else if(i==null||n!=a||n.parentNode==null)e:if(a==null||a.parentNode!==e)e.appendChild(n),l=null;else{for(u=a,c=0;(u=u.nextSibling)&&c<r.length;c+=2)if(u==n)break e;e.insertBefore(n,a),l=a}return l!==void 0?l:n.nextSibling}function se(e,t,i,r,n){var a;for(a in i)a==="children"||a==="key"||a in t||ee(e,a,null,i[a],r);for(a in t)n&&typeof t[a]!="function"||a==="children"||a==="key"||a==="value"||a==="checked"||i[a]===t[a]||ee(e,a,t[a],i[a],r)}function de(e,t,i){t[0]==="-"?e.setProperty(t,i):e[t]=i==null?"":typeof i!="number"||Rf.test(t)?i:i+"px"}function ee(e,t,i,r,n){var a;e:if(t==="style")if(typeof i=="string")e.style.cssText=i;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)i&&t in i||de(e.style,t,"");if(i)for(t in i)r&&i[t]===r[t]||de(e.style,t,i[t])}else if(t[0]==="o"&&t[1]==="n")a=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=i,i?r||e.addEventListener(t,a?nt:Ie,a):e.removeEventListener(t,a?nt:Ie,a);else if(t!=="dangerouslySetInnerHTML"){if(n)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=i??"";break e}catch{}typeof i=="function"||(i!=null&&(i!==!1||t[0]==="a"&&t[1]==="r")?e.setAttribute(t,i):e.removeAttribute(t))}}function Ie(e){this.l[e.type+!1](Ce.event?Ce.event(e):e)}function nt(e){this.l[e.type+!0](Ce.event?Ce.event(e):e)}function wi(e,t,i,r,n,a,l,u,c){var d,p,y,x,E,S,k,T,R,A,$,z=t.type;if(t.constructor!==void 0)return null;i.__h!=null&&(c=i.__h,u=t.__e=i.__e,t.__h=null,a=[u]),(d=Ce.__b)&&d(t);try{e:if(typeof z=="function"){if(T=t.props,R=(d=z.contextType)&&r[d.__c],A=d?R?R.props.value:d.__:r,i.__c?k=(p=t.__c=i.__c).__=p.__E:("prototype"in z&&z.prototype.render?t.__c=p=new z(T,A):(t.__c=p=new ei(T,A),p.constructor=z,p.render=Wu),R&&R.sub(p),p.props=T,p.state||(p.state={}),p.context=A,p.__n=r,y=p.__d=!0,p.__h=[]),p.__s==null&&(p.__s=p.state),z.getDerivedStateFromProps!=null&&(p.__s==p.state&&(p.__s=Bt({},p.__s)),Bt(p.__s,z.getDerivedStateFromProps(T,p.__s))),x=p.props,E=p.state,y)z.getDerivedStateFromProps==null&&p.componentWillMount!=null&&p.componentWillMount(),p.componentDidMount!=null&&p.__h.push(p.componentDidMount);else{if(z.getDerivedStateFromProps==null&&T!==x&&p.componentWillReceiveProps!=null&&p.componentWillReceiveProps(T,A),!p.__e&&p.shouldComponentUpdate!=null&&p.shouldComponentUpdate(T,p.__s,A)===!1||t.__v===i.__v){p.props=T,p.state=p.__s,t.__v!==i.__v&&(p.__d=!1),p.__v=t,t.__e=i.__e,t.__k=i.__k,t.__k.forEach(function(B){B&&(B.__=t)}),p.__h.length&&l.push(p);break e}p.componentWillUpdate!=null&&p.componentWillUpdate(T,p.__s,A),p.componentDidUpdate!=null&&p.__h.push(function(){p.componentDidUpdate(x,E,S)})}p.context=A,p.props=T,p.state=p.__s,(d=Ce.__r)&&d(t),p.__d=!1,p.__v=t,p.__P=e,d=p.render(p.props,p.state,p.context),p.state=p.__s,p.getChildContext!=null&&(r=Bt(Bt({},r),p.getChildContext())),y||p.getSnapshotBeforeUpdate==null||(S=p.getSnapshotBeforeUpdate(x,E)),$=d!=null&&d.type===rt&&d.key==null?d.props.children:d,Yi(e,Array.isArray($)?$:[$],t,i,r,n,a,l,u,c),p.base=t.__e,t.__h=null,p.__h.length&&l.push(p),k&&(p.__E=p.__=null),p.__e=!1}else a==null&&t.__v===i.__v?(t.__k=i.__k,t.__e=i.__e):t.__e=Ss(i.__e,t,i,r,n,a,l,c);(d=Ce.diffed)&&d(t)}catch(B){t.__v=null,(c||a!=null)&&(t.__e=u,t.__h=!!c,a[a.indexOf(u)]=null),Ce.__e(B,t,i)}}function gt(e,t){Ce.__c&&Ce.__c(t,e),e.some(function(i){try{e=i.__h,i.__h=[],e.some(function(r){r.call(i)})}catch(r){Ce.__e(r,i.__v)}})}function Ss(e,t,i,r,n,a,l,u){var c,d,p,y=i.props,x=t.props,E=t.type,S=0;if(E==="svg"&&(n=!0),a!=null){for(;S<a.length;S++)if((c=a[S])&&"setAttribute"in c==!!E&&(E?c.localName===E:c.nodeType===3)){e=c,a[S]=null;break}}if(e==null){if(E===null)return document.createTextNode(x);e=n?document.createElementNS("http://www.w3.org/2000/svg",E):document.createElement(E,x.is&&x),a=null,u=!1}if(E===null)y===x||u&&e.data===x||(e.data=x);else{if(a=a&&fa.call(e.childNodes),d=(y=i.props||ga).dangerouslySetInnerHTML,p=x.dangerouslySetInnerHTML,!u){if(a!=null)for(y={},S=0;S<e.attributes.length;S++)y[e.attributes[S].name]=e.attributes[S].value;(p||d)&&(p&&(d&&p.__html==d.__html||p.__html===e.innerHTML)||(e.innerHTML=p&&p.__html||""))}if(se(e,x,y,n,u),p)t.__k=[];else if(S=t.props.children,Yi(e,Array.isArray(S)?S:[S],t,i,r,n&&E!=="foreignObject",a,l,a?a[0]:i.__k&&Mt(i,0),u),a!=null)for(S=a.length;S--;)a[S]!=null&&bi(a[S]);u||("value"in x&&(S=x.value)!==void 0&&(S!==e.value||E==="progress"&&!S||E==="option"&&S!==y.value)&&ee(e,"value",S,y.value,!1),"checked"in x&&(S=x.checked)!==void 0&&S!==e.checked&&ee(e,"checked",S,y.checked,!1))}return e}function _o(e,t,i){try{typeof e=="function"?e(t):e.current=t}catch(r){Ce.__e(r,i)}}function kf(e,t,i){var r,n;if(Ce.unmount&&Ce.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||_o(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){Ce.__e(a,t)}r.base=r.__P=null}if(r=e.__k)for(n=0;n<r.length;n++)r[n]&&kf(r[n],t,typeof e.type!="function");i||e.__e==null||bi(e.__e),e.__e=e.__d=void 0}function Wu(e,t,i){return this.constructor(e,i)}function wr(e,t,i){var r,n,a;Ce.__&&Ce.__(e,t),n=(r=typeof i=="function")?null:i&&i.__k||t.__k,a=[],wi(t,e=(!r&&i||t).__k=N(rt,null,[e]),n||ga,ga,t.ownerSVGElement!==void 0,!r&&i?[i]:n?null:t.firstChild?fa.call(t.childNodes):null,a,!r&&i?i:n?n.__e:t.firstChild,r),gt(a,e)}function Hu(e,t){wr(e,t,Hu)}function qu(e,t,i){var r,n,a,l=Bt({},e.props);for(a in t)a=="key"?r=t[a]:a=="ref"?n=t[a]:l[a]=t[a];return arguments.length>2&&(l.children=arguments.length>3?fa.call(arguments,2):i),Ri(e.type,l,r||e.key,n||e.ref,null)}function ri(e,t){var i={__c:t="__cC"+If++,__:e,Consumer:function(r,n){return r.children(n)},Provider:function(r){var n,a;return this.getChildContext||(n=[],(a={})[t]=this,this.getChildContext=function(){return a},this.shouldComponentUpdate=function(l){this.props.value!==l.value&&n.some(ur)},this.sub=function(l){n.push(l);var u=l.componentWillUnmount;l.componentWillUnmount=function(){n.splice(n.indexOf(l),1),u&&u.call(l)}}),r.children}};return i.Provider.__=i.Consumer.contextType=i}var fa,Ce,Pf,pa,Cf,Tf,If,ga,Qu,Rf,tt=xt(()=>{ga={},Qu=[],Rf=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,fa=Qu.slice,Ce={__e:function(e,t,i,r){for(var n,a,l;t=t.__;)if((n=t.__c)&&!n.__)try{if((a=n.constructor)&&a.getDerivedStateFromError!=null&&(n.setState(a.getDerivedStateFromError(e)),l=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(e,r||{}),l=n.__d),l)return n.__E=n}catch(u){e=u}throw e}},Pf=0,ei.prototype.setState=function(e,t){var i;i=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Bt({},this.state),typeof e=="function"&&(e=e(Bt({},i),this.props)),e&&Bt(i,e),e!=null&&this.__v&&(t&&this.__h.push(t),ur(this))},ei.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ur(this))},ei.prototype.render=rt,pa=[],Cf=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,qi.__r=0,If=0});function Es(e,t){Ce.__h&&Ce.__h(hi,e,Mn||t),Mn=0;var i=hi.__H||(hi.__H={__:[],__h:[]});return e>=i.__.length&&i.__.push({}),i.__[e]}function je(e){return Mn=1,As(Lf,e)}function As(e,t,i){var r=Es(On++,2);return r.t=e,r.__c||(r.__=[i?i(t):Lf(void 0,t),function(n){var a=r.t(r.__[0],n);r.__[0]!==a&&(r.__=[a,r.__[1]],r.__c.setState({}))}],r.__c=hi),r.__}function fe(e,t){var i=Es(On++,3);!Ce.__s&&Gu(i.__H,t)&&(i.__=e,i.__H=t,hi.__H.__h.push(i))}function Et(e,t){var i=Es(On++,4);!Ce.__s&&Gu(i.__H,t)&&(i.__=e,i.__H=t,hi.__h.push(i))}function xe(e){return Mn=5,Ae(function(){return{current:e}},[])}function Of(e,t,i){Mn=6,Et(function(){return typeof e=="function"?(e(t()),function(){return e(null)}):e?(e.current=t(),function(){return e.current=null}):void 0},i==null?i:i.concat(e))}function Ae(e,t){var i=Es(On++,7);return Gu(i.__H,t)&&(i.__=e(),i.__H=t,i.__h=e),i.__}function Qe(e,t){return Mn=8,Ae(function(){return e},t)}function Yt(e){var t=hi.context[e.__c],i=Es(On++,9);return i.c=e,t?(i.__==null&&(i.__=!0,t.sub(hi)),t.props.value):e.__}function Mf(e,t){Ce.useDebugValue&&Ce.useDebugValue(t?t(e):e)}function vx(e){var t=Es(On++,10),i=je();return t.__=e,hi.componentDidCatch||(hi.componentDidCatch=function(r){t.__&&t.__(r),i[1](r)}),[i[0],function(){i[1](void 0)}]}function bx(){for(var e;e=Zu.shift();)if(e.__P)try{e.__H.__h.forEach(So),e.__H.__h.forEach(Vu),e.__H.__h=[]}catch(t){e.__H.__h=[],Ce.__e(t,e.__v)}}function So(e){var t=hi,i=e.__c;typeof i=="function"&&(e.__c=void 0,i()),hi=t}function Vu(e){var t=hi;e.__c=e.__(),hi=t}function Gu(e,t){return!e||e.length!==t.length||t.some(function(i,r){return i!==e[r]})}function Lf(e,t){return typeof t=="function"?t(e):t}var On,hi,$f,Mn,Zu,Yu,Xu,Ku,Ju,eh,th,Nf=xt(()=>{tt(),Mn=0,Zu=[],Yu=Ce.__b,Xu=Ce.__r,Ku=Ce.diffed,Ju=Ce.__c,eh=Ce.unmount,Ce.__b=function(e){hi=null,Yu&&Yu(e)},Ce.__r=function(e){Xu&&Xu(e),On=0;var t=(hi=e.__c).__H;t&&(t.__h.forEach(So),t.__h.forEach(Vu),t.__h=[])},Ce.diffed=function(e){Ku&&Ku(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(Zu.push(t)!==1&&$f===Ce.requestAnimationFrame||(($f=Ce.requestAnimationFrame)||function(i){var r,n=function(){clearTimeout(a),th&&cancelAnimationFrame(r),setTimeout(i)},a=setTimeout(n,100);th&&(r=requestAnimationFrame(n))})(bx)),hi=null},Ce.__c=function(e,t){t.some(function(i){try{i.__h.forEach(So),i.__h=i.__h.filter(function(r){return!r.__||Vu(r)})}catch(r){t.some(function(n){n.__h&&(n.__h=[])}),t=[],Ce.__e(r,i.__v)}}),Ju&&Ju(e,t)},Ce.unmount=function(e){eh&&eh(e);var t,i=e.__c;i&&i.__H&&(i.__H.__.forEach(function(r){try{So(r)}catch(n){t=n}}),t&&Ce.__e(t,i.__v))},th=typeof requestAnimationFrame=="function"}),Ln={};kt(Ln,{Children:()=>nn,Component:()=>ei,Fragment:()=>rt,PureComponent:()=>Eo,StrictMode:()=>Xf,Suspense:()=>ma,SuspenseList:()=>ks,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:()=>fh,cloneElement:()=>Ao,createContext:()=>ri,createElement:()=>N,createFactory:()=>Df,createPortal:()=>jf,createRef:()=>br,default:()=>te,findDOMNode:()=>Hf,flushSync:()=>gh,forwardRef:()=>ci,hydrate:()=>Uf,isValidElement:()=>ya,lazy:()=>Bf,memo:()=>rh,render:()=>Ps,unmountComponentAtNode:()=>Wf,unstable_batchedUpdates:()=>ph,useCallback:()=>Qe,useContext:()=>Yt,useDebugValue:()=>Mf,useEffect:()=>fe,useErrorBoundary:()=>vx,useImperativeHandle:()=>Of,useLayoutEffect:()=>Et,useMemo:()=>Ae,useReducer:()=>As,useRef:()=>xe,useState:()=>je,version:()=>Cs});function zf(e,t){for(var i in t)e[i]=t[i];return e}function ih(e,t){for(var i in e)if(i!=="__source"&&!(i in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function Eo(e){this.props=e}function rh(e,t){function i(n){var a=this.props.ref,l=a==n.ref;return!l&&a&&(a.call?a(null):a.current=null),t?!t(this.props,n)||!l:ih(this.props,n)}function r(n){return this.shouldComponentUpdate=i,N(e,n)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}function ci(e){function t(i){var r=zf({},i);return delete r.ref,e(r,i.ref||null)}return t.$$typeof=qf,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}function ma(){this.__u=0,this.t=null,this.__b=null}function Ff(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function Bf(e){var t,i,r;function n(a){if(t||(t=e()).then(function(l){i=l.default||l},function(l){r=l}),r)throw r;if(!i)throw t;return N(i,a)}return n.displayName="Lazy",n.__f=!0,n}function ks(){this.u=null,this.o=null}function wx(e){return this.getChildContext=function(){return e.context},e.children}function xx(e){var t=this,i=e.i;t.componentWillUnmount=function(){wr(null,t.l),t.l=null,t.i=null},t.i&&t.i!==i&&t.componentWillUnmount(),e.__v?(t.l||(t.i=i,t.l={nodeType:1,parentNode:i,childNodes:[],appendChild:function(r){this.childNodes.push(r),t.i.appendChild(r)},insertBefore:function(r,n){this.childNodes.push(r),t.i.appendChild(r)},removeChild:function(r){this.childNodes.splice(this.childNodes.indexOf(r)>>>1,1),t.i.removeChild(r)}}),wr(N(wx,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function jf(e,t){return N(xx,{__v:e,i:t})}function Ps(e,t,i){return t.__k==null&&(t.textContent=""),wr(e,t),typeof i=="function"&&i(),e?e.__c:null}function Uf(e,t,i){return Hu(e,t),typeof i=="function"&&i(),e?e.__c:null}function _x(){}function Sx(){return this.cancelBubble}function Ex(){return this.defaultPrevented}function Df(e){return N.bind(null,e)}function ya(e){return!!e&&e.$$typeof===lh}function Ao(e){return ya(e)?qu.apply(null,arguments):e}function Wf(e){return!!e.__k&&(wr(null,e),!0)}function Hf(e){return e&&(e.base||e.nodeType===1&&e)||null}var nh,qf,sh,nn,Qf,ah,oh,lh,Vf,Gf,Zf,uh,Yf,hh,ch,dh,fh,Cs,ph,gh,Xf,te,pe=xt(()=>{Nf(),Nf(),tt(),tt(),(Eo.prototype=new ei).isPureReactComponent=!0,Eo.prototype.shouldComponentUpdate=function(e,t){return ih(this.props,e)||ih(this.state,t)},nh=Ce.__b,Ce.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),nh&&nh(e)},qf=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911,sh=function(e,t){return e==null?null:ge(ge(e).map(t))},nn={map:sh,forEach:sh,count:function(e){return e?ge(e).length:0},only:function(e){var t=ge(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:ge},Qf=Ce.__e,Ce.__e=function(e,t,i,r){if(e.then){for(var n,a=t;a=a.__;)if((n=a.__c)&&n.__c)return t.__e==null&&(t.__e=i.__e,t.__k=i.__k),n.__c(e,t)}Qf(e,t,i,r)},ah=Ce.unmount,Ce.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),ah&&ah(e)},(ma.prototype=new ei).__c=function(e,t){var i=t.__c,r=this;r.t==null&&(r.t=[]),r.t.push(i);var n=Ff(r.__v),a=!1,l=function(){a||(a=!0,i.__R=null,n?n(u):u())};i.__R=l;var u=function(){if(!--r.__u){if(r.state.__e){var d=r.state.__e;r.__v.__k[0]=function y(x,E,S){return x&&(x.__v=null,x.__k=x.__k&&x.__k.map(function(k){return y(k,E,S)}),x.__c&&x.__c.__P===E&&(x.__e&&S.insertBefore(x.__e,x.__d),x.__c.__e=!0,x.__c.__P=S)),x}(d,d.__c.__P,d.__c.__O)}var p;for(r.setState({__e:r.__b=null});p=r.t.pop();)p.forceUpdate()}},c=t.__h===!0;r.__u++||c||r.setState({__e:r.__b=r.__v.__k[0]}),e.then(l,l)},ma.prototype.componentWillUnmount=function(){this.t=[]},ma.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var i=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=function a(l,u,c){return l&&(l.__c&&l.__c.__H&&(l.__c.__H.__.forEach(function(d){typeof d.__c=="function"&&d.__c()}),l.__c.__H=null),(l=zf({},l)).__c!=null&&(l.__c.__P===c&&(l.__c.__P=u),l.__c=null),l.__k=l.__k&&l.__k.map(function(d){return a(d,u,c)})),l}(this.__b,i,r.__O=r.__P)}this.__b=null}var n=t.__e&&N(rt,null,e.fallback);return n&&(n.__h=null),[N(rt,null,t.__e?null:e.children),n]},oh=function(e,t,i){if(++i[1]===i[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(i=e.u;i;){for(;i.length>3;)i.pop()();if(i[1]<i[0])break;e.u=i=i[2]}},(ks.prototype=new ei).__e=function(e){var t=this,i=Ff(t.__v),r=t.o.get(e);return r[0]++,function(n){var a=function(){t.props.revealOrder?(r.push(n),oh(t,e,r)):n()};i?i(a):a()}},ks.prototype.render=function(e){this.u=null,this.o=new Map;var t=ge(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var i=t.length;i--;)this.o.set(t[i],this.u=[1,0,this.u]);return e.children},ks.prototype.componentDidUpdate=ks.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,i){oh(e,i,t)})},lh=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Vf=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Gf=typeof document<"u",Zf=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(e)},ei.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(ei.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}),uh=Ce.event,Ce.event=function(e){return uh&&(e=uh(e)),e.persist=_x,e.isPropagationStopped=Sx,e.isDefaultPrevented=Ex,e.nativeEvent=e},hh={configurable:!0,get:function(){return this.class}},ch=Ce.vnode,Ce.vnode=function(e){var t=e.type,i=e.props,r=i;if(typeof t=="string"){var n=t.indexOf("-")===-1;for(var a in r={},i){var l=i[a];Gf&&a==="children"&&t==="noscript"||a==="value"&&"defaultValue"in i&&l==null||(a==="defaultValue"&&"value"in i&&i.value==null?a="value":a==="download"&&l===!0?l="":/ondoubleclick/i.test(a)?a="ondblclick":/^onchange(textarea|input)/i.test(a+t)&&!Zf(i.type)?a="oninput":/^onfocus$/i.test(a)?a="onfocusin":/^onblur$/i.test(a)?a="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(a)?a=a.toLowerCase():n&&Vf.test(a)?a=a.replace(/[A-Z0-9]/,"-$&").toLowerCase():l===null&&(l=void 0),r[a]=l)}t=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=ge(i.children).forEach(function(u){u.props.selected=r.value.indexOf(u.props.value)!=-1})),t=="select"&&r.defaultValue!=null&&(r.value=ge(i.children).forEach(function(u){u.props.selected=r.multiple?r.defaultValue.indexOf(u.props.value)!=-1:r.defaultValue==u.props.value})),e.props=r,i.class!=i.className&&(hh.enumerable="className"in i,i.className!=null&&(r.class=i.className),Object.defineProperty(r,"className",hh))}e.$$typeof=lh,ch&&ch(e)},dh=Ce.__r,Ce.__r=function(e){dh&&dh(e),Yf=e.__c},fh={ReactCurrentDispatcher:{current:{readContext:function(e){return Yf.__n[e.__c].props.value}}}},Cs="17.0.2",ph=function(e,t){return e(t)},gh=function(e,t){return e(t)},Xf=rt,te={useState:je,useReducer:As,useEffect:fe,useLayoutEffect:Et,useRef:xe,useImperativeHandle:Of,useMemo:Ae,useCallback:Qe,useContext:Yt,useDebugValue:Mf,version:"17.0.2",Children:nn,render:Ps,hydrate:Uf,unmountComponentAtNode:Wf,createPortal:jf,createElement:N,createContext:ri,createFactory:Df,cloneElement:Ao,createRef:br,Fragment:rt,isValidElement:ya,findDOMNode:Hf,Component:ei,PureComponent:Eo,memo:rh,forwardRef:ci,flushSync:gh,unstable_batchedUpdates:ph,StrictMode:rt,Suspense:ma,SuspenseList:ks,lazy:Bf,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:fh}}),Ax=Ge(e=>{function t(ne,ke){var Le=ne.length;ne.push(ke);e:for(;0<Le;){var J=Le-1>>>1,Fe=ne[J];if(0<n(Fe,ke))ne[J]=ke,ne[Le]=Fe,Le=J;else break e}}function i(ne){return ne.length===0?null:ne[0]}function r(ne){if(ne.length===0)return null;var ke=ne[0],Le=ne.pop();if(Le!==ke){ne[0]=Le;e:for(var J=0,Fe=ne.length,Ve=Fe>>>1;J<Ve;){var Ze=2*(J+1)-1,Pt=ne[Ze],at=Ze+1,Xt=ne[at];if(0>n(Pt,Le))at<Fe&&0>n(Xt,Pt)?(ne[J]=Xt,ne[at]=Le,J=at):(ne[J]=Pt,ne[Ze]=Le,J=Ze);else if(at<Fe&&0>n(Xt,Le))ne[J]=Xt,ne[at]=Le,J=at;else break e}}return ke}function n(ne,ke){var Le=ne.sortIndex-ke.sortIndex;return Le!==0?Le:ne.id-ke.id}typeof performance=="object"&&typeof performance.now=="function"?(a=performance,e.unstable_now=function(){return a.now()}):(l=Date,u=l.now(),e.unstable_now=function(){return l.now()-u});var a,l,u,c=[],d=[],p=1,y=null,x=3,E=!1,S=!1,k=!1,T=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function $(ne){for(var ke=i(d);ke!==null;){if(ke.callback===null)r(d);else if(ke.startTime<=ne)r(d),ke.sortIndex=ke.expirationTime,t(c,ke);else break;ke=i(d)}}function z(ne){if(k=!1,$(ne),!S)if(i(c)!==null)S=!0,Oe(B);else{var ke=i(d);ke!==null&&qe(z,ke.startTime-ne)}}function B(ne,ke){S=!1,k&&(k=!1,R(Q),Q=-1),E=!0;var Le=x;try{for($(ke),y=i(c);y!==null&&(!(y.expirationTime>ke)||ne&&!ue());){var J=y.callback;if(typeof J=="function"){y.callback=null,x=y.priorityLevel;var Fe=J(y.expirationTime<=ke);ke=e.unstable_now(),typeof Fe=="function"?y.callback=Fe:y===i(c)&&r(c),$(ke)}else r(c);y=i(c)}if(y!==null)var Ve=!0;else{var Ze=i(d);Ze!==null&&qe(z,Ze.startTime-ke),Ve=!1}return Ve}finally{y=null,x=Le,E=!1}}var H=!1,Y=null,Q=-1,he=5,G=-1;function ue(){return!(e.unstable_now()-G<he)}function ce(){if(Y!==null){var ne=e.unstable_now();G=ne;var ke=!0;try{ke=Y(!0,ne)}finally{ke?be():(H=!1,Y=null)}}else H=!1}var be;typeof A=="function"?be=function(){A(ce)}:typeof MessageChannel<"u"?(re=new MessageChannel,Te=re.port2,re.port1.onmessage=ce,be=function(){Te.postMessage(null)}):be=function(){T(ce,0)};var re,Te;function Oe(ne){Y=ne,H||(H=!0,be())}function qe(ne,ke){Q=T(function(){ne(e.unstable_now())},ke)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ne){ne.callback=null},e.unstable_continueExecution=function(){S||E||(S=!0,Oe(B))},e.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):he=0<ne?Math.floor(1e3/ne):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return i(c)},e.unstable_next=function(ne){switch(x){case 1:case 2:case 3:var ke=3;break;default:ke=x}var Le=x;x=ke;try{return ne()}finally{x=Le}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ne,ke){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var Le=x;x=ne;try{return ke()}finally{x=Le}},e.unstable_scheduleCallback=function(ne,ke,Le){var J=e.unstable_now();switch(typeof Le=="object"&&Le!==null?(Le=Le.delay,Le=typeof Le=="number"&&0<Le?J+Le:J):Le=J,ne){case 1:var Fe=-1;break;case 2:Fe=250;break;case 5:Fe=1073741823;break;case 4:Fe=1e4;break;default:Fe=5e3}return Fe=Le+Fe,ne={id:p++,callback:ke,priorityLevel:ne,startTime:Le,expirationTime:Fe,sortIndex:-1},Le>J?(ne.sortIndex=Le,t(d,ne),i(c)===null&&ne===i(d)&&(k?(R(Q),Q=-1):k=!0,qe(z,Le-J))):(ne.sortIndex=Fe,t(c,ne),S||E||(S=!0,Oe(B))),ne},e.unstable_shouldYield=ue,e.unstable_wrapCallback=function(ne){var ke=x;return function(){var Le=x;x=ke;try{return ne.apply(this,arguments)}finally{x=Le}}}}),kx=Ge((e,t)=>{t.exports=Ax()}),Px=Ge((e,t)=>{t.exports=function(i){var r={},n=(pe(),Zt(Ln)),a=kx(),l=Object.assign;function u(s){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+s,h=1;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,d=Symbol.for("react.element"),p=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),k=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),$=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),B=Symbol.for("react.offscreen"),H=Symbol.iterator;function Y(s){return s===null||typeof s!="object"?null:(s=H&&s[H]||s["@@iterator"],typeof s=="function"?s:null)}function Q(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case y:return"Fragment";case p:return"Portal";case E:return"Profiler";case x:return"StrictMode";case R:return"Suspense";case A:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case k:return(s.displayName||"Context")+".Consumer";case S:return(s._context.displayName||"Context")+".Provider";case T:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case $:return o=s.displayName||null,o!==null?o:Q(s.type)||"Memo";case z:o=s._payload,s=s._init;try{return Q(s(o))}catch{}}return null}function he(s){var o=s.type;switch(s.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=o.render,s=s.displayName||s.name||"",o.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Q(o);case 8:return o===x?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function G(s){var o=s,h=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(h=o.return),s=o.return;while(s)}return o.tag===3?h:null}function ue(s){if(G(s)!==s)throw Error(u(188))}function ce(s){var o=s.alternate;if(!o){if(o=G(s),o===null)throw Error(u(188));return o!==s?null:s}for(var h=s,f=o;;){var m=h.return;if(m===null)break;var b=m.alternate;if(b===null){if(f=m.return,f!==null){h=f;continue}break}if(m.child===b.child){for(b=m.child;b;){if(b===h)return ue(m),s;if(b===f)return ue(m),o;b=b.sibling}throw Error(u(188))}if(h.return!==f.return)h=m,f=b;else{for(var I=!1,j=m.child;j;){if(j===h){I=!0,h=m,f=b;break}if(j===f){I=!0,f=m,h=b;break}j=j.sibling}if(!I){for(j=b.child;j;){if(j===h){I=!0,h=b,f=m;break}if(j===f){I=!0,f=b,h=m;break}j=j.sibling}if(!I)throw Error(u(189))}}if(h.alternate!==f)throw Error(u(190))}if(h.tag!==3)throw Error(u(188));return h.stateNode.current===h?s:o}function be(s){return s=ce(s),s!==null?re(s):null}function re(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var o=re(s);if(o!==null)return o;s=s.sibling}return null}function Te(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){if(s.tag!==4){var o=Te(s);if(o!==null)return o}s=s.sibling}return null}var Oe=Array.isArray,qe=i.getPublicInstance,ne=i.getRootHostContext,ke=i.getChildHostContext,Le=i.prepareForCommit,J=i.resetAfterCommit,Fe=i.createInstance,Ve=i.appendInitialChild,Ze=i.finalizeInitialChildren,Pt=i.prepareUpdate,at=i.shouldSetTextContent,Xt=i.createTextInstance,Ki=i.scheduleTimeout,cr=i.cancelTimeout,Ir=i.noTimeout,mi=i.isPrimaryRenderer,Wt=i.supportsMutation,Ji=i.supportsPersistence,Ht=i.supportsHydration,Be=i.getInstanceFromNode,ve=i.preparePortalMount,Pe=i.getCurrentEventPriority,ot=i.detachDeletedInstance,yt=i.supportsMicrotasks,qt=i.scheduleMicrotask,Kt=i.supportsTestSelectors,Zr=i.findFiberRoot,Dc=i.getBoundingRect,Wc=i.getTextContent,os=i.isHiddenSubtree,Fi=i.matchAccessibilityRole,Ul=i.setFocusIfFocusable,Hc=i.setupIntersectionObserver,qc=i.appendChild,Ha=i.appendChildToContainer,Zs=i.commitTextUpdate,qa=i.commitMount,Dl=i.commitUpdate,we=i.insertBefore,De=i.insertInContainerBefore,bt=i.removeChild,Nt=i.removeChildFromContainer,Ct=i.resetTextContent,ie=i.hideInstance,Me=i.hideTextInstance,lt=i.unhideInstance,wt=i.unhideTextInstance,ft=i.clearContainer,Qc=i.cloneInstance,qb=i.createContainerChildSet,Qb=i.appendChildToContainerChildSet,CR=i.finalizeContainerChildren,Vc=i.replaceContainerChildren,Vb=i.cloneHiddenInstance,Gb=i.cloneHiddenTextInstance,TR=i.canHydrateInstance,IR=i.canHydrateTextInstance,RR=i.canHydrateSuspenseInstance,Zb=i.isSuspenseInstancePending,Gc=i.isSuspenseInstanceFallback,OR=i.getSuspenseInstanceFallbackErrorDetails,MR=i.registerSuspenseInstanceRetry,Wl=i.getNextHydratableSibling,LR=i.getFirstHydratableChild,$R=i.getFirstHydratableChildWithinContainer,NR=i.getFirstHydratableChildWithinSuspenseInstance,zR=i.hydrateInstance,FR=i.hydrateTextInstance,BR=i.hydrateSuspenseInstance,jR=i.getNextHydratableInstanceAfterSuspenseInstance,UR=i.commitHydratedContainer,DR=i.commitHydratedSuspenseInstance,WR=i.clearSuspenseBoundary,HR=i.clearSuspenseBoundaryFromContainer,qR=i.shouldDeleteUnhydratedTailInstances,QR=i.didNotMatchHydratedContainerTextInstance,VR=i.didNotMatchHydratedTextInstance,Zc;function Qa(s){if(Zc===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);Zc=o&&o[1]||""}return`
`+Zc+s}var Yc=!1;function Xc(s,o){if(!s||Yc)return"";Yc=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(oe){var f=oe}Reflect.construct(s,[],o)}else{try{o.call()}catch(oe){f=oe}s.call(o.prototype)}else{try{throw Error()}catch(oe){f=oe}s()}}catch(oe){if(oe&&f&&typeof oe.stack=="string"){for(var m=oe.stack.split(`
`),b=f.stack.split(`
`),I=m.length-1,j=b.length-1;1<=I&&0<=j&&m[I]!==b[j];)j--;for(;1<=I&&0<=j;I--,j--)if(m[I]!==b[j]){if(I!==1||j!==1)do if(I--,j--,0>j||m[I]!==b[j]){var V=`
`+m[I].replace(" at new "," at ");return s.displayName&&V.includes("<anonymous>")&&(V=V.replace("<anonymous>",s.displayName)),V}while(1<=I&&0<=j);break}}}finally{Yc=!1,Error.prepareStackTrace=h}return(s=s?s.displayName||s.name:"")?Qa(s):""}var GR=Object.prototype.hasOwnProperty,Kc=[],Ys=-1;function wn(s){return{current:s}}function Tt(s){0>Ys||(s.current=Kc[Ys],Kc[Ys]=null,Ys--)}function At(s,o){Ys++,Kc[Ys]=s.current,s.current=o}var xn={},ki=wn(xn),Bi=wn(!1),ls=xn;function Xs(s,o){var h=s.type.contextTypes;if(!h)return xn;var f=s.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===o)return f.__reactInternalMemoizedMaskedChildContext;var m={},b;for(b in h)m[b]=o[b];return f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=o,s.__reactInternalMemoizedMaskedChildContext=m),m}function ji(s){return s=s.childContextTypes,s!=null}function Hl(){Tt(Bi),Tt(ki)}function Yb(s,o,h){if(ki.current!==xn)throw Error(u(168));At(ki,o),At(Bi,h)}function Xb(s,o,h){var f=s.stateNode;if(o=o.childContextTypes,typeof f.getChildContext!="function")return h;f=f.getChildContext();for(var m in f)if(!(m in o))throw Error(u(108,he(s)||"Unknown",m));return l({},h,f)}function ql(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||xn,ls=ki.current,At(ki,s),At(Bi,Bi.current),!0}function Kb(s,o,h){var f=s.stateNode;if(!f)throw Error(u(169));h?(s=Xb(s,o,ls),f.__reactInternalMemoizedMergedChildContext=s,Tt(Bi),Tt(ki),At(ki,s)):Tt(Bi),At(Bi,h)}var dr=Math.clz32?Math.clz32:XR,ZR=Math.log,YR=Math.LN2;function XR(s){return s>>>=0,s===0?32:31-(ZR(s)/YR|0)|0}var Ql=64,Vl=4194304;function Va(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Gl(s,o){var h=s.pendingLanes;if(h===0)return 0;var f=0,m=s.suspendedLanes,b=s.pingedLanes,I=h&268435455;if(I!==0){var j=I&~m;j!==0?f=Va(j):(b&=I,b!==0&&(f=Va(b)))}else I=h&~m,I!==0?f=Va(I):b!==0&&(f=Va(b));if(f===0)return 0;if(o!==0&&o!==f&&(o&m)===0&&(m=f&-f,b=o&-o,m>=b||m===16&&(b&4194240)!==0))return o;if((f&4)!==0&&(f|=h&16),o=s.entangledLanes,o!==0)for(s=s.entanglements,o&=f;0<o;)h=31-dr(o),m=1<<h,f|=s[h],o&=~m;return f}function KR(s,o){switch(s){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function JR(s,o){for(var h=s.suspendedLanes,f=s.pingedLanes,m=s.expirationTimes,b=s.pendingLanes;0<b;){var I=31-dr(b),j=1<<I,V=m[I];V===-1?((j&h)===0||(j&f)!==0)&&(m[I]=KR(j,o)):V<=o&&(s.expiredLanes|=j),b&=~j}}function Jc(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Jb(){var s=Ql;return Ql<<=1,(Ql&4194240)===0&&(Ql=64),s}function ed(s){for(var o=[],h=0;31>h;h++)o.push(s);return o}function Ga(s,o,h){s.pendingLanes|=o,o!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,o=31-dr(o),s[o]=h}function eO(s,o){var h=s.pendingLanes&~o;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=o,s.mutableReadLanes&=o,s.entangledLanes&=o,o=s.entanglements;var f=s.eventTimes;for(s=s.expirationTimes;0<h;){var m=31-dr(h),b=1<<m;o[m]=0,f[m]=-1,s[m]=-1,h&=~b}}function td(s,o){var h=s.entangledLanes|=o;for(s=s.entanglements;h;){var f=31-dr(h),m=1<<f;m&o|s[f]&o&&(s[f]|=o),h&=~m}}var ht=0;function e0(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var id=a.unstable_scheduleCallback,t0=a.unstable_cancelCallback,tO=a.unstable_shouldYield,iO=a.unstable_requestPaint,ai=a.unstable_now,rd=a.unstable_ImmediatePriority,rO=a.unstable_UserBlockingPriority,nd=a.unstable_NormalPriority,nO=a.unstable_IdlePriority,Zl=null,Rr=null;function sO(s){if(Rr&&typeof Rr.onCommitFiberRoot=="function")try{Rr.onCommitFiberRoot(Zl,s,void 0,(s.current.flags&128)===128)}catch{}}function aO(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var fr=typeof Object.is=="function"?Object.is:aO,Yr=null,Yl=!1,sd=!1;function i0(s){Yr===null?Yr=[s]:Yr.push(s)}function oO(s){Yl=!0,i0(s)}function Or(){if(!sd&&Yr!==null){sd=!0;var s=0,o=ht;try{var h=Yr;for(ht=1;s<h.length;s++){var f=h[s];do f=f(!0);while(f!==null)}Yr=null,Yl=!1}catch(m){throw Yr!==null&&(Yr=Yr.slice(s+1)),id(rd,Or),m}finally{ht=o,sd=!1}}return null}var Ks=[],Js=0,Xl=null,Kl=0,er=[],tr=0,us=null,Xr=1,Kr="";function hs(s,o){Ks[Js++]=Kl,Ks[Js++]=Xl,Xl=s,Kl=o}function r0(s,o,h){er[tr++]=Xr,er[tr++]=Kr,er[tr++]=us,us=s;var f=Xr;s=Kr;var m=32-dr(f)-1;f&=~(1<<m),h+=1;var b=32-dr(o)+m;if(30<b){var I=m-m%5;b=(f&(1<<I)-1).toString(32),f>>=I,m-=I,Xr=1<<32-dr(o)+m|h<<m|f,Kr=b+s}else Xr=1<<b|h<<m|f,Kr=s}function ad(s){s.return!==null&&(hs(s,1),r0(s,1,0))}function od(s){for(;s===Xl;)Xl=Ks[--Js],Ks[Js]=null,Kl=Ks[--Js],Ks[Js]=null;for(;s===us;)us=er[--tr],er[tr]=null,Kr=er[--tr],er[tr]=null,Xr=er[--tr],er[tr]=null}var Gi=null,ir=null,Rt=!1,Za=!1,pr=null;function n0(s,o){var h=or(5,null,null,0);h.elementType="DELETED",h.stateNode=o,h.return=s,o=s.deletions,o===null?(s.deletions=[h],s.flags|=16):o.push(h)}function s0(s,o){switch(s.tag){case 5:return o=TR(o,s.type,s.pendingProps),o!==null?(s.stateNode=o,Gi=s,ir=LR(o),!0):!1;case 6:return o=IR(o,s.pendingProps),o!==null?(s.stateNode=o,Gi=s,ir=null,!0):!1;case 13:if(o=RR(o),o!==null){var h=us!==null?{id:Xr,overflow:Kr}:null;return s.memoizedState={dehydrated:o,treeContext:h,retryLane:1073741824},h=or(18,null,null,0),h.stateNode=o,h.return=s,s.child=h,Gi=s,ir=null,!0}return!1;default:return!1}}function ld(s){return(s.mode&1)!==0&&(s.flags&128)===0}function ud(s){if(Rt){var o=ir;if(o){var h=o;if(!s0(s,o)){if(ld(s))throw Error(u(418));o=Wl(h);var f=Gi;o&&s0(s,o)?n0(f,h):(s.flags=s.flags&-4097|2,Rt=!1,Gi=s)}}else{if(ld(s))throw Error(u(418));s.flags=s.flags&-4097|2,Rt=!1,Gi=s}}}function a0(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Gi=s}function Jl(s){if(!Ht||s!==Gi)return!1;if(!Rt)return a0(s),Rt=!0,!1;if(s.tag!==3&&(s.tag!==5||qR(s.type)&&!at(s.type,s.memoizedProps))){var o=ir;if(o){if(ld(s))throw o0(),Error(u(418));for(;o;)n0(s,o),o=Wl(o)}}if(a0(s),s.tag===13){if(!Ht)throw Error(u(316));if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(u(317));ir=jR(s)}else ir=Gi?Wl(s.stateNode):null;return!0}function o0(){for(var s=ir;s;)s=Wl(s)}function ea(){Ht&&(ir=Gi=null,Za=Rt=!1)}function hd(s){pr===null?pr=[s]:pr.push(s)}var lO=c.ReactCurrentBatchConfig;function eu(s,o){if(fr(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var h=Object.keys(s),f=Object.keys(o);if(h.length!==f.length)return!1;for(f=0;f<h.length;f++){var m=h[f];if(!GR.call(o,m)||!fr(s[m],o[m]))return!1}return!0}function uO(s){switch(s.tag){case 5:return Qa(s.type);case 16:return Qa("Lazy");case 13:return Qa("Suspense");case 19:return Qa("SuspenseList");case 0:case 2:case 15:return s=Xc(s.type,!1),s;case 11:return s=Xc(s.type.render,!1),s;case 1:return s=Xc(s.type,!0),s;default:return""}}function gr(s,o){if(s&&s.defaultProps){o=l({},o),s=s.defaultProps;for(var h in s)o[h]===void 0&&(o[h]=s[h]);return o}return o}var tu=wn(null),iu=null,ta=null,cd=null;function dd(){cd=ta=iu=null}function l0(s,o,h){mi?(At(tu,o._currentValue),o._currentValue=h):(At(tu,o._currentValue2),o._currentValue2=h)}function fd(s){var o=tu.current;Tt(tu),mi?s._currentValue=o:s._currentValue2=o}function pd(s,o,h){for(;s!==null;){var f=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),s===h)break;s=s.return}}function ia(s,o){iu=s,cd=ta=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&o)!==0&&(Ui=!0),s.firstContext=null)}function rr(s){var o=mi?s._currentValue:s._currentValue2;if(cd!==s)if(s={context:s,memoizedValue:o,next:null},ta===null){if(iu===null)throw Error(u(308));ta=s,iu.dependencies={lanes:0,firstContext:s}}else ta=ta.next=s;return o}var cs=null;function gd(s){cs===null?cs=[s]:cs.push(s)}function u0(s,o,h,f){var m=o.interleaved;return m===null?(h.next=h,gd(o)):(h.next=m.next,m.next=h),o.interleaved=h,Mr(s,f)}function Mr(s,o){s.lanes|=o;var h=s.alternate;for(h!==null&&(h.lanes|=o),h=s,s=s.return;s!==null;)s.childLanes|=o,h=s.alternate,h!==null&&(h.childLanes|=o),h=s,s=s.return;return h.tag===3?h.stateNode:null}var _n=!1;function md(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function h0(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Jr(s,o){return{eventTime:s,lane:o,tag:0,payload:null,callback:null,next:null}}function Sn(s,o,h){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(it&2)!==0){var m=f.pending;return m===null?o.next=o:(o.next=m.next,m.next=o),f.pending=o,Mr(s,h)}return m=f.interleaved,m===null?(o.next=o,gd(f)):(o.next=m.next,m.next=o),f.interleaved=o,Mr(s,h)}function ru(s,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194240)!==0)){var f=o.lanes;f&=s.pendingLanes,h|=f,o.lanes=h,td(s,h)}}function c0(s,o){var h=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,h===f)){var m=null,b=null;if(h=h.firstBaseUpdate,h!==null){do{var I={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};b===null?m=b=I:b=b.next=I,h=h.next}while(h!==null);b===null?m=b=o:b=b.next=o}else m=b=o;h={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:b,shared:f.shared,effects:f.effects},s.updateQueue=h;return}s=h.lastBaseUpdate,s===null?h.firstBaseUpdate=o:s.next=o,h.lastBaseUpdate=o}function nu(s,o,h,f){var m=s.updateQueue;_n=!1;var b=m.firstBaseUpdate,I=m.lastBaseUpdate,j=m.shared.pending;if(j!==null){m.shared.pending=null;var V=j,oe=V.next;V.next=null,I===null?b=oe:I.next=oe,I=V;var Ee=s.alternate;Ee!==null&&(Ee=Ee.updateQueue,j=Ee.lastBaseUpdate,j!==I&&(j===null?Ee.firstBaseUpdate=oe:j.next=oe,Ee.lastBaseUpdate=V))}if(b!==null){var Ye=m.baseState;I=0,Ee=oe=V=null,j=b;do{var me=j.lane,It=j.eventTime;if((f&me)===me){Ee!==null&&(Ee=Ee.next={eventTime:It,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var _t=s,Hi=j;switch(me=o,It=h,Hi.tag){case 1:if(_t=Hi.payload,typeof _t=="function"){Ye=_t.call(It,Ye,me);break e}Ye=_t;break e;case 3:_t.flags=_t.flags&-65537|128;case 0:if(_t=Hi.payload,me=typeof _t=="function"?_t.call(It,Ye,me):_t,me==null)break e;Ye=l({},Ye,me);break e;case 2:_n=!0}}j.callback!==null&&j.lane!==0&&(s.flags|=64,me=m.effects,me===null?m.effects=[j]:me.push(j))}else It={eventTime:It,lane:me,tag:j.tag,payload:j.payload,callback:j.callback,next:null},Ee===null?(oe=Ee=It,V=Ye):Ee=Ee.next=It,I|=me;if(j=j.next,j===null){if(j=m.shared.pending,j===null)break;me=j,j=me.next,me.next=null,m.lastBaseUpdate=me,m.shared.pending=null}}while(!0);if(Ee===null&&(V=Ye),m.baseState=V,m.firstBaseUpdate=oe,m.lastBaseUpdate=Ee,o=m.shared.interleaved,o!==null){m=o;do I|=m.lane,m=m.next;while(m!==o)}else b===null&&(m.shared.lanes=0);fs|=I,s.lanes=I,s.memoizedState=Ye}}function d0(s,o,h){if(s=o.effects,o.effects=null,s!==null)for(o=0;o<s.length;o++){var f=s[o],m=f.callback;if(m!==null){if(f.callback=null,f=h,typeof m!="function")throw Error(u(191,m));m.call(f)}}}var f0=new n.Component().refs;function yd(s,o,h,f){o=s.memoizedState,h=h(f,o),h=h==null?o:l({},o,h),s.memoizedState=h,s.lanes===0&&(s.updateQueue.baseState=h)}var su={isMounted:function(s){return(s=s._reactInternals)?G(s)===s:!1},enqueueSetState:function(s,o,h){s=s._reactInternals;var f=Ii(),m=kn(s),b=Jr(f,m);b.payload=o,h!=null&&(b.callback=h),o=Sn(s,b,m),o!==null&&(ar(o,s,m,f),ru(o,s,m))},enqueueReplaceState:function(s,o,h){s=s._reactInternals;var f=Ii(),m=kn(s),b=Jr(f,m);b.tag=1,b.payload=o,h!=null&&(b.callback=h),o=Sn(s,b,m),o!==null&&(ar(o,s,m,f),ru(o,s,m))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var h=Ii(),f=kn(s),m=Jr(h,f);m.tag=2,o!=null&&(m.callback=o),o=Sn(s,m,f),o!==null&&(ar(o,s,f,h),ru(o,s,f))}};function p0(s,o,h,f,m,b,I){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,b,I):o.prototype&&o.prototype.isPureReactComponent?!eu(h,f)||!eu(m,b):!0}function g0(s,o,h){var f=!1,m=xn,b=o.contextType;return typeof b=="object"&&b!==null?b=rr(b):(m=ji(o)?ls:ki.current,f=o.contextTypes,b=(f=f!=null)?Xs(s,m):xn),o=new o(h,b),s.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=su,s.stateNode=o,o._reactInternals=s,f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=m,s.__reactInternalMemoizedMaskedChildContext=b),o}function m0(s,o,h,f){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,f),o.state!==s&&su.enqueueReplaceState(o,o.state,null)}function vd(s,o,h,f){var m=s.stateNode;m.props=h,m.state=s.memoizedState,m.refs=f0,md(s);var b=o.contextType;typeof b=="object"&&b!==null?m.context=rr(b):(b=ji(o)?ls:ki.current,m.context=Xs(s,b)),m.state=s.memoizedState,b=o.getDerivedStateFromProps,typeof b=="function"&&(yd(s,o,b,h),m.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(o=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),o!==m.state&&su.enqueueReplaceState(m,m.state,null),nu(s,h,m,f),m.state=s.memoizedState),typeof m.componentDidMount=="function"&&(s.flags|=4194308)}function Ya(s,o,h){if(s=h.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(u(309));var f=h.stateNode}if(!f)throw Error(u(147,s));var m=f,b=""+s;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===b?o.ref:(o=function(I){var j=m.refs;j===f0&&(j=m.refs={}),I===null?delete j[b]:j[b]=I},o._stringRef=b,o)}if(typeof s!="string")throw Error(u(284));if(!h._owner)throw Error(u(290,s))}return s}function au(s,o){throw s=Object.prototype.toString.call(o),Error(u(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s))}function y0(s){var o=s._init;return o(s._payload)}function v0(s){function o(q,D){if(s){var Z=q.deletions;Z===null?(q.deletions=[D],q.flags|=16):Z.push(D)}}function h(q,D){if(!s)return null;for(;D!==null;)o(q,D),D=D.sibling;return null}function f(q,D){for(q=new Map;D!==null;)D.key!==null?q.set(D.key,D):q.set(D.index,D),D=D.sibling;return q}function m(q,D){return q=Cn(q,D),q.index=0,q.sibling=null,q}function b(q,D,Z){return q.index=Z,s?(Z=q.alternate,Z!==null?(Z=Z.index,Z<D?(q.flags|=2,D):Z):(q.flags|=2,D)):(q.flags|=1048576,D)}function I(q){return s&&q.alternate===null&&(q.flags|=2),q}function j(q,D,Z,ye){return D===null||D.tag!==6?(D=sf(Z,q.mode,ye),D.return=q,D):(D=m(D,Z),D.return=q,D)}function V(q,D,Z,ye){var ze=Z.type;return ze===y?Ee(q,D,Z.props.children,ye,Z.key):D!==null&&(D.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===z&&y0(ze)===D.type)?(ye=m(D,Z.props),ye.ref=Ya(q,D,Z),ye.return=q,ye):(ye=Ou(Z.type,Z.key,Z.props,null,q.mode,ye),ye.ref=Ya(q,D,Z),ye.return=q,ye)}function oe(q,D,Z,ye){return D===null||D.tag!==4||D.stateNode.containerInfo!==Z.containerInfo||D.stateNode.implementation!==Z.implementation?(D=af(Z,q.mode,ye),D.return=q,D):(D=m(D,Z.children||[]),D.return=q,D)}function Ee(q,D,Z,ye,ze){return D===null||D.tag!==7?(D=ys(Z,q.mode,ye,ze),D.return=q,D):(D=m(D,Z),D.return=q,D)}function Ye(q,D,Z){if(typeof D=="string"&&D!==""||typeof D=="number")return D=sf(""+D,q.mode,Z),D.return=q,D;if(typeof D=="object"&&D!==null){switch(D.$$typeof){case d:return Z=Ou(D.type,D.key,D.props,null,q.mode,Z),Z.ref=Ya(q,null,D),Z.return=q,Z;case p:return D=af(D,q.mode,Z),D.return=q,D;case z:var ye=D._init;return Ye(q,ye(D._payload),Z)}if(Oe(D)||Y(D))return D=ys(D,q.mode,Z,null),D.return=q,D;au(q,D)}return null}function me(q,D,Z,ye){var ze=D!==null?D.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number")return ze!==null?null:j(q,D,""+Z,ye);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case d:return Z.key===ze?V(q,D,Z,ye):null;case p:return Z.key===ze?oe(q,D,Z,ye):null;case z:return ze=Z._init,me(q,D,ze(Z._payload),ye)}if(Oe(Z)||Y(Z))return ze!==null?null:Ee(q,D,Z,ye,null);au(q,Z)}return null}function It(q,D,Z,ye,ze){if(typeof ye=="string"&&ye!==""||typeof ye=="number")return q=q.get(Z)||null,j(D,q,""+ye,ze);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case d:return q=q.get(ye.key===null?Z:ye.key)||null,V(D,q,ye,ze);case p:return q=q.get(ye.key===null?Z:ye.key)||null,oe(D,q,ye,ze);case z:var et=ye._init;return It(q,D,Z,et(ye._payload),ze)}if(Oe(ye)||Y(ye))return q=q.get(Z)||null,Ee(D,q,ye,ze,null);au(D,ye)}return null}function _t(q,D,Z,ye){for(var ze=null,et=null,Xe=D,ct=D=0,ui=null;Xe!==null&&ct<Z.length;ct++){Xe.index>ct?(ui=Xe,Xe=null):ui=Xe.sibling;var dt=me(q,Xe,Z[ct],ye);if(dt===null){Xe===null&&(Xe=ui);break}s&&Xe&&dt.alternate===null&&o(q,Xe),D=b(dt,D,ct),et===null?ze=dt:et.sibling=dt,et=dt,Xe=ui}if(ct===Z.length)return h(q,Xe),Rt&&hs(q,ct),ze;if(Xe===null){for(;ct<Z.length;ct++)Xe=Ye(q,Z[ct],ye),Xe!==null&&(D=b(Xe,D,ct),et===null?ze=Xe:et.sibling=Xe,et=Xe);return Rt&&hs(q,ct),ze}for(Xe=f(q,Xe);ct<Z.length;ct++)ui=It(Xe,q,ct,Z[ct],ye),ui!==null&&(s&&ui.alternate!==null&&Xe.delete(ui.key===null?ct:ui.key),D=b(ui,D,ct),et===null?ze=ui:et.sibling=ui,et=ui);return s&&Xe.forEach(function(Tn){return o(q,Tn)}),Rt&&hs(q,ct),ze}function Hi(q,D,Z,ye){var ze=Y(Z);if(typeof ze!="function")throw Error(u(150));if(Z=ze.call(Z),Z==null)throw Error(u(151));for(var et=ze=null,Xe=D,ct=D=0,ui=null,dt=Z.next();Xe!==null&&!dt.done;ct++,dt=Z.next()){Xe.index>ct?(ui=Xe,Xe=null):ui=Xe.sibling;var Tn=me(q,Xe,dt.value,ye);if(Tn===null){Xe===null&&(Xe=ui);break}s&&Xe&&Tn.alternate===null&&o(q,Xe),D=b(Tn,D,ct),et===null?ze=Tn:et.sibling=Tn,et=Tn,Xe=ui}if(dt.done)return h(q,Xe),Rt&&hs(q,ct),ze;if(Xe===null){for(;!dt.done;ct++,dt=Z.next())dt=Ye(q,dt.value,ye),dt!==null&&(D=b(dt,D,ct),et===null?ze=dt:et.sibling=dt,et=dt);return Rt&&hs(q,ct),ze}for(Xe=f(q,Xe);!dt.done;ct++,dt=Z.next())dt=It(Xe,q,ct,dt.value,ye),dt!==null&&(s&&dt.alternate!==null&&Xe.delete(dt.key===null?ct:dt.key),D=b(dt,D,ct),et===null?ze=dt:et.sibling=dt,et=dt);return s&&Xe.forEach(function(BO){return o(q,BO)}),Rt&&hs(q,ct),ze}function rn(q,D,Z,ye){if(typeof Z=="object"&&Z!==null&&Z.type===y&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case d:e:{for(var ze=Z.key,et=D;et!==null;){if(et.key===ze){if(ze=Z.type,ze===y){if(et.tag===7){h(q,et.sibling),D=m(et,Z.props.children),D.return=q,q=D;break e}}else if(et.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===z&&y0(ze)===et.type){h(q,et.sibling),D=m(et,Z.props),D.ref=Ya(q,et,Z),D.return=q,q=D;break e}h(q,et);break}else o(q,et);et=et.sibling}Z.type===y?(D=ys(Z.props.children,q.mode,ye,Z.key),D.return=q,q=D):(ye=Ou(Z.type,Z.key,Z.props,null,q.mode,ye),ye.ref=Ya(q,D,Z),ye.return=q,q=ye)}return I(q);case p:e:{for(et=Z.key;D!==null;){if(D.key===et)if(D.tag===4&&D.stateNode.containerInfo===Z.containerInfo&&D.stateNode.implementation===Z.implementation){h(q,D.sibling),D=m(D,Z.children||[]),D.return=q,q=D;break e}else{h(q,D);break}else o(q,D);D=D.sibling}D=af(Z,q.mode,ye),D.return=q,q=D}return I(q);case z:return et=Z._init,rn(q,D,et(Z._payload),ye)}if(Oe(Z))return _t(q,D,Z,ye);if(Y(Z))return Hi(q,D,Z,ye);au(q,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"?(Z=""+Z,D!==null&&D.tag===6?(h(q,D.sibling),D=m(D,Z),D.return=q,q=D):(h(q,D),D=sf(Z,q.mode,ye),D.return=q,q=D),I(q)):h(q,D)}return rn}var ra=v0(!0),b0=v0(!1),Xa={},nr=wn(Xa),Ka=wn(Xa),na=wn(Xa);function Lr(s){if(s===Xa)throw Error(u(174));return s}function bd(s,o){At(na,o),At(Ka,s),At(nr,Xa),s=ne(o),Tt(nr),At(nr,s)}function sa(){Tt(nr),Tt(Ka),Tt(na)}function w0(s){var o=Lr(na.current),h=Lr(nr.current);o=ke(h,s.type,o),h!==o&&(At(Ka,s),At(nr,o))}function wd(s){Ka.current===s&&(Tt(nr),Tt(Ka))}var zt=wn(0);function ou(s){for(var o=s;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||Zb(h)||Gc(h)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var xd=[];function _d(){for(var s=0;s<xd.length;s++){var o=xd[s];mi?o._workInProgressVersionPrimary=null:o._workInProgressVersionSecondary=null}xd.length=0}var lu=c.ReactCurrentDispatcher,Sd=c.ReactCurrentBatchConfig,ds=0,Ft=null,ti=null,oi=null,uu=!1,Ja=!1,eo=0,hO=0;function Pi(){throw Error(u(321))}function Ed(s,o){if(o===null)return!1;for(var h=0;h<o.length&&h<s.length;h++)if(!fr(s[h],o[h]))return!1;return!0}function Ad(s,o,h,f,m,b){if(ds=b,Ft=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,lu.current=s===null||s.memoizedState===null?pO:gO,s=h(f,m),Ja){b=0;do{if(Ja=!1,eo=0,25<=b)throw Error(u(301));b+=1,oi=ti=null,o.updateQueue=null,lu.current=mO,s=h(f,m)}while(Ja)}if(lu.current=du,o=ti!==null&&ti.next!==null,ds=0,oi=ti=Ft=null,uu=!1,o)throw Error(u(300));return s}function kd(){var s=eo!==0;return eo=0,s}function $r(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return oi===null?Ft.memoizedState=oi=s:oi=oi.next=s,oi}function sr(){if(ti===null){var s=Ft.alternate;s=s!==null?s.memoizedState:null}else s=ti.next;var o=oi===null?Ft.memoizedState:oi.next;if(o!==null)oi=o,ti=s;else{if(s===null)throw Error(u(310));ti=s,s={memoizedState:ti.memoizedState,baseState:ti.baseState,baseQueue:ti.baseQueue,queue:ti.queue,next:null},oi===null?Ft.memoizedState=oi=s:oi=oi.next=s}return oi}function to(s,o){return typeof o=="function"?o(s):o}function Pd(s){var o=sr(),h=o.queue;if(h===null)throw Error(u(311));h.lastRenderedReducer=s;var f=ti,m=f.baseQueue,b=h.pending;if(b!==null){if(m!==null){var I=m.next;m.next=b.next,b.next=I}f.baseQueue=m=b,h.pending=null}if(m!==null){b=m.next,f=f.baseState;var j=I=null,V=null,oe=b;do{var Ee=oe.lane;if((ds&Ee)===Ee)V!==null&&(V=V.next={lane:0,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),f=oe.hasEagerState?oe.eagerState:s(f,oe.action);else{var Ye={lane:Ee,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null};V===null?(j=V=Ye,I=f):V=V.next=Ye,Ft.lanes|=Ee,fs|=Ee}oe=oe.next}while(oe!==null&&oe!==b);V===null?I=f:V.next=j,fr(f,o.memoizedState)||(Ui=!0),o.memoizedState=f,o.baseState=I,o.baseQueue=V,h.lastRenderedState=f}if(s=h.interleaved,s!==null){m=s;do b=m.lane,Ft.lanes|=b,fs|=b,m=m.next;while(m!==s)}else m===null&&(h.lanes=0);return[o.memoizedState,h.dispatch]}function Cd(s){var o=sr(),h=o.queue;if(h===null)throw Error(u(311));h.lastRenderedReducer=s;var f=h.dispatch,m=h.pending,b=o.memoizedState;if(m!==null){h.pending=null;var I=m=m.next;do b=s(b,I.action),I=I.next;while(I!==m);fr(b,o.memoizedState)||(Ui=!0),o.memoizedState=b,o.baseQueue===null&&(o.baseState=b),h.lastRenderedState=b}return[b,f]}function x0(){}function _0(s,o){var h=Ft,f=sr(),m=o(),b=!fr(f.memoizedState,m);if(b&&(f.memoizedState=m,Ui=!0),f=f.queue,Td(A0.bind(null,h,f,s),[s]),f.getSnapshot!==o||b||oi!==null&&oi.memoizedState.tag&1){if(h.flags|=2048,io(9,E0.bind(null,h,f,m,o),void 0,null),li===null)throw Error(u(349));(ds&30)!==0||S0(h,o,m)}return m}function S0(s,o,h){s.flags|=16384,s={getSnapshot:o,value:h},o=Ft.updateQueue,o===null?(o={lastEffect:null,stores:null},Ft.updateQueue=o,o.stores=[s]):(h=o.stores,h===null?o.stores=[s]:h.push(s))}function E0(s,o,h,f){o.value=h,o.getSnapshot=f,k0(o)&&P0(s)}function A0(s,o,h){return h(function(){k0(o)&&P0(s)})}function k0(s){var o=s.getSnapshot;s=s.value;try{var h=o();return!fr(s,h)}catch{return!0}}function P0(s){var o=Mr(s,1);o!==null&&ar(o,s,1,-1)}function C0(s){var o=$r();return typeof s=="function"&&(s=s()),o.memoizedState=o.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:to,lastRenderedState:s},o.queue=s,s=s.dispatch=fO.bind(null,Ft,s),[o.memoizedState,s]}function io(s,o,h,f){return s={tag:s,create:o,destroy:h,deps:f,next:null},o=Ft.updateQueue,o===null?(o={lastEffect:null,stores:null},Ft.updateQueue=o,o.lastEffect=s.next=s):(h=o.lastEffect,h===null?o.lastEffect=s.next=s:(f=h.next,h.next=s,s.next=f,o.lastEffect=s)),s}function T0(){return sr().memoizedState}function hu(s,o,h,f){var m=$r();Ft.flags|=s,m.memoizedState=io(1|o,h,void 0,f===void 0?null:f)}function cu(s,o,h,f){var m=sr();f=f===void 0?null:f;var b=void 0;if(ti!==null){var I=ti.memoizedState;if(b=I.destroy,f!==null&&Ed(f,I.deps)){m.memoizedState=io(o,h,b,f);return}}Ft.flags|=s,m.memoizedState=io(1|o,h,b,f)}function I0(s,o){return hu(8390656,8,s,o)}function Td(s,o){return cu(2048,8,s,o)}function R0(s,o){return cu(4,2,s,o)}function O0(s,o){return cu(4,4,s,o)}function M0(s,o){if(typeof o=="function")return s=s(),o(s),function(){o(null)};if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function L0(s,o,h){return h=h!=null?h.concat([s]):null,cu(4,4,M0.bind(null,o,s),h)}function Id(){}function $0(s,o){var h=sr();o=o===void 0?null:o;var f=h.memoizedState;return f!==null&&o!==null&&Ed(o,f[1])?f[0]:(h.memoizedState=[s,o],s)}function N0(s,o){var h=sr();o=o===void 0?null:o;var f=h.memoizedState;return f!==null&&o!==null&&Ed(o,f[1])?f[0]:(s=s(),h.memoizedState=[s,o],s)}function z0(s,o,h){return(ds&21)===0?(s.baseState&&(s.baseState=!1,Ui=!0),s.memoizedState=h):(fr(h,o)||(h=Jb(),Ft.lanes|=h,fs|=h,s.baseState=!0),o)}function cO(s,o){var h=ht;ht=h!==0&&4>h?h:4,s(!0);var f=Sd.transition;Sd.transition={};try{s(!1),o()}finally{ht=h,Sd.transition=f}}function F0(){return sr().memoizedState}function dO(s,o,h){var f=kn(s);if(h={lane:f,action:h,hasEagerState:!1,eagerState:null,next:null},B0(s))j0(o,h);else if(h=u0(s,o,h,f),h!==null){var m=Ii();ar(h,s,f,m),U0(h,o,f)}}function fO(s,o,h){var f=kn(s),m={lane:f,action:h,hasEagerState:!1,eagerState:null,next:null};if(B0(s))j0(o,m);else{var b=s.alternate;if(s.lanes===0&&(b===null||b.lanes===0)&&(b=o.lastRenderedReducer,b!==null))try{var I=o.lastRenderedState,j=b(I,h);if(m.hasEagerState=!0,m.eagerState=j,fr(j,I)){var V=o.interleaved;V===null?(m.next=m,gd(o)):(m.next=V.next,V.next=m),o.interleaved=m;return}}catch{}finally{}h=u0(s,o,m,f),h!==null&&(m=Ii(),ar(h,s,f,m),U0(h,o,f))}}function B0(s){var o=s.alternate;return s===Ft||o!==null&&o===Ft}function j0(s,o){Ja=uu=!0;var h=s.pending;h===null?o.next=o:(o.next=h.next,h.next=o),s.pending=o}function U0(s,o,h){if((h&4194240)!==0){var f=o.lanes;f&=s.pendingLanes,h|=f,o.lanes=h,td(s,h)}}var du={readContext:rr,useCallback:Pi,useContext:Pi,useEffect:Pi,useImperativeHandle:Pi,useInsertionEffect:Pi,useLayoutEffect:Pi,useMemo:Pi,useReducer:Pi,useRef:Pi,useState:Pi,useDebugValue:Pi,useDeferredValue:Pi,useTransition:Pi,useMutableSource:Pi,useSyncExternalStore:Pi,useId:Pi,unstable_isNewReconciler:!1},pO={readContext:rr,useCallback:function(s,o){return $r().memoizedState=[s,o===void 0?null:o],s},useContext:rr,useEffect:I0,useImperativeHandle:function(s,o,h){return h=h!=null?h.concat([s]):null,hu(4194308,4,M0.bind(null,o,s),h)},useLayoutEffect:function(s,o){return hu(4194308,4,s,o)},useInsertionEffect:function(s,o){return hu(4,2,s,o)},useMemo:function(s,o){var h=$r();return o=o===void 0?null:o,s=s(),h.memoizedState=[s,o],s},useReducer:function(s,o,h){var f=$r();return o=h!==void 0?h(o):o,f.memoizedState=f.baseState=o,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},f.queue=s,s=s.dispatch=dO.bind(null,Ft,s),[f.memoizedState,s]},useRef:function(s){var o=$r();return s={current:s},o.memoizedState=s},useState:C0,useDebugValue:Id,useDeferredValue:function(s){return $r().memoizedState=s},useTransition:function(){var s=C0(!1),o=s[0];return s=cO.bind(null,s[1]),$r().memoizedState=s,[o,s]},useMutableSource:function(){},useSyncExternalStore:function(s,o,h){var f=Ft,m=$r();if(Rt){if(h===void 0)throw Error(u(407));h=h()}else{if(h=o(),li===null)throw Error(u(349));(ds&30)!==0||S0(f,o,h)}m.memoizedState=h;var b={value:h,getSnapshot:o};return m.queue=b,I0(A0.bind(null,f,b,s),[s]),f.flags|=2048,io(9,E0.bind(null,f,b,h,o),void 0,null),h},useId:function(){var s=$r(),o=li.identifierPrefix;if(Rt){var h=Kr,f=Xr;h=(f&~(1<<32-dr(f)-1)).toString(32)+h,o=":"+o+"R"+h,h=eo++,0<h&&(o+="H"+h.toString(32)),o+=":"}else h=hO++,o=":"+o+"r"+h.toString(32)+":";return s.memoizedState=o},unstable_isNewReconciler:!1},gO={readContext:rr,useCallback:$0,useContext:rr,useEffect:Td,useImperativeHandle:L0,useInsertionEffect:R0,useLayoutEffect:O0,useMemo:N0,useReducer:Pd,useRef:T0,useState:function(){return Pd(to)},useDebugValue:Id,useDeferredValue:function(s){var o=sr();return z0(o,ti.memoizedState,s)},useTransition:function(){var s=Pd(to)[0],o=sr().memoizedState;return[s,o]},useMutableSource:x0,useSyncExternalStore:_0,useId:F0,unstable_isNewReconciler:!1},mO={readContext:rr,useCallback:$0,useContext:rr,useEffect:Td,useImperativeHandle:L0,useInsertionEffect:R0,useLayoutEffect:O0,useMemo:N0,useReducer:Cd,useRef:T0,useState:function(){return Cd(to)},useDebugValue:Id,useDeferredValue:function(s){var o=sr();return ti===null?o.memoizedState=s:z0(o,ti.memoizedState,s)},useTransition:function(){var s=Cd(to)[0],o=sr().memoizedState;return[s,o]},useMutableSource:x0,useSyncExternalStore:_0,useId:F0,unstable_isNewReconciler:!1};function aa(s,o){try{var h="",f=o;do h+=uO(f),f=f.return;while(f);var m=h}catch(b){m=`
Error generating stack: `+b.message+`
`+b.stack}return{value:s,source:o,stack:m,digest:null}}function Rd(s,o,h){return{value:s,source:null,stack:h??null,digest:o??null}}function Od(s,o){try{console.error(o.value)}catch(h){setTimeout(function(){throw h})}}var yO=typeof WeakMap=="function"?WeakMap:Map;function D0(s,o,h){h=Jr(-1,h),h.tag=3,h.payload={element:null};var f=o.value;return h.callback=function(){ku||(ku=!0,Xd=f),Od(s,o)},h}function W0(s,o,h){h=Jr(-1,h),h.tag=3;var f=s.type.getDerivedStateFromError;if(typeof f=="function"){var m=o.value;h.payload=function(){return f(m)},h.callback=function(){Od(s,o)}}var b=s.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(h.callback=function(){Od(s,o),typeof f!="function"&&(En===null?En=new Set([this]):En.add(this));var I=o.stack;this.componentDidCatch(o.value,{componentStack:I!==null?I:""})}),h}function H0(s,o,h){var f=s.pingCache;if(f===null){f=s.pingCache=new yO;var m=new Set;f.set(o,m)}else m=f.get(o),m===void 0&&(m=new Set,f.set(o,m));m.has(h)||(m.add(h),s=RO.bind(null,s,o,h),o.then(s,s))}function q0(s){do{var o;if((o=s.tag===13)&&(o=s.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return s;s=s.return}while(s!==null);return null}function Q0(s,o,h,f,m){return(s.mode&1)===0?(s===o?s.flags|=65536:(s.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(o=Jr(-1,1),o.tag=2,Sn(h,o,1))),h.lanes|=1),s):(s.flags|=65536,s.lanes=m,s)}var vO=c.ReactCurrentOwner,Ui=!1;function $i(s,o,h,f){o.child=s===null?b0(o,null,h,f):ra(o,s.child,h,f)}function V0(s,o,h,f,m){h=h.render;var b=o.ref;return ia(o,m),f=Ad(s,o,h,f,b,m),h=kd(),s!==null&&!Ui?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~m,en(s,o,m)):(Rt&&h&&ad(o),o.flags|=1,$i(s,o,f,m),o.child)}function G0(s,o,h,f,m){if(s===null){var b=h.type;return typeof b=="function"&&!nf(b)&&b.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(o.tag=15,o.type=b,Z0(s,o,b,f,m)):(s=Ou(h.type,null,f,o,o.mode,m),s.ref=o.ref,s.return=o,o.child=s)}if(b=s.child,(s.lanes&m)===0){var I=b.memoizedProps;if(h=h.compare,h=h!==null?h:eu,h(I,f)&&s.ref===o.ref)return en(s,o,m)}return o.flags|=1,s=Cn(b,f),s.ref=o.ref,s.return=o,o.child=s}function Z0(s,o,h,f,m){if(s!==null){var b=s.memoizedProps;if(eu(b,f)&&s.ref===o.ref)if(Ui=!1,o.pendingProps=f=b,(s.lanes&m)!==0)(s.flags&131072)!==0&&(Ui=!0);else return o.lanes=s.lanes,en(s,o,m)}return Md(s,o,h,f,m)}function Y0(s,o,h){var f=o.pendingProps,m=f.children,b=s!==null?s.memoizedState:null;if(f.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},At(la,Zi),Zi|=h;else{if((h&1073741824)===0)return s=b!==null?b.baseLanes|h:h,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:s,cachePool:null,transitions:null},o.updateQueue=null,At(la,Zi),Zi|=s,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=b!==null?b.baseLanes:h,At(la,Zi),Zi|=f}else b!==null?(f=b.baseLanes|h,o.memoizedState=null):f=h,At(la,Zi),Zi|=f;return $i(s,o,m,h),o.child}function X0(s,o){var h=o.ref;(s===null&&h!==null||s!==null&&s.ref!==h)&&(o.flags|=512,o.flags|=2097152)}function Md(s,o,h,f,m){var b=ji(h)?ls:ki.current;return b=Xs(o,b),ia(o,m),h=Ad(s,o,h,f,b,m),f=kd(),s!==null&&!Ui?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~m,en(s,o,m)):(Rt&&f&&ad(o),o.flags|=1,$i(s,o,h,m),o.child)}function K0(s,o,h,f,m){if(ji(h)){var b=!0;ql(o)}else b=!1;if(ia(o,m),o.stateNode===null)pu(s,o),g0(o,h,f),vd(o,h,f,m),f=!0;else if(s===null){var I=o.stateNode,j=o.memoizedProps;I.props=j;var V=I.context,oe=h.contextType;typeof oe=="object"&&oe!==null?oe=rr(oe):(oe=ji(h)?ls:ki.current,oe=Xs(o,oe));var Ee=h.getDerivedStateFromProps,Ye=typeof Ee=="function"||typeof I.getSnapshotBeforeUpdate=="function";Ye||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(j!==f||V!==oe)&&m0(o,I,f,oe),_n=!1;var me=o.memoizedState;I.state=me,nu(o,f,I,m),V=o.memoizedState,j!==f||me!==V||Bi.current||_n?(typeof Ee=="function"&&(yd(o,h,Ee,f),V=o.memoizedState),(j=_n||p0(o,h,j,f,me,V,oe))?(Ye||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(o.flags|=4194308)):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=V),I.props=f,I.state=V,I.context=oe,f=j):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{I=o.stateNode,h0(s,o),j=o.memoizedProps,oe=o.type===o.elementType?j:gr(o.type,j),I.props=oe,Ye=o.pendingProps,me=I.context,V=h.contextType,typeof V=="object"&&V!==null?V=rr(V):(V=ji(h)?ls:ki.current,V=Xs(o,V));var It=h.getDerivedStateFromProps;(Ee=typeof It=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(j!==Ye||me!==V)&&m0(o,I,f,V),_n=!1,me=o.memoizedState,I.state=me,nu(o,f,I,m);var _t=o.memoizedState;j!==Ye||me!==_t||Bi.current||_n?(typeof It=="function"&&(yd(o,h,It,f),_t=o.memoizedState),(oe=_n||p0(o,h,oe,f,me,_t,V)||!1)?(Ee||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(f,_t,V),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(f,_t,V)),typeof I.componentDidUpdate=="function"&&(o.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof I.componentDidUpdate!="function"||j===s.memoizedProps&&me===s.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&me===s.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=_t),I.props=f,I.state=_t,I.context=V,f=oe):(typeof I.componentDidUpdate!="function"||j===s.memoizedProps&&me===s.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&me===s.memoizedState||(o.flags|=1024),f=!1)}return Ld(s,o,h,f,b,m)}function Ld(s,o,h,f,m,b){X0(s,o);var I=(o.flags&128)!==0;if(!f&&!I)return m&&Kb(o,h,!1),en(s,o,b);f=o.stateNode,vO.current=o;var j=I&&typeof h.getDerivedStateFromError!="function"?null:f.render();return o.flags|=1,s!==null&&I?(o.child=ra(o,s.child,null,b),o.child=ra(o,null,j,b)):$i(s,o,j,b),o.memoizedState=f.state,m&&Kb(o,h,!0),o.child}function J0(s){var o=s.stateNode;o.pendingContext?Yb(s,o.pendingContext,o.pendingContext!==o.context):o.context&&Yb(s,o.context,!1),bd(s,o.containerInfo)}function ew(s,o,h,f,m){return ea(),hd(m),o.flags|=256,$i(s,o,h,f),o.child}var $d={dehydrated:null,treeContext:null,retryLane:0};function Nd(s){return{baseLanes:s,cachePool:null,transitions:null}}function tw(s,o,h){var f=o.pendingProps,m=zt.current,b=!1,I=(o.flags&128)!==0,j;if((j=I)||(j=s!==null&&s.memoizedState===null?!1:(m&2)!==0),j?(b=!0,o.flags&=-129):(s===null||s.memoizedState!==null)&&(m|=1),At(zt,m&1),s===null)return ud(o),s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((o.mode&1)===0?o.lanes=1:Gc(s)?o.lanes=8:o.lanes=1073741824,null):(I=f.children,s=f.fallback,b?(f=o.mode,b=o.child,I={mode:"hidden",children:I},(f&1)===0&&b!==null?(b.childLanes=0,b.pendingProps=I):b=Mu(I,f,0,null),s=ys(s,f,h,null),b.return=o,s.return=o,b.sibling=s,o.child=b,o.child.memoizedState=Nd(h),o.memoizedState=$d,s):zd(o,I));if(m=s.memoizedState,m!==null&&(j=m.dehydrated,j!==null))return bO(s,o,I,f,j,m,h);if(b){b=f.fallback,I=o.mode,m=s.child,j=m.sibling;var V={mode:"hidden",children:f.children};return(I&1)===0&&o.child!==m?(f=o.child,f.childLanes=0,f.pendingProps=V,o.deletions=null):(f=Cn(m,V),f.subtreeFlags=m.subtreeFlags&14680064),j!==null?b=Cn(j,b):(b=ys(b,I,h,null),b.flags|=2),b.return=o,f.return=o,f.sibling=b,o.child=f,f=b,b=o.child,I=s.child.memoizedState,I=I===null?Nd(h):{baseLanes:I.baseLanes|h,cachePool:null,transitions:I.transitions},b.memoizedState=I,b.childLanes=s.childLanes&~h,o.memoizedState=$d,f}return b=s.child,s=b.sibling,f=Cn(b,{mode:"visible",children:f.children}),(o.mode&1)===0&&(f.lanes=h),f.return=o,f.sibling=null,s!==null&&(h=o.deletions,h===null?(o.deletions=[s],o.flags|=16):h.push(s)),o.child=f,o.memoizedState=null,f}function zd(s,o){return o=Mu({mode:"visible",children:o},s.mode,0,null),o.return=s,s.child=o}function fu(s,o,h,f){return f!==null&&hd(f),ra(o,s.child,null,h),s=zd(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function bO(s,o,h,f,m,b,I){if(h)return o.flags&256?(o.flags&=-257,f=Rd(Error(u(422))),fu(s,o,I,f)):o.memoizedState!==null?(o.child=s.child,o.flags|=128,null):(b=f.fallback,m=o.mode,f=Mu({mode:"visible",children:f.children},m,0,null),b=ys(b,m,I,null),b.flags|=2,f.return=o,b.return=o,f.sibling=b,o.child=f,(o.mode&1)!==0&&ra(o,s.child,null,I),o.child.memoizedState=Nd(I),o.memoizedState=$d,b);if((o.mode&1)===0)return fu(s,o,I,null);if(Gc(m))return f=OR(m).digest,b=Error(u(419)),f=Rd(b,f,void 0),fu(s,o,I,f);if(h=(I&s.childLanes)!==0,Ui||h){if(f=li,f!==null){switch(I&-I){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(f.suspendedLanes|I))!==0?0:m,m!==0&&m!==b.retryLane&&(b.retryLane=m,Mr(s,m),ar(f,s,m,-1))}return rf(),f=Rd(Error(u(421))),fu(s,o,I,f)}return Zb(m)?(o.flags|=128,o.child=s.child,o=OO.bind(null,s),MR(m,o),null):(s=b.treeContext,Ht&&(ir=NR(m),Gi=o,Rt=!0,pr=null,Za=!1,s!==null&&(er[tr++]=Xr,er[tr++]=Kr,er[tr++]=us,Xr=s.id,Kr=s.overflow,us=o)),o=zd(o,f.children),o.flags|=4096,o)}function iw(s,o,h){s.lanes|=o;var f=s.alternate;f!==null&&(f.lanes|=o),pd(s.return,o,h)}function Fd(s,o,h,f,m){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:h,tailMode:m}:(b.isBackwards=o,b.rendering=null,b.renderingStartTime=0,b.last=f,b.tail=h,b.tailMode=m)}function rw(s,o,h){var f=o.pendingProps,m=f.revealOrder,b=f.tail;if($i(s,o,f.children,h),f=zt.current,(f&2)!==0)f=f&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&iw(s,h,o);else if(s.tag===19)iw(s,h,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}f&=1}if(At(zt,f),(o.mode&1)===0)o.memoizedState=null;else switch(m){case"forwards":for(h=o.child,m=null;h!==null;)s=h.alternate,s!==null&&ou(s)===null&&(m=h),h=h.sibling;h=m,h===null?(m=o.child,o.child=null):(m=h.sibling,h.sibling=null),Fd(o,!1,m,h,b);break;case"backwards":for(h=null,m=o.child,o.child=null;m!==null;){if(s=m.alternate,s!==null&&ou(s)===null){o.child=m;break}s=m.sibling,m.sibling=h,h=m,m=s}Fd(o,!0,h,null,b);break;case"together":Fd(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function pu(s,o){(o.mode&1)===0&&s!==null&&(s.alternate=null,o.alternate=null,o.flags|=2)}function en(s,o,h){if(s!==null&&(o.dependencies=s.dependencies),fs|=o.lanes,(h&o.childLanes)===0)return null;if(s!==null&&o.child!==s.child)throw Error(u(153));if(o.child!==null){for(s=o.child,h=Cn(s,s.pendingProps),o.child=h,h.return=o;s.sibling!==null;)s=s.sibling,h=h.sibling=Cn(s,s.pendingProps),h.return=o;h.sibling=null}return o.child}function wO(s,o,h){switch(o.tag){case 3:J0(o),ea();break;case 5:w0(o);break;case 1:ji(o.type)&&ql(o);break;case 4:bd(o,o.stateNode.containerInfo);break;case 10:l0(o,o.type._context,o.memoizedProps.value);break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(At(zt,zt.current&1),o.flags|=128,null):(h&o.child.childLanes)!==0?tw(s,o,h):(At(zt,zt.current&1),s=en(s,o,h),s!==null?s.sibling:null);At(zt,zt.current&1);break;case 19:if(f=(h&o.childLanes)!==0,(s.flags&128)!==0){if(f)return rw(s,o,h);o.flags|=128}var m=o.memoizedState;if(m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),At(zt,zt.current),f)break;return null;case 22:case 23:return o.lanes=0,Y0(s,o,h)}return en(s,o,h)}function Nr(s){s.flags|=4}function nw(s,o){if(s!==null&&s.child===o.child)return!0;if((o.flags&16)!==0)return!1;for(s=o.child;s!==null;){if((s.flags&12854)!==0||(s.subtreeFlags&12854)!==0)return!1;s=s.sibling}return!0}var ro,no,gu,mu;if(Wt)ro=function(s,o){for(var h=o.child;h!==null;){if(h.tag===5||h.tag===6)Ve(s,h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===o)break;for(;h.sibling===null;){if(h.return===null||h.return===o)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},no=function(){},gu=function(s,o,h,f,m){if(s=s.memoizedProps,s!==f){var b=o.stateNode,I=Lr(nr.current);h=Pt(b,h,s,f,m,I),(o.updateQueue=h)&&Nr(o)}},mu=function(s,o,h,f){h!==f&&Nr(o)};else if(Ji){ro=function(s,o,h,f){for(var m=o.child;m!==null;){if(m.tag===5){var b=m.stateNode;h&&f&&(b=Vb(b,m.type,m.memoizedProps,m)),Ve(s,b)}else if(m.tag===6)b=m.stateNode,h&&f&&(b=Gb(b,m.memoizedProps,m)),Ve(s,b);else if(m.tag!==4){if(m.tag===22&&m.memoizedState!==null)b=m.child,b!==null&&(b.return=m),ro(s,m,!0,!0);else if(m.child!==null){m.child.return=m,m=m.child;continue}}if(m===o)break;for(;m.sibling===null;){if(m.return===null||m.return===o)return;m=m.return}m.sibling.return=m.return,m=m.sibling}};var sw=function(s,o,h,f){for(var m=o.child;m!==null;){if(m.tag===5){var b=m.stateNode;h&&f&&(b=Vb(b,m.type,m.memoizedProps,m)),Qb(s,b)}else if(m.tag===6)b=m.stateNode,h&&f&&(b=Gb(b,m.memoizedProps,m)),Qb(s,b);else if(m.tag!==4){if(m.tag===22&&m.memoizedState!==null)b=m.child,b!==null&&(b.return=m),sw(s,m,!0,!0);else if(m.child!==null){m.child.return=m,m=m.child;continue}}if(m===o)break;for(;m.sibling===null;){if(m.return===null||m.return===o)return;m=m.return}m.sibling.return=m.return,m=m.sibling}};no=function(s,o){var h=o.stateNode;if(!nw(s,o)){s=h.containerInfo;var f=qb(s);sw(f,o,!1,!1),h.pendingChildren=f,Nr(o),CR(s,f)}},gu=function(s,o,h,f,m){var b=s.stateNode,I=s.memoizedProps;if((s=nw(s,o))&&I===f)o.stateNode=b;else{var j=o.stateNode,V=Lr(nr.current),oe=null;I!==f&&(oe=Pt(j,h,I,f,m,V)),s&&oe===null?o.stateNode=b:(b=Qc(b,oe,h,I,f,o,s,j),Ze(b,h,f,m,V)&&Nr(o),o.stateNode=b,s?Nr(o):ro(b,o,!1,!1))}},mu=function(s,o,h,f){h!==f?(s=Lr(na.current),h=Lr(nr.current),o.stateNode=Xt(f,s,h,o),Nr(o)):o.stateNode=s.stateNode}}else no=function(){},gu=function(){},mu=function(){};function so(s,o){if(!Rt)switch(s.tailMode){case"hidden":o=s.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?s.tail=null:h.sibling=null;break;case"collapsed":h=s.tail;for(var f=null;h!==null;)h.alternate!==null&&(f=h),h=h.sibling;f===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function Ci(s){var o=s.alternate!==null&&s.alternate.child===s.child,h=0,f=0;if(o)for(var m=s.child;m!==null;)h|=m.lanes|m.childLanes,f|=m.subtreeFlags&14680064,f|=m.flags&14680064,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)h|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=f,s.childLanes=h,o}function xO(s,o,h){var f=o.pendingProps;switch(od(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ci(o),null;case 1:return ji(o.type)&&Hl(),Ci(o),null;case 3:return h=o.stateNode,sa(),Tt(Bi),Tt(ki),_d(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Jl(o)?Nr(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,pr!==null&&(ef(pr),pr=null))),no(s,o),Ci(o),null;case 5:wd(o),h=Lr(na.current);var m=o.type;if(s!==null&&o.stateNode!=null)gu(s,o,m,f,h),s.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!f){if(o.stateNode===null)throw Error(u(166));return Ci(o),null}if(s=Lr(nr.current),Jl(o)){if(!Ht)throw Error(u(175));s=zR(o.stateNode,o.type,o.memoizedProps,h,s,o,!Za),o.updateQueue=s,s!==null&&Nr(o)}else{var b=Fe(m,f,h,s,o);ro(b,o,!1,!1),o.stateNode=b,Ze(b,m,f,h,s)&&Nr(o)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Ci(o),null;case 6:if(s&&o.stateNode!=null)mu(s,o,s.memoizedProps,f);else{if(typeof f!="string"&&o.stateNode===null)throw Error(u(166));if(s=Lr(na.current),h=Lr(nr.current),Jl(o)){if(!Ht)throw Error(u(176));if(s=o.stateNode,h=o.memoizedProps,(f=FR(s,h,o,!Za))&&(m=Gi,m!==null))switch(m.tag){case 3:QR(m.stateNode.containerInfo,s,h,(m.mode&1)!==0);break;case 5:VR(m.type,m.memoizedProps,m.stateNode,s,h,(m.mode&1)!==0)}f&&Nr(o)}else o.stateNode=Xt(f,s,h,o)}return Ci(o),null;case 13:if(Tt(zt),f=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Rt&&ir!==null&&(o.mode&1)!==0&&(o.flags&128)===0)o0(),ea(),o.flags|=98560,m=!1;else if(m=Jl(o),f!==null&&f.dehydrated!==null){if(s===null){if(!m)throw Error(u(318));if(!Ht)throw Error(u(344));if(m=o.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(u(317));BR(m,o)}else ea(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Ci(o),m=!1}else pr!==null&&(ef(pr),pr=null),m=!0;if(!m)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=h,o):(h=f!==null,h!==(s!==null&&s.memoizedState!==null)&&h&&(o.child.flags|=8192,(o.mode&1)!==0&&(s===null||(zt.current&1)!==0?ii===0&&(ii=3):rf())),o.updateQueue!==null&&(o.flags|=4),Ci(o),null);case 4:return sa(),no(s,o),s===null&&ve(o.stateNode.containerInfo),Ci(o),null;case 10:return fd(o.type._context),Ci(o),null;case 17:return ji(o.type)&&Hl(),Ci(o),null;case 19:if(Tt(zt),m=o.memoizedState,m===null)return Ci(o),null;if(f=(o.flags&128)!==0,b=m.rendering,b===null)if(f)so(m,!1);else{if(ii!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(b=ou(s),b!==null){for(o.flags|=128,so(m,!1),s=b.updateQueue,s!==null&&(o.updateQueue=s,o.flags|=4),o.subtreeFlags=0,s=h,h=o.child;h!==null;)f=h,m=s,f.flags&=14680066,b=f.alternate,b===null?(f.childLanes=0,f.lanes=m,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=b.childLanes,f.lanes=b.lanes,f.child=b.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=b.memoizedProps,f.memoizedState=b.memoizedState,f.updateQueue=b.updateQueue,f.type=b.type,m=b.dependencies,f.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext}),h=h.sibling;return At(zt,zt.current&1|2),o.child}s=s.sibling}m.tail!==null&&ai()>Yd&&(o.flags|=128,f=!0,so(m,!1),o.lanes=4194304)}else{if(!f)if(s=ou(b),s!==null){if(o.flags|=128,f=!0,s=s.updateQueue,s!==null&&(o.updateQueue=s,o.flags|=4),so(m,!0),m.tail===null&&m.tailMode==="hidden"&&!b.alternate&&!Rt)return Ci(o),null}else 2*ai()-m.renderingStartTime>Yd&&h!==1073741824&&(o.flags|=128,f=!0,so(m,!1),o.lanes=4194304);m.isBackwards?(b.sibling=o.child,o.child=b):(s=m.last,s!==null?s.sibling=b:o.child=b,m.last=b)}return m.tail!==null?(o=m.tail,m.rendering=o,m.tail=o.sibling,m.renderingStartTime=ai(),o.sibling=null,s=zt.current,At(zt,f?s&1|2:s&1),o):(Ci(o),null);case 22:case 23:return tf(),h=o.memoizedState!==null,s!==null&&s.memoizedState!==null!==h&&(o.flags|=8192),h&&(o.mode&1)!==0?(Zi&1073741824)!==0&&(Ci(o),Wt&&o.subtreeFlags&6&&(o.flags|=8192)):Ci(o),null;case 24:return null;case 25:return null}throw Error(u(156,o.tag))}function _O(s,o){switch(od(o),o.tag){case 1:return ji(o.type)&&Hl(),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return sa(),Tt(Bi),Tt(ki),_d(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 5:return wd(o),null;case 13:if(Tt(zt),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(u(340));ea()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return Tt(zt),null;case 4:return sa(),null;case 10:return fd(o.type._context),null;case 22:case 23:return tf(),null;case 24:return null;default:return null}}var yu=!1,Ti=!1,SO=typeof WeakSet=="function"?WeakSet:Set,_e=null;function oa(s,o){var h=s.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(f){Ot(s,o,f)}else h.current=null}function aw(s,o,h){try{h()}catch(f){Ot(s,o,f)}}var ow=!1;function EO(s,o){for(Le(s.containerInfo),_e=o;_e!==null;)if(s=_e,o=s.child,(s.subtreeFlags&1028)!==0&&o!==null)o.return=s,_e=o;else for(;_e!==null;){s=_e;try{var h=s.alternate;if((s.flags&1024)!==0)switch(s.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var f=h.memoizedProps,m=h.memoizedState,b=s.stateNode,I=b.getSnapshotBeforeUpdate(s.elementType===s.type?f:gr(s.type,f),m);b.__reactInternalSnapshotBeforeUpdate=I}break;case 3:Wt&&ft(s.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(u(163))}}catch(j){Ot(s,s.return,j)}if(o=s.sibling,o!==null){o.return=s.return,_e=o;break}_e=s.return}return h=ow,ow=!1,h}function ao(s,o,h){var f=o.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var m=f=f.next;do{if((m.tag&s)===s){var b=m.destroy;m.destroy=void 0,b!==void 0&&aw(o,h,b)}m=m.next}while(m!==f)}}function vu(s,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var h=o=o.next;do{if((h.tag&s)===s){var f=h.create;h.destroy=f()}h=h.next}while(h!==o)}}function Bd(s){var o=s.ref;if(o!==null){var h=s.stateNode;switch(s.tag){case 5:s=qe(h);break;default:s=h}typeof o=="function"?o(s):o.current=s}}function lw(s){var o=s.alternate;o!==null&&(s.alternate=null,lw(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&ot(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function uw(s){return s.tag===5||s.tag===3||s.tag===4}function hw(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||uw(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function jd(s,o,h){var f=s.tag;if(f===5||f===6)s=s.stateNode,o?De(h,s,o):Ha(h,s);else if(f!==4&&(s=s.child,s!==null))for(jd(s,o,h),s=s.sibling;s!==null;)jd(s,o,h),s=s.sibling}function Ud(s,o,h){var f=s.tag;if(f===5||f===6)s=s.stateNode,o?we(h,s,o):qc(h,s);else if(f!==4&&(s=s.child,s!==null))for(Ud(s,o,h),s=s.sibling;s!==null;)Ud(s,o,h),s=s.sibling}var yi=null,mr=!1;function zr(s,o,h){for(h=h.child;h!==null;)Dd(s,o,h),h=h.sibling}function Dd(s,o,h){if(Rr&&typeof Rr.onCommitFiberUnmount=="function")try{Rr.onCommitFiberUnmount(Zl,h)}catch{}switch(h.tag){case 5:Ti||oa(h,o);case 6:if(Wt){var f=yi,m=mr;yi=null,zr(s,o,h),yi=f,mr=m,yi!==null&&(mr?Nt(yi,h.stateNode):bt(yi,h.stateNode))}else zr(s,o,h);break;case 18:Wt&&yi!==null&&(mr?HR(yi,h.stateNode):WR(yi,h.stateNode));break;case 4:Wt?(f=yi,m=mr,yi=h.stateNode.containerInfo,mr=!0,zr(s,o,h),yi=f,mr=m):(Ji&&(f=h.stateNode.containerInfo,m=qb(f),Vc(f,m)),zr(s,o,h));break;case 0:case 11:case 14:case 15:if(!Ti&&(f=h.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){m=f=f.next;do{var b=m,I=b.destroy;b=b.tag,I!==void 0&&((b&2)!==0||(b&4)!==0)&&aw(h,o,I),m=m.next}while(m!==f)}zr(s,o,h);break;case 1:if(!Ti&&(oa(h,o),f=h.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=h.memoizedProps,f.state=h.memoizedState,f.componentWillUnmount()}catch(j){Ot(h,o,j)}zr(s,o,h);break;case 21:zr(s,o,h);break;case 22:h.mode&1?(Ti=(f=Ti)||h.memoizedState!==null,zr(s,o,h),Ti=f):zr(s,o,h);break;default:zr(s,o,h)}}function cw(s){var o=s.updateQueue;if(o!==null){s.updateQueue=null;var h=s.stateNode;h===null&&(h=s.stateNode=new SO),o.forEach(function(f){var m=MO.bind(null,s,f);h.has(f)||(h.add(f),f.then(m,m))})}}function yr(s,o){var h=o.deletions;if(h!==null)for(var f=0;f<h.length;f++){var m=h[f];try{var b=s,I=o;if(Wt){var j=I;e:for(;j!==null;){switch(j.tag){case 5:yi=j.stateNode,mr=!1;break e;case 3:yi=j.stateNode.containerInfo,mr=!0;break e;case 4:yi=j.stateNode.containerInfo,mr=!0;break e}j=j.return}if(yi===null)throw Error(u(160));Dd(b,I,m),yi=null,mr=!1}else Dd(b,I,m);var V=m.alternate;V!==null&&(V.return=null),m.return=null}catch(oe){Ot(m,o,oe)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)dw(o,s),o=o.sibling}function dw(s,o){var h=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(yr(o,s),Fr(s),f&4){try{ao(3,s,s.return),vu(3,s)}catch(me){Ot(s,s.return,me)}try{ao(5,s,s.return)}catch(me){Ot(s,s.return,me)}}break;case 1:yr(o,s),Fr(s),f&512&&h!==null&&oa(h,h.return);break;case 5:if(yr(o,s),Fr(s),f&512&&h!==null&&oa(h,h.return),Wt){if(s.flags&32){var m=s.stateNode;try{Ct(m)}catch(me){Ot(s,s.return,me)}}if(f&4&&(m=s.stateNode,m!=null)){var b=s.memoizedProps;if(h=h!==null?h.memoizedProps:b,f=s.type,o=s.updateQueue,s.updateQueue=null,o!==null)try{Dl(m,o,f,h,b,s)}catch(me){Ot(s,s.return,me)}}}break;case 6:if(yr(o,s),Fr(s),f&4&&Wt){if(s.stateNode===null)throw Error(u(162));m=s.stateNode,b=s.memoizedProps,h=h!==null?h.memoizedProps:b;try{Zs(m,h,b)}catch(me){Ot(s,s.return,me)}}break;case 3:if(yr(o,s),Fr(s),f&4){if(Wt&&Ht&&h!==null&&h.memoizedState.isDehydrated)try{UR(o.containerInfo)}catch(me){Ot(s,s.return,me)}if(Ji){m=o.containerInfo,b=o.pendingChildren;try{Vc(m,b)}catch(me){Ot(s,s.return,me)}}}break;case 4:if(yr(o,s),Fr(s),f&4&&Ji){b=s.stateNode,m=b.containerInfo,b=b.pendingChildren;try{Vc(m,b)}catch(me){Ot(s,s.return,me)}}break;case 13:yr(o,s),Fr(s),m=s.child,m.flags&8192&&(b=m.memoizedState!==null,m.stateNode.isHidden=b,!b||m.alternate!==null&&m.alternate.memoizedState!==null||(Zd=ai())),f&4&&cw(s);break;case 22:var I=h!==null&&h.memoizedState!==null;if(s.mode&1?(Ti=(h=Ti)||I,yr(o,s),Ti=h):yr(o,s),Fr(s),f&8192){if(h=s.memoizedState!==null,(s.stateNode.isHidden=h)&&!I&&(s.mode&1)!==0)for(_e=s,f=s.child;f!==null;){for(o=_e=f;_e!==null;){I=_e;var j=I.child;switch(I.tag){case 0:case 11:case 14:case 15:ao(4,I,I.return);break;case 1:oa(I,I.return);var V=I.stateNode;if(typeof V.componentWillUnmount=="function"){var oe=I,Ee=I.return;try{var Ye=oe;V.props=Ye.memoizedProps,V.state=Ye.memoizedState,V.componentWillUnmount()}catch(me){Ot(oe,Ee,me)}}break;case 5:oa(I,I.return);break;case 22:if(I.memoizedState!==null){gw(o);continue}}j!==null?(j.return=I,_e=j):gw(o)}f=f.sibling}if(Wt){e:if(f=null,Wt)for(o=s;;){if(o.tag===5){if(f===null){f=o;try{m=o.stateNode,h?ie(m):lt(o.stateNode,o.memoizedProps)}catch(me){Ot(s,s.return,me)}}}else if(o.tag===6){if(f===null)try{b=o.stateNode,h?Me(b):wt(b,o.memoizedProps)}catch(me){Ot(s,s.return,me)}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;f===o&&(f=null),o=o.return}f===o&&(f=null),o.sibling.return=o.return,o=o.sibling}}}break;case 19:yr(o,s),Fr(s),f&4&&cw(s);break;case 21:break;default:yr(o,s),Fr(s)}}function Fr(s){var o=s.flags;if(o&2){try{if(Wt){e:{for(var h=s.return;h!==null;){if(uw(h)){var f=h;break e}h=h.return}throw Error(u(160))}switch(f.tag){case 5:var m=f.stateNode;f.flags&32&&(Ct(m),f.flags&=-33);var b=hw(s);Ud(s,b,m);break;case 3:case 4:var I=f.stateNode.containerInfo,j=hw(s);jd(s,j,I);break;default:throw Error(u(161))}}}catch(V){Ot(s,s.return,V)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function AO(s,o,h){_e=s,fw(s)}function fw(s,o,h){for(var f=(s.mode&1)!==0;_e!==null;){var m=_e,b=m.child;if(m.tag===22&&f){var I=m.memoizedState!==null||yu;if(!I){var j=m.alternate,V=j!==null&&j.memoizedState!==null||Ti;j=yu;var oe=Ti;if(yu=I,(Ti=V)&&!oe)for(_e=m;_e!==null;)I=_e,V=I.child,I.tag===22&&I.memoizedState!==null?mw(m):V!==null?(V.return=I,_e=V):mw(m);for(;b!==null;)_e=b,fw(b),b=b.sibling;_e=m,yu=j,Ti=oe}pw(s)}else(m.subtreeFlags&8772)!==0&&b!==null?(b.return=m,_e=b):pw(s)}}function pw(s){for(;_e!==null;){var o=_e;if((o.flags&8772)!==0){var h=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:Ti||vu(5,o);break;case 1:var f=o.stateNode;if(o.flags&4&&!Ti)if(h===null)f.componentDidMount();else{var m=o.elementType===o.type?h.memoizedProps:gr(o.type,h.memoizedProps);f.componentDidUpdate(m,h.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var b=o.updateQueue;b!==null&&d0(o,b,f);break;case 3:var I=o.updateQueue;if(I!==null){if(h=null,o.child!==null)switch(o.child.tag){case 5:h=qe(o.child.stateNode);break;case 1:h=o.child.stateNode}d0(o,I,h)}break;case 5:var j=o.stateNode;h===null&&o.flags&4&&qa(j,o.type,o.memoizedProps,o);break;case 6:break;case 4:break;case 12:break;case 13:if(Ht&&o.memoizedState===null){var V=o.alternate;if(V!==null){var oe=V.memoizedState;if(oe!==null){var Ee=oe.dehydrated;Ee!==null&&DR(Ee)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(u(163))}Ti||o.flags&512&&Bd(o)}catch(Ye){Ot(o,o.return,Ye)}}if(o===s){_e=null;break}if(h=o.sibling,h!==null){h.return=o.return,_e=h;break}_e=o.return}}function gw(s){for(;_e!==null;){var o=_e;if(o===s){_e=null;break}var h=o.sibling;if(h!==null){h.return=o.return,_e=h;break}_e=o.return}}function mw(s){for(;_e!==null;){var o=_e;try{switch(o.tag){case 0:case 11:case 15:var h=o.return;try{vu(4,o)}catch(V){Ot(o,h,V)}break;case 1:var f=o.stateNode;if(typeof f.componentDidMount=="function"){var m=o.return;try{f.componentDidMount()}catch(V){Ot(o,m,V)}}var b=o.return;try{Bd(o)}catch(V){Ot(o,b,V)}break;case 5:var I=o.return;try{Bd(o)}catch(V){Ot(o,I,V)}}}catch(V){Ot(o,o.return,V)}if(o===s){_e=null;break}var j=o.sibling;if(j!==null){j.return=o.return,_e=j;break}_e=o.return}}var bu=0,wu=1,xu=2,_u=3,Su=4;if(typeof Symbol=="function"&&Symbol.for){var oo=Symbol.for;bu=oo("selector.component"),wu=oo("selector.has_pseudo_class"),xu=oo("selector.role"),_u=oo("selector.test_id"),Su=oo("selector.text")}function Wd(s){var o=Be(s);if(o!=null){if(typeof o.memoizedProps["data-testname"]!="string")throw Error(u(364));return o}if(s=Zr(s),s===null)throw Error(u(362));return s.stateNode.current}function Hd(s,o){switch(o.$$typeof){case bu:if(s.type===o.value)return!0;break;case wu:e:{o=o.value,s=[s,0];for(var h=0;h<s.length;){var f=s[h++],m=s[h++],b=o[m];if(f.tag!==5||!os(f)){for(;b!=null&&Hd(f,b);)m++,b=o[m];if(m===o.length){o=!0;break e}else for(f=f.child;f!==null;)s.push(f,m),f=f.sibling}}o=!1}return o;case xu:if(s.tag===5&&Fi(s.stateNode,o.value))return!0;break;case Su:if((s.tag===5||s.tag===6)&&(s=Wc(s),s!==null&&0<=s.indexOf(o.value)))return!0;break;case _u:if(s.tag===5&&(s=s.memoizedProps["data-testname"],typeof s=="string"&&s.toLowerCase()===o.value.toLowerCase()))return!0;break;default:throw Error(u(365))}return!1}function qd(s){switch(s.$$typeof){case bu:return"<"+(Q(s.value)||"Unknown")+">";case wu:return":has("+(qd(s)||"")+")";case xu:return'[role="'+s.value+'"]';case Su:return'"'+s.value+'"';case _u:return'[data-testname="'+s.value+'"]';default:throw Error(u(365))}}function yw(s,o){var h=[];s=[s,0];for(var f=0;f<s.length;){var m=s[f++],b=s[f++],I=o[b];if(m.tag!==5||!os(m)){for(;I!=null&&Hd(m,I);)b++,I=o[b];if(b===o.length)h.push(m);else for(m=m.child;m!==null;)s.push(m,b),m=m.sibling}}return h}function Qd(s,o){if(!Kt)throw Error(u(363));s=Wd(s),s=yw(s,o),o=[],s=Array.from(s);for(var h=0;h<s.length;){var f=s[h++];if(f.tag===5)os(f)||o.push(f.stateNode);else for(f=f.child;f!==null;)s.push(f),f=f.sibling}return o}var kO=Math.ceil,Eu=c.ReactCurrentDispatcher,Vd=c.ReactCurrentOwner,Gt=c.ReactCurrentBatchConfig,it=0,li=null,Jt=null,vi=0,Zi=0,la=wn(0),ii=0,lo=null,fs=0,Au=0,Gd=0,uo=null,Di=null,Zd=0,Yd=1/0,tn=null;function ua(){Yd=ai()+500}var ku=!1,Xd=null,En=null,Pu=!1,An=null,Cu=0,ho=0,Kd=null,Tu=-1,Iu=0;function Ii(){return(it&6)!==0?ai():Tu!==-1?Tu:Tu=ai()}function kn(s){return(s.mode&1)===0?1:(it&2)!==0&&vi!==0?vi&-vi:lO.transition!==null?(Iu===0&&(Iu=Jb()),Iu):(s=ht,s!==0?s:Pe())}function ar(s,o,h,f){if(50<ho)throw ho=0,Kd=null,Error(u(185));Ga(s,h,f),((it&2)===0||s!==li)&&(s===li&&((it&2)===0&&(Au|=h),ii===4&&Pn(s,vi)),Wi(s,f),h===1&&it===0&&(o.mode&1)===0&&(ua(),Yl&&Or()))}function Wi(s,o){var h=s.callbackNode;JR(s,o);var f=Gl(s,s===li?vi:0);if(f===0)h!==null&&t0(h),s.callbackNode=null,s.callbackPriority=0;else if(o=f&-f,s.callbackPriority!==o){if(h!=null&&t0(h),o===1)s.tag===0?oO(bw.bind(null,s)):i0(bw.bind(null,s)),yt?qt(function(){(it&6)===0&&Or()}):id(rd,Or),h=null;else{switch(e0(f)){case 1:h=rd;break;case 4:h=rO;break;case 16:h=nd;break;case 536870912:h=nO;break;default:h=nd}h=Cw(h,vw.bind(null,s))}s.callbackPriority=o,s.callbackNode=h}}function vw(s,o){if(Tu=-1,Iu=0,(it&6)!==0)throw Error(u(327));var h=s.callbackNode;if(ms()&&s.callbackNode!==h)return null;var f=Gl(s,s===li?vi:0);if(f===0)return null;if((f&30)!==0||(f&s.expiredLanes)!==0||o)o=Ru(s,f);else{o=f;var m=it;it|=2;var b=_w();(li!==s||vi!==o)&&(tn=null,ua(),ps(s,o));do try{TO();break}catch(j){xw(s,j)}while(!0);dd(),Eu.current=b,it=m,Jt!==null?o=0:(li=null,vi=0,o=ii)}if(o!==0){if(o===2&&(m=Jc(s),m!==0&&(f=m,o=Jd(s,m))),o===1)throw h=lo,ps(s,0),Pn(s,f),Wi(s,ai()),h;if(o===6)Pn(s,f);else{if(m=s.current.alternate,(f&30)===0&&!PO(m)&&(o=Ru(s,f),o===2&&(b=Jc(s),b!==0&&(f=b,o=Jd(s,b))),o===1))throw h=lo,ps(s,0),Pn(s,f),Wi(s,ai()),h;switch(s.finishedWork=m,s.finishedLanes=f,o){case 0:case 1:throw Error(u(345));case 2:gs(s,Di,tn);break;case 3:if(Pn(s,f),(f&130023424)===f&&(o=Zd+500-ai(),10<o)){if(Gl(s,0)!==0)break;if(m=s.suspendedLanes,(m&f)!==f){Ii(),s.pingedLanes|=s.suspendedLanes&m;break}s.timeoutHandle=Ki(gs.bind(null,s,Di,tn),o);break}gs(s,Di,tn);break;case 4:if(Pn(s,f),(f&4194240)===f)break;for(o=s.eventTimes,m=-1;0<f;){var I=31-dr(f);b=1<<I,I=o[I],I>m&&(m=I),f&=~b}if(f=m,f=ai()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*kO(f/1960))-f,10<f){s.timeoutHandle=Ki(gs.bind(null,s,Di,tn),f);break}gs(s,Di,tn);break;case 5:gs(s,Di,tn);break;default:throw Error(u(329))}}}return Wi(s,ai()),s.callbackNode===h?vw.bind(null,s):null}function Jd(s,o){var h=uo;return s.current.memoizedState.isDehydrated&&(ps(s,o).flags|=256),s=Ru(s,o),s!==2&&(o=Di,Di=h,o!==null&&ef(o)),s}function ef(s){Di===null?Di=s:Di.push.apply(Di,s)}function PO(s){for(var o=s;;){if(o.flags&16384){var h=o.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var f=0;f<h.length;f++){var m=h[f],b=m.getSnapshot;m=m.value;try{if(!fr(b(),m))return!1}catch{return!1}}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Pn(s,o){for(o&=~Gd,o&=~Au,s.suspendedLanes|=o,s.pingedLanes&=~o,s=s.expirationTimes;0<o;){var h=31-dr(o),f=1<<h;s[h]=-1,o&=~f}}function bw(s){if((it&6)!==0)throw Error(u(327));ms();var o=Gl(s,0);if((o&1)===0)return Wi(s,ai()),null;var h=Ru(s,o);if(s.tag!==0&&h===2){var f=Jc(s);f!==0&&(o=f,h=Jd(s,f))}if(h===1)throw h=lo,ps(s,0),Pn(s,o),Wi(s,ai()),h;if(h===6)throw Error(u(345));return s.finishedWork=s.current.alternate,s.finishedLanes=o,gs(s,Di,tn),Wi(s,ai()),null}function ww(s){An!==null&&An.tag===0&&(it&6)===0&&ms();var o=it;it|=1;var h=Gt.transition,f=ht;try{if(Gt.transition=null,ht=1,s)return s()}finally{ht=f,Gt.transition=h,it=o,(it&6)===0&&Or()}}function tf(){Zi=la.current,Tt(la)}function ps(s,o){s.finishedWork=null,s.finishedLanes=0;var h=s.timeoutHandle;if(h!==Ir&&(s.timeoutHandle=Ir,cr(h)),Jt!==null)for(h=Jt.return;h!==null;){var f=h;switch(od(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&Hl();break;case 3:sa(),Tt(Bi),Tt(ki),_d();break;case 5:wd(f);break;case 4:sa();break;case 13:Tt(zt);break;case 19:Tt(zt);break;case 10:fd(f.type._context);break;case 22:case 23:tf()}h=h.return}if(li=s,Jt=s=Cn(s.current,null),vi=Zi=o,ii=0,lo=null,Gd=Au=fs=0,Di=uo=null,cs!==null){for(o=0;o<cs.length;o++)if(h=cs[o],f=h.interleaved,f!==null){h.interleaved=null;var m=f.next,b=h.pending;if(b!==null){var I=b.next;b.next=m,f.next=I}h.pending=f}cs=null}return s}function xw(s,o){do{var h=Jt;try{if(dd(),lu.current=du,uu){for(var f=Ft.memoizedState;f!==null;){var m=f.queue;m!==null&&(m.pending=null),f=f.next}uu=!1}if(ds=0,oi=ti=Ft=null,Ja=!1,eo=0,Vd.current=null,h===null||h.return===null){ii=1,lo=o,Jt=null;break}e:{var b=s,I=h.return,j=h,V=o;if(o=vi,j.flags|=32768,V!==null&&typeof V=="object"&&typeof V.then=="function"){var oe=V,Ee=j,Ye=Ee.tag;if((Ee.mode&1)===0&&(Ye===0||Ye===11||Ye===15)){var me=Ee.alternate;me?(Ee.updateQueue=me.updateQueue,Ee.memoizedState=me.memoizedState,Ee.lanes=me.lanes):(Ee.updateQueue=null,Ee.memoizedState=null)}var It=q0(I);if(It!==null){It.flags&=-257,Q0(It,I,j,b,o),It.mode&1&&H0(b,oe,o),o=It,V=oe;var _t=o.updateQueue;if(_t===null){var Hi=new Set;Hi.add(V),o.updateQueue=Hi}else _t.add(V);break e}else{if((o&1)===0){H0(b,oe,o),rf();break e}V=Error(u(426))}}else if(Rt&&j.mode&1){var rn=q0(I);if(rn!==null){(rn.flags&65536)===0&&(rn.flags|=256),Q0(rn,I,j,b,o),hd(aa(V,j));break e}}b=V=aa(V,j),ii!==4&&(ii=2),uo===null?uo=[b]:uo.push(b),b=I;do{switch(b.tag){case 3:b.flags|=65536,o&=-o,b.lanes|=o;var q=D0(b,V,o);c0(b,q);break e;case 1:j=V;var D=b.type,Z=b.stateNode;if((b.flags&128)===0&&(typeof D.getDerivedStateFromError=="function"||Z!==null&&typeof Z.componentDidCatch=="function"&&(En===null||!En.has(Z)))){b.flags|=65536,o&=-o,b.lanes|=o;var ye=W0(b,j,o);c0(b,ye);break e}}b=b.return}while(b!==null)}Ew(h)}catch(ze){o=ze,Jt===h&&h!==null&&(Jt=h=h.return);continue}break}while(!0)}function _w(){var s=Eu.current;return Eu.current=du,s===null?du:s}function rf(){(ii===0||ii===3||ii===2)&&(ii=4),li===null||(fs&268435455)===0&&(Au&268435455)===0||Pn(li,vi)}function Ru(s,o){var h=it;it|=2;var f=_w();(li!==s||vi!==o)&&(tn=null,ps(s,o));do try{CO();break}catch(m){xw(s,m)}while(!0);if(dd(),it=h,Eu.current=f,Jt!==null)throw Error(u(261));return li=null,vi=0,ii}function CO(){for(;Jt!==null;)Sw(Jt)}function TO(){for(;Jt!==null&&!tO();)Sw(Jt)}function Sw(s){var o=Pw(s.alternate,s,Zi);s.memoizedProps=s.pendingProps,o===null?Ew(s):Jt=o,Vd.current=null}function Ew(s){var o=s;do{var h=o.alternate;if(s=o.return,(o.flags&32768)===0){if(h=xO(h,o,Zi),h!==null){Jt=h;return}}else{if(h=_O(h,o),h!==null){h.flags&=32767,Jt=h;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{ii=6,Jt=null;return}}if(o=o.sibling,o!==null){Jt=o;return}Jt=o=s}while(o!==null);ii===0&&(ii=5)}function gs(s,o,h){var f=ht,m=Gt.transition;try{Gt.transition=null,ht=1,IO(s,o,h,f)}finally{Gt.transition=m,ht=f}return null}function IO(s,o,h,f){do ms();while(An!==null);if((it&6)!==0)throw Error(u(327));h=s.finishedWork;var m=s.finishedLanes;if(h===null)return null;if(s.finishedWork=null,s.finishedLanes=0,h===s.current)throw Error(u(177));s.callbackNode=null,s.callbackPriority=0;var b=h.lanes|h.childLanes;if(eO(s,b),s===li&&(Jt=li=null,vi=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||Pu||(Pu=!0,Cw(nd,function(){return ms(),null})),b=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||b){b=Gt.transition,Gt.transition=null;var I=ht;ht=1;var j=it;it|=4,Vd.current=null,EO(s,h),dw(h,s),J(s.containerInfo),s.current=h,AO(h),iO(),it=j,ht=I,Gt.transition=b}else s.current=h;if(Pu&&(Pu=!1,An=s,Cu=m),b=s.pendingLanes,b===0&&(En=null),sO(h.stateNode),Wi(s,ai()),o!==null)for(f=s.onRecoverableError,h=0;h<o.length;h++)m=o[h],f(m.value,{componentStack:m.stack,digest:m.digest});if(ku)throw ku=!1,s=Xd,Xd=null,s;return(Cu&1)!==0&&s.tag!==0&&ms(),b=s.pendingLanes,(b&1)!==0?s===Kd?ho++:(ho=0,Kd=s):ho=0,Or(),null}function ms(){if(An!==null){var s=e0(Cu),o=Gt.transition,h=ht;try{if(Gt.transition=null,ht=16>s?16:s,An===null)var f=!1;else{if(s=An,An=null,Cu=0,(it&6)!==0)throw Error(u(331));var m=it;for(it|=4,_e=s.current;_e!==null;){var b=_e,I=b.child;if((_e.flags&16)!==0){var j=b.deletions;if(j!==null){for(var V=0;V<j.length;V++){var oe=j[V];for(_e=oe;_e!==null;){var Ee=_e;switch(Ee.tag){case 0:case 11:case 15:ao(8,Ee,b)}var Ye=Ee.child;if(Ye!==null)Ye.return=Ee,_e=Ye;else for(;_e!==null;){Ee=_e;var me=Ee.sibling,It=Ee.return;if(lw(Ee),Ee===oe){_e=null;break}if(me!==null){me.return=It,_e=me;break}_e=It}}}var _t=b.alternate;if(_t!==null){var Hi=_t.child;if(Hi!==null){_t.child=null;do{var rn=Hi.sibling;Hi.sibling=null,Hi=rn}while(Hi!==null)}}_e=b}}if((b.subtreeFlags&2064)!==0&&I!==null)I.return=b,_e=I;else e:for(;_e!==null;){if(b=_e,(b.flags&2048)!==0)switch(b.tag){case 0:case 11:case 15:ao(9,b,b.return)}var q=b.sibling;if(q!==null){q.return=b.return,_e=q;break e}_e=b.return}}var D=s.current;for(_e=D;_e!==null;){I=_e;var Z=I.child;if((I.subtreeFlags&2064)!==0&&Z!==null)Z.return=I,_e=Z;else e:for(I=D;_e!==null;){if(j=_e,(j.flags&2048)!==0)try{switch(j.tag){case 0:case 11:case 15:vu(9,j)}}catch(ze){Ot(j,j.return,ze)}if(j===I){_e=null;break e}var ye=j.sibling;if(ye!==null){ye.return=j.return,_e=ye;break e}_e=j.return}}if(it=m,Or(),Rr&&typeof Rr.onPostCommitFiberRoot=="function")try{Rr.onPostCommitFiberRoot(Zl,s)}catch{}f=!0}return f}finally{ht=h,Gt.transition=o}}return!1}function Aw(s,o,h){o=aa(h,o),o=D0(s,o,1),s=Sn(s,o,1),o=Ii(),s!==null&&(Ga(s,1,o),Wi(s,o))}function Ot(s,o,h){if(s.tag===3)Aw(s,s,h);else for(;o!==null;){if(o.tag===3){Aw(o,s,h);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(En===null||!En.has(f))){s=aa(h,s),s=W0(o,s,1),o=Sn(o,s,1),s=Ii(),o!==null&&(Ga(o,1,s),Wi(o,s));break}}o=o.return}}function RO(s,o,h){var f=s.pingCache;f!==null&&f.delete(o),o=Ii(),s.pingedLanes|=s.suspendedLanes&h,li===s&&(vi&h)===h&&(ii===4||ii===3&&(vi&130023424)===vi&&500>ai()-Zd?ps(s,0):Gd|=h),Wi(s,o)}function kw(s,o){o===0&&((s.mode&1)===0?o=1:(o=Vl,Vl<<=1,(Vl&130023424)===0&&(Vl=4194304)));var h=Ii();s=Mr(s,o),s!==null&&(Ga(s,o,h),Wi(s,h))}function OO(s){var o=s.memoizedState,h=0;o!==null&&(h=o.retryLane),kw(s,h)}function MO(s,o){var h=0;switch(s.tag){case 13:var f=s.stateNode,m=s.memoizedState;m!==null&&(h=m.retryLane);break;case 19:f=s.stateNode;break;default:throw Error(u(314))}f!==null&&f.delete(o),kw(s,h)}var Pw;Pw=function(s,o,h){if(s!==null)if(s.memoizedProps!==o.pendingProps||Bi.current)Ui=!0;else{if((s.lanes&h)===0&&(o.flags&128)===0)return Ui=!1,wO(s,o,h);Ui=(s.flags&131072)!==0}else Ui=!1,Rt&&(o.flags&1048576)!==0&&r0(o,Kl,o.index);switch(o.lanes=0,o.tag){case 2:var f=o.type;pu(s,o),s=o.pendingProps;var m=Xs(o,ki.current);ia(o,h),m=Ad(null,o,f,s,m,h);var b=kd();return o.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,ji(f)?(b=!0,ql(o)):b=!1,o.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,md(o),m.updater=su,o.stateNode=m,m._reactInternals=o,vd(o,f,s,h),o=Ld(null,o,f,!0,b,h)):(o.tag=0,Rt&&b&&ad(o),$i(null,o,m,h),o=o.child),o;case 16:f=o.elementType;e:{switch(pu(s,o),s=o.pendingProps,m=f._init,f=m(f._payload),o.type=f,m=o.tag=$O(f),s=gr(f,s),m){case 0:o=Md(null,o,f,s,h);break e;case 1:o=K0(null,o,f,s,h);break e;case 11:o=V0(null,o,f,s,h);break e;case 14:o=G0(null,o,f,gr(f.type,s),h);break e}throw Error(u(306,f,""))}return o;case 0:return f=o.type,m=o.pendingProps,m=o.elementType===f?m:gr(f,m),Md(s,o,f,m,h);case 1:return f=o.type,m=o.pendingProps,m=o.elementType===f?m:gr(f,m),K0(s,o,f,m,h);case 3:e:{if(J0(o),s===null)throw Error(u(387));f=o.pendingProps,b=o.memoizedState,m=b.element,h0(s,o),nu(o,f,null,h);var I=o.memoizedState;if(f=I.element,Ht&&b.isDehydrated)if(b={element:f,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},o.updateQueue.baseState=b,o.memoizedState=b,o.flags&256){m=aa(Error(u(423)),o),o=ew(s,o,f,h,m);break e}else if(f!==m){m=aa(Error(u(424)),o),o=ew(s,o,f,h,m);break e}else for(Ht&&(ir=$R(o.stateNode.containerInfo),Gi=o,Rt=!0,pr=null,Za=!1),h=b0(o,null,f,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(ea(),f===m){o=en(s,o,h);break e}$i(s,o,f,h)}o=o.child}return o;case 5:return w0(o),s===null&&ud(o),f=o.type,m=o.pendingProps,b=s!==null?s.memoizedProps:null,I=m.children,at(f,m)?I=null:b!==null&&at(f,b)&&(o.flags|=32),X0(s,o),$i(s,o,I,h),o.child;case 6:return s===null&&ud(o),null;case 13:return tw(s,o,h);case 4:return bd(o,o.stateNode.containerInfo),f=o.pendingProps,s===null?o.child=ra(o,null,f,h):$i(s,o,f,h),o.child;case 11:return f=o.type,m=o.pendingProps,m=o.elementType===f?m:gr(f,m),V0(s,o,f,m,h);case 7:return $i(s,o,o.pendingProps,h),o.child;case 8:return $i(s,o,o.pendingProps.children,h),o.child;case 12:return $i(s,o,o.pendingProps.children,h),o.child;case 10:e:{if(f=o.type._context,m=o.pendingProps,b=o.memoizedProps,I=m.value,l0(o,f,I),b!==null)if(fr(b.value,I)){if(b.children===m.children&&!Bi.current){o=en(s,o,h);break e}}else for(b=o.child,b!==null&&(b.return=o);b!==null;){var j=b.dependencies;if(j!==null){I=b.child;for(var V=j.firstContext;V!==null;){if(V.context===f){if(b.tag===1){V=Jr(-1,h&-h),V.tag=2;var oe=b.updateQueue;if(oe!==null){oe=oe.shared;var Ee=oe.pending;Ee===null?V.next=V:(V.next=Ee.next,Ee.next=V),oe.pending=V}}b.lanes|=h,V=b.alternate,V!==null&&(V.lanes|=h),pd(b.return,h,o),j.lanes|=h;break}V=V.next}}else if(b.tag===10)I=b.type===o.type?null:b.child;else if(b.tag===18){if(I=b.return,I===null)throw Error(u(341));I.lanes|=h,j=I.alternate,j!==null&&(j.lanes|=h),pd(I,h,o),I=b.sibling}else I=b.child;if(I!==null)I.return=b;else for(I=b;I!==null;){if(I===o){I=null;break}if(b=I.sibling,b!==null){b.return=I.return,I=b;break}I=I.return}b=I}$i(s,o,m.children,h),o=o.child}return o;case 9:return m=o.type,f=o.pendingProps.children,ia(o,h),m=rr(m),f=f(m),o.flags|=1,$i(s,o,f,h),o.child;case 14:return f=o.type,m=gr(f,o.pendingProps),m=gr(f.type,m),G0(s,o,f,m,h);case 15:return Z0(s,o,o.type,o.pendingProps,h);case 17:return f=o.type,m=o.pendingProps,m=o.elementType===f?m:gr(f,m),pu(s,o),o.tag=1,ji(f)?(s=!0,ql(o)):s=!1,ia(o,h),g0(o,f,m),vd(o,f,m,h),Ld(null,o,f,!0,s,h);case 19:return rw(s,o,h);case 22:return Y0(s,o,h)}throw Error(u(156,o.tag))};function Cw(s,o){return id(s,o)}function LO(s,o,h,f){this.tag=s,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function or(s,o,h,f){return new LO(s,o,h,f)}function nf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function $O(s){if(typeof s=="function")return nf(s)?1:0;if(s!=null){if(s=s.$$typeof,s===T)return 11;if(s===$)return 14}return 2}function Cn(s,o){var h=s.alternate;return h===null?(h=or(s.tag,o,s.key,s.mode),h.elementType=s.elementType,h.type=s.type,h.stateNode=s.stateNode,h.alternate=s,s.alternate=h):(h.pendingProps=o,h.type=s.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=s.flags&14680064,h.childLanes=s.childLanes,h.lanes=s.lanes,h.child=s.child,h.memoizedProps=s.memoizedProps,h.memoizedState=s.memoizedState,h.updateQueue=s.updateQueue,o=s.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=s.sibling,h.index=s.index,h.ref=s.ref,h}function Ou(s,o,h,f,m,b){var I=2;if(f=s,typeof s=="function")nf(s)&&(I=1);else if(typeof s=="string")I=5;else e:switch(s){case y:return ys(h.children,m,b,o);case x:I=8,m|=8;break;case E:return s=or(12,h,o,m|2),s.elementType=E,s.lanes=b,s;case R:return s=or(13,h,o,m),s.elementType=R,s.lanes=b,s;case A:return s=or(19,h,o,m),s.elementType=A,s.lanes=b,s;case B:return Mu(h,m,b,o);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case S:I=10;break e;case k:I=9;break e;case T:I=11;break e;case $:I=14;break e;case z:I=16,f=null;break e}throw Error(u(130,s==null?s:typeof s,""))}return o=or(I,h,o,m),o.elementType=s,o.type=f,o.lanes=b,o}function ys(s,o,h,f){return s=or(7,s,f,o),s.lanes=h,s}function Mu(s,o,h,f){return s=or(22,s,f,o),s.elementType=B,s.lanes=h,s.stateNode={isHidden:!1},s}function sf(s,o,h){return s=or(6,s,null,o),s.lanes=h,s}function af(s,o,h){return o=or(4,s.children!==null?s.children:[],s.key,o),o.lanes=h,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}function NO(s,o,h,f,m){this.tag=o,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ir,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ed(0),this.expirationTimes=ed(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ed(0),this.identifierPrefix=f,this.onRecoverableError=m,Ht&&(this.mutableSourceEagerHydrationData=null)}function Tw(s,o,h,f,m,b,I,j,V){return s=new NO(s,o,h,j,V),o===1?(o=1,b===!0&&(o|=8)):o=0,b=or(3,null,null,o),s.current=b,b.stateNode=s,b.memoizedState={element:f,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},md(b),s}function Iw(s){if(!s)return xn;s=s._reactInternals;e:{if(G(s)!==s||s.tag!==1)throw Error(u(170));var o=s;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(ji(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(u(171))}if(s.tag===1){var h=s.type;if(ji(h))return Xb(s,h,o)}return o}function Rw(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(u(188)):(s=Object.keys(s).join(","),Error(u(268,s)));return s=be(o),s===null?null:s.stateNode}function Ow(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var h=s.retryLane;s.retryLane=h!==0&&h<o?h:o}}function Lu(s,o){Ow(s,o),(s=s.alternate)&&Ow(s,o)}function zO(s){return s=be(s),s===null?null:s.stateNode}function FO(){return null}return r.attemptContinuousHydration=function(s){if(s.tag===13){var o=Mr(s,134217728);if(o!==null){var h=Ii();ar(o,s,134217728,h)}Lu(s,134217728)}},r.attemptDiscreteHydration=function(s){if(s.tag===13){var o=Mr(s,1);if(o!==null){var h=Ii();ar(o,s,1,h)}Lu(s,1)}},r.attemptHydrationAtCurrentPriority=function(s){if(s.tag===13){var o=kn(s),h=Mr(s,o);if(h!==null){var f=Ii();ar(h,s,o,f)}Lu(s,o)}},r.attemptSynchronousHydration=function(s){switch(s.tag){case 3:var o=s.stateNode;if(o.current.memoizedState.isDehydrated){var h=Va(o.pendingLanes);h!==0&&(td(o,h|1),Wi(o,ai()),(it&6)===0&&(ua(),Or()))}break;case 13:ww(function(){var f=Mr(s,1);if(f!==null){var m=Ii();ar(f,s,1,m)}}),Lu(s,1)}},r.batchedUpdates=function(s,o){var h=it;it|=1;try{return s(o)}finally{it=h,it===0&&(ua(),Yl&&Or())}},r.createComponentSelector=function(s){return{$$typeof:bu,value:s}},r.createContainer=function(s,o,h,f,m,b,I){return Tw(s,o,!1,null,h,f,m,b,I)},r.createHasPseudoClassSelector=function(s){return{$$typeof:wu,value:s}},r.createHydrationContainer=function(s,o,h,f,m,b,I,j,V){return s=Tw(h,f,!0,s,m,b,I,j,V),s.context=Iw(null),h=s.current,f=Ii(),m=kn(h),b=Jr(f,m),b.callback=o??null,Sn(h,b,m),s.current.lanes=m,Ga(s,m,f),Wi(s,f),s},r.createPortal=function(s,o,h){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:p,key:f==null?null:""+f,children:s,containerInfo:o,implementation:h}},r.createRoleSelector=function(s){return{$$typeof:xu,value:s}},r.createTestNameSelector=function(s){return{$$typeof:_u,value:s}},r.createTextSelector=function(s){return{$$typeof:Su,value:s}},r.deferredUpdates=function(s){var o=ht,h=Gt.transition;try{return Gt.transition=null,ht=16,s()}finally{ht=o,Gt.transition=h}},r.discreteUpdates=function(s,o,h,f,m){var b=ht,I=Gt.transition;try{return Gt.transition=null,ht=1,s(o,h,f,m)}finally{ht=b,Gt.transition=I,it===0&&ua()}},r.findAllNodes=Qd,r.findBoundingRects=function(s,o){if(!Kt)throw Error(u(363));o=Qd(s,o),s=[];for(var h=0;h<o.length;h++)s.push(Dc(o[h]));for(o=s.length-1;0<o;o--){h=s[o];for(var f=h.x,m=f+h.width,b=h.y,I=b+h.height,j=o-1;0<=j;j--)if(o!==j){var V=s[j],oe=V.x,Ee=oe+V.width,Ye=V.y,me=Ye+V.height;if(f>=oe&&b>=Ye&&m<=Ee&&I<=me){s.splice(o,1);break}else if(f!==oe||h.width!==V.width||me<b||Ye>I){if(!(b!==Ye||h.height!==V.height||Ee<f||oe>m)){oe>f&&(V.width+=oe-f,V.x=f),Ee<m&&(V.width=m-oe),s.splice(o,1);break}}else{Ye>b&&(V.height+=Ye-b,V.y=b),me<I&&(V.height=I-Ye),s.splice(o,1);break}}}return s},r.findHostInstance=Rw,r.findHostInstanceWithNoPortals=function(s){return s=ce(s),s=s!==null?Te(s):null,s===null?null:s.stateNode},r.findHostInstanceWithWarning=function(s){return Rw(s)},r.flushControlled=function(s){var o=it;it|=1;var h=Gt.transition,f=ht;try{Gt.transition=null,ht=1,s()}finally{ht=f,Gt.transition=h,it=o,it===0&&(ua(),Or())}},r.flushPassiveEffects=ms,r.flushSync=ww,r.focusWithin=function(s,o){if(!Kt)throw Error(u(363));for(s=Wd(s),o=yw(s,o),o=Array.from(o),s=0;s<o.length;){var h=o[s++];if(!os(h)){if(h.tag===5&&Ul(h.stateNode))return!0;for(h=h.child;h!==null;)o.push(h),h=h.sibling}}return!1},r.getCurrentUpdatePriority=function(){return ht},r.getFindAllNodesFailureDescription=function(s,o){if(!Kt)throw Error(u(363));var h=0,f=[];s=[Wd(s),0];for(var m=0;m<s.length;){var b=s[m++],I=s[m++],j=o[I];if((b.tag!==5||!os(b))&&(Hd(b,j)&&(f.push(qd(j)),I++,I>h&&(h=I)),I<o.length))for(b=b.child;b!==null;)s.push(b,I),b=b.sibling}if(h<o.length){for(s=[];h<o.length;h++)s.push(qd(o[h]));return`findAllNodes was able to match part of the selector:
  `+(f.join(" > ")+`

No matching component was found for:
  `)+s.join(" > ")}return null},r.getPublicRootInstance=function(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return qe(s.child.stateNode);default:return s.child.stateNode}},r.injectIntoDevTools=function(s){if(s={bundleType:s.bundleType,version:s.version,rendererPackageName:s.rendererPackageName,rendererConfig:s.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:c.ReactCurrentDispatcher,findHostInstanceByFiber:zO,findFiberByHostInstance:s.findFiberByHostInstance||FO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")s=!1;else{var o=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(o.isDisabled||!o.supportsFiber)s=!0;else{try{Zl=o.inject(s),Rr=o}catch{}s=!!o.checkDCE}}return s},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(s,o,h,f){if(!Kt)throw Error(u(363));s=Qd(s,o);var m=Hc(s,h,f).disconnect;return{disconnect:function(){m()}}},r.registerMutableSourceForHydration=function(s,o){var h=o._getVersion;h=h(o._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[o,h]:s.mutableSourceEagerHydrationData.push(o,h)},r.runWithPriority=function(s,o){var h=ht;try{return ht=s,o()}finally{ht=h}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(s,o,h,f){var m=o.current,b=Ii(),I=kn(m);return h=Iw(h),o.context===null?o.context=h:o.pendingContext=h,o=Jr(b,I),o.payload={element:s},f=f===void 0?null:f,f!==null&&(o.callback=f),s=Sn(m,o,I),s!==null&&(ar(s,m,I,b),ru(s,m,I)),I},r}}),Kf=Ge((e,t)=>{t.exports=Px()}),mh=Ge(e=>{var t=(pe(),Zt(Ln));e.createRoot=t.createRoot,e.hydrateRoot=t.hydrateRoot}),yh=Ge((e,t)=>{(function(i,r){r(typeof e=="object"&&typeof t<"u"?e:(i=i||self).TypesafeActions={})})(e,function(i){function r(A){return A==null}function n(A){throw new Error("Argument "+A+" is empty.")}function a(A){return typeof A=="function"&&"getType"in A}function l(A){throw new Error("Argument "+A+' is invalid, it should be an action-creator instance from "typesafe-actions"')}function u(A,$){if(A==null)throw new Error("Argument contains array with empty element at index "+$);if(A.getType==null)throw new Error("Argument contains array with invalid element at index "+$+', it should be an action-creator instance from "typesafe-actions"')}function c(A){return typeof A=="string"||typeof A=="symbol"}function d(A){return!c(A)}function p(A){throw new Error("Argument "+A+" is invalid, it should be an action type of type: string | symbol")}function y(A,$){if(A==null)throw new Error("Argument contains array with empty element at index "+$);if(typeof A!="string"&&typeof A!="symbol")throw new Error("Argument contains array with invalid element at index "+$+", it should be of type: string | symbol")}function x(A,$,z,B){return r(A)&&n(1),d(A)&&l(1),{type:A,payload:$,meta:z,error:B}}function E(A,$){return r(A)&&n(1),d(A)&&p(1),Object.assign(function(){var z=$!=null?$.apply(void 0,arguments):void 0;return Object.assign({type:A},z)},{getType:function(){return A},toString:function(){return A}})}function S(A,$,z){return r(A)&&n(1),d(A)&&p(1),function(){return E(A,function(){var B=arguments.length<=0?void 0:arguments[0],H=arguments.length<=1?void 0:arguments[1];return $==null&&z==null||(B=$!=null?$.apply(void 0,arguments):void 0,H=z!=null?z.apply(void 0,arguments):void 0),Object.assign({},B!==void 0&&{payload:B},{},H!==void 0&&{meta:H})})}}function k(A){return r(A)&&n(1),a(A)||l(1),A.getType()}function T(A,$){r(A)&&n(1),d(A)&&p(1);var z=$!=null?$(A):function(){return{type:A}};return Object.assign(z,{getType:function(){return A},toString:function(){return A}})}var R={createAction:function(A,$){var z=$==null?function(){return x(A)}:$(x.bind(null,A));return Object.assign(z,{getType:function(){return A},toString:function(){return A}})},createCustomAction:T,createStandardAction:function(A){return r(A)&&n(1),d(A)&&p(1),Object.assign(function(){return T(A,function($){return function(z,B){return{type:$,payload:z,meta:B}}})},{map:function($){return T(A,function(z){return function(B,H){return Object.assign($(B,H),{type:z})}})}})}};i.action=x,i.createAction=S,i.createAsyncAction=function(A,$,z,B){return function(){var H=[A,$,z,B].map(function(Y,Q){return Array.isArray(Y)?S(Y[0],Y[1],Y[2])():typeof Y=="string"||typeof Y=="symbol"?S(Y)():void(Q<3&&function(he){throw new Error("Argument "+he+' is invalid, it should be an action type of "string | symbol" or a tuple of "[string | symbol, Function, Function?]"')}(Q))});return{request:H[0],success:H[1],failure:H[2],cancel:H[3]}}},i.createCustomAction=E,i.createReducer=function A($,z){z===void 0&&(z={});var B=Object.assign({},z),H=function(Y,Q){var he=Array.isArray(Y)?Y:[Y],G={};return he.map(function(ue,ce){return a(ue)?k(ue):c(ue)?ue:function(be){throw new Error("Argument "+be+' is invalid, it should be an action-creator instance from "typesafe-actions" or action type of type: string | symbol')}(ce+1)}).forEach(function(ue){return G[ue]=Q}),A($,Object.assign({},B,{},G))};return Object.assign(function(Y,Q){if(Y===void 0&&(Y=$),B.hasOwnProperty(Q.type)){var he=B[Q.type];if(typeof he!="function")throw Error('Reducer under "'+Q.type+'" key is not a valid reducer');return he(Y,Q)}return Y},{handlers:Object.assign({},B),handleAction:H,handleType:H})},i.deprecated=R,i.getType=k,i.isActionOf=function(A,$){r(A)&&n(1);var z=Array.isArray(A)?A:[A];z.forEach(u);var B=function(H){return z.some(function(Y){return H.type===Y.getType()})};return $===void 0?B:B($)},i.isOfType=function(A,$){r(A)&&n(1);var z=Array.isArray(A)?A:[A];z.forEach(y);var B=function(H){return z.includes(H.type)};return $===void 0?B:B($)}})}),Cx=Ge((e,t)=>{var i=!1,r,n,a,l,u,c,d,p,y,x,E,S,k,T,R;function A(){if(!i){i=!0;var z=navigator.userAgent,B=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(z),H=/(Mac OS X)|(Windows)|(Linux)/.exec(z);if(S=/\b(iPhone|iP[ao]d)/.exec(z),k=/\b(iP[ao]d)/.exec(z),x=/Android/i.exec(z),T=/FBAN\/\w+;/i.exec(z),R=/Mobile/i.exec(z),E=!!/Win64/.exec(z),B){r=B[1]?parseFloat(B[1]):B[5]?parseFloat(B[5]):NaN,r&&document&&document.documentMode&&(r=document.documentMode);var Y=/(?:Trident\/(\d+.\d+))/.exec(z);c=Y?parseFloat(Y[1])+4:r,n=B[2]?parseFloat(B[2]):NaN,a=B[3]?parseFloat(B[3]):NaN,l=B[4]?parseFloat(B[4]):NaN,l?(B=/(?:Chrome\/(\d+\.\d+))/.exec(z),u=B&&B[1]?parseFloat(B[1]):NaN):u=NaN}else r=n=a=u=l=NaN;if(H){if(H[1]){var Q=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(z);d=Q?parseFloat(Q[1].replace("_",".")):!0}else d=!1;p=!!H[2],y=!!H[3]}else d=p=y=!1}}var $={ie:function(){return A()||r},ieCompatibilityMode:function(){return A()||c>r},ie64:function(){return $.ie()&&E},firefox:function(){return A()||n},opera:function(){return A()||a},webkit:function(){return A()||l},safari:function(){return $.webkit()},chrome:function(){return A()||u},windows:function(){return A()||p},osx:function(){return A()||d},linux:function(){return A()||y},iphone:function(){return A()||S},mobile:function(){return A()||S||k||x||R},nativeApp:function(){return A()||T},android:function(){return A()||x},ipad:function(){return A()||k}};t.exports=$}),Tx=Ge((e,t)=>{var i=!!(typeof window<"u"&&window.document&&window.document.createElement),r={canUseDOM:i,canUseWorkers:typeof Worker<"u",canUseEventListeners:i&&!!(window.addEventListener||window.attachEvent),canUseViewport:i&&!!window.screen,isInWorker:!i};t.exports=r}),Ix=Ge((e,t)=>{var i=Tx(),r;i.canUseDOM&&(r=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function n(a,l){if(!i.canUseDOM||l&&!("addEventListener"in document))return!1;var u="on"+a,c=u in document;if(!c){var d=document.createElement("div");d.setAttribute(u,"return;"),c=typeof d[u]=="function"}return!c&&r&&a==="wheel"&&(c=document.implementation.hasFeature("Events.wheel","3.0")),c}t.exports=n}),Rx=Ge((e,t)=>{var i=Cx(),r=Ix(),n=10,a=40,l=800;function u(c){var d=0,p=0,y=0,x=0;return"detail"in c&&(p=c.detail),"wheelDelta"in c&&(p=-c.wheelDelta/120),"wheelDeltaY"in c&&(p=-c.wheelDeltaY/120),"wheelDeltaX"in c&&(d=-c.wheelDeltaX/120),"axis"in c&&c.axis===c.HORIZONTAL_AXIS&&(d=p,p=0),y=d*n,x=p*n,"deltaY"in c&&(x=c.deltaY),"deltaX"in c&&(y=c.deltaX),(y||x)&&c.deltaMode&&(c.deltaMode==1?(y*=a,x*=a):(y*=l,x*=l)),y&&!d&&(d=y<1?-1:1),x&&!p&&(p=x<1?-1:1),{spinX:d,spinY:p,pixelX:y,pixelY:x}}u.getEventType=function(){return i.firefox()?"DOMMouseScroll":r("wheel")?"wheel":"mousewheel"},t.exports=u}),Ox=Ge((e,t)=>{t.exports=Rx()}),Mx=Ge((e,t)=>{function i(r,n,a){var l,u,c,d,p;n==null&&(n=100);function y(){var E=Date.now()-d;E<n&&E>=0?l=setTimeout(y,n-E):(l=null,a||(p=r.apply(c,u),c=u=null))}var x=function(){c=this,u=arguments,d=Date.now();var E=a&&!l;return l||(l=setTimeout(y,n)),E&&(p=r.apply(c,u),c=u=null),p};return x.clear=function(){l&&(clearTimeout(l),l=null)},x.flush=function(){l&&(p=r.apply(c,u),c=u=null,clearTimeout(l),l=null)},x}i.debounce=i,t.exports=i}),Jf=Ge((e,t)=>{(function(i,r){typeof e=="object"&&typeof t<"u"?r(e,(pe(),Zt(Ln))):(i=typeof globalThis<"u"?globalThis:i||self,r(i.ReactErrorBoundary={},i.React))})(e,function(i,r){function n(E){if(E&&E.__esModule)return E;var S=Object.create(null);return E&&Object.keys(E).forEach(function(k){if(k!=="default"){var T=Object.getOwnPropertyDescriptor(E,k);Object.defineProperty(S,k,T.get?T:{enumerable:!0,get:function(){return E[k]}})}}),S.default=E,Object.freeze(S)}var a=n(r);function l(E,S){return l=Object.setPrototypeOf||function(k,T){return k.__proto__=T,k},l(E,S)}function u(E,S){E.prototype=Object.create(S.prototype),E.prototype.constructor=E,l(E,S)}var c=function(E,S){return E===void 0&&(E=[]),S===void 0&&(S=[]),E.length!==S.length||E.some(function(k,T){return!Object.is(k,S[T])})},d={error:null},p=function(E){u(S,E);function S(){for(var T,R=arguments.length,A=new Array(R),$=0;$<R;$++)A[$]=arguments[$];return T=E.call.apply(E,[this].concat(A))||this,T.state=d,T.resetErrorBoundary=function(){for(var z,B=arguments.length,H=new Array(B),Y=0;Y<B;Y++)H[Y]=arguments[Y];T.props.onReset==null||(z=T.props).onReset.apply(z,H),T.reset()},T}S.getDerivedStateFromError=function(T){return{error:T}};var k=S.prototype;return k.reset=function(){this.setState(d)},k.componentDidCatch=function(T,R){var A,$;(A=($=this.props).onError)==null||A.call($,T,R)},k.componentDidUpdate=function(T,R){var A=this.state.error,$=this.props.resetKeys;if(A!==null&&R.error!==null&&c(T.resetKeys,$)){var z,B;(z=(B=this.props).onResetKeysChange)==null||z.call(B,T.resetKeys,$),this.reset()}},k.render=function(){var T=this.state.error,R=this.props,A=R.fallbackRender,$=R.FallbackComponent,z=R.fallback;if(T!==null){var B={error:T,resetErrorBoundary:this.resetErrorBoundary};if(a.isValidElement(z))return z;if(typeof A=="function")return A(B);if($)return a.createElement($,B);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},S}(a.Component);function y(E,S){var k=function(R){return a.createElement(p,S,a.createElement(E,R))},T=E.displayName||E.name||"Unknown";return k.displayName="withErrorBoundary("+T+")",k}function x(E){var S=a.useState(null),k=S[0],T=S[1];if(E!=null)throw E;if(k!=null)throw k;return T}i.ErrorBoundary=p,i.useErrorHandler=x,i.withErrorBoundary=y,Object.defineProperty(i,"__esModule",{value:!0})})});tt();function $n(e,t,i,r){function n(){let l=Reflect.construct(HTMLElement,[],n);return l._vdomComponent=e,l._shadowEnabled=r&&r.shadow,l._root=l._shadowEnabled?l.attachShadow({mode:"open"}):l,r.onConstruct&&r.onConstruct(l),l.ready=!1,l.whenReady=u=>{l.ready?u():l.addEventListener("ready",u)},l}n.prototype=Object.create(HTMLElement.prototype),n.prototype.constructor=n,n.prototype.connectedCallback=$x,n.prototype.attributeChangedCallback=Nx,n.prototype.disconnectedCallback=zx,i=i||e.observedAttributes||Object.keys(e.propTypes||{}),n.observedAttributes=i,i.forEach(l=>{Object.defineProperty(n.prototype,l,{get(){return this._vdom?this._vdom.props[l]:(this._props||(this._props={}),this._props[l])},set(u){this._vdom?(this._props[l]=u,this.attributeChangedCallback(l,null,u)):(this._props||(this._props={}),this._props[l]=u,this._props[vh(l)]=u);let c=typeof u;(u==null||c==="string"||c==="boolean"||c==="number")&&this.setAttribute(l,u)}})}),r.beforeCreate&&r.beforeCreate(n);let a=t||e.tagName||e.displayName||e.name;if(!customElements.get(a))return customElements.define(t||e.tagName||e.displayName||e.name,n)}function Lx(e){this.getChildContext=()=>e.context;let t=e,{context:i,children:r}=t,n=le(t,["context","children"]);return qu(r,n)}function $x(){let e=new CustomEvent("_preact",{detail:{},bubbles:!0,cancelable:!0});this.dispatchEvent(e);let t=e.detail.context;this._vdom=N(Lx,W(C({},this._props),{context:t}),tp(this,this._vdomComponent,this._shadowEnabled)),(this.hasAttribute("hydrate")?Hu:wr)(this._vdom,this._root),this.ready||(this.ready=!0,this.dispatchEvent(new CustomEvent("ready",{detail:{},bubbles:!1,cancelable:!1})))}function vh(e){return e.replace(/-(\w)/g,(t,i)=>i?i.toUpperCase():"")}function Nx(e,t,i){if(!this._vdom)return;i=i??void 0;let r={};r[e]=i,r[vh(e)]=i,this._vdom=qu(this._vdom,r),wr(this._vdom,this._root)}function zx(){wr(this._vdom=null,this._root)}function ep(e,t){let i=e,{shadow:r,addContextListener:n,removeContextListener:a}=i,l=le(i,["shadow","addContextListener","removeContextListener"]),u=c=>{c?(this.ref=c,this._listener||(this._listener=d=>{d.stopPropagation(),d.detail.context=t},n(this._listener,this.ref))):a(this._listener,this.ref)};return!r&&!this._listener&&(this._listener=c=>{c.stopPropagation(),c.detail.context=t},n(this._listener)),N(r?"slot":rt,W(C({},l),{ref:u}))}function tp(e,t,i){if(e.nodeType===3)return e.data;if(e.nodeType!==1)return null;let r=[],n={},a=0,l=e.attributes,u=e.childNodes;for(a=l.length;a--;)l[a].name!=="slot"&&(n[l[a].name]=l[a].value,n[vh(l[a].name)]=l[a].value);for(a=u.length;a--;){let d=u[a],p=tp(d,null,i),y=d.slot;y?n[y]=N(ep,{name:y,shadow:i,addContextListener(x,E=d){E.addEventListener("_preact",x)},removeContextListener(x,E=d){E.removeEventListener("_preact",x)}},p):r[a]=p}let c=t?N(ep,{shadow:i,addContextListener(d,p=e){p.addEventListener("_preact",d)},removeContextListener(d,p=e){p.removeEventListener("_preact",d)}},r):r;return!i&&t&&(e.innerHTML=""),N(t||e.nodeName.toLowerCase(),n,c)}pe(),pe(),pe(),pe(),pe();var Fx=Ue(Kf(),1),ip,rp,ko=["onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onScroll","onWheel","onClick","onDragStart","onDragEnd","onDragEnter","onDragExit","onDrag","onDragOver"];function Bx(){return ko.reduce((e,t)=>(e[t]=[],e),{})}var bh=ko.reduce((e,t)=>(e[t.slice(2).toLowerCase()]=t,e[t]=t,e),{}),va=(e,t,i)=>{let r=e.length,n=i||Ne(r);for(let a=0;a<r;a++)n[a]=a%5===0?e[a+1]<t[3]&&e[a+3]>t[1]&&e[a+2]<t[4]&&e[a+4]>t[2]?1:0:e[a];return n};function Ne(e,t,i){return new Float32Array(e,t,i)}var jx=(e,t,i)=>{let r=e[1]<=t[3]&&e[3]>=t[1]&&e[2]<=t[4]&&e[4]>=t[2],n=i||Ne(5);return r?(n[0]=1,n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n[3]=Math.min(e[3],t[3]),n[4]=Math.min(e[4],t[4]),n):(n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n)},Ux=e=>e.length/5,sn=(e,t,i)=>{let r=i||Ne(9);return r[0]=e[0]*t[0]+e[1]*t[3]+e[2]*t[6],r[1]=e[0]*t[1]+e[1]*t[4]+e[2]*t[7],r[2]=e[0]*t[2]+e[1]*t[5]+e[2]*t[8],r[3]=e[3]*t[0]+e[4]*t[3]+e[5]*t[6],r[4]=e[3]*t[1]+e[4]*t[4]+e[5]*t[7],r[5]=e[3]*t[2]+e[4]*t[5]+e[5]*t[8],r[6]=e[6]*t[0]+e[7]*t[3]+e[8]*t[6],r[7]=e[6]*t[1]+e[7]*t[4]+e[8]*t[7],r[8]=e[6]*t[2]+e[7]*t[5]+e[8]*t[8],r},ut=class{constructor(e){this.index=0,this.length=e,this.points=Ne(this.length)}static grid(e=1,t=1){return new ut(5*e*t)}static point(e,t){let i=Ne(5);return i[0]=1,i[1]=e,i[2]=t,i[3]=e,i[4]=t,i}static positionPair(e){let t=Ne(5);return t[0]=1,t[1]=e.x1,t[2]=e.y1,t[3]=e.x2,t[4]=e.y2,t}static projection(e){return ut.singleBox(e.width,e.height,e.x,e.y)}static singleBox(e,t,i=0,r=0){let n=Ne(5);return n[0]=1,n[1]=i,n[2]=r,n[3]=e+i,n[4]=t+r,n}row(e){return e(this)}addPoints(e,t,i,r){return this.points[this.index]=1,this.points[1+this.index]=e,this.points[2+this.index]=t,this.points[3+this.index]=i,this.points[4+this.index]=r,this.index+=5,this}addBox(e,t,i,r){return this.addPoints(e,t,e+i,t+r),this}build(){return this.points}},xr=(e,t)=>{let i=e.length;for(let r=0;r<i;r++)e[r]=r%5===0?t[6]*e[r+1]+t[7]*e[r+2]+t[8]*e[r]:r%5%2===1?t[0]*e[r]+t[1]*e[r+1]+t[2]:t[3]*e[r-1]+t[4]*e[r]+t[5];return e},Nn=e=>{let t=Ne(9);return t[0]=e,t[4]=e,t[8]=1,t},Qi=(e,t)=>{let i=Ne(9);return i[0]=1,i[2]=e,i[4]=1,i[5]=t,i[8]=1,i},Po=(e,t,i)=>sn(Qi((1-e)*t,(1-e)*i),Nn(e)),zn=(e,t,i)=>{let r=e.length,n=i&&i.length>=r?i.slice(0,r):Ne(r);for(let a=0;a<r;a++)n[a]=a%5===0?t[6]*e[a+1]+t[7]*e[a+2]+t[8]*e[a]:a%5%2===1?t[0]*e[a]+t[1]*e[a+1]+t[2]:t[3]*e[a-1]+t[4]*e[a]+t[5];return n},Co=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,i)=>(i&=63,i<36?t+=i.toString(36):i<62?t+=(i-26).toString(36).toUpperCase():i>62?t+="-":t+="_",t),""),_r=class{constructor(){this.__revision=0,this.__owner={value:void 0},this.__state={},this.scale=1,this.layers=[],this.time=[],this.addEventListener=(e,t,i)=>{let r=bh[e];if(!this.eventHandlers[r])throw new Error(`Unknown event ${r}`);this.eventHandlers[r].indexOf(t)===-1&&this.eventHandlers[r].push(t)},this.removeEventListener=(e,t)=>{let i=bh[e];if(!this.eventHandlers[i]){console.warn(`Unknown event ${i}`);return}this.eventHandlers[i].indexOf(t)!==-1&&(this.eventHandlers[i]=this.eventHandlers[i].filter(r=>r!==t))},this.id=this.__id=Co(),this.eventHandlers=Bx()}get crop(){return this._crop}set crop(e){this._crop=e}getObjectsAt(e){return[]}getAllPointsAt(e,t,i){return[]}getScheduledUpdates(e,t){return[]}dispatchEvent(e,t){let i=this.eventHandlers[e],r=i?i.length:0,n=!1;if(r)for(let a=0;a<r;a++)try{i[a](t),n=!0}catch(l){console.error(e,l)}return n}get x(){return this.points[1]}get y(){return this.points[2]}get width(){return this.points[3]-this.points[1]}get height(){return this.points[4]-this.points[2]}translate(e,t){xr(this.points,Qi(e,t))}atScale(e){xr(this.points,Po(e,this.x,this.y)),this.scale*=e}transform(e){xr(this.points,e)}applyProps(e){this.__revision++}appendChild(e){}removeChild(e){}insertBefore(e,t){}hideInstance(){}},ba=class extends _r{constructor(e){if(super(),this.type="spacial-content",this.style={opacity:1},!e)this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:Ne(5)},this.points=Ne(5);else{let t=e.scale||1;this.id=e.id||e.uri,this.uri=e.uri,this.points=ut.singleBox(e.width,e.height,e.x,e.y),this.display={x:0,y:0,scale:t,width:e.width/t,height:e.height/t,points:ut.singleBox(e.width/t,e.height/t),rotation:e==null?void 0:e.rotation}}}applyProps(e){let t=e.display?e.display.width:e.target.width,i=e.target.width/t;if(this.id=e.id||e.uri,this.uri=e.uri,this.points.set(ut.singleBox(e.target.width,e.target.height,e.target.x,e.target.y)),e.style&&typeof e.style.opacity<"u"&&(this.style.opacity=e.style.opacity),e.crop){this.cropData=e.crop;let r=ut.singleBox(e.crop.width,e.crop.height,e.crop.x,e.crop.y);xr(r,Qi(-e.crop.x,-e.crop.y)),this.crop?this.crop.set(r):this.crop=Ne(r)}e.display?(this.display.scale=i,this.display.width=e.display.width,this.display.height=e.display.height,this.display.rotation=e.display.rotation,this.display.points=ut.singleBox(e.display.width,e.display.height)):(this.display.scale=i,this.display.width=e.target.width/i,this.display.height=e.target.height/i,this.display.points=ut.singleBox(e.target.width/i,e.target.height/i))}getAllPointsAt(e,t,i){return[[this,this.crop||this.points,t]]}static fromSvg(e,t,i,r){return ba.fromImage("data:image/svg+xml;base64,"+btoa(e),t,i,r)}static fromImage(e,t,i,r){let n=new ba;return n.applyProps({uri:e,id:r,display:i,target:t}),n}getImageUrl(){return this.uri}},Dx=class extends _r{constructor(e){if(super(),this.type="spacial-content",this.getTexture=()=>({source:void 0,hash:-1}),!e)this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:Ne(5)},this.points=Ne(5);else{let t=e.scale||1;this.id=e.id||e.uri,this.uri=e.uri,this.points=ut.singleBox(e.width,e.height),this.display={x:0,y:0,scale:t,width:e.width/t,height:e.height/t,points:t!==1?ut.singleBox(e.width/t,e.height/t):this.points}}}applyProps(e){let t=e.display?e.display.width:e.target.width,i=e.target.width/t;this.id=e.id,this.points.set(ut.singleBox(e.target.width,e.target.height)),this.display.scale=i,this.display.width=e.target.width/i,this.display.height=e.target.height/i,this.getTexture=e.getTexture,this.display.points=i!==1?ut.singleBox(e.target.width/i,e.target.height/i):this.points}getAllPointsAt(e,t,i){return[[this,this.points,t]]}};function Wx(e,t,i=1){let r=t.length;if(r===0)throw new Error("No resources passed in.");let n=0;for(let a=0;a<r&&!(!t[a]||!t[a].display);a++)n=Math.abs(t[a].display.scale-e)*i<Math.abs(t[n].display.scale-e)?a:n;return n}function Hx(e){let t=e.length;return e.indexOf("/info.json")===t-10?e.slice(0,-10):e}function np(...e){return t=>e.forEach(i=>function(r,n){typeof r=="function"?r(n):r!=null&&(r.current=n)}(i,t))}function To(...e){return Qe(np(...e),e)}function xi(){return xi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},xi.apply(this,arguments)}var sp=ci((e,t)=>{let i=e,{children:r}=i,n=le(i,["children"]);return nn.toArray(r).some(op)?N(rt,null,nn.map(r,a=>op(a)?N(wh,xi({},n,{ref:t}),a.props.children):a)):N(wh,xi({},n,{ref:t}),r)});sp.displayName="Slot";var wh=ci((e,t)=>{let i=e,{children:r}=i,n=le(i,["children"]);return ya(r)?Ao(r,W(C({},qx(n,r.props)),{ref:np(t,r.ref)})):nn.count(r)>1?nn.only(null):null});wh.displayName="SlotClone";var ap=({children:e})=>N(rt,null,e);function op(e){return ya(e)&&e.type===ap}function qx(e,t){let i=C({},t);for(let r in t){let n=e[r],a=t[r];/^on[A-Z]/.test(r)?i[r]=(...l)=>{a==null||a(...l),n==null||n(...l)}:r==="style"?i[r]=C(C({},n),a):r==="className"&&(i[r]=[n,a].filter(Boolean).join(" "))}return C(C({},e),i)}var Io=globalThis!=null&&globalThis.document?Et:()=>{},Ro=function(e,t,i,r){this.name=e,this.fn=t,this.args=i,this.modifiers=r};Ro.prototype._test=function(e){var t=this.fn;try{Ts(this.modifiers.slice(),t,this)(e)}catch{t=function(){return!1}}try{return Ts(this.modifiers.slice(),t,this)(e)}catch{return!1}},Ro.prototype._check=function(e){try{Ts(this.modifiers.slice(),this.fn,this)(e)}catch{if(Ts(this.modifiers.slice(),function(i){return i},this)(!1))return}if(!Ts(this.modifiers.slice(),this.fn,this)(e))throw null},Ro.prototype._testAsync=function(e){var t=this;return new Promise(function(i,r){up(t.modifiers.slice(),t.fn,t)(e).then(function(n){n?i(e):r(null)}).catch(function(n){return r(n)})})};function lp(e,t){return t===void 0&&(t="simple"),typeof e=="object"?e[t]:e}function Ts(e,t,i){if(e.length){var r=e.shift(),n=Ts(e,t,i);return r.perform(n,i)}else return lp(t)}function up(e,t,i){if(e.length){var r=e.shift(),n=up(e,t,i);return r.performAsync(n,i)}else return function(a){return Promise.resolve(lp(t,"async")(a))}}var Qx=function(e,t,i){this.name=e,this.perform=t,this.performAsync=i},xh=function(e){function t(i,r,n,a){for(var l=[],u=arguments.length-4;u-- >0;)l[u]=arguments[u+4];e.call(this,l),e.captureStackTrace&&e.captureStackTrace(this,t),this.rule=i,this.value=r,this.cause=n,this.target=a}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),Sr=function(e,t){e===void 0&&(e=[]),t===void 0&&(t=[]),this.chain=e,this.nextRuleModifiers=t};Sr.prototype._applyRule=function(e,t){var i=this;return function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];return i.chain.push(new Ro(t,e.apply(i,r),r,i.nextRuleModifiers)),i.nextRuleModifiers=[],i}},Sr.prototype._applyModifier=function(e,t){return this.nextRuleModifiers.push(new Qx(t,e.simple,e.async)),this},Sr.prototype._clone=function(){return new Sr(this.chain.slice(),this.nextRuleModifiers.slice())},Sr.prototype.test=function(e){return this.chain.every(function(t){return t._test(e)})},Sr.prototype.testAll=function(e){var t=[];return this.chain.forEach(function(i){try{i._check(e)}catch(r){t.push(new xh(i,e,r))}}),t},Sr.prototype.check=function(e){this.chain.forEach(function(t){try{t._check(e)}catch(i){throw new xh(t,e,i)}})},Sr.prototype.testAsync=function(e){var t=this;return new Promise(function(i,r){hp(e,t.chain.slice(),i,r)})};function hp(e,t,i,r){if(t.length){var n=t.shift();n._testAsync(e).then(function(){hp(e,t,i,r)},function(a){r(new xh(n,e,a))})}else i(e)}var cp=function(e,t){return t&&typeof e=="string"&&e.trim().length===0?!0:e==null};function Vx(e,t){return t===void 0&&(t=!1),{simple:function(i){return cp(i,t)||e.check(i)===void 0},async:function(i){return cp(i,t)||e.testAsync(i)}}}function an(){return typeof Proxy<"u"?dp(new Sr):_h(new Sr)}var wa={};an.extend=function(e){Object.assign(wa,e)},an.clearCustomRules=function(){wa={}};function dp(e){return new Proxy(e,{get:function(t,i){if(i in t)return t[i];var r=dp(e._clone());if(i in Oo)return r._applyModifier(Oo[i],i);if(i in wa)return r._applyRule(wa[i],i);if(i in Sh)return r._applyRule(Sh[i],i)}})}function _h(e){var t=function(n,a){return Object.keys(n).forEach(function(l){a[l]=function(){for(var u=[],c=arguments.length;c--;)u[c]=arguments[c];var d=_h(a._clone()),p=d._applyRule(n[l],l).apply(void 0,u);return p}}),a},i=t(Sh,e),r=t(wa,i);return Object.keys(Oo).forEach(function(n){Object.defineProperty(r,n,{get:function(){var a=_h(r._clone());return a._applyModifier(Oo[n],n)}})}),r}var Oo={not:{simple:function(e){return function(t){return!e(t)}},async:function(e){return function(t){return Promise.resolve(e(t)).then(function(i){return!i}).catch(function(){return!0})}}},some:{simple:function(e){return function(t){return Mo(t).some(function(i){try{return e(i)}catch{return!1}})}},async:function(e){return function(t){return Promise.all(Mo(t).map(function(i){try{return e(i).catch(function(){return!1})}catch{return!1}})).then(function(i){return i.some(Boolean)})}}},every:{simple:function(e){return function(t){return t!==!1&&Mo(t).every(e)}},async:function(e){return function(t){return Promise.all(Mo(t).map(e)).then(function(i){return i.every(Boolean)})}}},strict:{simple:function(e,t){return function(i){return fp(t)&&i&&typeof i=="object"?Object.keys(t.args[0]).length===Object.keys(i).length&&e(i):e(i)}},async:function(e,t){return function(i){return Promise.resolve(e(i)).then(function(r){return fp(t)&&i&&typeof i=="object"?Object.keys(t.args[0]).length===Object.keys(i).length&&r:r}).catch(function(){return!1})}}}};function fp(e){return e&&e.name==="schema"&&e.args.length>0&&typeof e.args[0]=="object"}function Mo(e){return typeof e=="string"?e.split(""):e}var Sh={equal:function(e){return function(t){return t==e}},exact:function(e){return function(t){return t===e}},number:function(e){return e===void 0&&(e=!0),function(t){return typeof t=="number"&&(e||isFinite(t))}},integer:function(){return function(e){var t=Number.isInteger||Gx;return t(e)}},numeric:function(){return function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},string:function(){return Is("string")},boolean:function(){return Is("boolean")},undefined:function(){return Is("undefined")},null:function(){return Is("null")},array:function(){return Is("array")},object:function(){return Is("object")},instanceOf:function(e){return function(t){return t instanceof e}},pattern:function(e){return function(t){return e.test(t)}},lowercase:function(){return function(e){return typeof e=="boolean"||e===e.toLowerCase()&&e.trim()!==""}},uppercase:function(){return function(e){return e===e.toUpperCase()&&e.trim()!==""}},vowel:function(){return function(e){return/^[aeiou]+$/i.test(e)}},consonant:function(){return function(e){return/^(?=[^aeiou])([a-z]+)$/i.test(e)}},first:function(e){return function(t){return t[0]==e}},last:function(e){return function(t){return t[t.length-1]==e}},empty:function(){return function(e){return e.length===0}},length:function(e,t){return function(i){return i.length>=e&&i.length<=(t||e)}},minLength:function(e){return function(t){return t.length>=e}},maxLength:function(e){return function(t){return t.length<=e}},negative:function(){return function(e){return e<0}},positive:function(){return function(e){return e>=0}},between:function(e,t){return function(i){return i>=e&&i<=t}},range:function(e,t){return function(i){return i>=e&&i<=t}},lessThan:function(e){return function(t){return t<e}},lessThanOrEqual:function(e){return function(t){return t<=e}},greaterThan:function(e){return function(t){return t>e}},greaterThanOrEqual:function(e){return function(t){return t>=e}},even:function(){return function(e){return e%2===0}},odd:function(){return function(e){return e%2!==0}},includes:function(e){return function(t){return~t.indexOf(e)}},schema:function(e){return Zx(e)},passesAnyOf:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(i){return e.some(function(r){return r.test(i)})}},optional:Vx};function Is(e){return function(t){return Array.isArray(t)&&e==="array"||t===null&&e==="null"||typeof t===e}}function Gx(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}function Zx(e){return{simple:function(t){var i=[];if(Object.keys(e).forEach(function(r){var n=e[r];try{n.check((t||{})[r])}catch(a){a.target=r,i.push(a)}}),i.length>0)throw i;return!0},async:function(t){var i=[],r=Object.keys(e).map(function(n){var a=e[n];return a.testAsync((t||{})[n]).catch(function(l){l.target=n,i.push(l)})});return Promise.all(r).then(function(){if(i.length>0)throw i;return!0})}}}var vt="colors",Oi="sizes",Se="space",Yx={gap:Se,gridGap:Se,columnGap:Se,gridColumnGap:Se,rowGap:Se,gridRowGap:Se,inset:Se,insetBlock:Se,insetBlockEnd:Se,insetBlockStart:Se,insetInline:Se,insetInlineEnd:Se,insetInlineStart:Se,margin:Se,marginTop:Se,marginRight:Se,marginBottom:Se,marginLeft:Se,marginBlock:Se,marginBlockEnd:Se,marginBlockStart:Se,marginInline:Se,marginInlineEnd:Se,marginInlineStart:Se,padding:Se,paddingTop:Se,paddingRight:Se,paddingBottom:Se,paddingLeft:Se,paddingBlock:Se,paddingBlockEnd:Se,paddingBlockStart:Se,paddingInline:Se,paddingInlineEnd:Se,paddingInlineStart:Se,top:Se,right:Se,bottom:Se,left:Se,scrollMargin:Se,scrollMarginTop:Se,scrollMarginRight:Se,scrollMarginBottom:Se,scrollMarginLeft:Se,scrollMarginX:Se,scrollMarginY:Se,scrollMarginBlock:Se,scrollMarginBlockEnd:Se,scrollMarginBlockStart:Se,scrollMarginInline:Se,scrollMarginInlineEnd:Se,scrollMarginInlineStart:Se,scrollPadding:Se,scrollPaddingTop:Se,scrollPaddingRight:Se,scrollPaddingBottom:Se,scrollPaddingLeft:Se,scrollPaddingX:Se,scrollPaddingY:Se,scrollPaddingBlock:Se,scrollPaddingBlockEnd:Se,scrollPaddingBlockStart:Se,scrollPaddingInline:Se,scrollPaddingInlineEnd:Se,scrollPaddingInlineStart:Se,fontSize:"fontSizes",background:vt,backgroundColor:vt,backgroundImage:vt,borderImage:vt,border:vt,borderBlock:vt,borderBlockEnd:vt,borderBlockStart:vt,borderBottom:vt,borderBottomColor:vt,borderColor:vt,borderInline:vt,borderInlineEnd:vt,borderInlineStart:vt,borderLeft:vt,borderLeftColor:vt,borderRight:vt,borderRightColor:vt,borderTop:vt,borderTopColor:vt,caretColor:vt,color:vt,columnRuleColor:vt,fill:vt,outline:vt,outlineColor:vt,stroke:vt,textDecorationColor:vt,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:Oi,minBlockSize:Oi,maxBlockSize:Oi,inlineSize:Oi,minInlineSize:Oi,maxInlineSize:Oi,width:Oi,minWidth:Oi,maxWidth:Oi,height:Oi,minHeight:Oi,maxHeight:Oi,flexBasis:Oi,gridTemplateColumns:Oi,gridTemplateRows:Oi,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},Xx=(e,t)=>typeof t=="function"?{"()":Function.prototype.toString.call(t)}:t,Rs=()=>{let e=Object.create(null);return(t,i,...r)=>{let n=(a=>JSON.stringify(a,Xx))(t);return n in e?e[n]:e[n]=i(t,...r)}},Fn=Symbol.for("sxs.internal"),Eh=(e,t)=>Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)),pp=e=>{for(let t in e)return!0;return!1},{hasOwnProperty:Kx}=Object.prototype,Ah=e=>e.includes("-")?e:e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),Jx=/\s+(?![^()]*\))/,Os=e=>t=>e(...typeof t=="string"?String(t).split(Jx):[t]),gp={appearance:e=>({WebkitAppearance:e,appearance:e}),backfaceVisibility:e=>({WebkitBackfaceVisibility:e,backfaceVisibility:e}),backdropFilter:e=>({WebkitBackdropFilter:e,backdropFilter:e}),backgroundClip:e=>({WebkitBackgroundClip:e,backgroundClip:e}),boxDecorationBreak:e=>({WebkitBoxDecorationBreak:e,boxDecorationBreak:e}),clipPath:e=>({WebkitClipPath:e,clipPath:e}),content:e=>({content:e.includes('"')||e.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(e)?e:`"${e}"`}),hyphens:e=>({WebkitHyphens:e,hyphens:e}),maskImage:e=>({WebkitMaskImage:e,maskImage:e}),maskSize:e=>({WebkitMaskSize:e,maskSize:e}),tabSize:e=>({MozTabSize:e,tabSize:e}),textSizeAdjust:e=>({WebkitTextSizeAdjust:e,textSizeAdjust:e}),userSelect:e=>({WebkitUserSelect:e,userSelect:e}),marginBlock:Os((e,t)=>({marginBlockStart:e,marginBlockEnd:t||e})),marginInline:Os((e,t)=>({marginInlineStart:e,marginInlineEnd:t||e})),maxSize:Os((e,t)=>({maxBlockSize:e,maxInlineSize:t||e})),minSize:Os((e,t)=>({minBlockSize:e,minInlineSize:t||e})),paddingBlock:Os((e,t)=>({paddingBlockStart:e,paddingBlockEnd:t||e})),paddingInline:Os((e,t)=>({paddingInlineStart:e,paddingInlineEnd:t||e}))},kh=/([\d.]+)([^]*)/,e1=(e,t)=>e.length?e.reduce((i,r)=>(i.push(...t.map(n=>n.includes("&")?n.replace(/&/g,/[ +>|~]/.test(r)&&/&.*&/.test(n)?`:is(${r})`:r):r+" "+n)),i),[]):t,t1=(e,t)=>e in i1&&typeof t=="string"?t.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(i,r,n,a)=>r+(n==="stretch"?`-moz-available${a};${Ah(e)}:${r}-webkit-fill-available`:`-moz-fit-content${a};${Ah(e)}:${r}fit-content`)+a):String(t),i1={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},jr=e=>e?e+"-":"",mp=(e,t,i)=>e.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(r,n,a,l,u)=>l=="$"==!!a?r:(n||l=="--"?"calc(":"")+"var(--"+(l==="$"?jr(t)+(u.includes("$")?"":jr(i))+u.replace(/\$/g,"-"):u)+")"+(n||l=="--"?"*"+(n||"")+(a||"1")+")":"")),r1=/\s*,\s*(?![^()]*\))/,n1=Object.prototype.toString,Ms=(e,t,i,r,n)=>{let a,l,u,c=(d,p,y)=>{let x,E,S=k=>{for(x in k){let A=x.charCodeAt(0)===64,$=A&&Array.isArray(k[x])?k[x]:[k[x]];for(E of $){let z=/[A-Z]/.test(R=x)?R:R.replace(/-[^]/g,H=>H[1].toUpperCase()),B=typeof E=="object"&&E&&E.toString===n1&&(!r.utils[z]||!p.length);if(z in r.utils&&!B){let H=r.utils[z];if(H!==l){l=H,S(H(E)),l=null;continue}}else if(z in gp){let H=gp[z];if(H!==u){u=H,S(H(E)),u=null;continue}}if(A&&(T=x.slice(1)in r.media?"@media "+r.media[x.slice(1)]:x,x=T.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(H,Y,Q,he,G,ue)=>{let ce=kh.test(Y),be=.0625*(ce?-1:1),[re,Te]=ce?[he,Y]:[Y,he];return"("+(Q[0]==="="?"":Q[0]===">"===ce?"max-":"min-")+re+":"+(Q[0]!=="="&&Q.length===1?Te.replace(kh,(Oe,qe,ne)=>Number(qe)+be*(Q===">"?1:-1)+ne):Te)+(G?") and ("+(G[0]===">"?"min-":"max-")+re+":"+(G.length===1?ue.replace(kh,(Oe,qe,ne)=>Number(qe)+be*(G===">"?-1:1)+ne):ue):"")+")"})),B){let H=A?y.concat(x):[...y],Y=A?[...p]:e1(p,x.split(r1));a!==void 0&&n(yp(...a)),a=void 0,c(E,Y,H)}else a===void 0&&(a=[[],p,y]),x=A||x.charCodeAt(0)!==36?x:`--${jr(r.prefix)}${x.slice(1).replace(/\$/g,"-")}`,E=B?E:typeof E=="number"?E&&z in s1?String(E)+"px":String(E):mp(t1(z,E??""),r.prefix,r.themeMap[z]),a[0].push(`${A?`${x} `:`${Ah(x)}:`}${E}`)}}var T,R};S(d),a!==void 0&&n(yp(...a)),a=void 0};c(e,t,i)},yp=(e,t,i)=>`${i.map(r=>`${r}{`).join("")}${t.length?`${t.join(",")}{`:""}${e.join(";")}${t.length?"}":""}${Array(i.length?i.length+1:0).join("}")}`,s1={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},vp=e=>String.fromCharCode(e+(e>25?39:97)),Bn=e=>(t=>{let i,r="";for(i=Math.abs(t);i>52;i=i/52|0)r=vp(i%52)+r;return vp(i%52)+r})(((t,i)=>{let r=i.length;for(;r;)t=33*t^i.charCodeAt(--r);return t})(5381,JSON.stringify(e))>>>0),xa=["themed","global","styled","onevar","resonevar","allvar","inline"],a1=e=>{if(e.href&&!e.href.startsWith(location.origin))return!1;try{return!!e.cssRules}catch{return!1}},o1=e=>{let t,i=()=>{let{cssRules:n}=t.sheet;return[].map.call(n,(a,l)=>{let{cssText:u}=a,c="";if(u.startsWith("--sxs"))return"";if(n[l-1]&&(c=n[l-1].cssText).startsWith("--sxs")){if(!a.cssRules.length)return"";for(let d in t.rules)if(t.rules[d].group===a)return`--sxs{--sxs:${[...t.rules[d].cache].join(" ")}}${u}`;return a.cssRules.length?`${c}${u}`:""}return u}).join("")},r=()=>{if(t){let{rules:u,sheet:c}=t;if(!c.deleteRule){for(;Object(Object(c.cssRules)[0]).type===3;)c.cssRules.splice(0,1);c.cssRules=[]}for(let d in u)delete u[d]}let n=Object(e).styleSheets||[];for(let u of n)if(a1(u)){for(let c=0,d=u.cssRules;d[c];++c){let p=Object(d[c]);if(p.type!==1)continue;let y=Object(d[c+1]);if(y.type!==4)continue;++c;let{cssText:x}=p;if(!x.startsWith("--sxs"))continue;let E=x.slice(14,-3).trim().split(/\s+/),S=xa[E[0]];S&&(t||(t={sheet:u,reset:r,rules:{},toString:i}),t.rules[S]={group:y,index:c,cache:new Set(E)})}if(t)break}if(!t){let u=(c,d)=>({type:d,cssRules:[],insertRule(p,y){this.cssRules.splice(y,0,u(p,{import:3,undefined:1}[(p.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return c==="@media{}"?`@media{${[].map.call(this.cssRules,p=>p.cssText).join("")}}`:c}});t={sheet:e?(e.head||e).appendChild(document.createElement("style")).sheet:u("","text/css"),rules:{},reset:r,toString:i}}let{sheet:a,rules:l}=t;for(let u=xa.length-1;u>=0;--u){let c=xa[u];if(!l[c]){let d=xa[u+1],p=l[d]?l[d].index:a.cssRules.length;a.insertRule("@media{}",p),a.insertRule(`--sxs{--sxs:${u}}`,p),l[c]={group:a.cssRules[p+1],index:p,cache:new Set([u])}}l1(l[c])}};return r(),t},l1=e=>{let t=e.group,i=t.cssRules.length;e.apply=r=>{try{t.insertRule(r,i),++i}catch{}}},_a=Symbol(),u1=Rs(),bp=(e,t)=>u1(e,()=>(...i)=>{let r={type:null,composers:new Set};for(let n of i)if(n!=null)if(n[Fn]){r.type==null&&(r.type=n[Fn].type);for(let a of n[Fn].composers)r.composers.add(a)}else n.constructor!==Object||n.$$typeof?r.type==null&&(r.type=n):r.composers.add(h1(n,e));return r.type==null&&(r.type="span"),r.composers.size||r.composers.add(["PJLV",{},[],[],{},[]]),c1(e,r,t)}),h1=(e,t)=>{var i=e,{variants:r,compoundVariants:n,defaultVariants:a}=i,l=le(i,["variants","compoundVariants","defaultVariants"]);let u=`${jr(t.prefix)}c-${Bn(l)}`,c=[],d=[],p=Object.create(null),y=[];for(let S in a)p[S]=String(a[S]);if(typeof r=="object"&&r)for(let S in r){x=p,E=S,Kx.call(x,E)||(p[S]="undefined");let k=r[S];for(let T in k){let R={[S]:String(T)};String(T)==="undefined"&&y.push(S);let A=k[T],$=[R,A,!pp(A)];c.push($)}}var x,E;if(typeof n=="object"&&n)for(let S of n){let k=S,{css:T}=k,R=le(k,["css"]);T=typeof T=="object"&&T||{};for(let $ in R)R[$]=String(R[$]);let A=[R,T,!pp(T)];d.push(A)}return[u,l,c,d,p,y]},c1=(e,t,i)=>{let[r,n,a,l]=d1(t.composers),u=typeof t.type=="function"||t.type.$$typeof?(y=>{function x(){for(let E=0;E<x[_a].length;E++){let[S,k]=x[_a][E];y.rules[S].apply(k)}return x[_a]=[],null}return x[_a]=[],x.rules={},xa.forEach(E=>x.rules[E]={apply:S=>x[_a].push([E,S])}),x})(i):null,c=(u||i).rules,d=`.${r}${n.length>1?`:where(.${n.slice(1).join(".")})`:""}`,p=y=>{y=typeof y=="object"&&y||f1;let x=y,{css:E}=x,S=le(x,["css"]),k={};for(let A in a)if(delete S[A],A in y){let $=y[A];typeof $=="object"&&$?k[A]=C({"@initial":a[A]},$):($=String($),k[A]=$!=="undefined"||l.has(A)?$:a[A])}else k[A]=a[A];let T=new Set([...n]);for(let[A,$,z,B]of t.composers){i.rules.styled.cache.has(A)||(i.rules.styled.cache.add(A),Ms($,[`.${A}`],[],e,Q=>{c.styled.apply(Q)}));let H=wp(z,k,e.media),Y=wp(B,k,e.media,!0);for(let Q of H)if(Q!==void 0)for(let[he,G,ue]of Q){let ce=`${A}-${Bn(G)}-${he}`;T.add(ce);let be=(ue?i.rules.resonevar:i.rules.onevar).cache,re=ue?c.resonevar:c.onevar;be.has(ce)||(be.add(ce),Ms(G,[`.${ce}`],[],e,Te=>{re.apply(Te)}))}for(let Q of Y)if(Q!==void 0)for(let[he,G]of Q){let ue=`${A}-${Bn(G)}-${he}`;T.add(ue),i.rules.allvar.cache.has(ue)||(i.rules.allvar.cache.add(ue),Ms(G,[`.${ue}`],[],e,ce=>{c.allvar.apply(ce)}))}}if(typeof E=="object"&&E){let A=`${r}-i${Bn(E)}-css`;T.add(A),i.rules.inline.cache.has(A)||(i.rules.inline.cache.add(A),Ms(E,[`.${A}`],[],e,$=>{c.inline.apply($)}))}for(let A of String(y.className||"").trim().split(/\s+/))A&&T.add(A);let R=S.className=[...T].join(" ");return{type:t.type,className:R,selector:d,props:S,toString:()=>R,deferredInjector:u}};return Eh(p,{className:r,selector:d,[Fn]:t,toString:()=>(i.rules.styled.cache.has(r)||p(),r)})},d1=e=>{let t="",i=[],r={},n=[];for(let[a,,,,l,u]of e){t===""&&(t=a),i.push(a),n.push(...u);for(let c in l){let d=l[c];(r[c]===void 0||d!=="undefined"||u.includes(d))&&(r[c]=d)}}return[t,i,r,new Set(n)]},wp=(e,t,i,r)=>{let n=[];e:for(let[a,l,u]of e){if(u)continue;let c,d=0,p=!1;for(c in a){let y=a[c],x=t[c];if(x!==y){if(typeof x!="object"||!x)continue e;{let E,S,k=0;for(let T in x){if(y===String(x[T])){if(T!=="@initial"){let R=T.slice(1);(S=S||[]).push(R in i?i[R]:T.replace(/^@media ?/,"")),p=!0}d+=k,E=!0}++k}if(S&&S.length&&(l={["@media "+S.join(", ")]:l}),!E)continue e}}}(n[d]=n[d]||[]).push([r?"cv":`${c}-${a[c]}`,l,p])}return n},f1={},p1=Rs(),g1=(e,t)=>p1(e,()=>(...i)=>{let r=()=>{for(let n of i){n=typeof n=="object"&&n||{};let a=Bn(n);if(!t.rules.global.cache.has(a)){if(t.rules.global.cache.add(a),"@import"in n){let l=[].indexOf.call(t.sheet.cssRules,t.rules.themed.group)-1;for(let u of[].concat(n["@import"]))u=u.includes('"')||u.includes("'")?u:`"${u}"`,t.sheet.insertRule(`@import ${u};`,l++);delete n["@import"]}Ms(n,[],[],e,l=>{t.rules.global.apply(l)})}}return""};return Eh(r,{toString:r})}),m1=Rs(),y1=(e,t)=>m1(e,()=>i=>{let r=`${jr(e.prefix)}k-${Bn(i)}`,n=()=>{if(!t.rules.global.cache.has(r)){t.rules.global.cache.add(r);let a=[];Ms(i,[],[],e,u=>a.push(u));let l=`@keyframes ${r}{${a.join("")}}`;t.rules.global.apply(l)}return r};return Eh(n,{get name(){return n()},toString:n})}),v1=class{constructor(e,t,i,r){this.token=e==null?"":String(e),this.value=t==null?"":String(t),this.scale=i==null?"":String(i),this.prefix=r==null?"":String(r)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+jr(this.prefix)+jr(this.scale)+this.token}toString(){return this.computedValue}},b1=Rs(),w1=(e,t)=>b1(e,()=>(i,r)=>{r=typeof i=="object"&&i||Object(r);let n=`.${i=(i=typeof i=="string"?i:"")||`${jr(e.prefix)}t-${Bn(r)}`}`,a={},l=[];for(let c in r){a[c]={};for(let d in r[c]){let p=`--${jr(e.prefix)}${c}-${d}`,y=mp(String(r[c][d]),e.prefix,c);a[c][d]=new v1(d,y,c,e.prefix),l.push(`${p}:${y}`)}}let u=()=>{if(l.length&&!t.rules.themed.cache.has(i)){t.rules.themed.cache.add(i);let c=`${r===e.theme?":root,":""}.${i}{${l.join(";")}}`;t.rules.themed.apply(c)}return i};return W(C({},a),{get className(){return u()},selector:n,toString:u})}),x1=Rs(),_1=Rs(),S1=e=>{let t=(i=>{let r=!1,n=x1(i,a=>{r=!0;let l="prefix"in(a=typeof a=="object"&&a||{})?String(a.prefix):"",u=typeof a.media=="object"&&a.media||{},c=typeof a.root=="object"?a.root||null:globalThis.document||null,d=typeof a.theme=="object"&&a.theme||{},p={prefix:l,media:u,theme:d,themeMap:typeof a.themeMap=="object"&&a.themeMap||C({},Yx),utils:typeof a.utils=="object"&&a.utils||{}},y=o1(c),x={css:bp(p,y),globalCss:g1(p,y),keyframes:y1(p,y),createTheme:w1(p,y),reset(){y.reset(),x.theme.toString()},theme:{},sheet:y,config:p,prefix:l,getCssText:y.toString,toString:y.toString};return String(x.theme=x.createTheme(d)),x});return r||n.reset(),n})(e);return t.styled=(({config:i,sheet:r})=>_1(i,()=>{let n=bp(i,r);return(...a)=>{let l=n(...a),u=l[Fn].type,c=te.forwardRef((d,p)=>{let y=d&&d.as||u,{props:x,deferredInjector:E}=l(d);return delete x.as,x.ref=p,E?te.createElement(te.Fragment,null,te.createElement(y,x),te.createElement(E,null)):te.createElement(y,x)});return c.className=l.className,c.displayName=`Styled.${u.displayName||u.name||u}`,c.selector=l.selector,c.toString=()=>l.selector,c[Fn]=l[Fn],c}}))(t),t};function E1(e,t,i){return Math.max(t,Math.min(e,i))}var _i={toVector(e,t){return e===void 0&&(e=t),Array.isArray(e)?e:[e,e]},add(e,t){return[e[0]+t[0],e[1]+t[1]]},sub(e,t){return[e[0]-t[0],e[1]-t[1]]},addTo(e,t){e[0]+=t[0],e[1]+=t[1]},subTo(e,t){e[0]-=t[0],e[1]-=t[1]}};function xp(e,t,i){return t===0||Math.abs(t)===1/0?Math.pow(e,i*5):e*t*i/(t+i*e)}function _p(e,t,i,r=.15){return r===0?E1(e,t,i):e<t?-xp(t-e,i-t,r)+t:e>i?+xp(e-i,i-t,r)+i:e}function A1(e,[t,i],[r,n]){let[[a,l],[u,c]]=e;return[_p(t,a,l,r),_p(i,u,c,n)]}function k1(e,t){if(typeof e!="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function P1(e){var t=k1(e,"string");return typeof t=="symbol"?t:String(t)}function zi(e,t,i){return t=P1(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Sp(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function Lt(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Sp(Object(i),!0).forEach(function(r){zi(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Sp(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}var Ep={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function Ap(e){return e?e[0].toUpperCase()+e.slice(1):""}var C1=["enter","leave"];function T1(e=!1,t){return e&&!C1.includes(t)}function I1(e,t="",i=!1){let r=Ep[e],n=r&&r[t]||t;return"on"+Ap(e)+Ap(n)+(T1(i,n)?"Capture":"")}var R1=["gotpointercapture","lostpointercapture"];function O1(e){let t=e.substring(2).toLowerCase(),i=!!~t.indexOf("passive");i&&(t=t.replace("passive",""));let r=R1.includes(t)?"capturecapture":"capture",n=!!~t.indexOf(r);return n&&(t=t.replace("capture","")),{device:t,capture:n,passive:i}}function M1(e,t=""){let i=Ep[e],r=i&&i[t]||t;return e+r}function Lo(e){return"touches"in e}function kp(e){return Lo(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function L1(e){return Array.from(e.touches).filter(t=>{var i,r;return t.target===e.currentTarget||((i=e.currentTarget)===null||i===void 0||(r=i.contains)===null||r===void 0?void 0:r.call(i,t.target))})}function $1(e){return e.type==="touchend"||e.type==="touchcancel"?e.changedTouches:e.targetTouches}function Pp(e){return Lo(e)?$1(e)[0]:e}function N1(e){return L1(e).map(t=>t.identifier)}function Ph(e){let t=Pp(e);return Lo(e)?t.identifier:t.pointerId}function Cp(e){let t=Pp(e);return[t.clientX,t.clientY]}function z1(e){let t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){let{shiftKey:i,altKey:r,metaKey:n,ctrlKey:a}=e;Object.assign(t,{shiftKey:i,altKey:r,metaKey:n,ctrlKey:a})}return t}function $o(e,...t){return typeof e=="function"?e(...t):e}function F1(){}function B1(...e){return e.length===0?F1:e.length===1?e[0]:function(){let t;for(let i of e)t=i.apply(this,arguments)||t;return t}}function Tp(e,t){return Object.assign({},t,e||{})}var j1=32,U1=class{constructor(e,t,i){this.ctrl=e,this.args=t,this.key=i,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){let{state:e,shared:t,ingKey:i,args:r}=this;t[i]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=r,e.axis=void 0,e.memo=void 0,e.elapsedTime=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){let t=this.state,i=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=i.from?$o(i.from,t):t.offset,t.offset=t.lastOffset),t.startTime=t.timeStamp=e.timeStamp}computeValues(e){let t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){let e=this.state;e._initial=e._values,e.initial=e.values}compute(e){let{state:t,config:i,shared:r}=this;t.args=this.args;let n=0;if(e&&(t.event=e,i.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,r.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,r.locked=!!document.pointerLockElement,Object.assign(r,z1(e)),r.down=r.pressed=r.buttons%2===1||r.touches>0,n=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){let B=t._delta.map(Math.abs);_i.addTo(t._distance,B)}this.axisIntent&&this.axisIntent(e);let[a,l]=t._movement,[u,c]=i.threshold,{_step:d,values:p}=t;if(i.hasCustomTransform?(d[0]===!1&&(d[0]=Math.abs(a)>=u&&p[0]),d[1]===!1&&(d[1]=Math.abs(l)>=c&&p[1])):(d[0]===!1&&(d[0]=Math.abs(a)>=u&&Math.sign(a)*u),d[1]===!1&&(d[1]=Math.abs(l)>=c&&Math.sign(l)*c)),t.intentional=d[0]!==!1||d[1]!==!1,!t.intentional)return;let y=[0,0];if(i.hasCustomTransform){let[B,H]=p;y[0]=d[0]!==!1?B-d[0]:0,y[1]=d[1]!==!1?H-d[1]:0}else y[0]=d[0]!==!1?a-d[0]:0,y[1]=d[1]!==!1?l-d[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(y);let x=t.offset,E=t._active&&!t._blocked||t.active;E&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=r[this.ingKey]=t._active,e&&(t.first&&("bounds"in i&&(t._bounds=$o(i.bounds,t)),this.setup&&this.setup()),t.movement=y,this.computeOffset()));let[S,k]=t.offset,[[T,R],[A,$]]=t._bounds;t.overflow=[S<T?-1:S>R?1:0,k<A?-1:k>$?1:0],t._movementBound[0]=t.overflow[0]?t._movementBound[0]===!1?t._movement[0]:t._movementBound[0]:!1,t._movementBound[1]=t.overflow[1]?t._movementBound[1]===!1?t._movement[1]:t._movementBound[1]:!1;let z=t._active?i.rubberband||[0,0]:[0,0];if(t.offset=A1(t._bounds,t.offset,z),t.delta=_i.sub(t.offset,x),this.computeMovement(),E&&(!t.last||n>j1)){t.delta=_i.sub(t.offset,x);let B=t.delta.map(Math.abs);_i.addTo(t.distance,B),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&n>0&&(t.velocity=[B[0]/n,B[1]/n])}}emit(){let e=this.state,t=this.shared,i=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!i.triggerAllEvents)return;let r=this.handler(Lt(Lt(Lt({},t),e),{},{[this.aliasKey]:e.values}));r!==void 0&&(e.memo=r)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}};function D1([e,t],i){let r=Math.abs(e),n=Math.abs(t);if(r>n&&r>i)return"x";if(n>r&&n>i)return"y"}var W1=class extends U1{constructor(...e){super(...e),zi(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=_i.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=_i.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){let t=this.state,i=this.config;if(!t.axis&&e){let r=typeof i.axisThreshold=="object"?i.axisThreshold[kp(e)]:i.axisThreshold;t.axis=D1(t._movement,r)}t._blocked=(i.lockDirection||!!i.axis)&&!t.axis||!!i.axis&&i.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}},H1=e=>e,Ip=.15,Rp={enabled(e=!0){return e},eventOptions(e,t,i){return Lt(Lt({},i.shared.eventOptions),e)},preventDefault(e=!1){return e},triggerAllEvents(e=!1){return e},rubberband(e=0){switch(e){case!0:return[Ip,Ip];case!1:return[0,0];default:return _i.toVector(e)}},from(e){if(typeof e=="function")return e;if(e!=null)return _i.toVector(e)},transform(e,t,i){let r=e||i.shared.transform;return this.hasCustomTransform=!!r,r||H1},threshold(e){return _i.toVector(e,0)}},q1=0,Sa=Lt(Lt({},Rp),{},{axis(e,t,{axis:i}){if(this.lockDirection=i==="lock",!this.lockDirection)return i},axisThreshold(e=q1){return e},bounds(e={}){if(typeof e=="function")return a=>Sa.bounds(e(a));if("current"in e)return()=>e.current;if(typeof HTMLElement=="function"&&e instanceof HTMLElement)return e;let{left:t=-1/0,right:i=1/0,top:r=-1/0,bottom:n=1/0}=e;return[[t,i],[r,n]]}}),Op={ArrowRight:(e,t=1)=>[e*t,0],ArrowLeft:(e,t=1)=>[-1*e*t,0],ArrowUp:(e,t=1)=>[0,-1*e*t],ArrowDown:(e,t=1)=>[0,e*t]},Q1=class extends W1{constructor(...e){super(...e),zi(this,"ingKey","dragging")}reset(){super.reset();let e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){let e=this.state;if(e._bounds instanceof HTMLElement){let t=e._bounds.getBoundingClientRect(),i=e.currentTarget.getBoundingClientRect(),r={left:t.left-i.left+e.offset[0],right:t.right-i.right+e.offset[0],top:t.top-i.top+e.offset[1],bottom:t.bottom-i.bottom+e.offset[1]};e._bounds=Sa.bounds(r)}}cancel(){let e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){let t=this.config,i=this.state;if(e.buttons!=null&&(Array.isArray(t.pointerButtons)?!t.pointerButtons.includes(e.buttons):t.pointerButtons!==-1&&t.pointerButtons!==e.buttons))return;let r=this.ctrl.setEventIds(e);t.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(r&&r.size>1&&i._pointerActive)&&(this.start(e),this.setupPointer(e),i._pointerId=Ph(e),i._pointerActive=!0,this.computeValues(Cp(e)),this.computeInitial(),t.preventScrollAxis&&kp(e)!=="mouse"?(i._active=!1,this.setupScrollPrevention(e)):t.delay>0?(this.setupDelayTrigger(e),t.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){let t=this.state;t._active=!0,t._preventScroll=!0,t._delayed=!1,this.compute(e),this.emit()}pointerMove(e){let t=this.state,i=this.config;if(!t._pointerActive||t.type===e.type&&e.timeStamp===t.timeStamp)return;let r=Ph(e);if(t._pointerId!==void 0&&r!==t._pointerId)return;let n=Cp(e);if(document.pointerLockElement===e.target?t._delta=[e.movementX,e.movementY]:(t._delta=_i.sub(n,t._values),this.computeValues(n)),_i.addTo(t._movement,t._delta),this.compute(e),t._delayed&&t.intentional){this.timeoutStore.remove("dragDelay"),t.active=!1,this.startPointerDrag(e);return}if(i.preventScrollAxis&&!t._preventScroll)if(t.axis)if(t.axis===i.preventScrollAxis||i.preventScrollAxis==="xy"){t._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}let t=this.state,i=this.config;if(!t._active||!t._pointerActive)return;let r=Ph(e);if(t._pointerId!==void 0&&r!==t._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);let[n,a]=t._distance;if(t.tap=n<=i.tapsThreshold&&a<=i.tapsThreshold,t.tap&&i.filterTaps)t._force=!0;else{let[l,u]=t.direction,[c,d]=t.velocity,[p,y]=t.movement,[x,E]=i.swipe.velocity,[S,k]=i.swipe.distance,T=i.swipe.duration;t.elapsedTime<T&&(Math.abs(c)>x&&Math.abs(p)>S&&(t.swipe[0]=l),Math.abs(d)>E&&Math.abs(y)>k&&(t.swipe[1]=u))}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){let t=this.config,i=t.device;t.pointerLock&&e.currentTarget.requestPointerLock(),t.pointerCapture||(this.eventStore.add(this.sharedConfig.window,i,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,V1(e);let t=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",t),this.eventStore.add(this.sharedConfig.window,"touch","cancel",t),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){let t=Op[e.key];if(t){let i=this.state,r=e.shiftKey?10:e.altKey?.1:1;this.start(e),i._delta=t(this.config.keyboardDisplacement,r),i._keyboardActive=!0,_i.addTo(i._movement,i._delta),this.compute(e),this.emit()}}keyUp(e){e.key in Op&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){let t=this.config.device;e(t,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(t,"change",this.pointerMove.bind(this)),e(t,"end",this.pointerUp.bind(this)),e(t,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}};function V1(e){"persist"in e&&typeof e.persist=="function"&&e.persist()}var Ea=typeof window<"u"&&window.document&&window.document.createElement;function G1(){return Ea&&"ontouchstart"in window}function Mp(){return G1()||Ea&&window.navigator.maxTouchPoints>1}function Z1(){return Ea&&"onpointerdown"in window}function Y1(){return Ea&&"exitPointerLock"in window.document}function X1(){try{return"constructor"in GestureEvent}catch{return!1}}var Xi={isBrowser:Ea,gesture:X1(),touch:Mp(),touchscreen:Mp(),pointer:Z1(),pointerLock:Y1()},K1=250,J1=180,e_=.5,t_=50,i_=250,r_=10,Lp={mouse:0,touch:0,pen:8},n_=Lt(Lt({},Sa),{},{device(e,t,{pointer:{touch:i=!1,lock:r=!1,mouse:n=!1}={}}){return this.pointerLock=r&&Xi.pointerLock,Xi.touch&&i?"touch":this.pointerLock?"mouse":Xi.pointer&&!n?"pointer":Xi.touch?"touch":"mouse"},preventScrollAxis(e,t,{preventScroll:i}){if(this.preventScrollDelay=typeof i=="number"?i:i||i===void 0&&e?K1:void 0,!(!Xi.touchscreen||i===!1))return e||(i!==void 0?"y":void 0)},pointerCapture(e,t,{pointer:{capture:i=!0,buttons:r=1,keys:n=!0}={}}){return this.pointerButtons=r,this.keys=n,!this.pointerLock&&this.device==="pointer"&&i},threshold(e,t,{filterTaps:i=!1,tapsThreshold:r=3,axis:n=void 0}){let a=_i.toVector(e,i?r:n?1:0);return this.filterTaps=i,this.tapsThreshold=r,a},swipe({velocity:e=e_,distance:t=t_,duration:i=i_}={}){return{velocity:this.transform(_i.toVector(e)),distance:this.transform(_i.toVector(t)),duration:i}},delay(e=0){switch(e){case!0:return J1;case!1:return 0;default:return e}},axisThreshold(e){return e?Lt(Lt({},Lp),e):Lp},keyboardDisplacement(e=r_){return e}});Lt(Lt({},Rp),{},{device(e,t,{shared:i,pointer:{touch:r=!1}={}}){if(i.target&&!Xi.touch&&Xi.gesture)return"gesture";if(Xi.touch&&r)return"touch";if(Xi.touchscreen){if(Xi.pointer)return"pointer";if(Xi.touch)return"touch"}},bounds(e,t,{scaleBounds:i={},angleBounds:r={}}){let n=l=>{let u=Tp($o(i,l),{min:-1/0,max:1/0});return[u.min,u.max]},a=l=>{let u=Tp($o(r,l),{min:-1/0,max:1/0});return[u.min,u.max]};return typeof i!="function"&&typeof r!="function"?[n(),a()]:l=>[n(l),a(l)]},threshold(e,t,i){return this.lockDirection=i.axis==="lock",_i.toVector(e,this.lockDirection?[.1,3]:0)},modifierKey(e){return e===void 0?"ctrlKey":e},pinchOnWheel(e=!0){return e}}),Lt(Lt({},Sa),{},{mouseOnly:(e=!0)=>e}),Lt(Lt({},Sa),{},{mouseOnly:(e=!0)=>e});var $p=new Map,Ch=new Map;function s_(e){$p.set(e.key,e.engine),Ch.set(e.key,e.resolver)}var a_={key:"drag",engine:Q1,resolver:n_};function o_(e,t){if(e==null)return{};var i={},r=Object.keys(e),n,a;for(a=0;a<r.length;a++)n=r[a],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}function l_(e,t){if(e==null)return{};var i=o_(e,t),r,n;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],!(t.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}var u_={target(e){if(e)return()=>"current"in e?e.current:e},enabled(e=!0){return e},window(e=Xi.isBrowser?window:void 0){return e},eventOptions({passive:e=!0,capture:t=!1}={}){return{passive:e,capture:t}},transform(e){return e}},h_=["target","eventOptions","window","enabled","transform"];function No(e={},t){let i={};for(let[r,n]of Object.entries(t))switch(typeof n){case"function":i[r]=n.call(i,e[r],r,e);break;case"object":i[r]=No(e[r],n);break;case"boolean":n&&(i[r]=e[r]);break}return i}function c_(e,t,i={}){let r=e,{target:n,eventOptions:a,window:l,enabled:u,transform:c}=r,d=l_(r,h_);if(i.shared=No({target:n,eventOptions:a,window:l,enabled:u,transform:c},u_),t){let p=Ch.get(t);i[t]=No(Lt({shared:i.shared},d),p)}else for(let p in d){let y=Ch.get(p);y&&(i[p]=No(Lt({shared:i.shared},d[p]),y))}return i}var Np=class{constructor(e,t){zi(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,i,r,n){let a=this._listeners,l=M1(t,i),u=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=Lt(Lt({},u),n);e.addEventListener(l,r,c);let d=()=>{e.removeEventListener(l,r,c),a.delete(d)};return a.add(d),d}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}},d_=class{constructor(){zi(this,"_timeouts",new Map)}add(e,t,i=140,...r){this.remove(e),this._timeouts.set(e,window.setTimeout(t,i,...r))}remove(e){let t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}},f_=class{constructor(e){zi(this,"gestures",new Set),zi(this,"_targetEventStore",new Np(this)),zi(this,"gestureEventStores",{}),zi(this,"gestureTimeoutStores",{}),zi(this,"handlers",{}),zi(this,"config",{}),zi(this,"pointerIds",new Set),zi(this,"touchIds",new Set),zi(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),p_(this,e)}setEventIds(e){if(Lo(e))return this.touchIds=new Set(N1(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=c_(e,t,this.config)}clean(){this._targetEventStore.clean();for(let e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){let t=this.config.shared,i={},r;if(!(t.target&&(r=t.target(),!r))){if(t.enabled){for(let a of this.gestures){let l=this.config[a],u=zp(i,l.eventOptions,!!r);if(l.enabled){let c=$p.get(a);new c(this,e,a).bind(u)}}let n=zp(i,t.eventOptions,!!r);for(let a in this.nativeHandlers)n(a,"",l=>this.nativeHandlers[a](Lt(Lt({},this.state.shared),{},{event:l,args:e})),void 0,!0)}for(let n in i)i[n]=B1(...i[n]);if(!r)return i;for(let n in i){let{device:a,capture:l,passive:u}=O1(n);this._targetEventStore.add(r,a,"",i[n],{capture:l,passive:u})}}}};function Ls(e,t){e.gestures.add(t),e.gestureEventStores[t]=new Np(e,t),e.gestureTimeoutStores[t]=new d_}function p_(e,t){t.drag&&Ls(e,"drag"),t.wheel&&Ls(e,"wheel"),t.scroll&&Ls(e,"scroll"),t.move&&Ls(e,"move"),t.pinch&&Ls(e,"pinch"),t.hover&&Ls(e,"hover")}var zp=(e,t,i)=>(r,n,a,l={},u=!1)=>{var c,d;let p=(c=l.capture)!==null&&c!==void 0?c:t.capture,y=(d=l.passive)!==null&&d!==void 0?d:t.passive,x=u?r:I1(r,n,p);i&&y&&(x+="Passive"),e[x]=e[x]||[],e[x].push(a)};function g_(e,t={},i,r){let n=te.useMemo(()=>new f_(e),[]);if(n.applyHandlers(e,r),n.applyConfig(t,i),te.useEffect(n.effect.bind(n)),te.useEffect(()=>n.clean.bind(n),[]),t.target===void 0)return n.bind.bind(n)}function m_(e,t){return s_(a_),g_({drag:e},{},"drag")}var y_=Ln.useId||(()=>{}),v_=0;function b_(e){let[t,i]=je(y_());return Io(()=>{i(r=>r??String(v_++))},[e]),t?`radix-${t}`:""}var $s=["a","button","div","h2","h3","img","li","nav","p","span","svg","ul"].reduce((e,t)=>W(C({},e),{[t]:ci((i,r)=>{let n=i,{asChild:a}=n,l=le(n,["asChild"]),u=a?sp:t;return fe(()=>{window[Symbol.for("radix-ui")]=!0},[]),i.as&&console.error(w_),N(u,xi({},l,{ref:r}))})}),{}),w_="Warning: The `as` prop has been removed in favour of `asChild`. For details, see https://radix-ui.com/docs/primitives/overview/styling#changing-the-rendered-element",x_=ci((e,t)=>N($s.span,xi({},e,{ref:t,style:W(C({},e.style),{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"})}))),__=x_,S_=ci((e,t)=>{var i,r;let n=e,{containerRef:a,style:l}=n,u=le(n,["containerRef","style"]),c=(i=a==null?void 0:a.current)!==null&&i!==void 0?i:globalThis==null||(r=globalThis.document)===null||r===void 0?void 0:r.body,[,d]=je({});return Io(()=>{d({})},[]),c?te.createPortal(N($s.div,xi({"data-radix-portal":""},u,{ref:t,style:c===document.body?C({position:"absolute",top:0,left:0,zIndex:2147483647},l):void 0})),c):null}),E_=ci((e,t)=>{let i=e,{children:r,width:n=10,height:a=5}=i,l=le(i,["children","width","height"]);return N($s.svg,xi({},l,{ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),e.asChild?r:N("polygon",{points:"0,0 30,0 15,10"}))}),A_=E_;function Fp(e){let[t,i]=je(void 0);return fe(()=>{if(e){let r=new ResizeObserver(n=>{if(!Array.isArray(n)||!n.length)return;let a=n[0],l,u;if("borderBoxSize"in a){let c=a.borderBoxSize,d=Array.isArray(c)?c[0]:c;l=d.inlineSize,u=d.blockSize}else{let c=e.getBoundingClientRect();l=c.width,u=c.height}i({width:l,height:u})});return r.observe(e,{box:"border-box"}),()=>{i(void 0),r.unobserve(e)}}},[e]),t}function k_(e,t){let i=jn.get(e);return i===void 0?(jn.set(e,{rect:{},callbacks:[t]}),jn.size===1&&(Th=requestAnimationFrame(Bp))):(i.callbacks.push(t),t(e.getBoundingClientRect())),()=>{let r=jn.get(e);if(r===void 0)return;let n=r.callbacks.indexOf(t);n>-1&&r.callbacks.splice(n,1),r.callbacks.length===0&&(jn.delete(e),jn.size===0&&cancelAnimationFrame(Th))}}var Th,jn=new Map;function Bp(){let e=[];jn.forEach((t,i)=>{let r=i.getBoundingClientRect();var n,a;n=t.rect,a=r,(n.width!==a.width||n.height!==a.height||n.top!==a.top||n.right!==a.right||n.bottom!==a.bottom||n.left!==a.left)&&(t.rect=r,e.push(t))}),e.forEach(t=>{t.callbacks.forEach(i=>i(t.rect))}),Th=requestAnimationFrame(Bp)}function jp(e){let[t,i]=je();return fe(()=>{if(e){let r=k_(e,i);return()=>{i(void 0),r()}}},[e]),t}function Up(e,t=[]){let i=[],r=()=>{let n=i.map(a=>ri(a));return function(a){let l=(a==null?void 0:a[e])||n;return Ae(()=>({[`__scope${e}`]:W(C({},a),{[e]:l})}),[a,l])}};return r.scopeName=e,[function(n,a){let l=ri(a),u=i.length;function c(d){let p=d,{scope:y,children:x}=p,E=le(p,["scope","children"]),S=(y==null?void 0:y[e][u])||l,k=Ae(()=>E,Object.values(E));return N(S.Provider,{value:k},x)}return i=[...i,a],c.displayName=n+"Provider",[c,function(d,p){let y=(p==null?void 0:p[e][u])||l,x=Yt(y);if(x)return x;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${n}\``)}]},P_(r,...t)]}function P_(...e){let t=e[0];if(e.length===1)return t;let i=()=>{let r=e.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(n){let a=r.reduce((l,{useScope:u,scopeName:c})=>C(C({},l),u(n)[`__scope${c}`]),{});return Ae(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return i.scopeName=t.scopeName,i}function C_({anchorRect:e,popperSize:t,arrowSize:i,arrowOffset:r=0,side:n,sideOffset:a=0,align:l,alignOffset:u=0,shouldAvoidCollisions:c=!0,collisionBoundariesRect:d,collisionTolerance:p=0}){if(!e||!t||!d)return{popperStyles:T_,arrowStyles:Ih};let y=function(Y,Q,he=0,G=0,ue){let ce=ue?ue.height:0,be=Dp(Q,Y,"x"),re=Dp(Q,Y,"y"),Te=re.before-he-ce,Oe=re.after+he+ce,qe=be.before-he-ce,ne=be.after+he+ce;return{top:{start:{x:be.start+G,y:Te},center:{x:be.center,y:Te},end:{x:be.end-G,y:Te}},right:{start:{x:ne,y:re.start+G},center:{x:ne,y:re.center},end:{x:ne,y:re.end-G}},bottom:{start:{x:be.start+G,y:Oe},center:{x:be.center,y:Oe},end:{x:be.end-G,y:Oe}},left:{start:{x:qe,y:re.start+G},center:{x:qe,y:re.center},end:{x:qe,y:re.end-G}}}}(t,e,a,u,i),x=y[n][l];if(c===!1){let Y=Wp(x),Q=Ih;return i&&(Q=qp({popperSize:t,arrowSize:i,arrowOffset:r,side:n,align:l})),{popperStyles:W(C({},Y),{"--radix-popper-transform-origin":Hp(t,n,l,r,i)}),arrowStyles:Q,placedSide:n,placedAlign:l}}let E=DOMRect.fromRect(C(C({},t),x)),S=(k=d,T=p,DOMRect.fromRect({width:k.width-2*T,height:k.height-2*T,x:k.left+T,y:k.top+T}));var k,T;let R=Vp(E,S),A=y[Qp(n)][l],$=function(Y,Q,he){let G=Qp(Y);return Q[Y]&&!he[G]?G:Y}(n,R,Vp(DOMRect.fromRect(C(C({},t),A)),S)),z=function(Y,Q,he,G,ue){let ce=he==="top"||he==="bottom",be=ce?"left":"top",re=ce?"right":"bottom",Te=ce?"width":"height",Oe=Q[Te]>Y[Te];return(G==="start"||G==="center")&&(ue[be]&&Oe||ue[re]&&!Oe)?"end":(G==="end"||G==="center")&&(ue[re]&&Oe||ue[be]&&!Oe)?"start":G}(t,e,n,l,R),B=Wp(y[$][z]),H=Ih;return i&&(H=qp({popperSize:t,arrowSize:i,arrowOffset:r,side:$,align:z})),{popperStyles:W(C({},B),{"--radix-popper-transform-origin":Hp(t,$,z,r,i)}),arrowStyles:H,placedSide:$,placedAlign:z}}function Dp(e,t,i){let r=e[i==="x"?"left":"top"],n=i==="x"?"width":"height",a=e[n],l=t[n];return{before:r-l,start:r,center:r+(a-l)/2,end:r+a-l,after:r+a}}function Wp(e){return{position:"absolute",top:0,left:0,minWidth:"max-content",willChange:"transform",transform:`translate3d(${Math.round(e.x+window.scrollX)}px, ${Math.round(e.y+window.scrollY)}px, 0)`}}function Hp(e,t,i,r,n){let a=t==="top"||t==="bottom",l=n?n.width:0,u=n?n.height:0,c=l/2+r,d="",p="";return a?(d={start:`${c}px`,center:"center",end:e.width-c+"px"}[i],p=t==="top"?`${e.height+u}px`:-u+"px"):(d=t==="left"?`${e.width+u}px`:-u+"px",p={start:`${c}px`,center:"center",end:e.height-c+"px"}[i]),`${d} ${p}`}var T_={position:"fixed",top:0,left:0,opacity:0,transform:"translate3d(0, -200%, 0)"},Ih={position:"absolute",opacity:0};function qp({popperSize:e,arrowSize:t,arrowOffset:i,side:r,align:n}){let a=(e.width-t.width)/2,l=(e.height-t.width)/2,u={top:0,right:90,bottom:180,left:-90}[r],c=Math.max(t.width,t.height),d={width:`${c}px`,height:`${c}px`,transform:`rotate(${u}deg)`,willChange:"transform",position:"absolute",[r]:"100%",direction:I_(r,n)};return r!=="top"&&r!=="bottom"||(n==="start"&&(d.left=`${i}px`),n==="center"&&(d.left=`${a}px`),n==="end"&&(d.right=`${i}px`)),r!=="left"&&r!=="right"||(n==="start"&&(d.top=`${i}px`),n==="center"&&(d.top=`${l}px`),n==="end"&&(d.bottom=`${i}px`)),d}function I_(e,t){return(e!=="top"&&e!=="right"||t!=="end")&&(e!=="bottom"&&e!=="left"||t==="end")?"ltr":"rtl"}function Qp(e){return{top:"bottom",right:"left",bottom:"top",left:"right"}[e]}function Vp(e,t){return{top:e.top<t.top,right:e.right>t.right,bottom:e.bottom>t.bottom,left:e.left<t.left}}var[Gp,Zp]=Up("Popper"),[R_,Yp]=Gp("Popper"),O_=e=>{let{__scopePopper:t,children:i}=e,[r,n]=je(null);return N(R_,{scope:t,anchor:r,onAnchorChange:n},i)},M_=ci((e,t)=>{let i=e,{__scopePopper:r,virtualRef:n}=i,a=le(i,["__scopePopper","virtualRef"]),l=Yp("PopperAnchor",r),u=xe(null),c=To(t,u);return fe(()=>{l.onAnchorChange((n==null?void 0:n.current)||u.current)}),n?null:N($s.div,xi({},a,{ref:c}))}),[L_,$_]=Gp("PopperContent"),N_=ci((e,t)=>{let i=e,{__scopePopper:r,side:n="bottom",sideOffset:a,align:l="center",alignOffset:u,collisionTolerance:c,avoidCollisions:d=!0}=i,p=le(i,["__scopePopper","side","sideOffset","align","alignOffset","collisionTolerance","avoidCollisions"]),y=Yp("PopperContent",r),[x,E]=je(),S=jp(y.anchor),[k,T]=je(null),R=Fp(k),[A,$]=je(null),z=Fp(A),B=To(t,be=>T(be)),H=function(){let[be,re]=je(void 0);return fe(()=>{let Te;function Oe(){re({width:window.innerWidth,height:window.innerHeight})}function qe(){window.clearTimeout(Te),Te=window.setTimeout(Oe,100)}return Oe(),window.addEventListener("resize",qe),()=>window.removeEventListener("resize",qe)},[]),be}(),Y=H?DOMRect.fromRect(W(C({},H),{x:0,y:0})):void 0,{popperStyles:Q,arrowStyles:he,placedSide:G,placedAlign:ue}=C_({anchorRect:S,popperSize:R,arrowSize:z,arrowOffset:x,side:n,sideOffset:a,align:l,alignOffset:u,shouldAvoidCollisions:d,collisionBoundariesRect:Y,collisionTolerance:c}),ce=G!==void 0;return N("div",{style:Q,"data-radix-popper-content-wrapper":""},N(L_,{scope:r,arrowStyles:he,onArrowChange:$,onArrowOffsetChange:E},N($s.div,xi({"data-side":G,"data-align":ue},p,{style:W(C({},p.style),{animation:ce?void 0:"none"}),ref:B}))))}),z_=ci(function(e,t){let i=e,{__scopePopper:r,offset:n}=i,a=le(i,["__scopePopper","offset"]),l=$_("PopperArrow",r),{onArrowOffsetChange:u}=l;return fe(()=>u(n),[u,n]),N("span",{style:W(C({},l.arrowStyles),{pointerEvents:"none"})},N("span",{ref:l.onArrowChange,style:{display:"inline-block",verticalAlign:"top",pointerEvents:"auto"}},N(A_,xi({},a,{ref:t,style:W(C({},a.style),{display:"block"})}))))}),F_=O_,B_=M_,j_=N_,U_=z_,Xp=e=>{let{present:t,children:i}=e,r=function(l){let[u,c]=je(),d=xe({}),p=xe(l),y=xe("none"),x=l?"mounted":"unmounted",[E,S]=function(k,T){return As((R,A)=>{let $=T[R][A];return $??R},k)}(x,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return fe(()=>{let k=zo(d.current);y.current=E==="mounted"?k:"none"},[E]),Io(()=>{let k=d.current,T=p.current;if(T!==l){let R=y.current,A=zo(k);l?S("MOUNT"):A==="none"||(k==null?void 0:k.display)==="none"?S("UNMOUNT"):S(T&&R!==A?"ANIMATION_OUT":"UNMOUNT"),p.current=l}},[l,S]),Io(()=>{if(u){let k=R=>{let A=zo(d.current).includes(R.animationName);R.target===u&&A&&S("ANIMATION_END")},T=R=>{R.target===u&&(y.current=zo(d.current))};return u.addEventListener("animationstart",T),u.addEventListener("animationcancel",k),u.addEventListener("animationend",k),()=>{u.removeEventListener("animationstart",T),u.removeEventListener("animationcancel",k),u.removeEventListener("animationend",k)}}},[u,S]),{isPresent:["mounted","unmountSuspended"].includes(E),ref:Qe(k=>{k&&(d.current=getComputedStyle(k)),c(k)},[])}}(t),n=typeof i=="function"?i({present:r.isPresent}):nn.only(i),a=To(r.ref,n.ref);return typeof i=="function"||r.isPresent?Ao(n,{ref:a}):null};function zo(e){return(e==null?void 0:e.animationName)||"none"}Xp.displayName="Presence";function Kp(e){let t=xe(e);return fe(()=>{t.current=e},[e]),t.current}function Rh(e){let t=xe(e);return fe(()=>{t.current=e}),Ae(()=>(...i)=>{var r;return(r=t.current)===null||r===void 0?void 0:r.call(t,...i)},[])}function D_(e){let t=Rh(e);fe(()=>{let i=r=>{r.key==="Escape"&&t(r)};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[t])}function W_({prop:e,defaultProp:t,onChange:i=()=>{}}){let[r,n]=function({defaultProp:c,onChange:d}){let p=je(c),[y]=p,x=xe(y),E=Rh(d);return fe(()=>{x.current!==y&&(E(y),x.current=y)},[y,x,E]),p}({defaultProp:t,onChange:i}),a=e!==void 0,l=a?e:r,u=Rh(i);return[l,Qe(c=>{if(a){let d=c,p=typeof c=="function"?d(e):c;p!==e&&u(p)}else n(c)},[a,e,n,u])]}function Ns(e,t,{checkForDefaultPrevented:i=!0}={}){return function(r){if(e==null||e(r),i===!1||!r.defaultPrevented)return t==null?void 0:t(r)}}var[Jp,BM]=Up("Tooltip",[Zp]),Fo=Zp(),H_=700,[jM,q_]=Jp("TooltipProvider",{isOpenDelayed:!0,delayDuration:H_,onOpen:()=>{},onClose:()=>{}}),[Q_,Bo]=Jp("Tooltip"),V_=e=>{let{__scopeTooltip:t,children:i,open:r,defaultOpen:n=!1,onOpenChange:a,delayDuration:l}=e,u=q_("Tooltip",t),c=Fo(t),[d,p]=je(null),y=b_(),x=xe(0),E=l??u.delayDuration,S=xe(!1),{onOpen:k,onClose:T}=u,[R=!1,A]=W_({prop:r,defaultProp:n,onChange:H=>{H&&(document.dispatchEvent(new CustomEvent("tooltip.open")),k()),a==null||a(H)}}),$=Ae(()=>R?S.current?"delayed-open":"instant-open":"closed",[R]),z=Qe(()=>{window.clearTimeout(x.current),S.current=!1,A(!0)},[A]),B=Qe(()=>{window.clearTimeout(x.current),x.current=window.setTimeout(()=>{S.current=!0,A(!0)},E)},[E,A]);return fe(()=>()=>window.clearTimeout(x.current),[]),N(F_,c,N(Q_,{scope:t,contentId:y,open:R,stateAttribute:$,trigger:d,onTriggerChange:p,onTriggerEnter:Qe(()=>{u.isOpenDelayed?B():z()},[u.isOpenDelayed,B,z]),onOpen:Qe(z,[z]),onClose:Qe(()=>{window.clearTimeout(x.current),A(!1),T()},[A,T])},i))},G_=ci((e,t)=>{let i=e,{__scopeTooltip:r}=i,n=le(i,["__scopeTooltip"]),a=Bo("TooltipTrigger",r),l=Fo(r),u=To(t,a.onTriggerChange),c=xe(!1),d=Qe(()=>c.current=!1,[]);return fe(()=>()=>document.removeEventListener("mouseup",d),[d]),N(B_,xi({asChild:!0},l),N($s.button,xi({"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute},n,{ref:u,onMouseEnter:Ns(e.onMouseEnter,a.onTriggerEnter),onMouseLeave:Ns(e.onMouseLeave,a.onClose),onMouseDown:Ns(e.onMouseDown,()=>{a.onClose(),c.current=!0,document.addEventListener("mouseup",d,{once:!0})}),onFocus:Ns(e.onFocus,()=>{c.current||a.onOpen()}),onBlur:Ns(e.onBlur,a.onClose),onClick:Ns(e.onClick,a.onClose)})))}),Z_=ci((e,t)=>{let i=e,{forceMount:r}=i,n=le(i,["forceMount"]),a=Bo("TooltipContent",e.__scopeTooltip);return N(Xp,{present:r||a.open},N(Y_,xi({ref:t},n)))}),Y_=ci((e,t)=>{let i=e,{__scopeTooltip:r,children:n,"aria-label":a,portalled:l=!0}=i,u=le(i,["__scopeTooltip","children","aria-label","portalled"]),c=Bo("TooltipContent",r),d=Fo(r),p=l?S_:rt,{onClose:y}=c;return D_(()=>y()),fe(()=>(document.addEventListener("tooltip.open",y),()=>document.removeEventListener("tooltip.open",y)),[y]),N(p,null,N(K_,{__scopeTooltip:r}),N(j_,xi({"data-state":c.stateAttribute},d,u,{ref:t,style:W(C({},u.style),{"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)"})}),N(ap,null,n),N(__,{id:c.contentId,role:"tooltip"},a||n)))}),X_=ci((e,t)=>{let i=e,{__scopeTooltip:r}=i,n=le(i,["__scopeTooltip"]),a=Fo(r);return N(U_,xi({},a,n,{ref:t}))});function K_(e){let{__scopeTooltip:t}=e,i=Bo("CheckTriggerMoved",t),r=jp(i.trigger),n=r==null?void 0:r.left,a=Kp(n),l=r==null?void 0:r.top,u=Kp(l),c=i.onClose;return fe(()=>{(a!==void 0&&a!==n||u!==void 0&&u!==l)&&c()},[c,a,u,n,l]),null}var J_=V_,eS=G_,tS=Z_,iS=X_;function rS(e,t){if(e==null)return{};var i={},r=Object.keys(e),n,a;for(a=0;a<r.length;a++)n=r[a],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}function Ur(e,t){if(e==null)return{};var i=rS(e,t),r,n;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],!(t.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(i[r]=e[r]))}return i}var Mi;(function(e){e[e.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",e[e.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",e[e.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",e[e.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",e[e.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",e[e.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",e[e.THEME_ERROR=6]="THEME_ERROR",e[e.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",e[e.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",e[e.EMPTY_KEY=9]="EMPTY_KEY"})(Mi||(Mi={}));var nS={[Mi.UNSUPPORTED_INPUT]:(e,t)=>[`An input with type \`${e}\` input was found at path \`${t}\` but it's not supported yet.`],[Mi.NO_COMPONENT_FOR_TYPE]:(e,t)=>[`Type \`${e}\` found at path \`${t}\` can't be displayed in panel because no component supports it yet.`],[Mi.UNKNOWN_INPUT]:(e,t)=>[`input at path \`${e}\` is not recognized.`,t],[Mi.DUPLICATE_KEYS]:(e,t,i)=>[`Key \`${e}\` of path \`${t}\` already exists at path \`${i}\`. Even nested keys need to be unique. Rename one of the keys.`],[Mi.ALREADY_REGISTERED_TYPE]:e=>[`Type ${e} has already been registered. You can't register a component with the same type.`],[Mi.CLIPBOARD_ERROR]:e=>["Error copying the value",e],[Mi.THEME_ERROR]:(e,t)=>[`Error accessing the theme \`${e}.${t}\` value.`],[Mi.PATH_DOESNT_EXIST]:e=>[`Error getting the value at path \`${e}\`. There is probably an error in your \`render\` function.`],[Mi.PATH_DOESNT_EXIST]:e=>[`Error accessing the value at path \`${e}\``],[Mi.INPUT_TYPE_OVERRIDE]:(e,t,i)=>[`Input at path \`${e}\` already exists with type: \`${t}\`. Its type cannot be overridden with type \`${i}\`.`],[Mi.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function eg(e,t,...i){let[r,...n]=nS[t](...i);console[e]("LEVA: "+r,...n)}var tg=eg.bind(null,"warn");eg.bind(null,"log");function sS(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ig(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function Un(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?ig(Object(i),!0).forEach(function(r){sS(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ig(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}var on=(e,t,i)=>e>i?i:e<t?t:e,aS=e=>{if(e===""||typeof e=="number")return e;try{let t=ln(e);if(!isNaN(t))return t}catch{}return parseFloat(e)},oS=Math.log(10);function rg(e){let t=Math.abs(+String(e).replace(".",""));if(t===0)return .01;for(;t!==0&&t%10===0;)t/=10;let i=Math.floor(Math.log(t)/oS)+1,r=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,r-i);return Math.max(n,.001)}var lS=(e,t,i)=>i===t?0:(on(e,t,i)-t)/(i-t),ng=(e,t,i)=>e*(i-t)+t,sg=/\(([0-9+\-*/^ .]+)\)/,ag=/(\d+(?:\.\d+)?) ?\^ ?(\d+(?:\.\d+)?)/,og=/(\d+(?:\.\d+)?) ?\* ?(\d+(?:\.\d+)?)/,lg=/(\d+(?:\.\d+)?) ?\/ ?(\d+(?:\.\d+)?)/,ug=/(\d+(?:\.\d+)?) ?\+ ?(\d+(?:\.\d+)?)/,hg=/(\d+(?:\.\d+)?) ?- ?(\d+(?:\.\d+)?)/;function ln(e){if(isNaN(Number(e)))if(sg.test(e)){let t=e.replace(sg,(i,r)=>String(ln(r)));return ln(t)}else if(ag.test(e)){let t=e.replace(ag,(i,r,n)=>String(Math.pow(Number(r),Number(n))));return ln(t)}else if(og.test(e)){let t=e.replace(og,(i,r,n)=>String(Number(r)*Number(n)));return ln(t)}else if(lg.test(e)){let t=e.replace(lg,(i,r,n)=>{if(n!=0)return String(Number(r)/Number(n));throw new Error("Division by zero")});return ln(t)}else if(ug.test(e)){let t=e.replace(ug,(i,r,n)=>String(Number(r)+Number(n)));return ln(t)}else if(hg.test(e)){let t=e.replace(hg,(i,r,n)=>String(Number(r)-Number(n)));return ln(t)}else return Number(e);return Number(e)}var cg;(function(e){e.BUTTON="BUTTON",e.BUTTON_GROUP="BUTTON_GROUP",e.MONITOR="MONITOR",e.FOLDER="FOLDER"})(cg||(cg={}));var dg;(function(e){e.SELECT="SELECT",e.IMAGE="IMAGE",e.NUMBER="NUMBER",e.COLOR="COLOR",e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.INTERVAL="INTERVAL",e.VECTOR3D="VECTOR3D",e.VECTOR2D="VECTOR2D"})(dg||(dg={}));var uS=e=>e.shiftKey?5:e.altKey?1/5:1,hS=["value"],cS=["min","max"],dS=e=>{if(typeof e=="number")return!0;if(typeof e=="string"){let t=parseFloat(e);return isNaN(t)?!1:e.substring((""+t).length).trim().length<4}return!1},fS=(e,{min:t=-1/0,max:i=1/0,suffix:r})=>{let n=parseFloat(e);if(e===""||isNaN(n))throw Error("Invalid number");let a=on(n,t,i);return r?a+r:a},pS=(e,{pad:t=0,suffix:i})=>{let r=parseFloat(e).toFixed(t);return i?r+i:r},gS=e=>{let{value:t}=e,i=Ur(e,hS),{min:r=-1/0,max:n=1/0}=i,a=Ur(i,cS),l=parseFloat(t),u=typeof t=="string"?t.substring((""+l).length):void 0;l=on(l,r,n);let c=i.step;c||(Number.isFinite(r)?Number.isFinite(n)?c=+(Math.abs(n-r)/100).toPrecision(1):c=+(Math.abs(l-r)/100).toPrecision(1):Number.isFinite(n)&&(c=+(Math.abs(n-l)/100).toPrecision(1)));let d=c?rg(c)*10:rg(l);c=c||d/10;let p=Math.round(on(Math.log10(1/d),0,2));return{value:u?l+u:l,settings:Un({initialValue:l,step:c,pad:p,min:r,max:n,suffix:u},a)}},fg=(e,{step:t,initialValue:i})=>{let r=Math.round((e-i)/t);return i+r*t},mS=Object.freeze({__proto__:null,schema:dS,sanitize:fS,format:pS,normalize:gS,sanitizeStep:fg});function Vi(){return Vi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Vi.apply(this,arguments)}var yS=ri({});function Dr(){return Yt(yS)}var vS=ri(null);ri(null);var bS=ri(null);function wS(){return Yt(bS)}var xS=()=>({colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}});function jo(e,t){let[i,r]=e.split(" "),n={};return i!=="none"&&(n.boxShadow=`${t.inset?"inset ":""}0 0 0 $borderWidths${[t.key]} $colors${i!=="default"&&i||t.borderColor}`),r&&(n.backgroundColor=r),n}var Aa={$inputStyle:()=>e=>jo(e,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>e=>jo(e,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>e=>jo(e,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>e=>jo(e,{key:"$active",borderColor:"$accent1",inset:!0})},{styled:mt,css:UM,createTheme:DM,globalCss:_S,keyframes:WM}=S1({prefix:"leva",theme:xS(),utils:Un(Un({},Aa),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:e=>({"&:focus":Aa.$focusStyle()(e)}),$focusWithin:e=>({"&:focus-within":Aa.$focusStyle()(e)}),$hover:e=>({"&:hover":Aa.$hoverStyle()(e)}),$active:e=>({"&:active":Aa.$activeStyle()(e)})})});_S({".leva__panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});function SS(e,t){let{theme:i}=Yt(vS);if(!(e in i)||!(t in i[e]))return tg(Mi.THEME_ERROR,e,t),"";let r=t;for(;;){let n=i[e][r];if(typeof n=="string"&&n.charAt(0)==="$")r=n.substr(1);else return n}}var pg=mt("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}},as:{textarea:{padding:"$sm"}}}}),gg=mt("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${pg}`]:{paddingLeft:0}}),ES=mt(gg,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),AS=mt("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:"",variants:{textArea:{true:{height:"auto"}}}}),kS=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id","inputType","rows"],PS=["onUpdate"];function mg(e){let{innerLabel:t,value:i,onUpdate:r,onChange:n,onKeyDown:a,type:l,id:u,inputType:c="text",rows:d=0}=e,p=Ur(e,kS),{id:y,emitOnEditStart:x,emitOnEditEnd:E,disabled:S}=Dr(),k=u||y,T=xe(null),R=d>0,A=R?"textarea":"input",$=Qe(H=>Y=>{let Q=Y.currentTarget.value;H(Q)},[]);te.useEffect(()=>{let H=T.current,Y=$(Q=>{r(Q),E()});return H==null||H.addEventListener("blur",Y),()=>H==null?void 0:H.removeEventListener("blur",Y)},[$,r,E]);let z=Qe(H=>{H.key==="Enter"&&$(r)(H)},[$,r]),B=Object.assign({as:A},R?{rows:d}:{},p);return te.createElement(AS,{textArea:R},t&&typeof t=="string"?te.createElement(gg,null,t):t,te.createElement(pg,Vi({levaType:l,ref:T,id:k,type:c,autoComplete:"off",spellCheck:"false",value:i,onChange:$(n),onFocus:()=>x(),onKeyPress:z,onKeyDown:a,disabled:S},B)))}function CS(e){let{onUpdate:t}=e,i=Ur(e,PS),r=Qe(a=>t(aS(a)),[t]),n=Qe(a=>{let l=a.key==="ArrowUp"?1:a.key==="ArrowDown"?-1:0;if(l){a.preventDefault();let u=a.altKey?.1:a.shiftKey?10:1;t(c=>parseFloat(c)+l*u)}},[t]);return te.createElement(mg,Vi({},i,{onUpdate:r,onKeyDown:n,type:"number"}))}var Oh=mt("div",{}),yg=mt("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]});mt("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${yg}::after`]:{opacity:.6},[`${Oh}:hover > & + ${yg}::after`]:{opacity:.6},[`${Oh}:hover > & > svg`]:{opacity:1}});var TS=mt("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${Oh}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),vg=mt("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${TS} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},variants:{disabled:{true:{pointerEvents:"none"},false:{"&:hover,&:focus-within":{color:"$highlight3"}}}}}),IS=mt(vg,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),RS=mt("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),OS=mt("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),Mh=mt("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}});mt("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none",[`& ${Mh}`]:{pointerEvents:"auto"}}}}}),mt("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"});var MS=mt("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),LS=mt(iS,{fill:"$toolTipBackground"}),$S=["align"];function NS(){let{id:e,disable:t,disabled:i}=Dr();return te.createElement(te.Fragment,null,te.createElement(OS,{id:e+"__disable",type:"checkbox",checked:!i,onChange:()=>t(!i)}),te.createElement("label",{htmlFor:e+"__disable"}))}function zS(e){let{id:t,optional:i,hint:r}=Dr(),n=e.htmlFor||(t?{htmlFor:t}:null),a=!r&&typeof e.children=="string"?{title:e.children}:null;return te.createElement(te.Fragment,null,i&&te.createElement(NS,null),r!==void 0?te.createElement(J_,null,te.createElement(eS,{asChild:!0},te.createElement(Mh,Vi({},n,e))),te.createElement(tS,{side:"top",sideOffset:2},te.createElement(MS,null,r,te.createElement(LS,null)))):te.createElement(Mh,Vi({},n,a,e)))}function Uo(e){let{align:t}=e,i=Ur(e,$S),{value:r,label:n,key:a,disabled:l}=Dr(),{hideCopyButton:u}=wS(),c=!u&&a!==void 0,[d,p]=je(!1),y=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[a]:r??""})),p(!0)}catch{tg(Mi.CLIPBOARD_ERROR,{[a]:r})}};return te.createElement(RS,{align:t,onPointerLeave:()=>p(!1)},te.createElement(zS,i),c&&!l&&te.createElement("div",{title:`Click to copy ${typeof n=="string"?n:a} value`},d?te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},te.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),te.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})):te.createElement("svg",{onClick:y,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},te.createElement("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),te.createElement("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"}))))}var FS=["toggled"],BS=mt("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function jS(e){let{toggled:t}=e,i=Ur(e,FS);return te.createElement(BS,Vi({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${t?0:-90}deg)`}},i),te.createElement("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"}))}var US=["input"];function Do(e){let{input:t}=e,i=Ur(e,US);return t?te.createElement(IS,i):te.createElement(vg,i)}function bg(e,t){let{emitOnEditStart:i,emitOnEditEnd:r}=Dr();return m_(n=>{n.first&&(document.body.classList.add("leva__panel__dragged"),i==null||i());let a=e(n);return n.last&&(document.body.classList.remove("leva__panel__dragged"),r==null||r()),a})}var DS=mt("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),WS=mt("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),HS=mt("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),qS=mt("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),QS=mt("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function VS({value:e,min:t,max:i,onDrag:r,step:n,initialValue:a}){let l=xe(null),u=xe(null),c=xe(0),d=SS("sizes","scrubberWidth"),p=bg(({event:x,first:E,xy:[S],movement:[k],memo:T})=>{if(E){let{width:A,left:$}=l.current.getBoundingClientRect();c.current=A-parseFloat(d),T=(x==null?void 0:x.target)===u.current?e:ng((S-$)/A,t,i)}let R=T+ng(k/c.current,0,i-t);return r(fg(R,{step:n,initialValue:a})),T}),y=lS(e,t,i);return te.createElement(qS,Vi({ref:l},p()),te.createElement(WS,null,te.createElement(QS,{style:{left:0,right:`${(1-y)*100}%`}})),te.createElement(HS,{ref:u,style:{left:`calc(${y} * (100% - ${d}))`}}))}var GS=te.memo(({label:e,onUpdate:t,step:i,innerLabelTrim:r})=>{let[n,a]=je(!1),l=bg(({active:u,delta:[c],event:d,memo:p=0})=>(a(u),p+=c/2,Math.abs(p)>=1&&(t(y=>parseFloat(y)+Math.floor(p)*i*uS(d)),p=0),p));return te.createElement(ES,Vi({dragging:n,title:e.length>1?e:""},l()),e.slice(0,r))});function ZS({label:e,id:t,displayValue:i,onUpdate:r,onChange:n,settings:a,innerLabelTrim:l=1}){let u=l>0&&te.createElement(GS,{label:e,step:a.step,onUpdate:r,innerLabelTrim:l});return te.createElement(CS,{id:t,value:String(i),onUpdate:r,onChange:n,innerLabel:u})}function YS(){let e=Dr(),{label:t,value:i,onUpdate:r,settings:n,id:a}=e,{min:l,max:u}=n,c=u!==1/0&&l!==-1/0;return te.createElement(Do,{input:!0},te.createElement(Uo,null,t),te.createElement(DS,{hasRange:c},c&&te.createElement(VS,Vi({value:parseFloat(i),onDrag:r},n)),te.createElement(ZS,Vi({},e,{id:a,label:"value",innerLabelTrim:c?0:1}))))}var XS=Ur(mS,["sanitizeStep"]);Un({component:YS},XS);var KS=(e,t)=>an().schema({options:an().passesAnyOf(an().object(),an().array())}).test(t),JS=(e,{values:t})=>{if(t.indexOf(e)<0)throw Error("Selected value doesn't match Select options");return e},eE=(e,{values:t})=>t.indexOf(e),tE=e=>{let{value:t,options:i}=e,r,n;return Array.isArray(i)?(n=i,r=i.map(a=>String(a))):(n=Object.values(i),r=Object.keys(i)),"value"in e?n.includes(t)||(r.unshift(String(t)),n.unshift(t)):t=n[0],Object.values(i).includes(t)||(i[String(t)]=t),{value:t,settings:{keys:r,values:n}}},iE=Object.freeze({__proto__:null,schema:KS,sanitize:JS,format:eE,normalize:tE}),rE=mt("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),Lh=mt("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),nE=mt("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${Lh}:focus + &`]:{$focusStyle:""},[`${Lh}:hover + &`]:{$hoverStyle:""}});function sE({displayValue:e,value:t,onUpdate:i,id:r,settings:n,disabled:a}){let{keys:l,values:u}=n,c=xe();return t===u[e]&&(c.current=l[e]),te.createElement(rE,null,te.createElement(Lh,{id:r,value:e,onChange:d=>i(u[Number(d.currentTarget.value)]),disabled:a},l.map((d,p)=>te.createElement("option",{key:d,value:p},d))),te.createElement(nE,null,c.current),te.createElement(jS,{toggled:!0}))}function aE(){let{label:e,value:t,displayValue:i,onUpdate:r,id:n,disabled:a,settings:l}=Dr();return te.createElement(Do,{input:!0},te.createElement(Uo,null,e),te.createElement(sE,{id:n,value:t,displayValue:i,onUpdate:r,settings:l,disabled:a}))}Un({component:aE},iE);var oE=e=>an().string().test(e),lE=e=>{if(typeof e!="string")throw Error("Invalid string");return e},uE=({value:e,editable:t=!0,rows:i=!1})=>({value:e,settings:{editable:t,rows:typeof i=="number"?i:i?5:0}}),hE=Object.freeze({__proto__:null,schema:oE,sanitize:lE,normalize:uE}),cE=["displayValue","onUpdate","onChange","editable"],dE=mt("div",{whiteSpace:"pre-wrap"});function fE(e){let{displayValue:t,onUpdate:i,onChange:r,editable:n=!0}=e,a=Ur(e,cE);return n?te.createElement(mg,Vi({value:t,onUpdate:i,onChange:r},a)):te.createElement(dE,null,t)}function pE(){let{label:e,settings:t,displayValue:i,onUpdate:r,onChange:n}=Dr();return te.createElement(Do,{input:!0},te.createElement(Uo,null,e),te.createElement(fE,Vi({displayValue:i,onUpdate:r,onChange:n},t)))}Un({component:pE},hE);var gE=e=>an().boolean().test(e),mE=e=>{if(typeof e!="boolean")throw Error("Invalid boolean");return e},yE=Object.freeze({__proto__:null,schema:gE,sanitize:mE}),vE=mt("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function bE({value:e,onUpdate:t,id:i,disabled:r}){return te.createElement(vE,null,te.createElement("input",{id:i,type:"checkbox",checked:e,onChange:n=>t(n.currentTarget.checked),disabled:r}),te.createElement("label",{htmlFor:i},te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},te.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}))))}function wE(){let{label:e,value:t,onUpdate:i,disabled:r,id:n}=Dr();return te.createElement(Do,{input:!0},te.createElement(Uo,null,e),te.createElement(bE,{value:t,onUpdate:i,id:n,disabled:r}))}Un({component:wE},yE),mt("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});var wg=class extends _r{constructor(e){super(),this.type="spacial-content",this.style={opacity:1},this.format="jpg",this.tileUrl=Hx(e.url),this.id=e.id||`${this.tileUrl}--${e.scaleFactor}`,this.points=e.displayPoints?e.displayPoints:zn(e.points,Nn(e.scaleFactor)),this.tileWidth=e.tileWidth,this.display={x:0,y:0,width:e.width/e.scaleFactor,height:e.height/e.scaleFactor,points:e.points,scale:e.scaleFactor},e.format&&(this.format=e.format)}applyProps(e){if(e.style&&typeof e.style.opacity<"u"&&(this.style.opacity=e.style.opacity),e.service!==this.service&&(this.service=e.service),e.format?this.format=e.format:this.format="jpg",e.crop){this.cropData=e.crop;let t=Ne([...this.points]),i=t.length/5,r=e.crop.x||0,n=e.crop.y||0,a=e.crop.x+e.crop.width,l=e.crop.y+e.crop.height;for(let u=0;u<i;u++){let c=u*5;t[c+1]<a&&t[c+3]>r&&t[c+2]<l&&t[c+4]>n?(t[c+1]=on(t[c+1],r,a),t[c+3]=on(t[c+3],r,a),t[c+2]=on(t[c+2],n,l),t[c+4]=on(t[c+4],n,l)):t[c]=0}xr(t,Qi(-e.crop.x,-e.crop.y)),this.crop?this.crop.set(t):this.crop=t}}static fromTile(e,t,i,r,n,a){i.height=i.height?i.height:i.width;let l=Math.ceil(t.width/r),u=Math.ceil(t.height/r),c=Math.ceil(l/i.width),d=Math.ceil(u/i.height),p=ut.grid(c,d),y=ut.grid(c,d);for(let E=0;E<d;E++)for(let S=0;S<c;S++){let k=S*i.width,T=E*i.height;y.addPoints(k*r,T*r,S===c-1?t.width:(k+i.width)*r,E===d-1?t.height:(T+i.height)*r),p.addPoints(k,T,S===c-1?l:k+i.width,E===d-1?u:T+i.height)}let x=new wg({url:e,scaleFactor:r,points:p.build(),displayPoints:y.build(),width:t.width,height:t.height,tileWidth:i.width,format:a});return x.applyProps({service:n}),x}getImageUrl(e){let t=this.points.slice(e*5,e*5+5),i=t[3]-t[1],r=t[4]-t[2],n=Math.ceil(i/this.display.scale);return`${this.tileUrl}/${t[1]},${t[2]},${i},${r}/${n>this.tileWidth?this.tileWidth:n},/0/default.${this.format||"jpg"}`}getAllPointsAt(e,t,i){let r=va(this.crop||this.points,e);return[[this,r,t]]}transform(e){xr(this.points,e)}getScheduledUpdates(e,t){return[]}},xE=class extends _r{constructor(){super(...arguments),this.type="spacial-content"}getAllPointsAt(e,t,i){return[[this,this.points,t]]}},_E=class extends xE{constructor(e){super(),this.images=[],this.allImages=[],this.scaleFactors=[],this.aggregateBuffer=Ne(9),this.isFullyLoaded=!1,this.maxScaleFactor=0,this._scheduleSortByScales=!1,this._sortByScales=()=>{this._scheduleSortByScales=!1,this.allImages.sort((i,r)=>r.display.width-i.display.width),this.images=[];let t=.1;for(let i of this.allImages)if(!(i.display.width<this.renderOptions.minSize&&i.display.height<this.renderOptions.minSize&&!i.priority||i instanceof ba&&(i.display.width>this.renderOptions.maxImageSize||i.display.height>this.renderOptions.maxImageSize)&&!i.priority)){if(Math.abs(i.display.scale-t)<.25||i.priority){let r=this.images.pop();r&&(r instanceof ba||r.priority)?(i.priority&&this.images.push(i),this.images.push(r)):i&&this.images.push(i)}else i&&this.images.push(i);t=i.display.scale}this.images.length===0&&(this.images=[...this.allImages]),this.scaleFactors=this.images.map(i=>i.display.scale),this.maxScaleFactor=Math.max(...this.scaleFactors)},this.loadFullResource=async()=>{if(!this.isFullyLoaded&&this.lazyLoader){this.isFullyLoaded=!0;let t=await this.lazyLoader();this.addImages(t)}},this.fallback=[this.loadFullResource],this.id=e.id,this.points=ut.singleBox(e.width,e.height),this.lazyLoader=e.loadFullImages,e.loadFullImages||(this.isFullyLoaded=!0),this.display={x:0,y:0,points:ut.singleBox(e.width,e.height),height:e.height,width:e.width,scale:1},this.renderOptions=C({renderSmallestFallback:!0,renderLayers:2,minSize:255,maxImageSize:1024,quality:1.75},e.renderOptions||{}),this.addImages(e.images)}applyProps(e){typeof e.renderSmallestFallback<"u"&&e.renderSmallestFallback!==this.renderOptions.renderSmallestFallback&&(this.renderOptions.renderSmallestFallback=e.renderSmallestFallback),typeof e.renderLayers<"u"&&e.renderLayers!==this.renderOptions.renderLayers&&(this.renderOptions.renderLayers=e.renderLayers),typeof e.minSize<"u"&&e.minSize!==this.renderOptions.minSize&&(this.renderOptions.minSize=e.minSize),typeof e.maxImageSize<"u"&&e.maxImageSize!==this.renderOptions.maxImageSize&&(this.renderOptions.maxImageSize=e.maxImageSize),typeof e.quality<"u"&&e.quality!==this.renderOptions.quality&&(this.renderOptions.quality=e.quality)}appendChild(e){this.addImages([e])}removeChild(e){this.images.indexOf(e)!==-1&&(this.images=this.images.filter(t=>t!==e),this.sortByScales())}insertBefore(e,t){this.addImages([e])}hideInstance(){}addImages(e){for(let t of e)t.__parent=this,t.__owner=this.__owner;this.allImages.push(...e.filter(Boolean)),this.sortByScales()}sortByScales(){this._scheduleSortByScales=!0}getScheduledUpdates(e,t){return this._scheduleSortByScales?[this._sortByScales]:this.isFullyLoaded?[]:t>1/this.maxScaleFactor?this.fallback:[]}getAllPointsAt(e,t,i){if(this.images.length===0)return[];let r=Wx(1/(i||1)/(window.devicePixelRatio||1),this.images,this.renderOptions.quality),n=this.images.length,a=t?sn(t,Qi(this.x,this.y)):Qi(this.x,this.y);if(r!==this.images.length-1&&this.images[r+1]){let l=[];for(let d=n-1;d>=r;d--)l.push(d);let u=l[0];this.renderOptions.renderLayers&&(l=l.slice(-Math.min(l.length,this.renderOptions.renderLayers))),this.renderOptions.renderSmallestFallback&&l.indexOf(u)===-1&&l.unshift(u);let c=[];for(let d=0;d<l.length;d++)c.push(...this.images[l[d]].getAllPointsAt(e,a,i));return c}return this.images[r].getAllPointsAt(e,a,i)}};function Wo(e,t,i,r,n){let a=Math.PI/180*n,l=Math.cos(a),u=Math.sin(a),c=l*(i-e)+u*(r-t)+e,d=l*(r-t)-u*(i-e)+t;return[c,d]}var Ho=class extends _r{constructor(e,t){super(),this.type="world-object",this.intersectionBuffer=Ne(5),this.aggregateBuffer=Ne(9),this.invertedBuffer=Ne(9),this.rotation=0,this._updatedList=[];let{x:i=0,y:r=0}=t||{};e?(this.id=e.id||"",this.scale=1,this.layers=e.layers,this.points=Ne([1,i,r,i+e.width,r+e.height]),this.worldPoints=Ne([1,i,r,i+e.width,r+e.height]),this.filteredPointsBuffer=Ne(e.layers.length*5)):(this.id="",this.scale=1,this.layers=[],this.points=Ne(5),this.worldPoints=Ne(5),this.filteredPointsBuffer=Ne(5))}static createWithProps(e){let t=new Ho;return t.applyProps(e),t}applyProps(e){let t=e.x||0,i=e.y||0;this.id=e.id;let r=typeof e.scale<"u"?e.scale:this.scale;this.points[0]=1,this.points[1]=t,this.points[2]=i,this.points[3]=t+e.width,this.points[4]=i+e.height,this.rotation=e.rotation||0,this.worldPoints[3]=this.worldPoints[1]+e.width,this.worldPoints[4]=this.worldPoints[2]+e.height,e.scale&&e.scale!==1&&this.atScale(r),this.scale=r}appendChild(e){e.points[0]===0&&e.points.set(this.points),e.__owner.value=this,this.addLayers([e])}removeChild(e){this.layers=this.layers.filter(t=>t!==e),this.filteredPointsBuffer=Ne(this.layers.length*5)}insertBefore(e,t){let i=this.layers.indexOf(t);if(i===-1||this.layers.indexOf(e)!==-1)return;let r=this.layers.slice(0,i),n=this.layers.slice(i);this.layers=[...r,e,...n]}hideInstance(){console.warn("hideInstance: not yet implemented")}getObjectsAt(e,t){if(this.rotation&&(e=this.applyRotation(e)),va(this.points,e,this.filteredPointsBuffer)[0]===0)return[];let i=this.layers.length,r=[];for(let n=0;n<i;n++){let a=this.layers[n];if(t&&a.isShape){let l=zn(a.points,Qi(this.x,this.y));if(!a.intersects([e[1]-l[1],e[2]-l[2]]))continue}if(va(zn(a.points,Qi(this.x,this.y)),e,this.filteredPointsBuffer)[0]!==0&&r.push(a),t){let l=a;r.push(...l.getObjectsAt(e,t))}}return r}applyRotation(e){if(this.rotation){let t={x:e[1],y:e[2]},i={x:e[1],y:e[4]},r={x:e[3],y:e[2]},n={x:e[3],y:e[4]},a=this.points[1]+(this.points[3]-this.points[1])/2,l=this.points[2]+(this.points[4]-this.points[2])/2,[u,c]=Wo(a,l,t.x,t.y,this.rotation),[d,p]=Wo(a,l,i.x,i.y,this.rotation),[y,x]=Wo(a,l,r.x,r.y,this.rotation),[E,S]=Wo(a,l,n.x,n.y,this.rotation),k=Math.min(u,d,y,E),T=Math.max(u,d,y,E),R=Math.min(c,p,x,S),A=Math.max(c,p,x,S);return Ne([e[0],k,R,T,A])}return e}getAllPointsAt(e,t,i){let r=sn(Qi(this.x,this.y),Nn(this.scale),this.aggregateBuffer);this.rotation&&(e=this.applyRotation(e));let n=jx(e,this.points,this.intersectionBuffer),a=this.layers.length,l=[],u=zn(n,sn(Nn(1/this.scale),Qi(-this.x,-this.y),this.invertedBuffer)),c=t?sn(t,r,this.aggregateBuffer):r,d=i*this.scale;for(let p=0;p<a;p++)l.push(...this.layers[p].getAllPointsAt(u,c,d));return l}addLayers(e){let t=[];for(let i of e)this.layers.indexOf(i)===-1&&(t.push(i),i.points.length===5&&(i.points[1]<this.worldPoints[1]/this.scale||i.points[2]<this.worldPoints[2]/this.scale||i.points[3]>this.worldPoints[3]/this.scale||i.points[4]>this.worldPoints[4]/this.scale)&&(i.crop=i.crop||Ne([1,Math.max(this.worldPoints[1]/this.scale,i.points[1]),Math.max(this.worldPoints[2]/this.scale,i.points[2]),Math.min(this.worldPoints[3]/this.scale,i.points[3]),Math.min(this.worldPoints[4]/this.scale,i.points[4])])));this.layers=this.layers.concat(t),this.filteredPointsBuffer=Ne(this.layers.length*5)}getScheduledUpdates(e,t){let i=this.layers.length;this._updatedList=[];let r=t*this.scale;for(let n=0;n<i;n++){let a=this.layers[n].getScheduledUpdates(e,r);a&&this._updatedList.push(...a)}return this._updatedList}},$h=class extends _r{constructor(e=0,t=0,i=100,r="left-to-right"){super(),this.id="world",this.aggregateBuffer=Ne(9),this.isDirty=!1,this.zones=[],this.triggerQueue=[],this.activatedEvents=[],this._updatedList=[],this.translationBuffer=Ne(9),this.needsRecalculate=!0,this.emptyPaintables=[],this.renderOrder=[],this.objects=[],this.subscriptions=[],this._propagateEventTargets=[],this._alreadyFlushed=[],this._width=e,this._height=t,this.aspectRatio=Number.isNaN(e/t)?1:e/t,this.viewingDirection=r,this.points=Ne(i*5),this.filteredPointsBuffer=Ne(i*5)}get x(){return 0}get y(){return 0}get width(){return this._width}get height(){return this._height}static withProps(e){let t=new $h;return t.applyProps(e),t}applyProps(e){typeof e.width<"u"&&typeof e.height<"u"&&(e.width!==this._width||e.height!==this._height)&&this.resize(e.width,e.height),e.viewingDirection!==this.viewingDirection&&(this.viewingDirection=e.viewingDirection,this.triggerRepaint())}propagateTouchEvent(e,t,i){let r=[];for(let n of i)if(n.x&&n.y){let a=ut.singleBox(1,1,n.x,n.y);r.push(this.getObjectsAt(a,!0).reverse())}return r.map(n=>this.propagateEvent(e,t,n,{bubbles:!0,cancelable:!0}))}propagatePointerEvent(e,t,i,r,n={}){let a=ut.singleBox(1,1,i,r),l=this.getObjectsAt(a,!0).reverse();return this.propagateEvent(e,t,l,n)}propagateEvent(e,t,i,{bubbles:r=!1,cancelable:n=!1}={}){t.atlasTarget=this,this._propagateEventTargets.length=1,this._propagateEventTargets[0]=this;let a=!1;t.stopPropagation=()=>{a=!0};let l=i.length;for(let d=l-1;d>=0;d--){this._propagateEventTargets.unshift(i[d][0]);let p=i[d][1].length;if(p)for(let y=0;y<p;y++)this._propagateEventTargets.unshift(i[d][1][y])}let u=this._propagateEventTargets.length,c=!1;for(let d=0;d<u&&(t.atlasTarget=this._propagateEventTargets[d],t.atlasWorld=this,c=this._propagateEventTargets[d].dispatchEvent(e,t)||c,!a);d++);return c&&this.triggerRepaint(),this._propagateEventTargets}appendChild(e){let t=this.appendWorldObject(e);this.renderOrder.push(t/5)}removeChild(e){let t=this.objects.indexOf(e);if(t===-1){for(let i of this.objects)if(i&&i.id===e.id){this.removeChild(i);return}return}this.objects[t]=null,this.renderOrder=this.renderOrder.filter(i=>i!==t),this.points[t*5]=0,this.triggerRepaint(),this.needsRecalculate=!0}insertBefore(e,t){let i=this.objects.indexOf(t);if(i===-1)return;let r=this.appendWorldObject(e);this.renderOrder.splice(i-1,0,r/5)}hideInstance(){}asWorldObject(){return null}addZone(e){this.zones.push(e)}selectZone(e){if(typeof e=="string"){let t=this.zones.length;for(let i=0;i<t;i++)if(this.zones[i].id===e){this.selectedZone=i,this.trigger("zone-changed");return}}else this.zones[e]&&(this.selectedZone=e,this.trigger("zone-changed"))}deselectZone(){this.selectedZone=void 0}getActiveZone(){if(this.selectedZone)return this.zones[this.selectedZone]}hasActiveZone(){return typeof this.selectedZone<"u"}checkResizeInternalBuffer(){if(Ux(this.points)===this.objects.length){let e=this.points,t=Ne(this.points.length*2);t.set(e,0),this.points=t}}appendWorldObject(e){this.checkResizeInternalBuffer();let t=this.objects.length*5,i=e.points;return e.points=this.points.subarray(this.objects.length*5,this.objects.length*5+5),e.points[1]=i[1],e.points[2]=i[2],e.points[3]=i[3],e.points[4]=i[4],this.objects.push(e),this.filteredPointsBuffer=Ne(this.objects.length*5),this.needsRecalculate=!0,this.triggerRepaint(),t}recalculateWorldSize(){let e=!1;if(this.needsRecalculate){let t=new Int32Array(this.objects.length),i=new Int32Array(this.objects.length),r=this.renderOrder.length;for(let l=0;l<r;l++){let u=this.renderOrder[l];this.objects[u]&&(t[l]=this.points[u*5+3],i[l]=this.points[u*5+4])}let n=Math.max(...t);n!==this._width&&(this._width=n,e=!0);let a=Math.max(...i);a!==this._height&&(this._height=a,e=!0),e&&this.trigger("recalculate-world-size",{width:n,height:a}),this.needsRecalculate=!1}return e}addObjectAt(e,t){t.width&&!t.height?t.height=t.width/e.width*e.height:t.height&&!t.width&&(t.width=t.height/e.height*e.width),(!t||!t.width||!t.height)&&(t.width=e.width,t.height=e.height);let{width:i,x:r,y:n}=t,a=i/e.width;this.checkResizeInternalBuffer(),this.points.set(ut.singleBox(e.width,e.height,0,0),this.objects.length*5);let l=new Ho(e);return l.points=this.points.subarray(this.objects.length*5,this.objects.length*5+5),this.objects.push(l),this.scaleWorldObject(this.objects.length-1,a),this.translateWorldObject(this.objects.length-1,r,n),this.filteredPointsBuffer=Ne(this.points.length*2),this.triggerRepaint(),this.needsRecalculate=!0,l}scaleWorldObject(e,t){xr(this.points.subarray(e*5,e*5+5),Po(t,this.points[e*5+1],this.points[e*5+2]));let i=this.objects[e];i&&(i.atScale(t),this.triggerRepaint())}translateWorldObject(e,t,i){xr(this.points.subarray(e*5,e*5+5),Qi(t,i));let r=this.objects[e];r&&(r.translate(t,i),this.triggerRepaint())}resize(e,t){return this._width=e,this._height=t,this.aspectRatio=e/t,this.triggerRepaint(),this}getObjects(){return this.objects}getPoints(){return this.points}getPointsFromViewer(e,t){let i=ut.singleBox(e.width,e.height,e.x,e.y);return this.getPointsAt(i,t,e.scale)}addLayoutSubscriber(e){return this.subscriptions.push(e),()=>{this.subscriptions.splice(this.subscriptions.indexOf(e),1)}}getScheduledUpdates(e,t){let i=va(this.points,e,this.filteredPointsBuffer),r=this.objects.length;this._updatedList=[];for(let n=0;n<r;n++)if(i[n*5]!==0){if(!this.objects[n])continue;this._updatedList.push(...this.objects[n].getScheduledUpdates(e,t))}return this._updatedList}getObjectsAt(e,t=!1){let i=this.getActiveZone(),r=va(this.points,e,this.filteredPointsBuffer),n=this.renderOrder.length,a=[];for(let l=0;l<n;l++){let u=this.renderOrder[l];if(r[u*5]!==0){let c=this.objects[u];if(!c||i&&i.objects.indexOf(c)===-1)continue;if(c.type!=="world-object"){a.push([c,[c]]);continue}t?a.push([c,c.getObjectsAt(e,t)]):a.push([c,this.emptyPaintables])}}return a}getPointsAt(e,t,i=1){let r=this.getObjectsAt(e),n=sn(Nn(i),Qi(-e[1],-e[2]),this.translationBuffer),a=t?sn(t,n,this.aggregateBuffer):n,l=r.length,u=[];for(let c=0;c<l;c++)r[c]&&u.push(...r[c][0].getAllPointsAt(e,a,i));return u}flushSubscriptions(){if(this.triggerQueue.length){this._alreadyFlushed=[];let e=this.triggerQueue.length;for(let t=0;t<e;t++){if(this._alreadyFlushed.indexOf(this.triggerQueue[t][0])!==-1)continue;typeof this.triggerQueue[t][1]>"u"&&this._alreadyFlushed.push(this.triggerQueue[t][0]);let i=this.subscriptions.length;for(let r=0;r<i;r++)this.subscriptions[r].apply(null,this.triggerQueue[t])}this.triggerQueue=[]}}trigger(e,t){this.triggerQueue.push([e,t])}triggerEventActivation(){this.trigger("event-activation")}triggerRepaint(){this.trigger("repaint")}gotoRegion(e){this.trigger("goto-region",e)}goHome(e=!1){this.trigger("go-home",{immediate:e})}zoomTo(e,t,i){this.trigger("zoom-to",{point:t,factor:e,stream:i})}zoomIn(e){this.trigger("zoom-to",{point:e,factor:.5})}zoomOut(e){this.trigger("zoom-to",{point:e,factor:2})}constraintBounds(e){this.trigger("constrain-bounds",{immediate:e})}},qo=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,Qo={},SE=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],EE=class extends _r{constructor(){super(),this.type="spacial-content",this.hoverEvents=!1,this.activeEvents=!1,this.display={x:0,y:0,scale:1,width:-1,height:-1,points:Ne(5)},this._parsed={border:{id:null,match:[]},outline:{id:null,match:[]}},this.props={},this.addHover=()=>{this.hovering=!0,this.__revision++},this.removeHover=()=>{this.hovering=!1,this.pressing=!1,this.__revision++},this.addPress=()=>{this.pressing=!0,this.__revision++},this.removePress=()=>{this.pressing=!1,this.__revision++},this.id=Co(12),this.points=Ne(5)}getAllPointsAt(e,t){return[[this,this.points,t]]}applyProps(e={}){let t=!1;if(e.interactive!==this.props.interactive&&(t=!0,this.props.interactive=e.interactive),e.style){let i=e.border||e.style.border;if(i!==this._parsed.border.id)if(!i)this._parsed.border.id=null,this._parsed.border.match=[];else{let r=Qo[i]||qo.exec(i)||qo.exec(i);r&&(this._parsed.border.id=i,this._parsed.border.match=Qo[i]=r)}if(this._parsed.border.id&&(e.style.borderWidth=this._parsed.border.match[1],e.style.borderStyle="solid",e.style.borderColor=this._parsed.border.match[4]),e.style.outline!==this._parsed.outline.id)if(!e.style.outline)this._parsed.outline.id=null,this._parsed.outline.match=[];else{let r=Qo[e.style.outline]||qo.exec(e.style.outline)||qo.exec(e.style.outline);r&&(this._parsed.outline.id=e.style.outline,this._parsed.outline.match=Qo[e.style.outline]=r)}this._parsed.outline.id&&(e.style.outlineWidth=this._parsed.outline.match[1],e.style.outlineStyle="solid",e.style.outlineColor=this._parsed.outline.match[4]),this.props.style=e.style,e.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.backgroundColor,t=!0),e.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.style.background,t=!0);for(let r of SE)if(this.props.style[r]!==e.style[r]){t=!0;break}e.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=e.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t=!0),e.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=e.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0)}e.href!==this.props.href&&(this.props.href=e.href,t=!0),e.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=e.hrefTarget,t=!0),e.title!==this.props.title&&(this.props.title=e.title,t=!0),e.className!==this.props.className&&(this.props.className=e.className,e.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0),e.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=e.relativeSize,t=!0),e.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=e.relativeStyle,t=!0),e.html!==this.props.html&&(this.props.html=e.html,t=!0),e.target&&(e.target.width!==this.display.width||e.target.height!==this.display.height||e.target.x!==this.points[1]||e.target.y!==this.points[2])&&(t=!0,this.points=ut.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.points=ut.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.width=e.target.width,this.display.height=e.target.height),t&&this.__revision++}},Vo=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,Go={},AE=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],kE=class extends _r{constructor(){super(),this.type="spacial-content",this.isShape=!0,this.hoverEvents=!1,this.activeEvents=!1,this.display={x:0,y:0,scale:1,width:-1,height:-1,points:Ne(5)},this.boundingBox=null,this._parsed={border:{id:null,match:[]},outline:{id:null,match:[]}},this.props={},this.shape={type:"none"},this.addHover=()=>{this.hovering=!0,this.__revision++},this.removeHover=()=>{this.hovering=!1,this.pressing=!1,this.__revision++},this.addPress=()=>{this.pressing=!0,this.__revision++},this.removePress=()=>{this.pressing=!1,this.__revision++},this.id=Co(12),this.points=Ne(5),this.shape={type:"none"}}updateBoundingBox(){if(this.shape.type==="none")return;let e=this.shape.points;if(this.shape.points.length>2){let t=Math.min(...e.map(a=>a[0])),i=Math.min(...e.map(a=>a[1])),r=Math.max(0,...e.map(a=>a[0])),n=Math.max(0,...e.map(a=>a[1]));this.boundingBox={x:t,y:i,width:r-t,height:n-i};return}this.boundingBox=null}intersects(e){if(!e||this.shape.type==="none")return!1;let[t,i]=e,r=this.shape.points,n=this.boundingBox;if(n||(this.updateBoundingBox(),n=this.boundingBox),!n||t<n.x||t>n.x+n.width||i<n.y||i>n.height+n.y)return!1;let a=!1;for(let l=0,u=r.length-1;l<r.length;u=l++)r[l][1]>i!=r[u][1]>i&&t<(r[u][0]-r[l][0])*(i-r[l][1])/(r[u][1]-r[l][1])+r[l][0]&&(a=!a);return a}getAllPointsAt(e,t){return e[3]-e[1]===1&&e[4]-e[2]===1?this.intersects([e[1],e[2]])?[[this,this.points,t]]:[]:[[this,this.points,t]]}applyProps(e={}){let t=!1;if(e.points)if(this.shape.type!=="polygon"||this.shape.points.length!==e.points.length)this.shape={type:"polygon",points:e.points,open:e.open},this.updateBoundingBox();else{let i=!1,r=e.points.length;for(let n=0;n<r;n++)if(e.points[n][0]!==this.shape.points[n][0]||e.points[n][1]!==this.shape.points[n][1]){i=!0;break}i&&(this.shape={type:"polygon",points:e.points,open:e.open},this.updateBoundingBox())}if(e.interactive!==this.props.interactive&&(t=!0,this.props.interactive=e.interactive),(e.open||e.open===!1)&&(t=!0,this.shape.open=e.open),e.style){let i=e.border||e.style.border;if(i!==this._parsed.border.id)if(!i)this._parsed.border.id=null,this._parsed.border.match=[];else{let r=Go[i]||Vo.exec(i)||Vo.exec(i);r&&(this._parsed.border.id=i,this._parsed.border.match=Go[i]=r)}if(this._parsed.border.id&&(e.style.borderWidth=this._parsed.border.match[1],e.style.borderStyle="solid",e.style.borderColor=this._parsed.border.match[4]),e.style.outline!==this._parsed.outline.id)if(!e.style.outline)this._parsed.outline.id=null,this._parsed.outline.match=[];else{let r=Go[e.style.outline]||Vo.exec(e.style.outline)||Vo.exec(e.style.outline);r&&(this._parsed.outline.id=e.style.outline,this._parsed.outline.match=Go[e.style.outline]=r)}this._parsed.outline.id&&(e.style.outlineWidth=this._parsed.outline.match[1],e.style.outlineStyle="solid",e.style.outlineColor=this._parsed.outline.match[4]),this.props.style=e.style,e.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.backgroundColor,t=!0),e.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.style.background,t=!0);for(let r of AE)if(this.props.style[r]!==e.style[r]){t=!0;break}e.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=e.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t=!0),e.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=e.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0)}e.href!==this.props.href&&(this.props.href=e.href,t=!0),e.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=e.hrefTarget,t=!0),e.title!==this.props.title&&(this.props.title=e.title,t=!0),e.className!==this.props.className&&(this.props.className=e.className,e.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0),e.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=e.relativeSize,t=!0),e.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=e.relativeStyle,t=!0),e.html!==this.props.html&&(this.props.html=e.html,t=!0),e.target&&(e.target.width!==this.display.width||e.target.height!==this.display.height||e.target.x!==this.points[1]||e.target.y!==this.points[2])&&(t=!0,this.points=ut.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.points=ut.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.width=e.target.width,this.display.height=e.target.height),t&&this.__revision++}},PE=class extends _r{constructor(){super(),this.type="spacial-content",this.color="#000",this.text="",this.display={x:0,y:0,scale:1,width:100,height:100,points:Ne(5)},this.interactive=!1,this.props={font:"18px Arial, sans-serif",lineHeight:1,textAlign:"left",verticalAlign:"top",paddingX:0,paddingY:0,fitParent:!1,lineBreak:"auto",strokeText:!1,sizeToFill:!1,maxFontSizeToFill:void 0,allowNewLine:!0,justifyLines:!1,renderHDPI:!1,textDecoration:"none",interactive:!1,relativeSize:!1},this.id="",this.points=Ne(5)}getAllPointsAt(e,t){return[[this,this.points,t]]}applyProps(e){var t=e,{id:i,target:r,text:n,color:a,backgroundColor:l,fontSize:u=18,interactive:c,fontFamily:d="Arial, sans-serif"}=t,p=le(t,["id","target","text","color","backgroundColor","fontSize","interactive","fontFamily"]);p.font=`${u}px ${d}`,this.interactive=c||!1,typeof n<"u"&&(this.text=n||""),a&&(this.color=a),l&&(this.backgroundColor=l),i&&(this.id=i),r&&(this.points=ut.singleBox(r.width,r.height,r.x,r.y),this.display.points=this.points,this.display.width=r.width,this.display.height=r.height),this.props=C(C({},this.props),p),this.__revision++}},Nh=Math.pow,CE=Math.cos,TE=Math.PI,zs={easeInOutQuad:function(e){return e<.5?2*e*e:1-Nh(-2*e+2,2)/2},easeOutQuart:function(e){return 1-Nh(1-e,4)},easeInOutSine:function(e){return-(CE(TE*e)-1)/2},easeOutExpo:function(e){return e===1?1:1-Nh(2,-10*e)}},IE=class{constructor(e){this.runtime=e,this.pendingTransition={from:Ne(5),to:Ne(5),elapsed_time:0,done:!0,total_time:0,timingFunction:zs.easeInOutQuad,constrain:!1}}hasPending(){return!this.pendingTransition.done}getPendingTransition(){return this.pendingTransition}getPendingFrom(){return this.pendingTransition.from}customTransition(e){e(this.pendingTransition)}stopTransition(){this.pendingTransition.from=Ne(this.runtime.target),this.pendingTransition.to=Ne(this.runtime.target),this.pendingTransition.done=!0,this.pendingTransition.elapsed_time=0,this.pendingTransition.total_time=0}runTransition(e,t){if(!this.pendingTransition.done){let i=this.pendingTransition,r=i.total_time===0?0:(i.elapsed_time+t)/i.total_time,n=i.total_time===0?1:r===0?0:i.timingFunction(r);e[1]=i.from[1]+(i.to[1]-i.from[1])*n,e[2]=i.from[2]+(i.to[2]-i.from[2])*n,e[3]=i.from[3]+(i.to[3]-i.from[3])*n,e[4]=i.from[4]+(i.to[4]-i.from[4])*n,this.pendingTransition.elapsed_time+=t,this.pendingTransition.elapsed_time>=this.pendingTransition.total_time&&(this.pendingTransition.done=!0,this.pendingTransition.constrain&&this.constrainBounds({transition:{duration:this.pendingTransition.total_time===0?0:500,easing:zs.easeOutExpo}}))}}zoomTo(e,{origin:t,stream:i=!1,transition:r}={}){let n=this.runtime.getZoomedPosition(e,{origin:t}),a=Math.abs(1-e);this.applyTransition(n,r,{duration:2e3*a,easing:zs.easeOutExpo,constrain:!0},{stream:!1})}constrainBounds({transition:e,panPadding:t=0}={}){let[i,r]=this.runtime.constrainBounds(this.runtime.target,{panPadding:t});i&&(this.applyTransition(r,e,{duration:500,easing:zs.easeOutQuart,constrain:!1}),this.runtime.updateNextFrame())}applyTransition(e,t,i,{stream:r}={}){this.pendingTransition.from=Ne(this.runtime.target),this.pendingTransition.to=e,r||(this.pendingTransition.elapsed_time=0),this.pendingTransition.done=!1,this.pendingTransition.total_time=typeof(t==null?void 0:t.duration)<"u"?t.duration:typeof(i==null?void 0:i.duration)<"u"?i.duration:1e3,this.pendingTransition.constrain=typeof(t==null?void 0:t.constrain)<"u"?t.constrain:typeof(i==null?void 0:i.constrain)<"u"?i.constrain:!1,this.pendingTransition.timingFunction=(t==null?void 0:t.easing)||(i==null?void 0:i.easing)||zs.easeInOutSine}goToRegion(e,{transition:t}={}){let i=this.runtime.clampRegion(e);this.applyTransition(ut.singleBox(i.width,i.height,i.x,i.y),t,{duration:1e3,easing:zs.easeOutExpo,constrain:!0}),this.runtime.updateNextFrame()}},xg=class{constructor(e,t,i,r=[],n){this.id=Co(),this.ready=!1,this.transformBuffer=Ne(500),this.lastTarget=Ne(5),this.zoomBuffer=Ne(5),this.logNextRender=!1,this.pendingUpdate=!0,this.isCommitting=!1,this.firstRender=!0,this.mode="explore",this.controllers=[],this.controllersRunning=!1,this.controllerStopFunctions=[],this.maxScaleFactor=1,this._viewerToWorld={x:0,y:0},this._lastGoodScale=1,this.hooks={useFrame:[],useBeforeFrame:[],useAfterPaint:[],useAfterFrame:[]},this.hookOptions={filters:{grayscale:0,contrast:0,brightness:0,saturate:0,sepia:0,invert:0,hueRotate:0,blur:0}},this._viewport={x:0,y:0,width:0,height:0},this.setViewport=a=>{let l=Math.round(typeof a.x>"u"?this.target[1]:a.x),u=Math.round(typeof a.y>"u"?this.target[2]:a.y);a.width?this.target[3]=l+a.width:this.target[3]=this.target[3]-this.target[1]+l,a.height?this.target[4]=u+a.height:this.target[4]=this.target[4]-this.target[2]+u,Math.abs(this.target[1]-l)>.01&&(this.target[1]=l),Math.abs(this.target[2]-u)>.01&&(this.target[2]=u),this.pendingUpdate=!0},this.render=a=>{let l=a-this.lastTime;if(this.isCommitting||this.fpsLimit&&l<1e3/this.fpsLimit){this.stopId=window.requestAnimationFrame(this.render);return}this.lastTime=a,this.world.flushSubscriptions(),this.stopId=window.requestAnimationFrame(this.render),this.hook("useFrame",l);let u=this.pendingUpdate,c=this.renderer.pendingUpdate();if(this.transitionManager.hasPending()&&(this.transitionManager.runTransition(this.target,l),this.pendingUpdate=!0,this.updateControllerPosition()),!this.firstRender&&!u&&!c&&this.target[0]===this.lastTarget[0]&&this.target[1]===this.lastTarget[1]&&this.target[2]===this.lastTarget[2]&&this.target[3]===this.lastTarget[3]&&this.target[4]===this.lastTarget[4])return;this.hook("useBeforeFrame",l),this.renderer.beforeFrame(this.world,l,this.target,this.hookOptions);let d=this.getScaleFactor(),p=this.renderer.getPointsAt(this.world,this.target,this.aggregate,d),y=p.length;for(let S=0;S<y;S++){let k=p[S][0],T=p[S][1],R=p[S][2],A=R?zn(T,R,this.transformBuffer):T;this.renderer.prepareLayer(k,k.__parent&&R?zn(k.__parent.crop||k.__parent.points,R):A);let $=A.length/5;for(let z=0;z<$;z++){let B=z*5;A[B]!==0&&(this.renderer.paint(k,z,A[B+1],A[B+2],A[B+3]-A[B+1],A[B+4]-A[B+2]),this.hook("useAfterPaint",k))}this.renderer.finishLayer(k,T)}this.renderer.afterFrame(this.world,l,this.target,this.hookOptions),this.hook("useAfterFrame",l),this.lastTarget[0]=this.target[0],this.lastTarget[1]=this.target[1],this.lastTarget[2]=this.target[2],this.lastTarget[3]=this.target[3],this.lastTarget[4]=this.target[4],this.firstRender=!1,this.pendingUpdate=!1,this.logNextRender=!1,this.renderer.isReady()&&(this.ready=!0,this.world.trigger("ready")),this.world.flushSubscriptions();let x=this.world.getScheduledUpdates(this.target,d),E=x.length;if(E>0)for(let S=0;S<E;S++){let k=x[E-S-1]();k?k.then(()=>{this.pendingUpdate=!0}):this.pendingUpdate=!0}},this.renderer=e,this.world=t,this.options=C({maxOverZoom:1,maxUnderZoom:1,visibilityRatio:1.5},n||{}),this.target=ut.projection(i),this.manualHomePosition=!1,this.pendingUpdate=!0,this.homePosition=ut.projection(this.world),this.manualFocalPosition=!1,this.focalPosition=this.target,this.updateFocalPosition(),this.transitionManager=new IE(this),this.aggregate=Nn(1),this.world.addLayoutSubscriber(a=>{a==="repaint"&&(this.pendingUpdate=!0),a==="recalculate-world-size"&&(this.manualHomePosition||(this.setHomePosition(),this.goHome()),this.updateFocalPosition())}),this.lastTime=performance.now(),this.controllers=r,this.render(this.lastTime),this.startControllers()}get x(){return this.target[1]}set x(e){this.target[1]=e}get y(){return this.target[2]}set y(e){this.target[2]=e}get x2(){return this.target[3]}set x2(e){this.target[3]=e}get y2(){return this.target[4]}set y2(e){this.target[4]=e}get width(){return this.target[3]-this.target[1]}set width(e){this.target[3]=this.target[1]+e}get height(){return this.target[4]-this.target[2]}set height(e){this.target[4]=this.target[2]=e}setHomePosition(e){this.homePosition.set(ut.projection(e||this.world)),this.pendingUpdate=!0}startControllers(){if(!this.controllersRunning){for(let e of this.controllers)this.controllerStopFunctions.push(e.start(this));this.controllersRunning=!0}}stopControllers(){if(this.controllersRunning){for(let e of this.controllerStopFunctions)e();this.controllersRunning=!1,this.controllerStopFunctions=[]}}updateControllerPosition(){for(let e of this.controllers)e.updatePosition(this.x,this.y,this.width,this.height)}triggerResize(){this.renderer.triggerResize&&this.renderer.triggerResize(),this.pendingUpdate=!0}addController(e){this.controllers.push(e),this.controllersRunning&&e.start(this),this.pendingUpdate=!0}cover(){return this.goHome({cover:!0})}getRendererScreenPosition(){return this.renderer.getRendererScreenPosition()}updateRendererScreenPosition(){this.pendingUpdate=!0,this.renderer.resize()}setOptions(e){this.options=C(C({},this.options),e)}goHome(e={}){if(this.world.width<=0||this.world.height<=0)return;let t=this.getScaleFactor(),i=e.position?{x:e.position[1],y:e.position[2],width:e.position[3]-e.position[1],height:e.position[4]-e.position[2]}:{x:this.homePosition[1],y:this.homePosition[2],width:this.homePosition[3]-this.homePosition[1],height:this.homePosition[4]-this.homePosition[2]},r=this.width*t,n=this.height*t,a=i.width/r,l=i.height/n,u=r/n;if(e.cover?a>l:a<l){let c=u*i.height,d=(c-i.width)/2;this.target[1]=Math.round(-d+i.x),this.target[2]=Math.round(i.y),this.target[3]=Math.round(c-d+i.x),this.target[4]=Math.round(i.height+i.y)}else{let c=i.width/u,d=(c-i.height)/2;this.target[1]=Math.round(i.x),this.target[2]=Math.round(i.y-d),this.target[3]=Math.round(i.x+i.width),this.target[4]=Math.round(i.y+c-d)}this.constrainBounds(this.target),this.updateControllerPosition()}resize(e,t,i,r){this.updateFocalPosition(e-t,i-r);let n=t/e,a=r/i;this.target[3]=this.target[1]+(this.target[3]-this.target[1])*n,this.target[4]=this.target[2]+(this.target[4]-this.target[2])*a,this.goHome({position:this.focalPosition}),this.renderer.resize(t,r),this.pendingUpdate=!0}updateFocalPosition(e,t){if(!this.manualFocalPosition){let i=this.width,r=this.height,n=Math.min(i,r),a=0,l=0,u=this.x+a,c=this.y+l;if(i<r){let d=this.height-this.width;this.focalPosition=ut.projection({x:u,y:c+d/2,width:n-a*2,height:n-l*2}),this.pendingUpdate=!0}else{let d=this.width-this.height;this.focalPosition=ut.projection({x:u+d/2,y:c,width:n-a*2,height:n-l*2}),this.pendingUpdate=!0}}}getViewport(){return this._viewport.x=this.target[1],this._viewport.y=this.target[2],this._viewport.width=this.target[3]-this.target[1],this._viewport.height=this.target[4]-this.target[2],this._viewport}constrainBounds(e,{panPadding:t=0,ref:i=!1}={}){let{minX:r,maxX:n,minY:a,maxY:l}=this.getBounds({target:e,padding:t}),u=!1,c=i?e:Ne(e),d=Math.round(e[3]-e[1]),p=Math.round(e[4]-e[2]);return r>e[1]&&(u=!0,c[1]=r,c[3]=r+d),a>e[2]&&(u=!0,c[2]=a,c[4]=a+p),n<e[1]&&(u=!0,c[1]=n,c[3]=n+d),l<e[2]&&(u=!0,c[2]=l,c[4]=l+p),[u,c]}getBounds(e){let t=e.target||this.target,i=e.padding,r=this.options.visibilityRatio,n=Math.abs(1-r);if(this.world.hasActiveZone()){let R=this.world.getActiveZone();if(R){let A=t[3]-t[1]<R.points[3]-R.points[1],$=t[4]-t[2]<R.points[4]-R.points[2];return{minX:A?R.points[1]-i:R.points[1]+(R.points[3]-R.points[1])/2-(t[3]-t[1])/2,maxX:$?R.points[2]-i:R.points[2]+(R.points[4]-R.points[2])/2-(t[4]-t[2])/2,minY:A?R.points[3]+i:R.points[1]+(R.points[3]-R.points[1])/2-(t[3]-t[1])/2,maxY:$?R.points[4]+i:R.points[2]+(R.points[4]-R.points[2])/2-(t[4]-t[2])/2}}}let a=t[3]-t[1],l=this.world.width,u=-a*n,c=l-a-u,d=t[4]-t[2],p=this.world.height,y=-d*n,x=p-d-y,E=Math.round(Math.max(u,c)),S=Math.round(Math.min(u,c)),k=Math.round(Math.max(y,x)),T=Math.round(Math.min(y,x));return{minX:S,maxX:E,minY:T,maxY:k}}getScaleFactor(e=!1){let t=this.renderer.getScale(this.target[3]-this.target[1],this.target[4]-this.target[2],e);return t===0?this._lastGoodScale:(this._lastGoodScale=t,t)}getZoomedPosition(e,{origin:t,fromPos:i}){var r;let n=i?{width:i[3]-i[1],height:i[4]-i[2]}:void 0,a=n?this.renderer.getScale(n.width,n.height):this.getScaleFactor(),l=n?n.width:this.width,u=n?n.height:this.height,c=(r=this.getRendererScreenPosition())==null?void 0:r.width,d=this.world.width,p=c?c/d:1,y=this.options.maxUnderZoom,x=Math.max(p||1,this.options.maxOverZoom),E=1/e,S=a*E;if(E<1){let T=l*a,R=u*a,A=this.world.width/T,$=this.world.height/R;if(A>$){let z=this.world.width*S,B=~~(l*a)*y;z<B&&(e=this.world.width*a/(l*a*y))}else{let z=this.world.height*S,B=~~(u*a)*y;z<B&&(e=this.world.height*a/(u*a*y))}}else S>x&&(e=a/x);let k=zn(this.target,Po(e,t?t.x:this.target[1]+(this.target[3]-this.target[1])/2,t?t.y:this.target[2]+(this.target[4]-this.target[2])/2),this.zoomBuffer);return this.constrainBounds(k,{ref:!0,panPadding:100}),k}clampRegion({x:e,y:t,width:i,height:r,padding:n=0}){let a=this.width,l=this.height,u=i/a<r/l,c=e-n,d=t-n,p=i+n*2,y=r+n*2;if(u){let E=y/l*a;return{x:c-(E-p)/2,y:d,width:E,height:y}}let x=p/a*l;return{x:c,y:d-(x-y)/2,width:p,height:x}}viewerToWorld(e,t){let i=this.getScaleFactor();return this._viewerToWorld.x=this.target[1]+e/i,this._viewerToWorld.y=this.target[2]+t/i,this._viewerToWorld}worldToViewer(e,t,i,r){let n=ut.singleBox(i,r,e,t);return xr(n,sn(Nn(this.getScaleFactor()),Qi(-this.target[1],-this.target[2]))),{x:n[1],y:n[2],width:n[3]-n[1],height:n[4]-n[2],strand:n}}setScale(e,t){xr(this.target,Po(e,t?t.x:this.target[1]+(this.target[3]-this.target[1])/2,t?t.y:this.target[2]+(this.target[4]-this.target[2])/2)),this.pendingUpdate=!0}syncTo(e){let t=this.target;return this.target=e.target,this.pendingUpdate=!0,()=>{this.target=t}}stop(){return typeof this.stopId<"u"&&(window.cancelAnimationFrame(this.stopId),this.stopId=void 0),()=>{this.render(performance.now())}}reset(){this.renderer.reset()}selectZone(e){this.world.selectZone(e),this.pendingUpdate=!0}deselectZone(){this.world.deselectZone(),this.pendingUpdate=!0}hook(e,t){let i=this.hooks[e].length;if(i!==0)for(let r=0;r<i;r++)this.hooks[e][r](t)}registerHook(e,t){return this.hooks[e].push(t),()=>{this.hooks[e]=this.hooks[e].filter(i=>i!==t)}}updateNextFrame(){this.pendingUpdate=!0}};typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes("firefox");var RE=!!(typeof window<"u"&&window.document&&window.document.createElement),OE={canUseDOM:RE},ME=OE,LE=ME;LE.canUseDOM&&document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","");var _g=te.createContext("explore");_g.displayName="Mode";function Sg(e,t,i){var r,n,a,l,u;t==null&&(t=100);function c(){var p=Date.now()-l;p<t&&p>=0?r=setTimeout(c,t-p):(r=null,i||(u=e.apply(a,n),a=n=null))}var d=function(){a=this,n=arguments,l=Date.now();var p=i&&!r;return r||(r=setTimeout(c,t)),p&&(u=e.apply(a,n),a=n=null),u};return d.clear=function(){r&&(clearTimeout(r),r=null)},d.flush=function(){r&&(u=e.apply(a,n),a=n=null,clearTimeout(r),r=null)},d}Sg.debounce=Sg;var zh=te.createContext(null);zh.displayName="Atlas";var Eg=te.createContext(null);Eg.displayName="Bounds";var Zo,$E=typeof performance=="object"&&typeof performance.now=="function";if($E){let e=performance;Zo=()=>e.now()}else{let e=Date,t=e.now();Zo=()=>e.now()-t}var Ag={exports:{}},Dn={};Dn.ConcurrentRoot=1,Dn.ContinuousEventPriority=4,Dn.DefaultEventPriority=16,Dn.DiscreteEventPriority=1,Dn.IdleEventPriority=536870912,Dn.LegacyRoot=0,Ag.exports=Dn;function kg(e,t){e&&e.appendChild&&t&&e.appendChild(t)}function Pg(e,t){e&&e.removeChild&&t&&e.removeChild(t)}function NE(e,t){return Pg(e.world,t)}function zE(e,t,i){return Cg(e.world,t,i)}function Cg(e,t,i){e&&e instanceof xg&&(e=e.world),e&&e.insertBefore&&e.insertBefore(t,i)}function Tg(e,t,i){if(i&&(e.applyProps&&e.applyProps(i),e instanceof _r))for(let r of ko){let n=r.slice(2).toLowerCase();i[r]!==t[r]&&(t[r]&&e.removeEventListener(n,t[r]),e.addEventListener(n,i[r]))}}function Ig(e,t){let i=Object.keys(t),r=!1;for(let n of i)if(ko.indexOf(n)!==-1){let a=bh[n];if(a){if(e.activatedEvents.indexOf(a)!==-1)continue;r=!0,e.activatedEvents.push(a)}}r&&e.triggerEventActivation()}var Yo=new Map,Rg={};function FE(e,t,i,r,n){var a=t,{args:l=[]}=a,u=le(a,["args"]);if(!(i instanceof xg)&&n){let p=y=>y.return?p(y.return):y.stateNode&&y.stateNode.containerInfo;i=p(n)}let c,d=i.world;switch(e){case"world":c=$h.withProps({width:u.width,height:u.height,viewingDirection:"left-to-right"}),c.activatedEvents=d.activatedEvents,c.eventHandlers=d.eventHandlers,c.subscriptions=d.subscriptions,c.triggerEventActivation(),d=c;break;case"box":c=new EE;break;case"shape":c=new kE;break;case"worldObject":case"world-object":c=new Ho;break;case"worldImage":case"world-image":c=new ba;break;case"texture":c=new Dx;break;case"compositeImage":case"composite-image":c=new _E({id:u.id,width:u.width,height:u.height,images:[],renderOptions:u.renderOptions});break;case"tiledImage":case"tiled-image":c=wg.fromTile(u.uri,u.display,u.tile,u.scaleFactor,void 0,u.format);break;case"paragraph":c=new PE,c.text=u.children;break;default:return}return Ig(d,u),Tg(c,{},u),c}function BE(e,t){if(t instanceof $h)e.world=t;else if(t instanceof Ho)e.world.appendChild(t);else if(t)throw new Error("Invalid root")}var ka=(0,Fx.default)({unstable_now:Zo,now:Zo,createInstance:FE,removeChild:Pg,appendChild:kg,appendInitialChild:kg,insertBefore:Cg,warnsIfNotActing:!0,supportsMutation:!0,isPrimaryRenderer:!1,scheduleTimeout:typeof setTimeout<"u"?setTimeout:void 0,cancelTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,setTimeout:typeof setTimeout<"u"?setTimeout:void 0,clearTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,noTimeout:-1,appendChildToContainer:BE,removeChildFromContainer:NE,createTextInstance(){},insertInContainerBefore:zE,prepareUpdate(e,t,i,r,n){return Ig(n.world,r),r},commitUpdate(e,t,i,r,n,a){e.applyProps&&t&&Tg(e,r,t)},finalizeInitialChildren(e){return e==null?void 0:e.__handlers},getChildHostContext(){return Rg},getRootHostContext(){return Rg},prepareForCommit(e){return e.isCommitting=!0,null},preparePortalMount(){},hideInstance(e){e&&e.points&&(e.points[0]=0)},unhideInstance(e,t){e&&e.points&&(e.points[0]=1)},getPublicInstance(e){return e},hideTextInstance(){throw new Error("Text is not allowed in the react-three-fibre tree. You may have extraneous whitespace between components.")},resetAfterCommit(e){e.isCommitting=!1,e.pendingUpdate=!0,e.world&&e.world.needsRecalculate&&(e.world.recalculateWorldSize(),e.world.triggerRepaint())},shouldSetTextContent(){return!1},clearContainer(){return!1},supportsHydration:!1,supportsPersistence:!1,detachDeletedInstance(e){},afterActiveInstanceBlur(){},beforeActiveInstanceBlur(){},getCurrentEventPriority(){return console.log("getCurrentEventPriority"),Ag.exports.DefaultEventPriority},getInstanceFromNode(e){throw console.log("getInstanceFromNode",e),new Error("Not implemented")},getInstanceFromScope(e){throw console.log("getInstanceFromScope",e),new Error("Not implemented")},prepareScopeUpdate(e,t){throw console.log("prepareScopeUpdate",e,t),new Error("Not implemented")},logRecoverableError(){},requestPostPaintCallback(){}});ka.injectIntoDevTools({bundleType:0,version:Cs,rendererPackageName:"@atlas-viewer/atlas"});function jE(e,t){let i=Yo.get(e);i&&ka.updateContainer(null,i,null,()=>{Yo.delete(e),t&&t(e)})}var Og={render(e,t){let i=Yo.get(t);if(i)ka.updateContainer(e,i,null);else{let r=ka.createContainer(t,0,null,!1,null,"",()=>{},null);ka.updateContainer(e,r,null),Yo.set(t,r)}},unmountComponentAtNode(e,t){jE(e,t)}},Mg=typeof window<"u"&&((ip=window.document)!=null&&ip.createElement||((rp=window.navigator)==null?void 0:rp.product)==="ReactNative")?Et:fe;te.memo(({children:e,setIsReady:t,onCreated:i,bounds:r,preset:n,mode:a="explore"})=>{let l=Qe(function(u){let c=xe(!1),d=()=>{t(!0)};return fe(()=>{if(n&&!c.current){n.runtime.goHome();let p=i&&i(n);return void(p&&p.then?p.then(d):d())}return()=>{}},[]),fe(()=>{c.current=!0},[]),u.children},[n]);return Mg(()=>{if(n){let u=n.runtime;a!==u.mode&&(u.mode=a),Og.render(te.createElement(te.StrictMode,null,te.createElement(l,null,te.createElement(Eg.Provider,{value:r},te.createElement(_g.Provider,{value:a},te.createElement(zh.Provider,{value:n},e))))),u)}},[n,a,e]),Mg(()=>{if(n){let u=n.runtime;return()=>{Og.unmountComponentAtNode(u)}}return()=>{}},[n]),null}),te.forwardRef((e,t)=>te.createElement("div",W(C({},e),{ref:t,part:e.className})));var UE=()=>Yt(zh),Lg=()=>{let e=UE();return e?e.runtime:void 0},DE=(e,t=[])=>{let i=Lg();fe(()=>i?i.registerHook("useFrame",e):()=>{},t)};async function WE(e,t,i){if(Cs.startsWith("18.")){let r=await Promise.resolve().then(()=>Ue(mh(),1)),n=r.default?r.default.createRoot:r.createRoot;i.current||(i.current=n(e)),i.current.render(t)}else if(typeof ReactDOM<"u"){let{render:r,unmountComponentAtNode:n}=ReactDOM;r(t,e),i.current={unmount(){n(e)}}}else{let r=await Promise.resolve().then(()=>(pe(),Ln)),n=r.default?r.default.render:r.render,a=r.default?r.default.unmountComponentAtNode:r.unmountComponentAtNode;n(t,e),i.current={unmount(){a(e)}}}}var HE=te.forwardRef((e,t)=>{var i=e,{children:r}=i,n=le(i,["children"]);let a=xe(),l=Lg(),u=xe(0),c=xe(),d=xe();return DE(()=>{var p,y,x,E;if(n.relative){let S=a.current;if(S&&l){let k=l.getScaleFactor();u.current!==k&&(u.current=k,S.style.transformOrigin="0 0",S.style.transform=`scale(${1/u.current})`,S.style.width=`${u.current*100}%`,S.style.height=`${u.current*100}%`,a.current&&((y=(p=c.current)==null?void 0:p.__owner.value)!=null&&y.rotation)&&(S.style.transform=`scale(${1/u.current}) translate(50%, 50%) rotate(${((E=(x=c.current)==null?void 0:x.__owner.value)==null?void 0:E.rotation)||0}deg)  translate(-50%, -50%)`))}}},[n.relative]),Et(()=>{let p=c.current;t&&p&&(typeof t=="function"?t(p):t.current=p);async function y(){if(p&&p.__host){let x=n.relative?te.createElement("div",{ref:a},r):r;await WE(p.__host.element,x,d)}}p&&p.__host?y():p&&(p.__onCreate=y)},[t,r,c,n.relative]),Et(()=>()=>{d.current&&setTimeout(()=>{d.current.unmount()},0)},[]),te.createElement("box",W(C({html:!0},n),{ref:c}))});HE.displayName="HTMLPortal",tt(),tt();var qE=0;function Ke(e,t,i,r,n){var a,l,u={};for(l in t)l=="ref"?a=t[l]:u[l]=t[l];var c={type:e,props:u,key:i,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--qE,__source:n,__self:r};if(typeof e=="function"&&(a=e.defaultProps))for(l in a)u[l]===void 0&&(u[l]=a[l]);return Ce.vnode&&Ce.vnode(c),c}var QE={id:"https://iiif-parser/annotation-page",type:"AnnotationPage",behavior:[],motivation:null,label:null,thumbnail:[],summary:null,requiredStatement:null,metadata:[],rights:null,provider:[],items:[],seeAlso:[],homepage:[],logo:[],rendering:[],service:[]},VE={id:"https://iiif-parser/empty-canvas",type:"Canvas",label:null,behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],duration:0,height:0,width:0},GE={id:"https://iiif-parser/empty-collection",type:"Collection",label:null,viewingDirection:"left-to-right",behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],services:[]},ZE={id:"https://iiif-parser/empty-manifest",type:"Manifest",annotations:[],behavior:[],homepage:[],items:[],label:null,logo:[],metadata:[],motivation:null,navDate:null,provider:[],partOf:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,rendering:[],requiredStatement:null,rights:null,seeAlso:[],service:[],services:[],start:null,structures:[],summary:null,thumbnail:[],viewingDirection:"left-to-right"},YE={id:"https://iiif-parser/empty-canvas",type:"Range",label:null,behavior:[],motivation:null,thumbnail:[],posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:[],rights:null,navDate:null,provider:[],items:[],annotations:[],seeAlso:[],homepage:[],logo:[],partOf:[],rendering:[],service:[],start:null,supplementary:null,viewingDirection:"left-to-right"},XE={id:"https://iiif-parser/empty-agent",type:"Agent",label:{},logo:[],seeAlso:[],homepage:[]},$g=["Collection","Manifest","Canvas","AnnotationPage","AnnotationCollection","Annotation","ContentResource","Range","Service","Selector","Agent"];function KE(e){if(typeof e>"u"||e===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(e))throw new Error("Array is not a valid entity");if(typeof e!="object")throw new Error(`${typeof e} is not a valid entity`);if(typeof e.type=="string"){let t=$g.indexOf(e.type);if(t!==-1)return $g[t]}if(e.profile)return"Service";throw new Error("Resource type is not known")}var Ng=class{constructor(e,t={}){Je(this,"traversals"),Je(this,"options"),this.traversals=C({collection:[],manifest:[],canvas:[],annotationCollection:[],annotationPage:[],annotation:[],contentResource:[],choice:[],range:[],service:[],agent:[]},e),this.options=C({allowUndefinedReturn:!1},t)}static all(e){return new Ng({collection:[e],manifest:[e],canvas:[e],annotationCollection:[e],annotationPage:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e]})}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=e.thumbnail.map(t=>this.traverseType(t,this.traversals.contentResource))),e.provider&&(e.provider=e.provider.map(t=>this.traverseAgent(t))),e}traverseLinking(e){return e.seeAlso&&(e.seeAlso=e.seeAlso.map(t=>this.traverseType(t,this.traversals.contentResource))),e.service&&(e.service=e.service.map(t=>this.traverseType(t,this.traversals.service))),e.services&&(e.services=e.services.map(t=>this.traverseType(t,this.traversals.service))),e.logo&&(e.logo=e.logo.map(t=>this.traverseType(t,this.traversals.contentResource))),e.homepage&&(e.homepage=e.homepage.map(t=>this.traverseType(t,this.traversals.contentResource))),e.partOf&&(e.partOf=e.partOf.map(t=>typeof t=="string"||!t.type?this.traverseType(t,this.traversals.contentResource):t.type==="Canvas"?this.traverseType(t,this.traversals.canvas):t.type==="AnnotationCollection"?this.traverseType(t,this.traversals.annotationCollection):this.traverseType(t,this.traversals.contentResource))),e.start&&(e.start=e.start?this.traverseType(e.start,this.traversals.canvas):null),e.rendering&&(e.rendering=e.rendering.map(t=>this.traverseType(t,this.traversals.contentResource))),e.supplementary&&(e.supplementary=e.supplementary.map(t=>this.traverseType(t,this.traversals.contentResource))),e}traverseCollectionItems(e){return e.items&&e.items.map(t=>t.type==="Collection"?this.traverseCollection(t):this.traverseManifest(t)),e}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseInlineAnnotationPages(this.traverseLinking(this.traversePosterCanvas(this.traverseCollectionItems(e))))),this.traversals.collection)}traverseManifestItems(e){return e.items&&(e.items=e.items.map(t=>this.traverseCanvas(t))),e}traverseManifestStructures(e){return e.structures&&(e.structures=e.structures.map(t=>this.traverseRange(t))),e}traverseManifest(e){return this.traverseType(this.traverseInlineAnnotationPages(this.traverseManifestStructures(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e)))))),this.traversals.manifest)}traverseCanvasItems(e){return e.items=(e.items||[]).map(t=>this.traverseAnnotationPage(t)),e}traverseInlineAnnotationPages(e){return typeof e=="string"||!e||e.annotations&&(e.annotations=e.annotations.map(t=>this.traverseAnnotationPage(t))),e}traverseCanvas(e){return this.traverseType(this.traverseInlineAnnotationPages(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))))),this.traversals.canvas)}traverseAnnotationPageItems(e){return e.items&&(e.items=e.items.map(t=>this.traverseAnnotation(t))),e}traverseAnnotationPage(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationPageItems(e))),this.traversals.annotationPage)}traverseAnnotationBody(e){return Array.isArray(e.body)?e.body=e.body.map(t=>this.traverseContentResource(t)):e.body&&(e.body=this.traverseContentResource(e.body)),e}traversePosterCanvas(e){return e.posterCanvas&&(e.posterCanvas=this.traverseType(e.posterCanvas,this.traversals.canvas)),e.placeholderCanvas&&(e.placeholderCanvas=this.traverseType(e.placeholderCanvas,this.traversals.canvas)),e.accompanyingCanvas&&(e.accompanyingCanvas=this.traverseType(e.accompanyingCanvas,this.traversals.canvas)),e}traverseAnnotation(e){return this.traverseType(this.traverseLinking(this.traverseAnnotationBody(e)),this.traversals.annotation)}traverseContentResourceLinking(e){return typeof e=="string"||!e||e&&e.service&&(e.service=(e.service||[]).map(t=>this.traverseType(t,this.traversals.service))),e}traverseContentResource(e){return e.type==="Choice"&&(e.items=e.items.map(t=>this.traverseContentResource(t))),this.traverseType(this.traverseInlineAnnotationPages(this.traverseContentResourceLinking(e)),this.traversals.contentResource)}traverseRangeRanges(e){return e.items&&(e.items=e.items.map(t=>typeof t=="string"?this.traverseCanvas({id:t,type:"Canvas"}):t.type==="Manifest"?this.traverseManifest(t):this.traverseRange(t))),e}traverseRange(e){return this.traverseType(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseRangeRanges(e)))),this.traversals.range)}traverseAgent(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.agent)}traverseType(e,t){return t.reduce((i,r)=>{let n=r(i);return typeof n>"u"&&!this.options.allowUndefinedReturn?i:n},e)}traverseService(e){return this.traverseType(e,this.traversals.service)}traverseUnknown(e){let t=KE(e);switch(t){case"Collection":return this.traverseCollection(e);case"Manifest":return this.traverseManifest(e);case"Canvas":return this.traverseCanvas(e);case"AnnotationPage":return this.traverseAnnotationPage(e);case"Annotation":return this.traverseAnnotation(e);case"ContentResource":return this.traverseContentResource(e);case"Range":return this.traverseRange(e);case"Service":return this.traverseService(e);case"Agent":return this.traverseAgent(e);default:throw new Error(`Unknown or unsupported resource type of ${t}`)}}},zg=["sc:Collection","sc:Manifest","sc:Canvas","oa:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];function JE(e){if(typeof e>"u"||e===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(e))throw new Error("Array is not a valid entity");if(typeof e!="object")throw new Error(`${typeof e} is not a valid entity`);if(typeof e["@type"]=="string"){let t=zg.indexOf(e["@type"]);if(t!==-1)return zg[t]}if(e.profile)return"Service";if(e.format||e["@type"])return"ContentResource";throw new Error("Resource type is not known")}var Fg=class{constructor(e,t={}){Je(this,"traversals"),Je(this,"options"),this.traversals=C({collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[]},e),this.options=C({convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1},t)}static all(e){return new Fg({collection:[e],manifest:[e],canvas:[e],annotationList:[e],sequence:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],layer:[e]})}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(e))),this.traversals.collection)}traverseCollectionItems(e){if(this.options.mergeMemberProperties){let t=[...(e.manifests||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Manifest"}:i),...(e.collections||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Collection"}:i),...e.members||[]];delete e.collections,delete e.manifests,e.members=t}return e.manifests&&(e.manifests=e.manifests.map(t=>this.traverseManifest(typeof t=="string"?{"@id":t,"@type":"sc:Manifest"}:t))),e.collections&&(e.collections=e.collections.map(t=>this.traverseCollection(typeof t=="string"?{"@id":t,"@type":"sc:Collection"}:t))),e.members&&(e.members=e.members.map(t=>typeof t=="string"?t:this.traverseUnknown(t))),e}traverseManifest(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e))),this.traversals.manifest)}traverseManifestItems(e){return e.sequences&&(e.sequences=e.sequences.map(t=>this.traverseSequence(t))),e.structures&&(e.structures=e.structures.map(t=>this.traverseRange(t))),e}traverseSequence(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(e))),this.traversals.sequence)}traverseSequenceItems(e){return e.canvases&&(e.canvases=e.canvases.map(t=>this.traverseCanvas(t))),e}traverseCanvas(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))),this.traversals.canvas)}traverseCanvasItems(e){return e.images&&(e.images=e.images.map(t=>this.traverseAnnotation(t))),e.otherContent&&(e.otherContent=e.otherContent.map(t=>this.traverseAnnotationList(t))),e}traverseRange(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(e))),this.traversals.range)}traverseRangeItems(e){if(this.options.mergeMemberProperties){let t=[...(e.ranges||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Range"}:i),...(e.canvases||[]).map(i=>typeof i=="string"?{"@id":i,"@type":"sc:Canvas"}:i),...e.members||[]];delete e.ranges,delete e.canvases,e.members=t.length?t.map(i=>this.traverseUnknown(i)):void 0}return e}traverseAnnotationList(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationListItems(e))),this.traversals.annotationList)}traverseAnnotationListItems(e){return e.resources&&(e.resources=e.resources.map(t=>this.traverseAnnotation(t))),e}traverseAnnotation(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(e))),this.traversals.annotation)}traverseAnnotationItems(e){return e.resource&&(e.resource=this.traverseContentResource(e.resource)),e.on,e}traverseLayer(e){return this.traverseType(this.traverseLinking(this.traverseLayerItems(e)),this.traversals.layer)}traverseLayerItems(e){return e.otherContent&&(e.otherContent=e.otherContent.map(t=>this.traverseAnnotationList(t))),e}traverseChoice(e){return this.traverseType(this.traverseChoiceItems(e),this.traversals.choice)}traverseChoiceItems(e){return e.default&&e.default!=="rdf:nil"&&(e.default=this.traverseContentResource(e.default)),e.item&&e.item!=="rdf:nil"&&(e.item=e.item.map(t=>this.traverseContentResource(t))),e}traverseService(e){return this.traverseType(this.traverseLinking(e),this.traversals.service)}traverseContentResource(e){return e["@type"]==="oa:Choice"?this.traverseChoice(e):this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.contentResource)}traverseUnknown(e){if(!e["@type"]||typeof e=="string")return e;switch(JE(e)){case"sc:Collection":return this.traverseCollection(e);case"sc:Manifest":return this.traverseManifest(e);case"sc:Canvas":return this.traverseCanvas(e);case"sc:Sequence":return this.traverseSequence(e);case"sc:Range":return this.traverseRange(e);case"oa:Annotation":return this.traverseAnnotation(e);case"oa:AnnotationList":return this.traverseAnnotationList(e);case"sc:Layer":return this.traverseLayer(e);case"Service":return this.traverseService(e);case"oa:Choice":return this.traverseChoice(e);case"ContentResource":return this.traverseContentResource(e)}return e.profile?this.traverseService(e):e}traverseImageResource(e){let t=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let n of i)typeof n=="string"?r.push(this.traverseContentResource({"@id":n,"@type":"dctypes:Image"})):r.push(this.traverseContentResource(n));return!t&&!this.options.convertPropsToArray?r[0]:r}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=this.traverseImageResource(e.thumbnail)),e.logo&&(e.logo=this.traverseImageResource(e.logo)),e}traverseOneOrMoreServices(e){let t=Array.isArray(e),i=Array.isArray(e)?e:[e],r=[];for(let n of i)r.push(this.traverseService(n));return!t&&!this.options.convertPropsToArray?r[0]:r}traverseLinking(e){return e.related&&(e.related=this.traverseOneOrManyType(e.related,this.traversals.contentResource)),e.rendering&&(e.rendering=this.traverseOneOrManyType(e.rendering,this.traversals.contentResource)),e.service&&(e.service=this.traverseOneOrMoreServices(e.service)),e.seeAlso&&(e.seeAlso=this.traverseOneOrManyType(e.seeAlso,this.traversals.contentResource)),e.within&&(typeof e.within=="string"||(e.within=this.traverseOneOrManyType(e.within,this.traversals.contentResource))),e.startCanvas&&(typeof e.startCanvas=="string"?e.startCanvas=this.traverseType({"@id":e.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):e.startCanvas&&this.traverseType(e.startCanvas,this.traversals.canvas)),e.contentLayer&&(typeof e.contentLayer=="string"?e.contentLayer=this.traverseLayer({"@id":e.contentLayer,"@type":"sc:Layer"}):e.contentLayer=this.traverseLayer(e.contentLayer)),e}traverseOneOrManyType(e,t){if(!Array.isArray(e))if(this.options.convertPropsToArray)e=[e];else return this.traverseType(e,t);return e.map(i=>this.traverseType(i,t))}traverseType(e,t){return t.reduce((i,r)=>{let n=r(i);return typeof n>"u"&&!this.options.allowUndefinedReturn?i:n},e)}},eA="http://library.stanford.edu/iiif/image-api/compliance.html#level0",Bg="http://library.stanford.edu/iiif/image-api/compliance.html#level1",jg="http://library.stanford.edu/iiif/image-api/compliance.html#level2",tA="http://library.stanford.edu/iiif/image-api/conformance.html#level0",Ug="http://library.stanford.edu/iiif/image-api/conformance.html#level1",Dg="http://library.stanford.edu/iiif/image-api/conformance.html#level2",iA="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",Wg="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",Hg="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",rA="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",qg="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",Qg="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",nA="http://iiif.io/api/image/1/level0.json",sA="http://iiif.io/api/image/1/profiles/level0.json",Vg="http://iiif.io/api/image/1/level1.json",Gg="http://iiif.io/api/image/1/profiles/level1.json",Zg="http://iiif.io/api/image/1/level2.json",Yg="http://iiif.io/api/image/1/profiles/level2.json",aA="http://iiif.io/api/image/2/level0.json",oA="http://iiif.io/api/image/2/profiles/level0.json",Xg="http://iiif.io/api/image/2/level1.json",Kg="http://iiif.io/api/image/2/profiles/level1.json",Jg="http://iiif.io/api/image/2/level2.json",em="http://iiif.io/api/image/2/profiles/level2.json",lA="level0",tm="level1",im="level2",uA="http://iiif.io/api/image/2/level0",rm="http://iiif.io/api/image/2/level1",nm="http://iiif.io/api/image/2/level2",hA=[rm,nm,Bg,jg,Ug,Dg,Wg,Hg,qg,Qg,Vg,Gg,Zg,Yg,Xg,Kg,Jg,em,tm,im],cA=[uA,rm,nm,eA,Bg,jg,tA,Ug,Dg,iA,Wg,Hg,rA,qg,Qg,nA,sA,Vg,Gg,Zg,Yg,aA,oA,Xg,Kg,Jg,em,lA,tm,im],Fh={attributionLabel:"Attribution",providerId:"http://example.org/provider",providerName:"Unknown"};function Wn(e,t="none"){if(!e)return{};let i=Array.isArray(e)?e:[e],r={};for(let n of i){if(typeof n=="string"){r[t]=r[t]?r[t]:[],r[t].push(n||"");continue}if(!n["@language"]){r[t]=r[t]?r[t]:[],r[t].push(n["@value"]||"");continue}let a=n["@language"];r[a]=r[a]?r[a]:[],r[a].push(n["@value"]||"")}return r}function sm(e){if(Array.isArray(e))return sm(e.find(t=>typeof t=="string"));if(cA.indexOf(e)!==-1)return"level2";if(hA.indexOf(e)!==-1)return"level1";if(typeof e=="string")return e}function dA(e){let t=Array.isArray(e)?e:[e];for(let i of t)switch(i){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}function fA(e){switch(e){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}function pA(e){return Array.isArray(e)?e:[e]}function gA(e){for(let t of["sc","oa","dcterms","dctypes","iiif"])if(e.startsWith(`${t}:`))return e.slice(t.length+1);return e}var mA=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function Bh(e){let t=e["@id"]||e.id,i=e["@type"]||e.type,r=e.profile||void 0,n=e["@context"]||void 0;if(r){let a=fA(r);if(a)return a}if(n){let a=dA(n);if(a)return a}if(i){if(Array.isArray(i)){if(i.indexOf("oa:CssStylesheet")!==-1)return"CssStylesheet";if(i.indexOf("cnt:ContentAsText")!==-1)return"TextualBody";i=i[0]}for(let a of["sc","oa","dcterms","dctypes","iiif"])if(i.startsWith(`${a}:`)){i=i.slice(a.length+1);break}switch(i){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(i&&mA.indexOf(i)!==-1)return i;if(e.format){if(e.format.startsWith("image/"))return"Image";if(e.format.startsWith("text/")||e.format==="application/pdf")return"Text";if(e.format.startsWith("application/"))return"Dataset"}return t&&(t.endsWith(".jpg")||t.endsWith(".png")||t.endsWith(".jpeg"))?"Image":i||"unknown"}var yA=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm;function vA(e){let t=e.match(yA);return t?t[0]:e}function bA(e,t="Rights/License",i="none"){let r=null,n=[],a=Array.isArray(e)?e:[e];for(let l of a){let u=l?vA(l):void 0;if(u&&(u.indexOf("creativecommons.org")!==-1||u.indexOf("rightsstatements.org")!==-1)){u.startsWith("https://")?r=`http://${u.slice(8)}`:r=u;continue}u&&n.push({label:{[i]:[t]},value:{[i]:[u]}})}return[r,n]}var wA=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function xA(e){if(e){let t=Array.isArray(e)?e:[e],i=[];for(let r of t)r==="http://iiif.io/api/presentation/2/context.json"&&i.push("http://iiif.io/api/presentation/3/context.json"),wA.indexOf(r)===-1&&i.push(r);if(t.length)return i.length===1?i[0]:i}}function _A(e){return e?e.map(t=>({label:Wn(t.label),value:Wn(t.value)})):[]}function Wr(e){for(let t in e)(typeof e[t]>"u"||e[t]===null)&&delete e[t];return e}var am=0;function om(e,t){let i=encodeURI(e.id||e["@id"]||"").trim();return i&&t?`${i}/${t}`:i||(am++,`http://example.org/${e["@type"]}${t?`/${t}`:""}/${am}`)}function Hr(e){let t=[...e.behavior||[]];return e.viewingHint&&t.push(e.viewingHint),{"@context":e["@context"]?xA(e["@context"]):void 0,id:(e["@id"]||om(e)).trim(),type:Bh(e),behavior:t.length?t:void 0,height:e.height?e.height:void 0,width:e.width?e.width:void 0,motivation:e.motivation?gA(e.motivation):void 0,viewingDirection:e.viewingDirection,profile:e.profile,format:e.format?e.format:void 0,duration:void 0,timeMode:void 0}}function Er(e){let[t,i]=bA(e.license),r=[...e.metadata?_A(e.metadata):[],...i];return{rights:t,metadata:r.length?r:void 0,label:e.label?Wn(e.label):void 0,requiredStatement:e.attribution?{label:Wn(Fh.attributionLabel),value:Wn(e.attribution)}:void 0,navDate:e.navDate,summary:e.description?Wn(e.description):void 0,thumbnail:e.thumbnail}}function SA(e){if(!e.within)return;let t=Array.isArray(e.within)?e.within:[e.within],i=[];for(let r of t)if(typeof r=="string"){if(r)switch(e["@type"]){case"sc:Manifest":i.push({id:r,type:"Collection"});break}}else r["@id"]&&i.push({id:r["@id"],type:Bh(r)});return i.length?i:void 0}function un(e){let t=e.related?Array.isArray(e.related)?e.related:[e.related]:[],i=e.contentLayer;return{provider:e.logo||t.length?[{id:Fh.providerId,type:"Agent",homepage:t.length?[t[0]]:void 0,logo:e.logo?Array.isArray(e.logo)?e.logo:[e.logo]:void 0,label:Wn(Fh.providerName)}]:void 0,partOf:SA(e),rendering:e.rendering,seeAlso:e.seeAlso,start:e.startCanvas,service:e.service?pA(e.service):void 0,supplementary:i?[i]:void 0}}function EA(e){return Wr(W(C(C(C({},Hr(e)),Er(e)),un(e)),{items:e.members}))}function AA(e){let t=[],i=[];for(let n of e.sequences||[])n.canvases.length&&t.push(...n.canvases),n.behavior&&i.push(...n.behavior);let r=Hr(e);return i.length&&(r.behavior?r.behavior.push(...i):r.behavior=i),Wr(W(C(C(C({},r),Er(e)),un(e)),{items:t,structures:e.structures}))}function kA(e){return Wr(W(C(C(C({},Hr(e)),Er(e)),un(e)),{items:e.images&&e.images.length?[{id:om(e,"annotation-page"),type:"AnnotationPage",items:e.images}]:void 0}))}function PA(e){return Wr(W(C(C(C({},Hr(e)),Er(e)),un(e)),{items:e.resources}))}function CA(e){return!e.canvases||e.canvases.length===0?{canvases:[],behavior:[]}:{canvases:e.canvases,behavior:e.viewingHint?[e.viewingHint]:[]}}function TA(e){return Wr(W(C(C(C({},Hr(e)),Er(e)),un(e)),{target:typeof e.on=="string"?encodeURI(e.on).trim():e.on,body:e.resource}))}function IA(e){let t=e;return Wr(C(C(C({},Hr(t)),Er(t)),un(t)))}function RA(e){let t=[];return e.default&&e.default!=="rdf:nil"&&t.push(e.default),e.item&&e.item!=="rdf:nil"&&t.push(...e.item),W(C(C({},Hr(e)),Er(e)),{items:t})}function OA(e){return Wr(W(C(C(C({},Hr(e)),Er(e)),un(e)),{items:e.members}))}function MA(e){let t=e,{"@id":i,"@type":r,"@context":n,profile:a}=t,l=le(t,["@id","@type","@context","profile"]);return i&&(l.id=i),l.type=Bh(e),l.type==="unknown"&&(l.type="Service"),a&&(l.profile=sm(a)),Wr(C(C({},l),Er(l)))}function LA(e){return Wr(C(C(C({},Hr(e)),Er(e)),un(e)))}var $A=new Fg({collection:[EA],manifest:[AA],canvas:[kA],annotationList:[PA],sequence:[CA],annotation:[TA],contentResource:[IA],choice:[RA],range:[OA],service:[MA],layer:[LA]});function NA(e){return e&&e["@context"]&&(e["@context"]==="http://iiif.io/api/presentation/2/context.json"||e["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")!==-1||e["@context"]==="http://www.shared-canvas.org/ns/context.json")||e["@context"]==="http://iiif.io/api/image/2/context.json"?$A.traverseUnknown(e):e}function zA(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}function lm(e,t){if(typeof e=="string")return{id:e,type:t};if(!e.id)throw new Error(`Invalid resource does not have an ID (${t})`);return e}function FA(e){return(t,i)=>{let r=e[t]?e[t]:{};return n=>{let a=lm(n,i||t);return a&&a.id&&t?(r[a.id]=r[a.id]?Object.assign({},r[a.id],a):Object.assign({},a),{id:a.id,type:t==="ContentResource"?t:a.type}):a}}}function BA(e){return(t,i)=>r=>{let{id:n,type:a}=lm(r,i||t);if(typeof n>"u")throw new Error("Found invalid entity without an ID.");return t==="ContentResource"?e[n]=t:e[n]=a,r}}function jA(e){let t=JSON.stringify(e),i=5381,r=t.length;for(;r;)i=i*33^t.charCodeAt(--r);let n=(i>>>0).toString(16);return n.length%2?"0"+n:n}function jh(e){return t=>typeof t=="string"?{id:t,type:e}:t.id?t.type?t:C({type:e},t):C({id:jA(t),type:e},t)}function Fs(e){return t=>C(C({},e),t)}function Bs(e){return Array.isArray(e)?e:[e]}function UA(e){return e.body&&(e.body=Bs(e.body)),e.seeAlso&&(e.seeAlso=Bs(e.seeAlso)),e.body&&(e.body=Bs(e.body)),e.audience&&(e.audience=Bs(e.audience)),e.accessibility&&(e.accessibility=Bs(e.accessibility)),e.motivation&&(e.motivation=Bs(e.motivation)),e}function um(e){let t=NA(e),i=zA(),r={},n=FA(i),a=BA(r),l=new Ng({collection:[Fs(GE),a("Collection"),n("Collection")],manifest:[Fs(ZE),a("Manifest"),n("Manifest")],canvas:[Fs(VE),a("Canvas"),n("Canvas")],annotationPage:[jh("AnnotationPage"),Fs(QE),a("AnnotationPage"),n("AnnotationPage")],annotation:[jh("Annotation"),UA,a("Annotation"),n("Annotation")],contentResource:[jh("ContentResource"),a("ContentResource"),n("ContentResource")],range:[Fs(YE),a("Range","Canvas"),n("Range","Canvas")],agent:[Fs(XE),a("Agent"),n("Agent")]}).traverseUnknown(t);return{entities:i,resource:l,mapping:r}}var Hn="__$UNSET$__",hm="__$UNWRAP$__";function DA(e,t){let i=e.requests[t],r=e.mapping[t];if(!(!r||i&&i.resourceUri&&!e.entities[r][i.resourceUri]))return e.entities[r][i?i.resourceUri:t]}function WA(e){let t={};for(let[i,r]of e){if(i===hm&&r!==Hn)return r;r!==Hn&&typeof r<"u"&&r!==null&&(t[i]=r)}return t}function cm(e,t,i){if(!t.type||!t.id)throw new Error("Unknown entity");if(!i[t.type])throw new Error(`Serializer not found for ${t.type}`);function r(n){let a=i[n.type];if(!a)return Hn;let l=DA(e,n.id)||(n.id&&n.type?n:null);if(!l)return Hn;let u=a(l,e,{isTopLevel:t.id===n.id}),c=u.next();for(;!c.done;){let d=c.value,p=Hn;if(d)if(Array.isArray(d)){let y=[];for(let x of d)y.push(r(x));p=y}else p=r(d);c=u.next(p)}return c.value===Hn?Hn:WA(c.value)}return r(t)}function js(e){if(!e)return;let t=Object.keys(e);if(t.length!==0){if(t.length===1){let i=t[0];if(!i)return"";let r=(e[i]||[]).join("");return i==="@none"||i==="none"||i==="en"?r:{"@language":i,"@value":r}}return t.map(i=>({"@language":i,"@value":(e[i]||[]).join("")}))}}function dm(e){return Array.isArray(e)?e.map(t=>dm(t)):typeof e=="string"?e:e.type&&e.type==="Canvas"?e.id:e}function hn(e,t=!1){if(e)return e.length>1&&!t?e:e[0]||void 0}function HA(e){if(e){if(typeof e=="string")return{"@id":e};if("@id"in e){let t=C({},e);return delete t["@type"],t}return{"@context":"http://iiif.io/api/image/2/context.json","@id":e.id,profile:`http://iiif.io/api/image/2/profiles/${e.profile}.json`}}}function qn(e,t){return[["@id",e.id],["@type",t],["format",e.format],["height",e.height],["width",e.width],["viewingDirection",e.viewingDirection!=="left-to-right"?e.viewingDirection:void 0]]}function*Qn(e){let t=e.provider?yield e.provider[0]:void 0;return[["label",js(e.label)],["metadata",e.metadata&&e.metadata.length?e.metadata.map(i=>({label:js(i.label)||"",value:js(i.value)||""})):void 0],["description",js(e.summary)],["thumbnail",hn(yield e.thumbnail)],["navDate",e.navDate],["logo",t?hn(t.logo):void 0],["homepage",t?t.homepage:void 0],["attribution",e.requiredStatement?js(e.requiredStatement.value):void 0]]}function*Pa(e){return[["seeAlso",hn(yield e.seeAlso)],["service",hn((e.service||[]).map(HA))],["rendering",hn(yield e.rendering)],["startCanvas",e.start?e.start.id:void 0]]}var fm={Manifest:function*(e){return[...qn(e,"sc:Manifest"),...yield*Qn(e),...yield*Pa(e),["sequences",[{"@id":`${e.id}/sequence0`,"@type":"sc:Sequence",canvases:yield e.items}]],["structures",yield e.structures]]},Canvas:function*(e){let t=(yield e.items)[0];return[...qn(e,"sc:Canvas"),...yield*Qn(e),...yield*Pa(e),["images",t?[t.resources]:void 0],["annotations",e.annotations&&e.annotations.length?hn(yield e.annotations):void 0]]},AnnotationPage:function*(e){return[...qn(e,"sc:AnnotationList"),...yield*Qn(e),["resources",e.items&&e.items.length?hn(yield e.items):void 0]]},Annotation:function*(e){return[["@id",e.id],["@type","oa:Annotation"],["motivation","sc:painting"],["on",dm(e.target)],["resource",hn(yield e.body,!0)]]},ContentResource:function*(e){switch(e.type){case"Image":return[...qn(e,"dctypes:Image"),...yield*Qn(e),...yield*Pa(e)];case"Text":case"Dataset":default:return[...qn(e,void 0),...yield*Qn(e)]}},AnnotationCollection:function*(e){return[["@id",e.id],["@type","sc:Layer"],["label",js(e.label)]]},Collection:function*(e){return[...qn(e,"sc:Collection"),...yield*Qn(e),...yield*Pa(e),["members",yield*e.items]]},Range:function*(e){let t=[],i=[];if(e.items)for(let r of e.items){let n=yield r;t.push({"@id":r.id,"@type":r.type,label:n?n.label:void 0,within:e.id}),r.type==="Canvas"&&i.push(r.id)}return[...qn(e,"sc:Range"),...yield*Qn(e),...yield*Pa(e),["canvases",i.length===t.length?i:void 0],["members",i.length!==t.length?t:void 0]]}};function Vn(e){return[["id",e.id],["type",e.type],["format",e.format],["profile",e.profile],["height",e.height],["width",e.width],["duration",e.duration||void 0],["viewingDirection",e.viewingDirection!=="left-to-right"?e.viewingDirection:void 0],["behavior",e.behavior&&e.behavior.length?e.behavior:void 0],["timeMode",e.timeMode],["motivation",e.motivation]]}function di(e){if(!(!e||e.length===0))return e}function pm(e){if(e&&e.type&&e.type==="ImageService2"){let t=e,{id:i,type:r,profile:n}=t,a=le(t,["id","type","profile"]);return C({"@id":i,"@type":r,profile:n.startsWith("http")?n:`http://iiif.io/api/image/2/${n}.json`},a)}return e}function gm(e){if(!(!e||e.length===0))return e.map(pm)}function*Gn(e){return[["label",e.label],["metadata",di(e.metadata)],["summary",e.summary],["requiredStatement",e.requiredStatement],["rights",e.rights],["navDate",e.navDate],["language",e.language],["thumbnail",di(yield e.thumbnail)],["placeholderCanvas",yield e.placeholderCanvas],["accompanyingCanvas",yield e.accompanyingCanvas],["provider",di(yield e.provider)]]}function*Zn(e){return[["seeAlso",di(yield e.seeAlso)],["service",gm(e.service)],["services",gm(e.services)],["rendering",di(yield e.rendering)],["supplementary",di(yield e.supplementary)],["homepage",di(yield e.homepage)],["logo",di(yield e.logo)],["partOf",di(yield e.partOf)],["start",e.start]]}var mm={Manifest:function*(e,t,{isTopLevel:i}){return i?[["@context","http://iiif.io/api/presentation/3/context.json"],...Vn(e),...yield*Gn(e),...yield*Zn(e),["items",yield e.items],["structures",di(yield e.structures)],["annotations",di(yield e.annotations)]]:[...Vn(e),...yield*Gn(e)]},Canvas:function*(e){return[...Vn(e),...yield*Gn(e),...yield*Zn(e),["items",yield e.items],["annotations",di(yield e.annotations)]]},Agent:function*(e){return[["id",e.id],["type","Agent"],["label",e.label],...yield*Zn(e)]},AnnotationPage:function*(e){return[...Object.entries(e).map(([t,i])=>[t,Array.isArray(i)?di(i):i]).filter(([t,i])=>t!=="items"),...yield*Zn(e),["items",yield e.items]]},Service:function*(e){return[[hm,pm(e)]]},Annotation:function*(e){return[...Object.entries(e).map(([t,i])=>[t,Array.isArray(i)?di(i):i]).filter(([t])=>t!=="body"),["body",yield e.body]]},ContentResource:function*(e){return[...Vn(e),...yield*Gn(e),...yield*Zn(e),["annotations",di(yield e.annotations)]]},AnnotationCollection:function*(e){return[["id",e.id],["type","AnnotationCollection"],["label",e.label]]},Collection:function*(e,t,{isTopLevel:i}){return i?[["@context","http://iiif.io/api/presentation/3/context.json"],...Vn(e),...yield*Gn(e),...yield*Zn(e),["items",di(yield e.items)]]:[...Vn(e),...yield*Gn(e)]},Range:function*(e){let t=[];for(let i of e.items)i.type==="Range"?t.push(yield i):t.push(i);return[...Vn(e),...yield*Gn(e),...yield*Zn(e),["items",t],["annotations",di(yield e.annotations)]]}},fi=Ue(yh(),1);function qA(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ym(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function vm(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?ym(Object(i),!0).forEach(function(r){qA(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ym(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function Si(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var bm=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),Uh=function(){return Math.random().toString(36).substring(7).split("").join(".")},Xo={INIT:"@@redux/INIT"+Uh(),REPLACE:"@@redux/REPLACE"+Uh(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Uh()}};function QA(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Dh(e,t,i){var r;if(typeof t=="function"&&typeof i=="function"||typeof i=="function"&&typeof arguments[3]=="function")throw new Error(Si(0));if(typeof t=="function"&&typeof i>"u"&&(i=t,t=void 0),typeof i<"u"){if(typeof i!="function")throw new Error(Si(1));return i(Dh)(e,t)}if(typeof e!="function")throw new Error(Si(2));var n=e,a=t,l=[],u=l,c=!1;function d(){u===l&&(u=l.slice())}function p(){if(c)throw new Error(Si(3));return a}function y(k){if(typeof k!="function")throw new Error(Si(4));if(c)throw new Error(Si(5));var T=!0;return d(),u.push(k),function(){if(T){if(c)throw new Error(Si(6));T=!1,d();var R=u.indexOf(k);u.splice(R,1),l=null}}}function x(k){if(!QA(k))throw new Error(Si(7));if(typeof k.type>"u")throw new Error(Si(8));if(c)throw new Error(Si(9));try{c=!0,a=n(a,k)}finally{c=!1}for(var T=l=u,R=0;R<T.length;R++){var A=T[R];A()}return k}function E(k){if(typeof k!="function")throw new Error(Si(10));n=k,x({type:Xo.REPLACE})}function S(){var k,T=y;return k={subscribe:function(R){if(typeof R!="object"||R===null)throw new Error(Si(11));function A(){R.next&&R.next(p())}A();var $=T(A);return{unsubscribe:$}}},k[bm]=function(){return this},k}return x({type:Xo.INIT}),r={dispatch:x,subscribe:y,getState:p,replaceReducer:E},r[bm]=S,r}function VA(e){Object.keys(e).forEach(function(t){var i=e[t],r=i(void 0,{type:Xo.INIT});if(typeof r>"u")throw new Error(Si(12));if(typeof i(void 0,{type:Xo.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Si(13))})}function Ko(e){for(var t=Object.keys(e),i={},r=0;r<t.length;r++){var n=t[r];typeof e[n]=="function"&&(i[n]=e[n])}var a=Object.keys(i),l;try{VA(i)}catch(u){l=u}return function(u,c){if(u===void 0&&(u={}),l)throw l;for(var d=!1,p={},y=0;y<a.length;y++){var x=a[y],E=i[x],S=u[x],k=E(S,c);if(typeof k>"u")throw c&&c.type,new Error(Si(14));p[x]=k,d=d||k!==S}return d=d||a.length!==Object.keys(u).length,d?p:u}}function Yn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.length===0?function(r){return r}:t.length===1?t[0]:t.reduce(function(r,n){return function(){return r(n.apply(void 0,arguments))}})}function Jo(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(r){return function(){var n=r.apply(void 0,arguments),a=function(){throw new Error(Si(15))},l={getState:n.getState,dispatch:function(){return a.apply(void 0,arguments)}},u=t.map(function(c){return c(l)});return a=Yn.apply(void 0,u)(n.dispatch),vm(vm({},n),{},{dispatch:a})}}}var wm="@iiif/IMPORT_ENTITIES",xm="@iiif/MODIFY_ENTITY_FIELD",_m="@iiif/REORDER_ENTITY_FIELD",Sm="@iiif/ADD_REFERENCE",Em="@iiif/REMOVE_REFERENCE",Am=(0,fi.createAction)(wm)(),GA=(0,fi.createAction)(xm)(),ZA=(0,fi.createAction)(_m)(),YA=(0,fi.createAction)(Sm)(),XA=(0,fi.createAction)(Em)(),KA={importEntities:Am,modifyEntityField:GA,reorderEntityField:ZA,addReference:YA,removeReference:XA},km="@iiif/ADD_MAPPING",Pm="@iiif/ADD_MAPPINGS",JA=(0,fi.createAction)(km)(),ek=(0,fi.createAction)(Pm)(),Cm="@iiif/SET_META_VALUE",Tm="@iiif/SET_META_VALUE_DYNAMIC",Im="@iiif/UNSET_META_VALUE",tk=(0,fi.createAction)(Cm)(),ik=(0,fi.createAction)(Tm)(),rk=(0,fi.createAction)(Im)(),Rm={setMetaValue:tk,setMetaValueDynamic:ik,unsetMetaValue:rk},Wh="RESOURCE_ERROR",Om="RESOURCE_LOADING",Hh="RESOURCE_READY",Mm="@iiif/REQUEST_RESOURCE",Lm="@iiif/REQUEST_ERROR",$m="@iiif/REQUEST_MISMATCH",Nm="@iiif/REQUEST_COMPLETE",zm="@iiif/REQUEST_OFFLINE_RESOURCE",nk=(0,fi.createAction)(Mm)(),Fm=(0,fi.createAction)(Lm)(),sk=(0,fi.createAction)($m)(),ak=(0,fi.createAction)(Nm)();(0,fi.createAction)(zm)();var qh="@iiif/BATCH",Bm="@iiif/BATCH_IMPORT",Qh=(0,fi.createAction)(qh)();(0,fi.createAction)(Bm)();var ok=(e,t)=>{let{entities:i,resource:r,mapping:n}=um(t);if(r.id===void 0)return[Fm({id:e,message:"ID is not defined in resource."})];let a=[Am({entities:i}),ek({mapping:n})];return r.id!==e&&(a.push(JA({id:e,type:r.type})),a.push(sk({requestId:e,actualId:r.id}))),a.push(ak({id:e})),a},jm=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function lk(e,t){return!!(e===t||jm(e)&&jm(t))}function Um(e,t){if(!Array.isArray(e)||!Array.isArray(t))return e===t;if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!lk(e[i],t[i]))return!1;return!0}function Vh(e,t){let i=e.iiif.requests[t],r=e.iiif.mapping[t];if(!(!r||!e.iiif.entities[r][i.resourceUri]))return e.iiif.entities[r][i.resourceUri]}function Dm(e,t,{waitTimeout:i=30}={}){return async(r,n)=>{let a=e.getState(),l=a.iiif.requests[r];if(l)switch(l.loadingState){case Wh:break;case Om:{let u,c=!1;try{let d=await Promise.race([new Promise((p,y)=>{c||(u=e.subscribe(()=>{let x=e.getState();if(x.iiif.requests[r].loadingState===Wh){y();return}if(x.iiif.requests[r].loadingState===Hh){let E=Vh(x,r);E?p(E):y()}}))}),new Promise((p,y)=>setTimeout(()=>{c=!0,y()},i*60))]);if(u&&u(),d)return d}catch{u&&u();break}break}case Hh:{let u=Vh(a,r);if(u)return u;break}}e.dispatch(nk({id:r}));try{let u=await t(r,n);!u.id&&!u["@id"]&&(u["@type"]&&(u["@id"]=r),u.id=r);let c=ok(r,u);return e.dispatch(Qh({actions:c})),Vh(e.getState(),r)}catch(u){throw e.dispatch(Fm({id:r,message:u.toString()})),u}}}function uk(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}var hk=(e={},t)=>{switch(t.type){case km:return W(C({},e),{[t.payload.id]:t.payload.type});case Pm:return C(C({},e),t.payload.mapping);default:return e}};function Gh(e,t,i,r){return!(!e[i]||!e[i][t]||!e[i][t][r]||!Array.isArray(e[i][t][r]))}var ck=(e=uk(),t)=>{var i;switch(t.type){case xm:{if(!e[t.payload.type]||!e[t.payload.type][t.payload.id])return e;let r=e[t.payload.type][t.payload.id];return typeof r=="string"?e:W(C({},e),{[t.payload.type]:W(C({},e[t.payload.type]),{[t.payload.id]:W(C({},r),{[t.payload.key]:t.payload.value})})})}case _m:{if(!Gh(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id];if(typeof r=="string")return e;let n=Array.from(r[t.payload.key]),[a]=n.splice(t.payload.startIndex,1);return n.splice(t.payload.endIndex,0,a),W(C({},e),{[t.payload.type]:W(C({},e[t.payload.type]),{[t.payload.id]:W(C({},r),{[t.payload.key]:n})})})}case wm:{let r=Object.keys(t.payload.entities),n=C({},e);for(let a of r)n[a]=C(C({},e[a]||{}),t.payload.entities[a]||{});return n}case Sm:{if(!Gh(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id],n=Array.from(r[t.payload.key]);return n.splice(t.payload.index||n.length+1,0,t.payload.reference),W(C({},e),{[t.payload.type]:W(C({},e[t.payload.type]),{[t.payload.id]:W(C({},r),{[t.payload.key]:n})})})}case Em:{if(!Gh(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id],n=Array.from(r[t.payload.key]),a=t.payload.index||n.findIndex(l=>l&&l.id===t.payload.reference.id);return a===-1||((i=n[a])==null?void 0:i.id)!==t.payload.reference.id?e:(n.splice(a,1),W(C({},e),{[t.payload.type]:W(C({},e[t.payload.type]),{[t.payload.id]:W(C({},r),{[t.payload.key]:n})})}))}default:return e}},dk=(e={},t)=>{switch(t.type){case Mm:case zm:return W(C({},e),{[t.payload.id]:{requestUri:t.payload.id,loadingState:Om,uriMismatch:!1,resourceUri:t.payload.id}});case $m:return W(C({},e),{[t.payload.requestId]:W(C({},e[t.payload.requestId]||{}),{uriMismatch:!0,resourceUri:t.payload.actualId}),[t.payload.actualId]:{requestUri:t.payload.requestId,loadingState:e[t.payload.requestId].loadingState,uriMismatch:!0,resourceUri:t.payload.actualId}});case Lm:return W(C({},e),{[t.payload.id]:W(C({},e[t.payload.id]||{}),{loadingState:Wh,error:t.payload.message})});case Nm:return W(C({},e),{[t.payload.id]:W(C({},e[t.payload.id]||{}),{loadingState:Hh,error:void 0})})}return e},fk=(e={},t)=>{let{id:i,updateValue:r,value:n,meta:a,key:l}=t&&t.payload||{};switch(t.type){case Cm:return W(C({},e),{[i]:W(C({},e[i]||{}),{[a]:W(C({},e[i]?e[i][a]||{}:{}),{[l]:n})})});case Tm:return W(C({},e),{[i]:W(C({},e[i]||{}),{[a]:W(C({},e[i]?e[i][a]||{}:{}),{[l]:e[i]&&e[i][a]?r(e[i][a][l]):r(void 0)})})});case Im:return e[i]&&e[i][a]&&e[i][a][l]?W(C({},e),{[i]:W(C({},e[i]||{}),{[a]:W(C({},e[i]?e[i][a]||{}:{}),{[l]:void 0})})}):e;default:return e}};function pk(e){return(t,i)=>i&&i.type===qh?i.payload.actions.reduce(e,t):i&&i.type===Bm?i.payload.state:e(t,i)}var gk=Ko({mapping:hk,entities:ck,requests:dk,meta:fk}),mk=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Yn;function yk(e={}){let{enableDevtools:t=!0,iiifStoreName:i="iiif",defaultState:r={},extraMiddleware:n=[],customReducers:a={}}=e,l=Ko(C({[i]:gk},a));return Dh(pk(l),r,t?mk(Jo(...n)):Yn(Jo(...n)))}function vk(e){return{all:e=e||new Map,on:function(t,i){var r=e.get(t);r?r.push(i):e.set(t,[i])},off:function(t,i){var r=e.get(t);r&&(i?r.splice(r.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var r=e.get(t);r&&r.slice().map(function(n){n(i)}),(r=e.get("*"))&&r.slice().map(function(n){n(t,i)})}}}var Zh=class{constructor(e,t){Je(this,"options"),Je(this,"store"),Je(this,"emitter"),Je(this,"isBatching",!1),Je(this,"batchQueue",[]),Je(this,"remoteFetcher"),Je(this,"staticFetcher"),Je(this,"defaultFetcher",i=>fetch(i).then(r=>r.json())),Je(this,"middleware",i=>r=>n=>{if(n.type===qh){for(let u of n.payload.actions)this.emitter.emit(u.type,{realAction:u,state:i.getState()});let l=r(n);for(let u of n.payload.actions)this.emitter.emit(`after:${n.type}`,{action:n,state:l});return l}this.emitter.emit(n.type,{action:n,state:i.getState()});let a=r(n);return this.emitter.emit(`after:${n.type}`,{action:n,state:a}),a}),this.options=Object.assign({reducers:{},middleware:[],defaultState:{},customFetcher:this.defaultFetcher,enableDevtools:!0},e||{}),this.store=t||yk({customReducers:this.options.reducers,extraMiddleware:[...this.options.middleware,this.middleware],defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=vk(),this.remoteFetcher=Dm(this.store,this.options.customFetcher),this.staticFetcher=Dm(this.store,(i,r)=>r)}batch(e){this.isBatching=!0;try{e(this),this.store.dispatch(Qh({actions:this.batchQueue}))}catch(t){throw this.batchQueue=[],this.isBatching=!1,t}this.batchQueue=[],this.isBatching=!1}async asyncBatch(e){this.isBatching=!0;try{await e(this),this.store.dispatch(Qh({actions:this.batchQueue}))}catch(t){throw this.batchQueue=[],this.isBatching=!1,t}this.batchQueue=[],this.isBatching=!1}modifyEntityField(e,t,i){this.dispatch(KA.modifyEntityField({id:e.id,type:e.type,key:t,value:i}))}dispatch(e){this.isBatching?this.batchQueue.push(e):this.store.dispatch(e)}serialize(e,t){return cm(this.getState().iiif,e,t)}toPresentation2(e){return this.serialize(e,fm)}toPresentation3(e){return this.serialize(e,mm)}hydrate(e,t){return this.get(e,t,{skipSelfReturn:!1})}get(e,t,i={}){typeof t!="string"&&(i=t||{},t=void 0);let{skipSelfReturn:r=!0}=i||{};if(Array.isArray(e))return e.map(c=>this.get(c,i));let n=this.getState();if(typeof e=="string"){let c=t||n.iiif.mapping[e];if(!c)return r?null:{id:e,type:"unknown"};e={id:e,type:c}}let a=t||e.type,l=e.id,u=n.iiif.entities[a];if(!u){let c=n.iiif.requests[l];return c&&c.resourceUri!==l?this.get(c.resourceUri,i):r?null:e}return u[e.id]||(r?null:e)}select(e){return e(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}loadManifest(e,t){let i=typeof e=="string"?e:e.id;return this.load(i,t)}loadCollection(e,t){let i=typeof e=="string"?e:e.id;return this.load(i,t)}load(e,t){let i=typeof e=="string"?e:e.id;return t?this.staticFetcher(i,t):this.remoteFetcher(i)}areInputsEqual(e,t){return Um(e,t)}subscribe(e,t,i){typeof i>"u"&&(typeof t>"u"||t===!1||t===!0)&&(i=t,t=e,e=n=>n);let r=i?null:e(this.store.getState());return i||t(r,this),this.store.subscribe(()=>{let n=this.store.getState(),a=e(n);Um(r,a)||t(a,this),r=a})}async ensureLoaded(e){let t=typeof e=="string"?e:e.id;this.requestStatus(t)||await this.load(t)}requestStatus(e){return this.select(t=>t.iiif.requests[e])}getResourceMeta(e,t){let i=this.getState().iiif.meta[e];if(i)return t?i[t]:i}setMetaValue([e,t,i],r){this.dispatch(typeof r=="function"?Rm.setMetaValueDynamic({id:e,meta:t,key:i,updateValue:r}):Rm.setMetaValue({id:e,meta:t,key:i,value:r}))}};function bk(){return typeof self<"u"?self:typeof window<"u"?window:typeof $u<"u"?$u:{}}function Wm(e){let t=bk();try{let r=t.IIIF_VAULT;if(r)return r}catch{}let i=new Zh(e);try{t.IIIF_VAULT=i}catch{}return i}var pi=Ue(yh(),1);Ue(mh(),1);var wk=Object.defineProperty,xk=Object.defineProperties,_k=Object.getOwnPropertyDescriptors,Hm=Object.getOwnPropertySymbols,Sk=Object.prototype.hasOwnProperty,Ek=Object.prototype.propertyIsEnumerable,qm=(e,t,i)=>t in e?wk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Qm=(e,t)=>{for(var i in t||(t={}))Sk.call(t,i)&&qm(e,i,t[i]);if(Hm)for(var i of Hm(t))Ek.call(t,i)&&qm(e,i,t[i]);return e},Vm=(e,t)=>xk(e,_k(t)),Ak=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,kk=/&?(t=)(npt:)?([0-9]+(.[0-9]+)?)?(,([0-9]+(.[0-9]+)?))?/;function Yh(e){if(Array.isArray(e))return e.reduce((t,i)=>{let{selector:r,selectors:n}=Yh(i);return r&&(t.selector||(t.selector=r),t.selectors.push(...n)),t},{selector:null,selectors:[]});if(!e)return{selector:null,selectors:[]};if(typeof e=="string"){let[t,i]=e.split("#");return i?Yh({type:"FragmentSelector",value:i}):{selector:null,selectors:[]}}if(e.type==="PointSelector"&&(e.t||e.t===0)){let t={type:"TemporalSelector",temporal:{startTime:e.t}};return{selector:t,selectors:[t]}}if(e.type==="FragmentSelector"){let t=Ak.exec(e.value);if(t){let r={type:"BoxSelector",spatial:{unit:t[2]==="percent:"||t[2]==="pct:"?"percent":"pixel",x:parseFloat(t[3]),y:parseFloat(t[4]),width:parseFloat(t[5]),height:parseFloat(t[6])}};return{selector:r,selectors:[r]}}let i=e.value.match(kk);if(i){let r={type:"TemporalSelector",temporal:{startTime:i[4]?parseFloat(i[4]):0,endTime:i[7]?parseFloat(i[7]):void 0}};return{selector:r,selectors:[r]}}return{selector:null,selectors:[]}}return{selector:null,selectors:[]}}function Ca(e,t={}){if(Array.isArray(e))return Ca(e[0]);if(typeof e=="string"){let[i,r]=e.split("#");return r?Ca({type:"SpecificResource",source:{id:i,type:"Unknown"},selector:{type:"FragmentSelector",value:r}}):{type:"SpecificResource",source:{id:i,type:t.typeMap&&t.typeMap[i]||"Unknown"},selector:null,selectors:[]}}if(e.type==="Choice"||e.type==="List"||e.type==="Composite"||e.type==="Independents")return Ca(e.items[0]);if(e.type==="SpecificResource"){e.source.type==="Canvas"&&e.source.partOf&&typeof e.source.partOf=="string"&&(e.source.partOf=[{id:e.source.partOf,type:"Manifest"}]);let{selector:i,selectors:r}=e.selector?Yh(e.selector):{selector:null,selectors:[]};return{type:"SpecificResource",source:e.source,selector:i,selectors:r}}if(e.id){e.type==="Canvas"&&e.partOf&&typeof e.partOf=="string"&&(e.partOf=[{id:e.partOf,type:"Manifest"}]);let[i,r]=e.id.split("#");return r?Ca({type:"SpecificResource",source:Vm(Qm({},e),{id:i}),selector:{type:"FragmentSelector",value:r}}):{type:"SpecificResource",source:Vm(Qm({},e),{id:i}),selector:null,selectors:[]}}return{type:"SpecificResource",source:e,selector:null,selectors:[]}}function cn(e){return e.endsWith("info.json")?e:e.endsWith("/")?`${e}info.json`:`${e}/info.json`}var Pk="http://library.stanford.edu/iiif/image-api/compliance.html#level0",Gm="http://library.stanford.edu/iiif/image-api/compliance.html#level1",Zm="http://library.stanford.edu/iiif/image-api/compliance.html#level2",Ck="http://library.stanford.edu/iiif/image-api/conformance.html#level0",Ym="http://library.stanford.edu/iiif/image-api/conformance.html#level1",Xm="http://library.stanford.edu/iiif/image-api/conformance.html#level2",Tk="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",Km="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",Jm="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",Ik="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",ey="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",ty="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",Rk="http://iiif.io/api/image/1/level0.json",Ok="http://iiif.io/api/image/1/profiles/level0.json",iy="http://iiif.io/api/image/1/level1.json",ry="http://iiif.io/api/image/1/profiles/level1.json",ny="http://iiif.io/api/image/1/level2.json",sy="http://iiif.io/api/image/1/profiles/level2.json",Mk="http://iiif.io/api/image/2/level0.json",Lk="http://iiif.io/api/image/2/profiles/level0.json",ay="http://iiif.io/api/image/2/level1.json",oy="http://iiif.io/api/image/2/profiles/level1.json",ly="http://iiif.io/api/image/2/level2.json",uy="http://iiif.io/api/image/2/profiles/level2.json",$k="level0",hy="level1",cy="level2",Nk="http://iiif.io/api/image/2/level0",dy="http://iiif.io/api/image/2/level1",fy="http://iiif.io/api/image/2/level2",py=[fy,Zm,Xm,Jm,ty,ny,sy,ly,uy,cy],gy=[...py,dy,Gm,Ym,Km,ey,iy,ry,ay,oy,hy],zk=[Nk,dy,fy,Pk,Gm,Zm,Ck,Ym,Xm,Tk,Km,Jm,Ik,ey,ty,Rk,Ok,iy,ry,ny,sy,Mk,Lk,ay,oy,ly,uy,$k,hy,cy],Fk={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},Bk={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},jk={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function Uk(e){return py.indexOf(e)!==-1?jk:gy.indexOf(e)!==-1?Bk:Fk}function Dk(e){let t=e?Array.isArray(e.profile)?e.profile:[e.profile]:[],i={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let r of t)if(typeof r=="string"&&(r=Uk(r)),!!r){if(r.formats)for(let n of r.formats)i.extraFormats.indexOf(n)===-1&&i.extraFormats.push(n);if(r.qualities)for(let n of r.qualities)i.extraQualities.indexOf(n)===-1&&i.extraQualities.push(n);if(r.supports)for(let n of r.supports)i.extraFeatures.indexOf(n)===-1&&i.extraFeatures.push(n);if(r.maxHeight&&(i.maxHeight=r.maxHeight),r.maxWidth&&(i.maxWidth=r.maxWidth),r.maxArea&&(i.maxArea=r.maxArea),r.extraFormats)for(let n of r.extraFormats)i.extraFormats.indexOf(n)===-1&&i.extraFormats.push(n);if(r.extraQualities)for(let n of r.extraQualities)i.extraQualities.indexOf(n)===-1&&i.extraQualities.push(n);if(r.extraFeatures)for(let n of r.extraFeatures)i.extraFeatures.indexOf(n)===-1&&i.extraFeatures.push(n);r.maxHeight&&(i.maxHeight=r.maxHeight),r.maxWidth&&(i.maxWidth=r.maxWidth),r.maxArea&&(i.maxArea=r.maxArea)}if(e.extraFormats)for(let r of e.extraFormats)i.extraFormats.indexOf(r)===-1&&i.extraFormats.push(r);if(e.extraFeatures)for(let r of e.extraFeatures)i.extraFeatures.indexOf(r)===-1&&i.extraFeatures.push(r);if(e.extraQualities)for(let r of e.extraQualities)i.extraQualities.indexOf(r)===-1&&i.extraQualities.push(r);return i}function Wk(e){try{if(e==="full")return{full:!0};if(e==="square")return{square:!0};let t=e.startsWith("pct:"),i=e.substr(t?4:0).split(",").map(r=>parseFloat(r));return{x:i[0],y:i[1],w:i[2],h:i[3],percent:t}}catch{throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+e)}}function Hk(e){let t={upscaled:!1,max:!1,confined:!1};if(e[0]==="^"&&(t.upscaled=!0,e=e.slice(1)),e==="max"||e==="full")return t.max=!0,t.serialiseAsFull=e==="full",t;if(e[0]==="!"&&(t.confined=!0,e=e.slice(1)),e[0]==="p")return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map(r=>r.trim());return i.length&&(i[0]!==""&&(t.width=parseInt(i[0],10)),i[1]!==""?(t.height=parseInt(i[1],10),t.version=2):t.version=3),t}function qk(e){let t={angle:0};if(e[0]==="!"&&(t.mirror=!0,e=e.substr(1)),t.angle=parseFloat(e)%360,Number.isNaN(t.angle))throw new Error(`Invalid rotation ${e}`);return t}function my(e,t=""){let i=e.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!i)throw new Error(`Invalid or unknown input ${e}`);let r=i[2],n=i[3],a=i[4];if(a[0]==="/"&&(a=a.substr(1)),t.length>0){if(t[0]==="/"&&(t=t.substr(1)),t!==a.substr(0,t.length))throw new Error(`Path does not start with prefix (path: ${a}, prefix: ${t})`);a=a.substr(t.length)}return{scheme:r,server:n,path:a,prefix:t}}function Qk(e,t=""){let{path:i,scheme:r,server:n,prefix:a}=my(e,t),l=i.split("/").reverse(),[u,c,d,p,...y]=l,x=y.reverse().filter(Boolean).join("/");if(l.length===1||u==="")return{type:"base",scheme:r,server:n,prefix:a,identifier:x};if(u==="info.json"){let[,...S]=l;return{type:"info",scheme:r,server:n,prefix:a,identifier:S.reverse().filter(Boolean).join("/")}}let E=u.split(".");return{type:"image",scheme:r,server:n,prefix:a,identifier:x,originalPath:i,region:Wk(p),size:Hk(d),rotation:qk(c),quality:E[0],format:E[1]}}function Vk(e){let t=Qk(cn(e.id));if(t.type!=="info")throw new Error("Invalid service URL");let i=Dk(e);return{identifier:t.identifier,originalPath:"",server:t.server,prefix:t.prefix,scheme:t.scheme,type:"image",quality:i.extraQualities.indexOf("default")===-1?i.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function Gk(e,t,i){let r=i.length,n=[];for(let a=0;a<r;a++){let l=i[a].width;n.push(e/l)}return n}function Zk(e,t,i){let r=i.length,n=[];for(let a=0;a<r;a++){let l=i[a];n.push({width:Math.floor(e/l),height:Math.floor(t/l)})}return n}function jt(e){if(e["@id"])return e["@id"];if(e.id)return e.id}function el(e){if(!e||!e.profile||!jt(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let i of t)if(typeof i=="string"&&zk.indexOf(i)!==-1)return!0;return!1}function Yk(e){if(!el(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let i of t)if(typeof i=="string"){if(gy.indexOf(i)!==-1)return!0}else{let r=[...i.supports||[],...i.extraFeatures||[]];if(r.indexOf("regionByPx")!==-1&&(r.indexOf("sizeByW")!==-1||r.indexOf("sizeByWh")!==-1))return!0}return!1}function tl(e,t){if(t&&t.profile){let i=t.profile;if(i){let r=Array.isArray(i)?i:[i];return r.includes(`level${e}`)||r.includes(`http://iiif.io/api/image/2/level${e}.json`)||r.includes(`http://iiif.io/api/image/1/level${e}.json`)||r.includes(`http://iiif.io/api/image/1/profiles/level${e}.json`)}}return!1}function Xh(e){return el(e)?tl(0,e)?0:tl(1,e)?1:tl(2,e)?2:null:null}function yy(e){return(e["@context"]?Array.isArray(e["@context"])?e["@context"]:[e["@context"]]:[]).indexOf("http://iiif.io/api/image/3/context.json")!==-1}function Xk(e){if(!Yk(e))return[];let t=[],i=Array.isArray(e.profile)?e.profile:[e.profile],r=i.length;for(let n=0;n<r;n++){let a=i[n];if(typeof a!="string"&&(a.maxHeight||a.maxWidth))return[{id:jt(e),type:"variable",minWidth:0,minHeight:0,maxHeight:a.maxHeight||a.maxWidth,maxWidth:a.maxWidth||a.maxHeight,level:Xh(e),version:e["@context"]==="http://iiif.io/api/image/3/context.json"?3:2}]}if(e.tiles){let n=e.tiles.length;for(let a=0;a<n;a++){let l=e.tiles[a];(l.height||l.width)&&t.push({id:jt(e),type:"variable",minHeight:0,minWidth:0,maxHeight:l.height||l.width,maxWidth:l.width,level:Xh(e),version:yy(e)?3:2})}}return t}function vy(e){let t=/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/,i=e.match(t);if(i){let r=i[1],n=parseInt(i[4],10),a=parseInt(i[5],10),l=i[7];if((r==="max"||r==="full")&&n&&a&&l)return{type:"fixed",id:e,height:a,width:n}}return{type:"unknown",id:e}}function Kk(e){if(e["@type"])return e["@type"];if(e.type)return e.type}function Kh(e){if(typeof e=="string")return vy(e);let t=Kk(e);if(t!=="Image"&&t!=="sc:Image")return null;let i=e,r=jt(i);return r?r&&i.width&&i.height?{id:r,type:"fixed",width:i.width,height:i.height,unsafe:!0}:vy(r):null}function Jk(e){return el(e)?(e&&e.sizes?e.sizes:[]).map(t=>({id:jt(e),type:"fixed-service",height:t.height,width:t.width,level:Xh(e),version:yy(e)?3:2})):[]}function by(e){let t=[],i=e.length;for(let r=0;r<i;r++){let n=Jk(e[r]);n.length&&t.push(...n);let a=Xk(e[r]);a.length&&t.push(...a)}return t}function Jh(e){let t=e.service?Array.isArray(e.service)?e.service:[e.service]:[],i=t.length,r=[];for(let n=0;n<i;n++)el(t[n])&&r.push(t[n]);return r}function eP(e,t=!0,i){let r=[],n=Kh(e);if(n===null)return r;let a=e;if(r.push(n),t&&a&&a.width&&a.height){let l=[],u=Jh(a);for(let c of u){let d={id:jt(c),width:a.width,height:a.height};if(i.canLoadSync(d)){let p=i.loadServiceSync(d);p&&(p.height||(p.height=a.height),p.width||(p.width=a.width),l.push(...by([p])))}}if(l.length)return r.push(...l),r}return a.service&&r.push(...by(a.service)),r}function tP({x:e=0,y:t=0,w:i,h:r,full:n,square:a,percent:l}){if(n)return"full";if(a)return"square";if(typeof i>"u"||typeof r>"u")throw new Error("RegionParameter: invalid region");let u=`${e},${t},${i},${r}`;return l?`pct:${u}`:u}function iP({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:a,serialiseAsFull:l,version:u}){let c=[];return i&&c.push("^"),e?(c.push(l?"full":"max"),c.join("")):(r&&c.push("!"),t&&c.push(`pct:${t}`),n&&c.push(`${n}`),c.push(","),a&&u===3&&c.push(`${a}`),c.join(""))}function rP(e){return`${e.mirror?"!":""}${(e.angle||0)%360}`}var nP=Object.defineProperty,sP=Object.defineProperties,aP=Object.getOwnPropertyDescriptors,wy=Object.getOwnPropertySymbols,oP=Object.prototype.hasOwnProperty,lP=Object.prototype.propertyIsEnumerable,xy=(e,t,i)=>t in e?nP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Xn=(e,t)=>{for(var i in t||(t={}))oP.call(t,i)&&xy(e,i,t[i]);if(wy)for(var i of wy(t))lP.call(t,i)&&xy(e,i,t[i]);return e},Kn=(e,t)=>sP(e,aP(t));function _y(e,t){let i=e.prefix.startsWith("/")?e.prefix.substr(1):e.prefix,r=`${e.scheme}://${e.server}/${i?`${i}/`:""}${e.identifier}`;if(e.type==="base")return r;if(e.type==="info")return`${r}/info.json`;let{size:n}=e,{region:a,rotation:l,format:u,quality:c}=e;if(t){let d=t["@context"]?Array.isArray(t["@context"])?t["@context"]:[t["@context"]]:[],p=d.indexOf("http://iiif.io/api/image/2/context.json")!==-1,y=d.indexOf("http://iiif.io/api/image/3/context.json")!==-1;if((n.width===t.width&&!n.height||n.height===t.height&&!n.width||n.width===t.width&&n.height===t.height)&&(n=Kn(Xn({},n),{max:!0})),p&&(n.max&&!n.serialiseAsFull&&(n=Kn(Xn({},n),{serialiseAsFull:!0})),!n.max&&n.width&&n.height&&(n=Kn(Xn({},n),{height:void 0})),n=Kn(Xn({},n),{version:2})),y){if(n.max&&n.serialiseAsFull&&(n=Kn(Xn({},n),{serialiseAsFull:!1})),n.width&&!n.height&&t.width&&t.height){let x=t.height/t.width;n=Kn(Xn({},n),{height:Math.ceil(n.width*x)})}n=Kn(Xn({},n),{version:3})}}return[r,tP(a),iP(n),rP(l),`${c}.${u}`].filter(Boolean).join("/")}function ec(e,t,i){let r=Vk({"@context":e.version===3?"http://iiif.io/api/image/3/context.json":"http://iiif.io/api/image/2/context.json",id:cn(jt(e)),profile:e.level===null||typeof e.level>"u"?"level0":`level${e.level}}`,type:e.version===3?"ImageService3":"ImageService2"});return r.size.max=!1,r.size.width=t,r.size.height=i,{id:_y(r),type:"fixed",width:t,height:i||e.height/(e.width||1)*t,unsafe:e.width>t}}function Us(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,"");return t.indexOf("/")!==-1?t.split("/")[0]:t}function uP(e,t,i){let r=e.width?e.width:e.maxWidth;return i.height<=e.maxHeight&&i.width<=e.maxWidth&&i.height>=e.minHeight&&i.width>=e.minWidth&&(!t||Math.abs(i.width-r)<Math.abs(t.width-r))}function hP(e,t){let i=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},e),n=(p,y=0)=>r.explain?i.push(new Array(y).fill(0).map(x=>"    ").join("")+p().trim()):void 0,a=[],l=[],u=null;n(()=>`Using configuration: ${JSON.stringify(r,null,2)}`);let c=(p,y)=>{if(n(()=>"Swapping choice",3),uP(r,y,p)){if(r.preferFixedSize&&p.unsafe){n(()=>`We found an image that was marked as unsafe, but it was the best size. (${p.id})`,4),l.push(p);return}r.returnAllOptions&&y&&l.push(y),n(()=>`We found a new image that was the best size. (${p.id})`,4),u=p}else r.returnAllOptions&&l.push(p)};n(()=>`The input shows we have ${t.length} list(s) of candidates to choose from.`);let d=t.length;for(let p=0;p<d;p++){let y=t[p]();n(()=>`Candidate group ${p}: ${JSON.stringify(y,null,2)}`,1);let x=y.length;n(()=>`Checking candidate list number ${p} and found ${x} potential ways of creating image(s)`,1);for(let E=0;E<x;E++){let S=y[E];if(n(()=>`-> Checking candidate ${E}`,1),S.type==="unknown"&&r.atAnyCost&&(n(()=>`We've found an unknown image type, adding this to the "last resort" list`,2),a.push(S)),S.type==="fixed"&&(S.unsafe?(n(()=>`We've found an unsafe fixed image type, adding this to the "last resort" list`,2),a.push(S)):(n(()=>"We've found a fixed size image, checking if it matches the request",2),c(S,u))),S.type==="fixed-service")if(r.unsafeImageService){n(()=>"Checking for an image from the tile source, without calculating the right height and width (unsafeImageService)",2);let k=ec(S,r.width,r.height);c(k,u)}else{n(()=>"Checking for an image from the tile source 3",2);let k=ec(S,S.width,S.height);c(k,u)}if(S.type==="variable"&&S.maxWidth){let k=ec({id:S.id,width:S.maxWidth,height:S.maxWidth,level:S.level,version:S.version},S.maxWidth);c(k,u)}}if(u&&!r.returnAllOptions){if(u.unsafe||r.allowUnsafe)continue;n(()=>`We found a match in choice list number ${p}, no searching any more`);break}}return r.atAnyCost&&l.length===0?(n(()=>u?`We found an image! ${u.id} of type ${u.type}`:'We found no images, but "atAnyCost" is set, so returning that'),{best:u||a[0],fallback:a.slice(1),log:i}):r.returnAllOptions?(n(()=>"Returning all options that we have found"),{best:r.atAnyCost?u||l[0]||a[0]:u||l[0],fallback:[...l,...a],log:i}):(n(()=>"Returning the best image that we found, and a fallback"),{best:u||l[0]||null,fallback:u?l:l.slice(1),log:i})}var cP=Object.defineProperty,dP=Object.defineProperties,fP=Object.getOwnPropertyDescriptors,Sy=Object.getOwnPropertySymbols,pP=Object.prototype.hasOwnProperty,gP=Object.prototype.propertyIsEnumerable,Ey=(e,t,i)=>t in e?cP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,mP=(e,t)=>{for(var i in t||(t={}))pP.call(t,i)&&Ey(e,i,t[i]);if(Sy)for(var i of Sy(t))gP.call(t,i)&&Ey(e,i,t[i]);return e},yP=(e,t)=>dP(e,fP(t));function vP(e,t,i){let r=e>t?e:t,n=i.length,a=[];for(let l=0;l<n;l++){let u=i[l],c=u.scaleFactors[0],d=r/c,p=[c];for(;d>=u.width;)c=c*2,p.push(c),d=d/2;a.push(yP(mP({},u),{scaleFactors:p}))}return a}function bP(e,t){if(e.length!==t.length)return!1;if(e.length===0&&t.length===0)return!0;let i=e.length,r=!0;for(let a=0;a<i;a++){let l=e[a],u=t[a];if(l.width!==u.width||l.height!==u.height){r=!1;break}}if(r)return!0;let n=0;for(let a=0;a<i;a++)for(let l=0;l<i;l++)if(e[a].width===t[l].width&&e[a].height===t[l].height){n++;break}return n===i}function Ay(e){return tl(0,e)}var Jn=(e,t,i)=>new Promise((r,n)=>{var a=c=>{try{u(i.next(c))}catch(d){n(d)}},l=c=>{try{u(i.throw(c))}catch(d){n(d)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(a,l);u((i=i.apply(e,t)).next())}),il=class{constructor(e={}){this.config={verificationsRequired:1,approximateServices:!1,enableFetching:!0,disableThrottling:!1},this.fetchingCount=0,this.imageServices={},this.knownImageServers={},this.config=Object.assign(this.config,e)}setConfig(e){Object.assign(this.config,e)}sample(e,t,i=!0){let r=Us(jt(e)),n=cn(jt(e)),a=this.knownImageServers[r];return this.imageServices[n]=Object.assign(e,{real:!0}),!a&&e.tiles&&!Ay(e)?(this.knownImageServers[r]={verifications:0,malformed:!1,root:r,preLoaded:i,sampledId:jt(e),verified:!1,server:null,result:{context:e["@context"]||[],sampledProfile:e.profile,resourceServiceRatio:t&&e.height?t.height/e.height:1,sampledSizes:e.sizes||[],sizeRatios:Gk(e.width,e.height,e.sizes||[]),sampledTiles:e.tiles||[]}},!0):this.verify(e)}preLoad(e,t=!0){this.knownImageServers[e.root]=e,t&&(this.knownImageServers[e.root].malformed=!1,this.knownImageServers[e.root].verifications=this.config.verificationsRequired)}predict(e,t=!1,i=!1){let r=e==null?void 0:e.source,n=Us(jt(e)),a=this.knownImageServers[n],l=cn(jt(e));return this.imageServices[l]?this.imageServices[l]:!this.config.approximateServices||!a||!a.result||!(r!=null&&r.height||e.height)||!(r!=null&&r.width||e.width)||!i&&(a.malformed||a.verifications<this.config.verificationsRequired)||Ay(e.source)?null:(this.imageServices[l]||(this.imageServices[l]={"@context":a.result.context,"@id":jt(e),id:jt(e),protocol:"http://iiif.io/api/image",tiles:(r==null?void 0:r.tiles)||vP(e.width,e.height,a.result.sampledTiles),sizes:(r==null?void 0:r.sizes)||Zk(Math.round(e.width/a.result.resourceServiceRatio),Math.round(e.height/a.result.resourceServiceRatio),a.result.sizeRatios),profile:(r==null?void 0:r.profile)||a.result.sampledProfile,height:(r==null?void 0:r.height)||e.height,width:(r==null?void 0:r.width)||e.width,real:!1}),this.imageServices[l])}getThumbnailFromResource(e,t){return Jn(this,arguments,function*(i,r,n=!0,a=[]){let l=i?yield this.getImageCandidates(i,n):[];return hP(r,[()=>a,()=>l])})}getImageCandidates(e,t=!0){return Jn(this,null,function*(){let i=e;if(t&&i&&i.height&&i.width){let r=Jh(i);for(let n of r){let a={id:jt(n),width:n.width?n.width:i.width,height:n.height?n.height:i.height,source:n};yield this.loadService(a)}}return eP(e,t,this)})}verify(e){return Jn(this,null,function*(){let t=this.predict(e,!1,!0),i=yield this.fetchService(jt(e));if(!t)return!1;let r=t.height===i.height&&t.width===i.width&&t["@context"]===i["@context"]&&bP(t.sizes||[],i.sizes||[]);if(r){let n=Us(jt(e));this.knownImageServers[n]&&(this.knownImageServers[n].verifications+=1,this.knownImageServers[n].verifications>=this.config.verificationsRequired&&(this.knownImageServers[n].verified=!0))}return r})}canLoadSync(e){let t=typeof e=="string"?e:jt(e),i=cn(t);if(this.imageServices[i])return!0;let r=this.knownImageServers[Us(t)];return r&&!r.malformed&&r.verifications>=this.config.verificationsRequired}markAsMalformed(e){return Jn(this,null,function*(){return this.knownImageServers[Us(jt(e))].malformed=!0,this.loadService(e,!0)})}fetchService(e,t=!1){return Jn(this,null,function*(){let i=cn(e);if(this.imageServices[i]&&(!t||this.imageServices[i].real))return this.imageServices[i];if(!this.config.enableFetching)throw new Error("Fetching is not enabled");let r=yield this.fetch(i).then(n=>n.json());return!r.id&&r["@id"]&&(r.id=r["@id"]),r.id!==e&&(r.id=e,r["@id"]&&(r["@id"]=e)),this.imageServices[i]=Object.assign(r,{real:!0}),this.imageServices[i]})}fetch(e,t){return Jn(this,null,function*(){return fetch(e,t)})}loadService(e,t=!1){return Jn(this,null,function*(){if(!this.config.disableThrottling){let n=!0;for(;n;)if(this.fetchingCount>=this.config.verificationsRequired)yield new Promise(a=>setTimeout(a,500));else{n=!1;break}}let i=this.knownImageServers[Us(jt(e))];if(i&&!i.malformed&&!t){yield i.result;let n=this.loadServiceSync(e);if(n)return n}this.fetchingCount++;let r=yield this.fetchService(jt(e),t);return this.fetchingCount--,r.real&&this.sample(r,e),r})}loadServiceSync(e){let t=cn(jt(e));return this.imageServices[t]?this.imageServices[t]:this.config.approximateServices?this.predict(e):null}};new il;var wP=Object.defineProperty,xP=Object.defineProperties,_P=Object.getOwnPropertyDescriptors,ky=Object.getOwnPropertySymbols,SP=Object.prototype.hasOwnProperty,EP=Object.prototype.propertyIsEnumerable,Py=(e,t,i)=>t in e?wP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ni=(e,t)=>{for(var i in t||(t={}))SP.call(t,i)&&Py(e,i,t[i]);if(ky)for(var i of ky(t))EP.call(t,i)&&Py(e,i,t[i]);return e},Ei=(e,t)=>xP(e,_P(t)),AP={collection:void 0,manifest:void 0,range:void 0,canvas:void 0,annotation:void 0,annotationPage:void 0},Cy=te.createContext(AP),es=()=>Yt(Cy);function rl({value:e,children:t}){let i=es(),r=Ae(()=>ni(ni({},i),e),[e,i]);return Ke(Cy.Provider,{value:r,children:t})}var tc=te.createContext({vault:null,setVaultInstance:e=>{}});function dn({vault:e,vaultOptions:t,useGlobal:i,resources:r,children:n}){let[a,l]=je(()=>e||(i?Wm(t):t?new Zh(t):new Zh));return Ke(tc.Provider,{value:{vault:a,setVaultInstance:l},children:Ke(rl,{value:r||{},children:n})})}var Ut=()=>{let{vault:e}=Yt(tc);if(e===null)throw new Error("Vault not found. Ensure you have your provider set up correctly.");return e};function kP(e,{noCache:t=!1}={}){let i=typeof e=="string"?e:e.id,r=Ut(),[n,a]=je(i),[l,u]=je(void 0),c=Ae(()=>r.get(i,{skipSelfReturn:!0})||void 0,[i,r]),[d,p]=je(c);return fe(()=>{(async()=>{try{let y=c&&!t?c:await r.load(i),x=y?y.id||y["@id"]:null;y&&n!==x&&a(x),p(y)}catch(y){u(y)}})()},[i,t]),{isLoaded:!!d,id:n,requestId:i,error:l,resource:d,cached:!!(d&&d===c)}}function nl(e,t){let{id:i,isLoaded:r,error:n,resource:a,requestId:l,cached:u}=kP(e,t);return{id:i,isLoaded:r,error:n,manifest:a,requestId:l,cached:u}}function sl({manifest:e,children:t}){return Ke(rl,{value:{manifest:e},children:t})}function ic({canvas:e,children:t}){return Ke(rl,{value:{canvas:e},children:t})}function Ai(e,t=[]){let i=Ut(),[r,n]=je(()=>e(i.getState(),i));return fe(()=>i.subscribe(a=>e(a,i),a=>{n(a)},!1),t),r}var Ty=te.createContext([]);function Iy(){let e=Yt(Ty);return Ai(t=>e.map(i=>t.iiif.entities.Canvas[i]).filter(Boolean),[e])}function fn(e={},t=[]){let{id:i,selector:r}=e,n=es();Ut();let a=i||n.manifest,l=Ai(u=>a?u.iiif.entities.Manifest[a]:void 0,[a]);return Ae(()=>{if(l)return r?r(l):l},[l,r,...t])}function rc({range:e,children:t}){return Ke(rl,{value:{range:e},children:t})}function Ry(e,t){let i=[];for(let r of t.items)if(r.type==="Canvas"&&(r.id.indexOf("#")!==-1?i.push({id:r.id.split("#")[0],type:"Canvas"}):i.push(r)),r.type==="Range"&&i.push(...Ry(e,e.get(r))),r.type==="SpecificResource"){let n=typeof r.source=="string"?r.source:r.source.id;i.push({id:n,type:"Canvas"})}return i}function PP(e,t,{disablePaging:i,skipNonPaged:r}={}){let n=t.behavior,a=n.includes("paged"),l=a?!1:n.includes("continuous"),u=a||l?!1:n.includes("individuals"),c=t.type==="Manifest"?t.items:Ry(e,t);if(l)return[c,[c.map((S,k)=>k)]];if(u||!a||i)return[c,c.map((S,k)=>[k])];let d=[],p=[],y=()=>{p.length&&(d.push([...p]),p=[])},x=0,E=!1;for(let S=0;S<c.length;S++){let k=e.get(c[S]);if(k.behavior.includes("non-paged")){S===x&&x++,r||(y(),d.push([S]),y());continue}if(S===x||k.behavior.includes("facing-pages")){p.length&&(E=!0),y(),d.push([S]),y();continue}if(p.push(S),E){y(),E=!1;continue}p.length>1&&y()}return p.length&&y(),[c,d]}function nc(e={},t=[]){let{id:i,selector:r}=e,n=es(),a=i||n.range,l=Ai(u=>a?u.iiif.entities.Range[a]:void 0,[a]);return Ae(()=>{if(l)return r?r(l):l},[l,r,...t])}function CP({startCanvas:e,disablePaging:t}){var i;let r=Ut(),n=fn(),a=nc(),[l,u]=je(void 0),c=a||n;if(!c)throw new Error("Nothing selected");let[d,p]=Ae(()=>PP(r,c,{disablePaging:t}),[r,c]),y=Qe(k=>{let T=p.findIndex(R=>R.includes(k));u(T===-1?0:T)},[d,p]),x=Qe(k=>{let T=d.findIndex(R=>R.id===k);T!==-1?y(T):u(0)},[d,p]),E=Qe(()=>{u(k=>k>=p.length?k:k+1)},[p]),S=Qe(()=>{u(k=>k<=0?0:k-1)},[p]);return typeof l>"u"&&(e?x(e):u(0)),{visibleItems:((i=p[l])==null?void 0:i.map(k=>d[k].id))||[],cursor:l,items:d,sequence:p,setSequenceIndex:u,setCanvasIndex:y,setCanvasId:x,next:E,previous:S}}var Ta=()=>{},Oy=ri({setCurrentCanvasId:Ta,setCurrentCanvasIndex:Ta,nextCanvas:Ta,previousCanvas:Ta,items:[],sequence:[],setSequenceIndex:Ta,currentSequenceIndex:0});function TP(e){let t=fn(),{cursor:i,visibleItems:r,next:n,sequence:a,items:l,setCanvasIndex:u,setCanvasId:c,previous:d,setSequenceIndex:p}=CP({startCanvas:e.startCanvas,disablePaging:e.pagingEnabled===!1}),y=Ae(()=>({sequence:a,items:l,setCurrentCanvasId:c,nextCanvas:n,previousCanvas:d,totalCanvases:l.length,setCurrentCanvasIndex:u,setSequenceIndex:p,currentSequenceIndex:i}),[a,l,c,n,d,l,u,p,i]);return t?Ke(Oy.Provider,{value:y,children:Ke(Ty.Provider,{value:r,children:Ke(ic,{canvas:r[0],children:e.children})})}):(console.warn("The manifest passed to the provider is not a valid IIIF manifest."),Ke("div",{children:"Sorry, something went wrong."}))}function IP(e){let t=nl(e.manifest);if(!t)return console.warn("The manifest passed to the provider is not a valid IIIF manifest."),Ke("div",{children:"Sorry, something went wrong."});if(!t.isLoaded)return Ke("div",{children:"Loading..."});let i=Ke(TP,Ei(ni({},e),{children:e.children}));return Ke(sl,{manifest:t.id,children:e.rangeId?Ke(rc,{range:e.rangeId,children:i}):i})}function RP(){return Yt(Oy)}var OP="@iiif/IMPORT_ENTITIES",MP="@iiif/MODIFY_ENTITY_FIELD",LP="@iiif/REORDER_ENTITY_FIELD",$P="@iiif/ADD_REFERENCE",NP="@iiif/REMOVE_REFERENCE",zP=(0,pi.createAction)(OP)(),FP=(0,pi.createAction)(MP)(),BP=(0,pi.createAction)(LP)(),jP=(0,pi.createAction)($P)(),UP=(0,pi.createAction)(NP)(),sc={importEntities:zP,modifyEntityField:FP,reorderEntityField:BP,addReference:jP,removeReference:UP},DP="@iiif/ADD_MAPPING",WP="@iiif/ADD_MAPPINGS";(0,pi.createAction)(DP)(),(0,pi.createAction)(WP)();var HP="@iiif/SET_META_VALUE",qP="@iiif/SET_META_VALUE_DYNAMIC",QP="@iiif/UNSET_META_VALUE";(0,pi.createAction)(HP)(),(0,pi.createAction)(qP)(),(0,pi.createAction)(QP)();var VP="@iiif/REQUEST_RESOURCE",GP="@iiif/REQUEST_ERROR",ZP="@iiif/REQUEST_MISMATCH",YP="@iiif/REQUEST_COMPLETE",XP="@iiif/REQUEST_OFFLINE_RESOURCE";(0,pi.createAction)(VP)(),(0,pi.createAction)(GP)(),(0,pi.createAction)(ZP)(),(0,pi.createAction)(YP)(),(0,pi.createAction)(XP)();var KP="@iiif/BATCH",JP="@iiif/BATCH_IMPORT";(0,pi.createAction)(KP)(),(0,pi.createAction)(JP)();function eC(){let e=Ut().getStore();return Ae(()=>t=>e.dispatch(t),[e])}function My(e){return typeof e!="string"&&e&&e.bindToVault}function tC(){let e=Ut(),t=xe([]),i=eC(),r=Ae(()=>`vault://annotation-page/${new Date().getTime()}/${Math.round(Math.random()*1e9).toString(16)}`,[]);Et(()=>{let u={id:r,type:"AnnotationPage",behavior:[],motivation:null,label:null,thumbnail:[],summary:null,requiredStatement:null,metadata:[],rights:null,provider:[],items:[],seeAlso:[],homepage:[],logo:[],rendering:[],service:[]};i(sc.importEntities({entities:{AnnotationPage:{[u.id]:u}}}))},[r]);let n=Ai(u=>r?u.iiif.entities.AnnotationPage[r]:null,[r]),a=Qe((u,c)=>{if(r){if(My(u)){let y=u;y.__vault||y.bindToVault(e),u=typeof y.source=="string"?y.source:y.source.id,t.current[u]=y}else typeof u!="string"&&(u=u.id);let d=e.get({id:r,type:"AnnotationPage"}),p=e.get({id:u,type:"Annotation"});d&&p&&(d.items.find(y=>y.id===p.id)||i(sc.addReference({id:r,type:"AnnotationPage",key:"items",reference:{id:u,type:"Annotation"},index:c})))}},[r]),l=Qe(u=>{r&&(My(u)?u=typeof u.source=="string"?u.source:u.source.id:typeof u!="string"&&(u=u.id),t.current[u]&&t.current[u].beforeRemove(),e.get({id:r,type:"AnnotationPage"})&&i(sc.removeReference({id:r,type:"AnnotationPage",key:"items",reference:{id:u,type:"Annotation"}})))},[r]);return[n,{addAnnotation:a,removeAnnotation:l}]}ri(null),ri(null),te.createContext(null),te.createContext(null);function iC(e){return{addEventListener(t,i,r,n){if(t)return e.setMetaValue([t.id,"eventManager",i],a=>{let l=a||[];for(let u of l)if(u.callback===r)return l;return[...l,{callback:r,scope:n}]}),r},removeEventListener(t,i,r){!t||e.setMetaValue([t.id,"eventManager",i],n=>(n||[]).filter(a=>a.callback!==r))},getListenersAsProps(t,i){let r=typeof t=="string"?{id:t}:t;if(!r||!r.id)return{};let n=e.getResourceMeta(r.id,"eventManager"),a={};if(n&&r)for(let l of Object.keys(n))a[l]=u=>{let c=e.get(r);for(let{callback:d,scope:p}of n[l]||[])(!p||i&&p.indexOf(i)!==-1)&&d(u,c)};return a}}}function al(e,t){let i=Ut(),r=Ae(()=>iC(i),[i]),n=Ai(()=>e&&e.id?i.getResourceMeta(e.id,"eventManager"):null,[e]);return Ae(()=>e?r.getListenersAsProps(e,t):{},[n,e,i,t])}function Ly(e){return{applyStyles(t,i,r){let n=typeof t=="string"?t:t.id;return e.setMetaValue([n,"styles",i],r)},getAppliedStyles(t){let i=typeof t=="string"?t:t.id;return e.getResourceMeta(i,"styles")}}}function ts(e,t){let i=Ut(),r=Ae(()=>Ly(i),[i]);return Ai(()=>{if(!e)return null;let n=r.getAppliedStyles(e.id);return n?t?n[t]:n:void 0},[e,t])}var rC=Object.defineProperty,nC=Object.defineProperties,sC=Object.getOwnPropertyDescriptors,$y=Object.getOwnPropertySymbols,aC=Object.prototype.hasOwnProperty,oC=Object.prototype.propertyIsEnumerable,Ny=(e,t,i)=>t in e?rC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,zy=(e,t)=>{for(var i in t||(t={}))aC.call(t,i)&&Ny(e,i,t[i]);if($y)for(var i of $y(t))oC.call(t,i)&&Ny(e,i,t[i]);return e},Fy=(e,t)=>nC(e,sC(t)),lC=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,uC=/&?(t=)(npt:)?([0-9]+(.[0-9]+)?)?(,([0-9]+(.[0-9]+)?))?/;function ol(e){if(Array.isArray(e))return e.reduce((t,i)=>{let{selector:r,selectors:n}=ol(i);return r&&(t.selector||(t.selector=r),t.selectors.push(...n)),t},{selector:null,selectors:[]});if(!e)return{selector:null,selectors:[]};if(typeof e=="string"){let[t,i]=e.split("#");return i?ol({type:"FragmentSelector",value:i}):{selector:null,selectors:[]}}if(e.type==="PointSelector"&&(e.t||e.t===0)){let t={type:"TemporalSelector",temporal:{startTime:e.t}};return{selector:t,selectors:[t]}}if(e.type==="FragmentSelector"){let t=lC.exec(e.value);if(t){let r={type:"BoxSelector",spatial:{unit:t[2]==="percent:"||t[2]==="pct:"?"percent":"pixel",x:parseFloat(t[3]),y:parseFloat(t[4]),width:parseFloat(t[5]),height:parseFloat(t[6])}};return{selector:r,selectors:[r]}}let i=e.value.match(uC);if(i){let r={type:"TemporalSelector",temporal:{startTime:i[4]?parseFloat(i[4]):0,endTime:i[7]?parseFloat(i[7]):void 0}};return{selector:r,selectors:[r]}}return{selector:null,selectors:[]}}return{selector:null,selectors:[]}}function qr(e,t={}){if(Array.isArray(e))return qr(e[0]);if(typeof e=="string"){let[i,r]=e.split("#");return r?qr({type:"SpecificResource",source:{id:i,type:"Unknown"},selector:{type:"FragmentSelector",value:r}}):{type:"SpecificResource",source:{id:i,type:t.typeMap&&t.typeMap[i]||"Unknown"},selector:null,selectors:[]}}if(e.type==="Choice"||e.type==="List"||e.type==="Composite"||e.type==="Independents")return qr(e.items[0]);if(e.type==="SpecificResource"){e.source.type==="Canvas"&&e.source.partOf&&typeof e.source.partOf=="string"&&(e.source.partOf=[{id:e.source.partOf,type:"Manifest"}]);let{selector:i,selectors:r}=e.selector?ol(e.selector):{selector:null,selectors:[]};return{type:"SpecificResource",source:e.source,selector:i,selectors:r}}if(e.id){e.type==="Canvas"&&e.partOf&&typeof e.partOf=="string"&&(e.partOf=[{id:e.partOf,type:"Manifest"}]);let[i,r]=e.id.split("#");return r?qr({type:"SpecificResource",source:Fy(zy({},e),{id:i}),selector:{type:"FragmentSelector",value:r}}):{type:"SpecificResource",source:Fy(zy({},e),{id:i}),selector:null,selectors:[]}}return{type:"SpecificResource",source:e,selector:null,selectors:[]}}function ac(e={},t=[]){let{id:i,selector:r}=e,n=es(),a=Ut(),l=i||n.annotation,u=Ai(d=>l?d.iiif.entities.Annotation[l]:void 0,[l]),c=Ai(d=>u&&u.body?u.body.map(p=>p?d.iiif.entities[p.type][p.id]:null).filter(Boolean):[],[u]);return Ae(()=>{if(!u)return;let d=Ei(ni({},u),{body:c,target:qr(u.target,{typeMap:a.getState().iiif.mapping})});return r?r(d):d},[u,r,c,...t])}function pn(e={},t=[]){let{id:i,selector:r}=e,n=es(),a=i||n.canvas,l=Ai(u=>a?u.iiif.entities.Canvas[a]:void 0,[a]);return Ae(()=>{if(l)return r?r(l):l},[l,r,...t])}function By(e){return e.type==="SpecificResource"?[e.source,{selector:e.selector}]:[e,{selector:null}]}function hC(e,t,i){let r=[],n=null,a=[];for(let l of t){let u=e.get(l.body,{skipSelfReturn:!1});for(let c of u){if(!c)continue;let[d,{selector:p}]=By(c),y=(d.type||"unknown").toLowerCase();if(y==="choice"){let x=e.get(d.items),E=i.length?i.map(S=>x.find(k=>k.id===S)).filter(Boolean):[x[0]];E.length===0&&E.push(x[0]),n={type:"single-choice",items:x.map(S=>({id:S.id,label:S.label,selected:E.indexOf(S)!==-1})),label:c.label},u.push(...E);continue}r.indexOf(y)===-1&&r.push(y),a.push({annotationId:l.id,type:y,resource:d,target:l.target,selector:p})}}return{types:r,items:a,choice:n}}function jy(e,t){let{selector:i,source:r}=Ca(t);if(r.id!==e.id)return[null,r];let n={spatial:{x:0,y:0,width:e.width,height:e.height}};return[i?i.type==="TemporalSelector"?{type:"TemporalBoxSelector",temporal:i.temporal,spatial:n.spatial}:i:null,r]}var cC={makeChoice:()=>{}},oc={type:"unknown"},si=e=>({type:"unknown",reason:e,annotations:{pages:[]}}),dC=(e,t)=>({type:"empty",width:e,height:t,annotations:{pages:[]},image:null,images:[]});function fC(e,t){var i;let r=(i=e==null?void 0:e.iiif)==null?void 0:i.meta[t];return r?r.annotationPageManager:null}function pC(e,t){return Ai(i=>{let r=[];if(!e)return r;let n=Object.keys(i.iiif.entities.AnnotationPage);for(let a of n)if(!t||t.indexOf(a)!==-1){let l=fC(i,a);l&&l.views&&l.views[e]&&r.push(a)}return r},[e,t])}function gC({canvas:e,manifest:t,all:i,canvases:r}){let n=[];if(t)for(let a of t.annotations)n.indexOf(a.id)===-1&&n.push(a.id);if(i){if(r&&r.length)for(let a of r)for(let l of a.annotations)n.indexOf(l.id)===-1&&n.push(l.id)}else if(e)for(let a of e.annotations)n.indexOf(a.id)===-1&&n.push(a.id);return n}function mC(e,t){var i;let r=(i=e==null?void 0:e.iiif)==null?void 0:i.meta[t];return r?r.annotationPageManager:null}function lc(e,t={}){let i=Ut(),r=fn(),n=pn(),a=Iy(),l=Ae(()=>gC({all:t.all,manifest:r,canvas:n,canvases:a}),[t.all,n,a,r]),u=pC(e,t.all?void 0:l),c=Qe(p=>{!e||i.setMetaValue([p,"annotationPageManager","views"],y=>y&&!y[e]?y:Ei(ni({},y||{}),{[e]:!1}))},[e,i]),d=Qe((p,y={})=>{if(!e)return;let x=i.getState(),E=[];if(y!=null&&y.deselectOthers){let S=Object.keys(x.iiif.entities.AnnotationPage);for(let k of S){let T=mC(x,k);T&&T.views&&T.views[e]&&E.push(k)}}for(let S of E)c(S);i.setMetaValue([p,"annotationPageManager","views"],S=>S&&S[e]?S:Ei(ni({},S||{}),{[e]:!0}))},[e,c,i]);return{availablePageIds:l,enabledPageIds:u,setPageEnabled:d,setPageDisabled:c}}function yC(e,t){return Ai((i,r)=>r.get(e.map(n=>({id:n,type:t}))),[e,t])}var Uy=te.createContext(new il);function uc(){return Yt(Uy)}function Dy(){let e=uc(),[t,i]=je({}),r=xe(!1);return fe(()=>()=>{r.current=!0},[]),[Qe((n,{height:a,width:l})=>{if(n){let u=n.id||n["@id"],c=e.loadServiceSync({id:u,width:n.width||l,height:n.height||a,source:n});c?n=c:t[u]||(r.current||i(d=>Ei(ni({},d),{[u]:"loading"})),e.loadService({id:u,width:n.width||l,height:n.height||a}).then(()=>{r.current||i(d=>Ei(ni({},d),{[u]:"done"}))}))}return n},[e,t]),t]}function vC(e={}){let t=ac(),i=pn(e.canvasId?{id:e.canvasId}:void 0);return Ai((r,n)=>{if(!i)return[];if(t&&e.enableSingleAnnotation)return[t];let a=n.get(i.items),l=[];for(let u of a)l.push(...n.get(u.items));return l},[i])}function bC(e,t=[]){let i=Ut(),r=vC({enableSingleAnnotation:e==null?void 0:e.enableSingleAnnotation}),[n,a]=je((e==null?void 0:e.defaultChoices)||[]),l=Ae(()=>hC(i,r,n),[i,r,n,...t]),u={makeChoice:Qe((c,{deselectOthers:d=!0,deselect:p=!1}={})=>{if(l.choice){if(l.choice.type!=="single-choice")throw new Error("Complex choice not supported yet");a(y=>{if(p){let E=y.filter(S=>S!==c);if(E.length===0){let S=l.items[0].resource.id;return S?[S]:[]}return E}if(d)return[c];let x=[...y];if(x.length===0&&l.items.length){let E=l.items[0].resource.id;E&&x.push(E)}return y.indexOf(c)!==-1?y:[...y,c]})}},[l.choice])};return[l,u]}function wC(e,t,i){let r=[];for(let n of t.items){let a=n.resource&&n.resource.type==="SpecificResource"?n.resource.source:n.resource;if(!a.id)return si("No resource Identifier");let l;if(a.service){let S=Jh(a);S[0]&&(l=i(S[0],e))}let u={type:"BoxSelector",spatial:{x:0,y:0,width:e.width,height:e.height}},[c,d]=jy(e,n.target);if(d.id!==e.id)continue;let p={type:"BoxSelector",spatial:{x:0,y:0,width:e.width,height:e.height}},y=n.resource.type==="SpecificResource"?qr(n.resource):null,x=y&&y.selector&&(y.selector.type==="BoxSelector"||y.selector.type==="TemporalBoxSelector")?{type:"BoxSelector",spatial:{x:y.selector.spatial.x,y:y.selector.spatial.y,width:y.selector.spatial.width,height:y.selector.spatial.height}}:p;l&&!l.id&&(l.id=l["@id"]);let E={id:a.id,type:"Image",annotationId:n.annotationId,width:c?a.width:e.width,height:c?a.height:e.height,service:l,sizes:l&&l.sizes?l.sizes:a.width&&a.height?[{width:a.width,height:a.height}]:[],target:c&&c.type!=="PointSelector"?c:u,selector:x};r.push(E)}return{type:"images",image:r[0],images:r,choice:t.choice}}var xC=["model/gltf-binary"];function _C(e,t){let i=t.items[0].resource;return i.format?xC.indexOf(i.format)===-1?si(`3D format: ${i.format} is unsupported`):{type:"3d-model",model:i}:si("Unknown format")}function SC(e,t){var i;if(!e.duration)return si("No duration on canvas");if(t.items.length>1)return si("Only one audio source supported");let r=(i=t.items[0])==null?void 0:i.resource;return r?r.format?{type:"media",media:{annotationId:t.items[0].annotationId,duration:e.duration,url:r.id,type:"Sound",target:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}},format:r.format,selector:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}}},annotations:{pages:[]}}:si("Audio does not have format"):si("Unknown audio")}function EC(e,t){var i;let r=t.items.filter(a=>a.type==="video");if(!e.duration)return si("No duration on canvas");if(r.length>1)return si("Only one video source supported");let n=(i=r[0])==null?void 0:i.resource;return n?n.format?{type:"media",media:{annotationId:t.items[0].annotationId,duration:e.duration,url:n.id,type:"Video",items:[],target:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}},format:n.format,selector:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}}},annotations:{pages:[]}}:si("Video does not have format"):si("Unknown video")}function Wy(e,t={},i){let r=e.language||i||"none";switch(e.type){case"TextualBody":{typeof e.value<"u"&&(t[r]=e.value);break}case"List":case"Composite":case"Choice":e.items&&e.items.forEach(n=>Wy(n,t,r))}return t}function AC(e,t){let i=[];return t.items.forEach(r=>{if(r.resource){let[n]=jy(e,r.target);i.push({annotationId:r.annotationId,text:Wy(r.resource),target:n})}}),{type:"textual-content",items:i}}function kC(e){let t=fn(),i=pn(),r=Ut(),[n,a]=Dy(),{enabledPageIds:l}=lc((e==null?void 0:e.annotationPageManagerId)||(t==null?void 0:t.id)||(i==null?void 0:i.id),{all:!1}),u=yC(l,"AnnotationPage"),c=(e==null?void 0:e.strategies)||["empty","images","media","textual-content","complex-timeline"],[d,p]=bC(e,[a]),y=Ae(()=>{if(!i)return oc;if(d.types.length===0)return c.indexOf("empty")!==-1?dC(i.width,i.height):oc;if(d.types.length!==1)if(d.types.length===2&&d.types.indexOf("text")!==-1)d.types=d.types.filter(E=>E!=="text");else return c.indexOf("complex-timeline")===-1?si("Complex timeline not supported"):si("ComplexTimelineStrategy not yet supported");let x=d.types[0];return x==="image"?c.indexOf("images")===-1?si("Image not supported"):wC(i,d,n):x==="Model"||x==="model"?c.indexOf("3d-model")===-1?si("3D not supported"):_C(i,d):x==="textualbody"?c.indexOf("textual-content")===-1?si("Textual content not supported"):AC(i,d):x==="sound"||x==="audio"?c.indexOf("media")===-1?si("Media not supported"):SC(i,d):x==="video"?c.indexOf("media")===-1?si("Media not supported"):EC(i,d):oc},[i,d,r,p.makeChoice]);return Ae(()=>y.type==="unknown"?[y,cC]:[Ei(ni({},y),{annotations:{pages:u}}),p],[y,u])}var PC=(e,t=[])=>{let i=Ut();fe(()=>{e(i)},[i,...t])};function CC(e,t={}){let i=t.imageServiceLoader||new il;async function r(n,a,l,u=[],c){if(typeof n=="string")return{best:Kh(n),fallback:[],log:[]};let d=e.get(n);if(typeof d=="string")return{best:Kh(d),fallback:[],log:[]};switch(d.type){case"Annotation":{let p=d.body,y=e.get(p[0]);return c&&!y.width&&(y.width=c.width,y.height=c.height),await i.getThumbnailFromResource(y,a,l,u)}case"Canvas":{let p=d;if(p.thumbnail&&p.thumbnail.length){let y=e.get(p.thumbnail[0]),x=await i.getImageCandidates(y,l);x&&x.length&&u.push(...x)}return r(p.items[0],a,l,u,{width:p.width,height:p.height})}case"AnnotationPage":return r(d.items[0],a,l,u,c);case"Choice":return r(d.items[0],a,l,u,c);case"Collection":{let p=d.items[0];return r(p,a,l,u,c)}case"Manifest":{let p=d.items[0];return r(p,a,l,u,c)}case"SpecificResource":case"Image":case"Dataset":case"Sound":case"Text":case"TextualBody":case"Video":return c&&!d.width&&(d.width=c.width,d.height=c.height),i.getThumbnailFromResource(d,a,l,u);case"Service":case"Range":case"AnnotationCollection":case"CanvasReference":case"ContentResource":return{best:void 0,fallback:[],log:[]}}return{best:void 0,fallback:[],log:[]}}return{getBestThumbnailAtSize:r}}function TC(e,t,{canvasId:i,manifestId:r}={}){let n=Ut(),a=uc(),l=Ae(()=>CC(n,{imageServiceLoader:a}),[n,a]),[u,c]=je(),d=fn(r?{id:r}:void 0),p=pn(i?{id:i}:void 0),y=p||d,x=xe(!1);if(fe(()=>(x.current=!1,()=>{x.current=!0}),[]),!y)throw new Error("Must be called under a manifest or canvas context.");return PC(E=>{l.getBestThumbnailAtSize(y,e,t).then(S=>{S.best&&!x.current&&c(S.best)})},[y]),u}function IC(e){return{isMuted:!1,playRequested:!1,isPlaying:!1,isFinished:!1,volume:100,duration:e}}function RC(e,t){switch(t.type){case"FINISHED":return Ei(ni({},e),{isFinished:!0,isPlaying:!1,playRequested:!1});case"PLAY_PAUSE":return Ei(ni({},e),{isFinished:!1,isPlaying:!e.isPlaying});case"PLAY_REQUESTED":return Ei(ni({},e),{isFinished:!1,playRequested:!0});case"PAUSE":return Ei(ni({},e),{isPlaying:!1});case"PLAY":return Ei(ni({},e),{isFinished:!1,playRequested:!1,isPlaying:!0});case"MUTE":return Ei(ni({},e),{isMuted:!0});case"SET_VOLUME":return Ei(ni({},e),{volume:t.volume,isMuted:t.volume===0});case"TOGGLE_MUTE":return Ei(ni({},e),{isMuted:!e.isMuted});case"UNMUTE":return Ei(ni({},e),{isMuted:!1})}return e}function OC(e){let t=Math.round(e);return`${Math.floor(t/60)}:${`${t%60}`.padStart(2,"0")}`}function Hy(e){let[t,i]=As(RC,IC(e.duration)),r=xe(null),n=xe(null),a=xe(null),l=xe(!1),u=Qe(()=>{n.current&&r.current&&(n.current.innerHTML=OC(r.current.currentTime),a.current&&(a.current.style.width=`${r.current.currentTime/e.duration*100}%`),l.current!==r.current.muted&&(l.current=r.current.muted,i(r.current.muted?{type:"MUTE"}:{type:"UNMUTE"})))},[e.duration]),c=Qe(()=>{r.current&&(i({type:"PLAY_REQUESTED"}),r.current.play().then(()=>{i({type:"PLAY"})}),u())},[u]),d=Qe(()=>{r.current&&(r.current.duration>0&&r.current.paused?c():p())},[u]),p=Qe(()=>{r.current&&(r.current.pause(),i({type:"PAUSE"}),u())},[u]),y=Qe(()=>{r.current&&(r.current.muted=!r.current.muted,i(r.current.muted?{type:"MUTE"}:{type:"UNMUTE"}))},[]),x=Qe(()=>{r.current&&(r.current.muted=!0,i({type:"MUTE"}))},[]),E=Qe(()=>{r.current&&(r.current.muted=!1,i({type:"UNMUTE"}))},[]),S=Qe(R=>{r.current&&(r.current.muted=!1,r.current.volume=R/100,i({type:"SET_VOLUME",volume:R}))},[]),k=Qe(R=>{r.current&&(r.current.currentTime=Math.max(0,Math.min(R*e.duration,e.duration)),u())},[]),T=Qe(R=>{r.current&&(r.current.currentTime=Math.max(0,Math.min(R,e.duration)),u())},[]);return fe(()=>{let R=setInterval(()=>{u()},350);return()=>clearInterval(R)},[u,e.duration]),fe(()=>{let R=()=>{i({type:"FINISHED"})},A=r.current;return A==null||A.addEventListener("ended",R),()=>A==null?void 0:A.removeEventListener("ended",R)},[]),[{element:r,currentTime:n,progress:a},t,{play:c,pause:p,playPause:d,mute:x,unmute:E,toggleMute:y,setVolume:S,setDurationPercent:k,setTime:T}]}var MC=ri(null),LC=ri(null),$C=ri(null);function NC({actions:e,state:t,children:i,currentTime:r,progress:n,element:a}){return Ke($C.Provider,{value:{currentTime:r,progress:n,element:a},children:Ke(LC.Provider,{value:e,children:Ke(MC.Provider,{value:t,children:i})})})}function zC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FC(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BC(e,t,i){return t&&FC(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}te.createContext(),function(){function e(){zC(this,e),this.usedNamespaces={}}return BC(e,[{key:"addUsedNamespaces",value:function(t){var i=this;t.forEach(function(r){i.usedNamespaces[r]||(i.usedNamespaces[r]=!0)})}},{key:"getUsedNamespaces",value:function(){return Object.keys(this.usedNamespaces)}}]),e}();function jC(e={},t=[]){let{id:i,selector:r}=e,n=es(),a=i||n.annotationPage,l=Ai(u=>a?u.iiif.entities.AnnotationPage[a]:void 0,[a]);return Ae(()=>{if(l)return r?r(l):l},[l,...t])}function ll(){let e=Yt(tc);return e&&e.vault?e.vault:Wm()}function UC(){let e=Ut();return Ae(()=>Ly(e),[e])}pe();async function DC(e){if(!e)return null;switch(e){case"static":return{render:"static",interactive:!1,viewport:!0};case"responsive":return{render:"static",interactive:!1,viewport:!1};case"zoom":return{render:"canvas",interactive:!0,viewport:!0}}if(e.startsWith("http"))return fetch(e).then(t=>t.json());if(e.startsWith("#")){let t=document.getElementById(e.slice(1));if(t)try{return JSON.parse(t.innerText)}catch{console.error("Invalid JSON on element",t)}}return null}function WC(e,t){let[i,r]=je(!1),[n,a]=je({}),l=e&&!n.__loaded,u=!!((!e||n.__loaded)&&i);return Et(()=>{let c=[];return e&&DC(e).then(d=>{if(d){let p=d,{media:y}=p,x=le(p,["media"]),E=Object.keys(y||{}),S=E.map(T=>({query:T,mql:window.matchMedia(T)})),k=()=>{if(!S.length||!y)return C({__loaded:!0},x);let T=S.filter(({mql:A})=>A.matches),R=C(C({__loaded:!0},x),T.reduce((A,$)=>Object.assign(A,y[$.query]),{}));if(t)for(let A of T)t(A.query,R);return R};for(let T of E){let R=window.matchMedia(T),A=()=>{let $=k();a($)};R.addEventListener("change",A),c.push(()=>{R.removeEventListener("change",A)})}a(k())}else a({__loaded:!0})}).catch(()=>{a({__loaded:!0})}),()=>{c.forEach(d=>d())}},[u,e]),{internalConfig:n,isReady:u,isConfigBlocking:l,setIsReady:r}}pe();var Ia=(e,t,i)=>{let r=e.length,n=i||Re(r);for(let a=0;a<r;a++)n[a]=a%5===0?e[a+1]<t[3]&&e[a+3]>t[1]&&e[a+2]<t[4]&&e[a+4]>t[2]?1:0:e[a];return n};function Re(e,t,i){return new Float32Array(e,t,i)}var HC=(e,t,i)=>{let r=e[1]<=t[3]&&e[3]>=t[1]&&e[2]<=t[4]&&e[4]>=t[2],n=i||Re(5);return r?(n[0]=1,n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n[3]=Math.min(e[3],t[3]),n[4]=Math.min(e[4],t[4]),n):(n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n)},qC=e=>e.length/5,Qr=(e,t,i)=>{let r=i||Re(9);return r[0]=e[0]*t[0]+e[1]*t[3]+e[2]*t[6],r[1]=e[0]*t[1]+e[1]*t[4]+e[2]*t[7],r[2]=e[0]*t[2]+e[1]*t[5]+e[2]*t[8],r[3]=e[3]*t[0]+e[4]*t[3]+e[5]*t[6],r[4]=e[3]*t[1]+e[4]*t[4]+e[5]*t[7],r[5]=e[3]*t[2]+e[4]*t[5]+e[5]*t[8],r[6]=e[6]*t[0]+e[7]*t[3]+e[8]*t[6],r[7]=e[6]*t[1]+e[7]*t[4]+e[8]*t[7],r[8]=e[6]*t[2]+e[7]*t[5]+e[8]*t[8],r},st=class{constructor(e){this.index=0,this.length=e,this.points=Re(this.length)}static grid(e=1,t=1){return new st(5*e*t)}static point(e,t){let i=Re(5);return i[0]=1,i[1]=e,i[2]=t,i[3]=e,i[4]=t,i}static positionPair(e){let t=Re(5);return t[0]=1,t[1]=e.x1,t[2]=e.y1,t[3]=e.x2,t[4]=e.y2,t}static projection(e){return st.singleBox(e.width,e.height,e.x,e.y)}static singleBox(e,t,i=0,r=0){let n=Re(5);return n[0]=1,n[1]=i,n[2]=r,n[3]=e+i,n[4]=t+r,n}row(e){return e(this)}addPoints(e,t,i,r){return this.points[this.index]=1,this.points[1+this.index]=e,this.points[2+this.index]=t,this.points[3+this.index]=i,this.points[4+this.index]=r,this.index+=5,this}addBox(e,t,i,r){return this.addPoints(e,t,e+i,t+r),this}build(){return this.points}},Ar=(e,t)=>{let i=e.length;for(let r=0;r<i;r++)e[r]=r%5===0?t[6]*e[r+1]+t[7]*e[r+2]+t[8]*e[r]:r%5%2===1?t[0]*e[r]+t[1]*e[r+1]+t[2]:t[3]*e[r-1]+t[4]*e[r]+t[5];return e},gn=e=>{let t=Re(9);return t[0]=e,t[4]=e,t[8]=1,t},Li=(e,t)=>{let i=Re(9);return i[0]=1,i[2]=e,i[4]=1,i[5]=t,i[8]=1,i},Ra=(e,t,i)=>Qr(Li((1-e)*t,(1-e)*i),gn(e)),Vr=(e,t,i)=>{let r=e.length,n=i&&i.length>=r?i.slice(0,r):Re(r);for(let a=0;a<r;a++)n[a]=a%5===0?t[6]*e[a+1]+t[7]*e[a+2]+t[8]*e[a]:a%5%2===1?t[0]*e[a]+t[1]*e[a+1]+t[2]:t[3]*e[a-1]+t[4]*e[a]+t[5];return n},Oa=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,QC=typeof AbortController=="function",ul=QC?AbortController:class{constructor(){this.signal=new qy}abort(e=new Error("This operation was aborted")){this.signal.reason=this.signal.reason||e,this.signal.aborted=!0,this.signal.dispatchEvent({type:"abort",target:this.signal})}},VC=typeof AbortSignal=="function",GC=typeof ul.AbortSignal=="function",qy=VC?AbortSignal:GC?ul.AbortController:class{constructor(){this.reason=void 0,this.aborted=!1,this._listeners=[]}dispatchEvent(e){e.type==="abort"&&(this.aborted=!0,this.onabort(e),this._listeners.forEach(t=>t(e),this))}onabort(){}addEventListener(e,t){e==="abort"&&this._listeners.push(t)}removeEventListener(e,t){e==="abort"&&(this._listeners=this._listeners.filter(i=>i!==t))}},hc=new Set,cc=(e,t)=>{let i=`LRU_CACHE_OPTION_${e}`;hl(i)&&fc(i,`${e} option`,`options.${t}`,Ds)},dc=(e,t)=>{let i=`LRU_CACHE_METHOD_${e}`;if(hl(i)){let{prototype:r}=Ds,{get:n}=Object.getOwnPropertyDescriptor(r,e);fc(i,`${e} method`,`cache.${t}()`,n)}},ZC=(e,t)=>{let i=`LRU_CACHE_PROPERTY_${e}`;if(hl(i)){let{prototype:r}=Ds,{get:n}=Object.getOwnPropertyDescriptor(r,e);fc(i,`${e} property`,`cache.${t}`,n)}},Qy=(...e)=>{typeof process=="object"&&process&&typeof process.emitWarning=="function"?process.emitWarning(...e):console.error(...e)},hl=e=>!hc.has(e),fc=(e,t,i,r)=>{hc.add(e);let n=`The ${t} is deprecated. Please use ${i} instead.`;Qy(n,"DeprecationWarning",e,r)},mn=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),Vy=e=>mn(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?cl:null:null,cl=class extends Array{constructor(e){super(e),this.fill(0)}},YC=class{constructor(e){if(e===0)return[];let t=Vy(e);this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},Ds=class{constructor(e={}){let{max:t=0,ttl:i,ttlResolution:r=1,ttlAutopurge:n,updateAgeOnGet:a,updateAgeOnHas:l,allowStale:u,dispose:c,disposeAfter:d,noDisposeOnSet:p,noUpdateTTL:y,maxSize:x=0,maxEntrySize:E=0,sizeCalculation:S,fetchMethod:k,fetchContext:T,noDeleteOnFetchRejection:R,noDeleteOnStaleGet:A,allowStaleOnFetchRejection:$,allowStaleOnFetchAbort:z,ignoreFetchAbort:B}=e,{length:H,maxAge:Y,stale:Q}=e instanceof Ds?{}:e;if(t!==0&&!mn(t))throw new TypeError("max option must be a nonnegative integer");let he=t?Vy(t):Array;if(!he)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=x,this.maxEntrySize=E||this.maxSize,this.sizeCalculation=S||H,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=k||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=T,!this.fetchMethod&&T!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new he(t),this.prev=new he(t),this.head=0,this.tail=0,this.free=new YC(t),this.initialFill=1,this.size=0,typeof c=="function"&&(this.dispose=c),typeof d=="function"?(this.disposeAfter=d,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!p,this.noUpdateTTL=!!y,this.noDeleteOnFetchRejection=!!R,this.allowStaleOnFetchRejection=!!$,this.allowStaleOnFetchAbort=!!z,this.ignoreFetchAbort=!!B,this.maxEntrySize!==0){if(this.maxSize!==0&&!mn(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!mn(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!u||!!Q,this.noDeleteOnStaleGet=!!A,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!l,this.ttlResolution=mn(r)||r===0?r:1,this.ttlAutopurge=!!n,this.ttl=i||Y||0,this.ttl){if(!mn(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){let G="LRU_CACHE_UNBOUNDED";hl(G)&&(hc.add(G),Qy("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",G,Ds))}Q&&cc("stale","allowStale"),Y&&cc("maxAge","ttl"),H&&cc("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new cl(this.max),this.starts=new cl(this.max),this.setItemTTL=(i,r,n=Oa.now())=>{if(this.starts[i]=r!==0?n:0,this.ttls[i]=r,r!==0&&this.ttlAutopurge){let a=setTimeout(()=>{this.isStale(i)&&this.delete(this.keyList[i])},r+1);a.unref&&a.unref()}},this.updateItemAge=i=>{this.starts[i]=this.ttls[i]!==0?Oa.now():0},this.statusTTL=(i,r)=>{i&&(i.ttl=this.ttls[r],i.start=this.starts[r],i.now=e||t(),i.remainingTTL=i.now+i.ttl-i.start)};let e=0,t=()=>{let i=Oa.now();if(this.ttlResolution>0){e=i;let r=setTimeout(()=>e=0,this.ttlResolution);r.unref&&r.unref()}return i};this.getRemainingTTL=i=>{let r=this.keyMap.get(i);return r===void 0?0:this.ttls[r]===0||this.starts[r]===0?1/0:this.starts[r]+this.ttls[r]-(e||t())},this.isStale=i=>this.ttls[i]!==0&&this.starts[i]!==0&&(e||t())-this.starts[i]>this.ttls[i]}updateItemAge(e){}statusTTL(e,t){}setItemTTL(e,t,i){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new cl(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,t,i,r)=>{if(this.isBackgroundFetch(t))return 0;if(!mn(i))if(r){if(typeof r!="function")throw new TypeError("sizeCalculation must be a function");if(i=r(t,e),!mn(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i},this.addItemSize=(e,t,i)=>{if(this.sizes[e]=t,this.maxSize){let r=this.maxSize-this.sizes[e];for(;this.calculatedSize>r;)this.evict(!0)}this.calculatedSize+=this.sizes[e],i&&(i.entrySize=t,i.totalCalculatedSize=this.calculatedSize)}}removeItemSize(e){}addItemSize(e,t){}requireSize(e,t,i,r){if(i||r)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;!(!this.isValidIndex(t)||((e||!this.isStale(t))&&(yield t),t===this.head));)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;!(!this.isValidIndex(t)||((e||!this.isStale(t))&&(yield t),t===this.tail));)t=this.next[t]}isValidIndex(e){return e!==void 0&&this.keyMap.get(this.keyList[e])===e}*entries(){for(let e of this.indexes())this.valList[e]!==void 0&&this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield[this.keyList[e],this.valList[e]])}*rentries(){for(let e of this.rindexes())this.valList[e]!==void 0&&this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield[this.keyList[e],this.valList[e]])}*keys(){for(let e of this.indexes())this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.keyList[e])}*rkeys(){for(let e of this.rindexes())this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.keyList[e])}*values(){for(let e of this.indexes())this.valList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.valList[e])}*rvalues(){for(let e of this.rindexes())this.valList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.valList[e])}[Symbol.iterator](){return this.entries()}find(e,t){for(let i of this.indexes()){let r=this.valList[i],n=this.isBackgroundFetch(r)?r.__staleWhileFetching:r;if(n!==void 0&&e(n,this.keyList[i],this))return this.get(this.keyList[i],t)}}forEach(e,t=this){for(let i of this.indexes()){let r=this.valList[i],n=this.isBackgroundFetch(r)?r.__staleWhileFetching:r;n!==void 0&&e.call(t,n,this.keyList[i],this)}}rforEach(e,t=this){for(let i of this.rindexes()){let r=this.valList[i],n=this.isBackgroundFetch(r)?r.__staleWhileFetching:r;n!==void 0&&e.call(t,n,this.keyList[i],this)}}get prune(){return dc("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(let t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){let e=[];for(let t of this.indexes({allowStale:!0})){let i=this.keyList[t],r=this.valList[t],n=this.isBackgroundFetch(r)?r.__staleWhileFetching:r;if(n===void 0)continue;let a={value:n};if(this.ttls){a.ttl=this.ttls[t];let l=Oa.now()-this.starts[t];a.start=Math.floor(Date.now()-l)}this.sizes&&(a.size=this.sizes[t]),e.unshift([i,a])}return e}load(e){this.clear();for(let[t,i]of e){if(i.start){let r=Date.now()-i.start;i.start=Oa.now()-r}this.set(t,i.value,i)}}dispose(e,t,i){}set(e,t,{ttl:i=this.ttl,start:r,noDisposeOnSet:n=this.noDisposeOnSet,size:a=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL,status:c}={}){if(a=this.requireSize(e,t,a,l),this.maxEntrySize&&a>this.maxEntrySize)return c&&(c.set="miss",c.maxEntrySizeExceeded=!0),this.delete(e),this;let d=this.size===0?void 0:this.keyMap.get(e);if(d===void 0)d=this.newIndex(),this.keyList[d]=e,this.valList[d]=t,this.keyMap.set(e,d),this.next[this.tail]=d,this.prev[d]=this.tail,this.tail=d,this.size++,this.addItemSize(d,a,c),c&&(c.set="add"),u=!1;else{this.moveToTail(d);let p=this.valList[d];if(t!==p){if(this.isBackgroundFetch(p)?p.__abortController.abort(new Error("replaced")):n||(this.dispose(p,e,"set"),this.disposeAfter&&this.disposed.push([p,e,"set"])),this.removeItemSize(d),this.valList[d]=t,this.addItemSize(d,a,c),c){c.set="replace";let y=p&&this.isBackgroundFetch(p)?p.__staleWhileFetching:p;y!==void 0&&(c.oldValue=y)}}else c&&(c.set="update")}if(i!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),u||this.setItemTTL(d,i,r),this.statusTTL(c,d),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){let e=this.valList[this.head];return this.evict(!0),e}}evict(e){let t=this.head,i=this.keyList[t],r=this.valList[t];return this.isBackgroundFetch(r)?r.__abortController.abort(new Error("evicted")):(this.dispose(r,i,"evict"),this.disposeAfter&&this.disposed.push([r,i,"evict"])),this.removeItemSize(t),e&&(this.keyList[t]=null,this.valList[t]=null,this.free.push(t)),this.head=this.next[t],this.keyMap.delete(i),this.size--,t}has(e,{updateAgeOnHas:t=this.updateAgeOnHas,status:i}={}){let r=this.keyMap.get(e);if(r!==void 0)if(this.isStale(r))i&&(i.has="stale",this.statusTTL(i,r));else return t&&this.updateItemAge(r),i&&(i.has="hit"),this.statusTTL(i,r),!0;else i&&(i.has="miss");return!1}peek(e,{allowStale:t=this.allowStale}={}){let i=this.keyMap.get(e);if(i!==void 0&&(t||!this.isStale(i))){let r=this.valList[i];return this.isBackgroundFetch(r)?r.__staleWhileFetching:r}}backgroundFetch(e,t,i,r){let n=t===void 0?void 0:this.valList[t];if(this.isBackgroundFetch(n))return n;let a=new ul;i.signal&&i.signal.addEventListener("abort",()=>a.abort(i.signal.reason));let l={signal:a.signal,options:i,context:r},u=(x,E=!1)=>{let{aborted:S}=a.signal,k=i.ignoreFetchAbort&&x!==void 0;return i.status&&(S&&!E?(i.status.fetchAborted=!0,i.status.fetchError=a.signal.reason,k&&(i.status.fetchAbortIgnored=!0)):i.status.fetchResolved=!0),S&&!k&&!E?d(a.signal.reason):(this.valList[t]===y&&(x===void 0?y.__staleWhileFetching?this.valList[t]=y.__staleWhileFetching:this.delete(e):(i.status&&(i.status.fetchUpdated=!0),this.set(e,x,l.options))),x)},c=x=>(i.status&&(i.status.fetchRejected=!0,i.status.fetchError=x),d(x)),d=x=>{let{aborted:E}=a.signal,S=E&&i.allowStaleOnFetchAbort,k=S||i.allowStaleOnFetchRejection,T=k||i.noDeleteOnFetchRejection;if(this.valList[t]===y&&(!T||y.__staleWhileFetching===void 0?this.delete(e):S||(this.valList[t]=y.__staleWhileFetching)),k)return i.status&&y.__staleWhileFetching!==void 0&&(i.status.returnedStale=!0),y.__staleWhileFetching;if(y.__returned===y)throw x},p=(x,E)=>{this.fetchMethod(e,n,l).then(S=>x(S),E),a.signal.addEventListener("abort",()=>{(!i.ignoreFetchAbort||i.allowStaleOnFetchAbort)&&(x(),i.allowStaleOnFetchAbort&&(x=S=>u(S,!0)))})};i.status&&(i.status.fetchDispatched=!0);let y=new Promise(p).then(u,c);return y.__abortController=a,y.__staleWhileFetching=n,y.__returned=null,t===void 0?(this.set(e,y,W(C({},l.options),{status:void 0})),t=this.keyMap.get(e)):this.valList[t]=y,y}isBackgroundFetch(e){return e&&typeof e=="object"&&typeof e.then=="function"&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||e.__returned===null)}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet,ttl:n=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:l=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:c=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:p=this.allowStaleOnFetchRejection,ignoreFetchAbort:y=this.ignoreFetchAbort,allowStaleOnFetchAbort:x=this.allowStaleOnFetchAbort,fetchContext:E=this.fetchContext,forceRefresh:S=!1,status:k,signal:T}={}){if(!this.fetchMethod)return k&&(k.fetch="get"),this.get(e,{allowStale:t,updateAgeOnGet:i,noDeleteOnStaleGet:r,status:k});let R={allowStale:t,updateAgeOnGet:i,noDeleteOnStaleGet:r,ttl:n,noDisposeOnSet:a,size:l,sizeCalculation:u,noUpdateTTL:c,noDeleteOnFetchRejection:d,allowStaleOnFetchRejection:p,allowStaleOnFetchAbort:x,ignoreFetchAbort:y,status:k,signal:T},A=this.keyMap.get(e);if(A===void 0){k&&(k.fetch="miss");let $=this.backgroundFetch(e,A,R,E);return $.__returned=$}else{let $=this.valList[A];if(this.isBackgroundFetch($)){let Q=t&&$.__staleWhileFetching!==void 0;return k&&(k.fetch="inflight",Q&&(k.returnedStale=!0)),Q?$.__staleWhileFetching:$.__returned=$}let z=this.isStale(A);if(!S&&!z)return k&&(k.fetch="hit"),this.moveToTail(A),i&&this.updateItemAge(A),this.statusTTL(k,A),$;let B=this.backgroundFetch(e,A,R,E),H=B.__staleWhileFetching!==void 0,Y=H&&t;return k&&(k.fetch=H&&z?"stale":"refresh",Y&&z&&(k.returnedStale=!0)),Y?B.__staleWhileFetching:B.__returned=B}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:r=this.noDeleteOnStaleGet,status:n}={}){let a=this.keyMap.get(e);if(a!==void 0){let l=this.valList[a],u=this.isBackgroundFetch(l);return this.statusTTL(n,a),this.isStale(a)?(n&&(n.get="stale"),u?(n&&(n.returnedStale=t&&l.__staleWhileFetching!==void 0),t?l.__staleWhileFetching:void 0):(r||this.delete(e),n&&(n.returnedStale=t),t?l:void 0)):(n&&(n.get="hit"),u?l.__staleWhileFetching:(this.moveToTail(a),i&&this.updateItemAge(a),l))}else n&&(n.get="miss")}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return dc("del","delete"),this.delete}delete(e){let t=!1;if(this.size!==0){let i=this.keyMap.get(e);if(i!==void 0)if(t=!0,this.size===1)this.clear();else{this.removeItemSize(i);let r=this.valList[i];this.isBackgroundFetch(r)?r.__abortController.abort(new Error("deleted")):(this.dispose(r,e,"delete"),this.disposeAfter&&this.disposed.push([r,e,"delete"])),this.keyMap.delete(e),this.keyList[i]=null,this.valList[i]=null,i===this.tail?this.tail=this.prev[i]:i===this.head?this.head=this.next[i]:(this.next[this.prev[i]]=this.next[i],this.prev[this.next[i]]=this.prev[i]),this.size--,this.free.push(i)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(let e of this.rindexes({allowStale:!0})){let t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort(new Error("deleted"));else{let i=this.keyList[e];this.dispose(t,i,"delete"),this.disposeAfter&&this.disposed.push([t,i,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return dc("reset","clear"),this.clear}get length(){return ZC("length","size"),this.size}static get AbortController(){return ul}static get AbortSignal(){return qy}},XC=Ds,KC=Ue(Ox(),1);pe(),pe(),pe();var Gy=Ue(Mx());function JC({debounce:e,scroll:t,polyfill:i}={debounce:0,scroll:!1}){let r=i||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");let[n,a]=je({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=xe({element:null,scrollContainers:null,resizeObserver:null,lastBounds:n}),u=e?typeof e=="number"?e:e.scroll:null,c=e?typeof e=="number"?e:e.resize:null,d=xe(!1);fe(()=>(d.current=!0,()=>void(d.current=!1)));let[p,y,x]=Ae(()=>{let T=()=>{if(!l.current.element)return;let{left:R,top:A,width:$,height:z,bottom:B,right:H,x:Y,y:Q}=l.current.element.getBoundingClientRect(),he={left:R,top:A,width:$,height:z,bottom:B,right:H,x:Y,y:Q};Object.freeze(he),d.current&&!rT(l.current.lastBounds,he)&&a(l.current.lastBounds=he)};return[T,c?(0,Gy.debounce)(T,c):T,u?(0,Gy.debounce)(T,u):T]},[a,u,c]);function E(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(T=>T.removeEventListener("scroll",x,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function S(){!l.current.element||(l.current.resizeObserver=new r(x),l.current.resizeObserver.observe(l.current.element),t&&l.current.scrollContainers&&l.current.scrollContainers.forEach(T=>T.addEventListener("scroll",x,{capture:!0,passive:!0})))}let k=T=>{!T||T===l.current.element||(E(),l.current.element=T,l.current.scrollContainers=Zy(T),S())};return tT(x,!!t),eT(y),fe(()=>{E(),S()},[t,x,y]),fe(()=>E,[]),[k,n,p]}function eT(e){fe(()=>{let t=e;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[e])}function tT(e,t){fe(()=>{if(t){let i=e;return window.addEventListener("scroll",i,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",i,!0)}},[e,t])}function Zy(e){let t=[];if(!e||e===document.body)return t;let{overflow:i,overflowX:r,overflowY:n}=window.getComputedStyle(e);return[i,r,n].some(a=>a==="auto"||a==="scroll")&&t.push(e),[...t,...Zy(e.parentElement)]}var iT=["x","y","top","bottom","left","right","width","height"],rT=(e,t)=>iT.every(i=>e[i]===t[i]),Yy=JC;pe(),pe();var nT=Ue(Kf(),1);pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe(),pe();var sT=Object.defineProperty,aT=(e,t,i)=>t in e?sT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,M=(e,t,i)=>(aT(e,typeof t!="symbol"?t+"":t,i),i),dl=["onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onScroll","onWheel","onClick","onDragStart","onDragEnd","onDragEnter","onDragExit","onDrag","onDragOver"];function oT(){return dl.reduce((e,t)=>(e[t]=[],e),{})}var Ws=dl.reduce((e,t)=>(e[t.slice(2).toLowerCase()]=t,e[t]=t,e),{}),lT="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",fl=(e=21)=>{let t="",i=crypto.getRandomValues(new Uint8Array(e));for(;e--;)t+=lT[i[e]&63];return t},kr=class{constructor(){M(this,"__id"),M(this,"__revision",0),M(this,"__host"),M(this,"__onCreate"),M(this,"__parent"),M(this,"__owner",{value:void 0}),M(this,"__state",{}),M(this,"eventHandlers"),M(this,"scale",1),M(this,"layers",[]),M(this,"time",[]),M(this,"_crop"),M(this,"cropData"),M(this,"id"),M(this,"addEventListener",(e,t,i)=>{let r=Ws[e];if(!this.eventHandlers[r])throw new Error(`Unknown event ${r}`);this.eventHandlers[r].indexOf(t)===-1&&this.eventHandlers[r].push(t)}),M(this,"removeEventListener",(e,t)=>{let i=Ws[e];if(!this.eventHandlers[i]){console.warn(`Unknown event ${i}`);return}this.eventHandlers[i].indexOf(t)!==-1&&(this.eventHandlers[i]=this.eventHandlers[i].filter(r=>r!==t))}),this.id=this.__id=fl(),this.eventHandlers=oT()}get crop(){return this._crop}set crop(e){this._crop=e}getObjectsAt(e){return[]}getAllPointsAt(e,t,i){return[]}getScheduledUpdates(e,t){return[]}dispatchEvent(e,t){let i=this.eventHandlers[e],r=i?i.length:0,n=!1;if(r)for(let a=0;a<r;a++)try{i[a](t),n=!0}catch(l){console.error(e,l)}return n}get x(){return this.points[1]}get y(){return this.points[2]}get width(){return this.points[3]-this.points[1]}get height(){return this.points[4]-this.points[2]}translate(e,t){Ar(this.points,Li(e,t))}atScale(e){Ar(this.points,Ra(e,this.x,this.y)),this.scale*=e}transform(e){Ar(this.points,e)}applyProps(e){this.__revision++}appendChild(e){}removeChild(e){}insertBefore(e,t){}hideInstance(){}},Gr=class ff extends kr{constructor(t){if(super(),M(this,"type","spacial-content"),M(this,"id"),M(this,"uri"),M(this,"display"),M(this,"points"),M(this,"priority"),M(this,"style",{opacity:1}),!t)this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:Re(5)},this.points=Re(5);else{let i=t.scale||1;this.id=t.id||t.uri,this.uri=t.uri,this.points=st.singleBox(t.width,t.height,t.x,t.y),this.display={x:0,y:0,scale:i,width:t.width/i,height:t.height/i,points:st.singleBox(t.width/i,t.height/i),rotation:t==null?void 0:t.rotation}}}applyProps(t){let i=t.display?t.display.width:t.target.width,r=t.target.width/i;if(this.id=t.id||t.uri,this.uri=t.uri,this.points.set(st.singleBox(t.target.width,t.target.height,t.target.x,t.target.y)),t.style&&typeof t.style.opacity<"u"&&(this.style.opacity=t.style.opacity),t.crop){this.cropData=t.crop;let n=st.singleBox(t.crop.width,t.crop.height,t.crop.x,t.crop.y);Ar(n,Li(-t.crop.x,-t.crop.y)),this.crop?this.crop.set(n):this.crop=Re(n)}t.display?(this.display.scale=r,this.display.width=t.display.width,this.display.height=t.display.height,this.display.rotation=t.display.rotation,this.display.points=st.singleBox(t.display.width,t.display.height)):(this.display.scale=r,this.display.width=t.target.width/r,this.display.height=t.target.height/r,this.display.points=st.singleBox(t.target.width/r,t.target.height/r))}getAllPointsAt(t,i,r){return[[this,this.crop||this.points,i]]}static fromSvg(t,i,r,n){return ff.fromImage("data:image/svg+xml;base64,"+btoa(t),i,r,n)}static fromImage(t,i,r,n){let a=new ff;return a.applyProps({uri:t,id:n,display:r,target:i}),a}getImageUrl(){return this.uri}},pl=class extends kr{constructor(e){if(super(),M(this,"type","spacial-content"),M(this,"id"),M(this,"uri"),M(this,"display"),M(this,"points"),M(this,"getTexture"),this.getTexture=()=>({source:void 0,hash:-1}),!e)this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:Re(5)},this.points=Re(5);else{let t=e.scale||1;this.id=e.id||e.uri,this.uri=e.uri,this.points=st.singleBox(e.width,e.height),this.display={x:0,y:0,scale:t,width:e.width/t,height:e.height/t,points:t!==1?st.singleBox(e.width/t,e.height/t):this.points}}}applyProps(e){let t=e.display?e.display.width:e.target.width,i=e.target.width/t;this.id=e.id,this.points.set(st.singleBox(e.target.width,e.target.height)),this.display.scale=i,this.display.width=e.target.width/i,this.display.height=e.target.height/i,this.getTexture=e.getTexture,this.display.points=i!==1?st.singleBox(e.target.width/i,e.target.height/i):this.points}getAllPointsAt(e,t,i){return[[this,this.points,t]]}};function uT(e,t,i=1){let r=t.length;if(r===0)throw new Error("No resources passed in.");let n=0;for(let a=0;a<r&&!(!t[a]||!t[a].display);a++)n=Math.abs(t[a].display.scale-e)*i<Math.abs(t[n].display.scale-e)?a:n;return n}function Xy(e,t){return Math.abs(e-t)}function gl(e,t){let i=Xy(e.x,t.x),r=Xy(e.y,t.y);return Math.sqrt(Math.pow(i,2)+Math.pow(r,2))}function hT(e){let t=e.length;return e.indexOf("/info.json")===t-10?e.slice(0,-10):e}function ml(e,t,i){return Math.min(Math.max(e,t),i)}var is=class Kw extends kr{constructor(t){super(),M(this,"id"),M(this,"type","spacial-content"),M(this,"display"),M(this,"tileWidth"),M(this,"style",{opacity:1}),M(this,"points"),M(this,"service"),M(this,"format","jpg"),M(this,"crop2"),M(this,"tileUrl"),this.tileUrl=hT(t.url),this.id=t.id||`${this.tileUrl}--${t.scaleFactor}`,this.points=t.displayPoints?t.displayPoints:Vr(t.points,gn(t.scaleFactor)),this.tileWidth=t.tileWidth,this.display={x:0,y:0,width:t.width/t.scaleFactor,height:t.height/t.scaleFactor,points:t.points,scale:t.scaleFactor},t.format&&(this.format=t.format)}applyProps(t){if(t.style&&typeof t.style.opacity<"u"&&(this.style.opacity=t.style.opacity),t.service!==this.service&&(this.service=t.service),t.format?this.format=t.format:this.format="jpg",t.crop){this.cropData=t.crop;let i=Re([...this.points]),r=i.length/5,n=t.crop.x||0,a=t.crop.y||0,l=t.crop.x+t.crop.width,u=t.crop.y+t.crop.height;for(let c=0;c<r;c++){let d=c*5;i[d+1]<l&&i[d+3]>n&&i[d+2]<u&&i[d+4]>a?(i[d+1]=ml(i[d+1],n,l),i[d+3]=ml(i[d+3],n,l),i[d+2]=ml(i[d+2],a,u),i[d+4]=ml(i[d+4],a,u)):i[d]=0}Ar(i,Li(-t.crop.x,-t.crop.y)),this.crop?this.crop.set(i):this.crop=i}}static fromTile(t,i,r,n,a,l){r.height=r.height?r.height:r.width;let u=Math.ceil(i.width/n),c=Math.ceil(i.height/n),d=Math.ceil(u/r.width),p=Math.ceil(c/r.height),y=st.grid(d,p),x=st.grid(d,p);for(let S=0;S<p;S++)for(let k=0;k<d;k++){let T=k*r.width,R=S*r.height;x.addPoints(T*n,R*n,k===d-1?i.width:(T+r.width)*n,S===p-1?i.height:(R+r.height)*n),y.addPoints(T,R,k===d-1?u:T+r.width,S===p-1?c:R+r.height)}let E=new Kw({url:t,scaleFactor:n,points:y.build(),displayPoints:x.build(),width:i.width,height:i.height,tileWidth:r.width,format:l});return E.applyProps({service:a}),E}getImageUrl(t){let i=this.points.slice(t*5,t*5+5),r=i[3]-i[1],n=i[4]-i[2],a=Math.ceil(r/this.display.scale);return`${this.tileUrl}/${i[1]},${i[2]},${r},${n}/${a>this.tileWidth?this.tileWidth:a},/0/default.${this.format||"jpg"}`}getAllPointsAt(t,i,r){let n=Ia(this.crop||this.points,t);return[[this,n,i]]}transform(t){Ar(this.points,t)}getScheduledUpdates(t,i){return[]}},cT=class extends kr{constructor(){super(...arguments),M(this,"type","spacial-content")}getAllPointsAt(e,t,i){return[[this,this.points,t]]}},pc=class extends cT{constructor(e){super(),M(this,"id"),M(this,"display"),M(this,"points"),M(this,"images",[]),M(this,"allImages",[]),M(this,"scaleFactors",[]),M(this,"aggregateBuffer",Re(9)),M(this,"lazyLoader"),M(this,"isFullyLoaded",!1),M(this,"maxScaleFactor",0),M(this,"renderOptions"),M(this,"_scheduleSortByScales",!1),M(this,"_sortByScales",()=>{this._scheduleSortByScales=!1,this.allImages.sort((i,r)=>r.display.width-i.display.width),this.images=[];let t=.1;for(let i of this.allImages)if(!(i.display.width<this.renderOptions.minSize&&i.display.height<this.renderOptions.minSize&&!i.priority||i instanceof Gr&&(i.display.width>this.renderOptions.maxImageSize||i.display.height>this.renderOptions.maxImageSize)&&!i.priority)){if(Math.abs(i.display.scale-t)<.25||i.priority){let r=this.images.pop();r&&(r instanceof Gr||r.priority)?(i.priority&&this.images.push(i),this.images.push(r)):i&&this.images.push(i)}else i&&this.images.push(i);t=i.display.scale}this.images.length===0&&(this.images=[...this.allImages]),this.scaleFactors=this.images.map(i=>i.display.scale),this.maxScaleFactor=Math.max(...this.scaleFactors)}),M(this,"loadFullResource",async()=>{if(!this.isFullyLoaded&&this.lazyLoader){this.isFullyLoaded=!0;let t=await this.lazyLoader();this.addImages(t)}}),M(this,"fallback",[this.loadFullResource]),this.id=e.id,this.points=st.singleBox(e.width,e.height),this.lazyLoader=e.loadFullImages,e.loadFullImages||(this.isFullyLoaded=!0),this.display={x:0,y:0,points:st.singleBox(e.width,e.height),height:e.height,width:e.width,scale:1},this.renderOptions=C({renderSmallestFallback:!0,renderLayers:2,minSize:255,maxImageSize:1024,quality:1.75},e.renderOptions||{}),this.addImages(e.images)}applyProps(e){typeof e.renderSmallestFallback<"u"&&e.renderSmallestFallback!==this.renderOptions.renderSmallestFallback&&(this.renderOptions.renderSmallestFallback=e.renderSmallestFallback),typeof e.renderLayers<"u"&&e.renderLayers!==this.renderOptions.renderLayers&&(this.renderOptions.renderLayers=e.renderLayers),typeof e.minSize<"u"&&e.minSize!==this.renderOptions.minSize&&(this.renderOptions.minSize=e.minSize),typeof e.maxImageSize<"u"&&e.maxImageSize!==this.renderOptions.maxImageSize&&(this.renderOptions.maxImageSize=e.maxImageSize),typeof e.quality<"u"&&e.quality!==this.renderOptions.quality&&(this.renderOptions.quality=e.quality)}appendChild(e){this.addImages([e])}removeChild(e){this.images.indexOf(e)!==-1&&(this.images=this.images.filter(t=>t!==e),this.sortByScales())}insertBefore(e,t){this.addImages([e])}hideInstance(){}addImages(e){for(let t of e)t.__parent=this,t.__owner=this.__owner;this.allImages.push(...e.filter(Boolean)),this.sortByScales()}sortByScales(){this._scheduleSortByScales=!0}getScheduledUpdates(e,t){return this._scheduleSortByScales?[this._sortByScales]:this.isFullyLoaded?[]:t>1/this.maxScaleFactor?this.fallback:[]}getAllPointsAt(e,t,i){if(this.images.length===0)return[];let r=uT(1/(i||1)/(window.devicePixelRatio||1),this.images,this.renderOptions.quality),n=this.images.length,a=t?Qr(t,Li(this.x,this.y)):Li(this.x,this.y);if(r!==this.images.length-1&&this.images[r+1]){let l=[];for(let d=n-1;d>=r;d--)l.push(d);let u=l[0];this.renderOptions.renderLayers&&(l=l.slice(-Math.min(l.length,this.renderOptions.renderLayers))),this.renderOptions.renderSmallestFallback&&l.indexOf(u)===-1&&l.unshift(u);let c=[];for(let d=0;d<l.length;d++)c.push(...this.images[l[d]].getAllPointsAt(e,a,i));return c}return this.images[r].getAllPointsAt(e,a,i)}};function yl(e,t,i,r,n){let a=Math.PI/180*n,l=Math.cos(a),u=Math.sin(a),c=l*(i-e)+u*(r-t)+e,d=l*(r-t)-u*(i-e)+t;return[c,d]}var Ma=class Jw extends kr{constructor(t,i){super(),M(this,"id"),M(this,"type","world-object"),M(this,"scale"),M(this,"layers"),M(this,"points"),M(this,"worldPoints"),M(this,"intersectionBuffer",Re(5)),M(this,"aggregateBuffer",Re(9)),M(this,"invertedBuffer",Re(9)),M(this,"rotation",0),M(this,"filteredPointsBuffer"),M(this,"_updatedList",[]),M(this,"geometry");let{x:r=0,y:n=0}=i||{};t?(this.id=t.id||"",this.scale=1,this.layers=t.layers,this.points=Re([1,r,n,r+t.width,n+t.height]),this.worldPoints=Re([1,r,n,r+t.width,n+t.height]),this.filteredPointsBuffer=Re(t.layers.length*5)):(this.id="",this.scale=1,this.layers=[],this.points=Re(5),this.worldPoints=Re(5),this.filteredPointsBuffer=Re(5))}static createWithProps(t){let i=new Jw;return i.applyProps(t),i}applyProps(t){let i=t.x||0,r=t.y||0;this.id=t.id;let n=typeof t.scale<"u"?t.scale:this.scale;this.points[0]=1,this.points[1]=i,this.points[2]=r,this.points[3]=i+t.width,this.points[4]=r+t.height,this.rotation=t.rotation||0,this.worldPoints[3]=this.worldPoints[1]+t.width,this.worldPoints[4]=this.worldPoints[2]+t.height,t.scale&&t.scale!==1&&this.atScale(n),this.scale=n}appendChild(t){t.points[0]===0&&t.points.set(this.points),t.__owner.value=this,this.addLayers([t])}removeChild(t){this.layers=this.layers.filter(i=>i!==t),this.filteredPointsBuffer=Re(this.layers.length*5)}insertBefore(t,i){let r=this.layers.indexOf(i);if(r===-1||this.layers.indexOf(t)!==-1)return;let n=this.layers.slice(0,r),a=this.layers.slice(r);this.layers=[...n,t,...a]}hideInstance(){console.warn("hideInstance: not yet implemented")}getObjectsAt(t,i){if(this.rotation&&(t=this.applyRotation(t)),Ia(this.points,t,this.filteredPointsBuffer)[0]===0)return[];let r=this.layers.length,n=[];for(let a=0;a<r;a++){let l=this.layers[a];if(i&&l.isShape){let u=Vr(l.points,Li(this.x,this.y));if(!l.intersects([t[1]-u[1],t[2]-u[2]]))continue}if(Ia(Vr(l.points,Li(this.x,this.y)),t,this.filteredPointsBuffer)[0]!==0&&n.push(l),i){let u=l;n.push(...u.getObjectsAt(t,i))}}return n}applyRotation(t){if(this.rotation){let i={x:t[1],y:t[2]},r={x:t[1],y:t[4]},n={x:t[3],y:t[2]},a={x:t[3],y:t[4]},l=this.points[1]+(this.points[3]-this.points[1])/2,u=this.points[2]+(this.points[4]-this.points[2])/2,[c,d]=yl(l,u,i.x,i.y,this.rotation),[p,y]=yl(l,u,r.x,r.y,this.rotation),[x,E]=yl(l,u,n.x,n.y,this.rotation),[S,k]=yl(l,u,a.x,a.y,this.rotation),T=Math.min(c,p,x,S),R=Math.max(c,p,x,S),A=Math.min(d,y,E,k),$=Math.max(d,y,E,k);return Re([t[0],T,A,R,$])}return t}getAllPointsAt(t,i,r){let n=Qr(Li(this.x,this.y),gn(this.scale),this.aggregateBuffer);this.rotation&&(t=this.applyRotation(t));let a=HC(t,this.points,this.intersectionBuffer),l=this.layers.length,u=[],c=Vr(a,Qr(gn(1/this.scale),Li(-this.x,-this.y),this.invertedBuffer)),d=i?Qr(i,n,this.aggregateBuffer):n,p=r*this.scale;for(let y=0;y<l;y++)u.push(...this.layers[y].getAllPointsAt(c,d,p));return u}addLayers(t){let i=[];for(let r of t)this.layers.indexOf(r)===-1&&(i.push(r),r.points.length===5&&(r.points[1]<this.worldPoints[1]/this.scale||r.points[2]<this.worldPoints[2]/this.scale||r.points[3]>this.worldPoints[3]/this.scale||r.points[4]>this.worldPoints[4]/this.scale)&&(r.crop=r.crop||Re([1,Math.max(this.worldPoints[1]/this.scale,r.points[1]),Math.max(this.worldPoints[2]/this.scale,r.points[2]),Math.min(this.worldPoints[3]/this.scale,r.points[3]),Math.min(this.worldPoints[4]/this.scale,r.points[4])])));this.layers=this.layers.concat(i),this.filteredPointsBuffer=Re(this.layers.length*5)}getScheduledUpdates(t,i){let r=this.layers.length;this._updatedList=[];let n=i*this.scale;for(let a=0;a<r;a++){let l=this.layers[a].getScheduledUpdates(t,n);l&&this._updatedList.push(...l)}return this._updatedList}},rs=class ex extends kr{constructor(t=0,i=0,r=100,n="left-to-right"){super(),M(this,"id","world"),M(this,"_width"),M(this,"_height"),M(this,"aspectRatio"),M(this,"viewingDirection"),M(this,"aggregateBuffer",Re(9)),M(this,"isDirty",!1),M(this,"zones",[]),M(this,"filteredPointsBuffer"),M(this,"selectedZone"),M(this,"triggerQueue",[]),M(this,"activatedEvents",[]),M(this,"_updatedList",[]),M(this,"translationBuffer",Re(9)),M(this,"needsRecalculate",!0),M(this,"emptyPaintables",[]),M(this,"renderOrder",[]),M(this,"points"),M(this,"objects",[]),M(this,"subscriptions",[]),M(this,"_propagateEventTargets",[]),M(this,"_alreadyFlushed",[]),this._width=t,this._height=i,this.aspectRatio=Number.isNaN(t/i)?1:t/i,this.viewingDirection=n,this.points=Re(r*5),this.filteredPointsBuffer=Re(r*5)}get x(){return 0}get y(){return 0}get width(){return this._width}get height(){return this._height}static withProps(t){let i=new ex;return i.applyProps(t),i}applyProps(t){typeof t.width<"u"&&typeof t.height<"u"&&(t.width!==this._width||t.height!==this._height)&&this.resize(t.width,t.height),t.viewingDirection!==this.viewingDirection&&(this.viewingDirection=t.viewingDirection,this.triggerRepaint())}propagateTouchEvent(t,i,r){let n=[];for(let a of r)if(a.x&&a.y){let l=st.singleBox(1,1,a.x,a.y);n.push(this.getObjectsAt(l,!0).reverse())}return n.map(a=>this.propagateEvent(t,i,a,{bubbles:!0,cancelable:!0}))}propagatePointerEvent(t,i,r,n,a={}){let l=st.singleBox(1,1,r,n),u=this.getObjectsAt(l,!0).reverse();return this.propagateEvent(t,i,u,a)}propagateEvent(t,i,r,{bubbles:n=!1,cancelable:a=!1}={}){i.atlasTarget=this,this._propagateEventTargets.length=1,this._propagateEventTargets[0]=this;let l=!1;i.stopPropagation=()=>{l=!0};let u=r.length;for(let p=u-1;p>=0;p--){this._propagateEventTargets.unshift(r[p][0]);let y=r[p][1].length;if(y)for(let x=0;x<y;x++)this._propagateEventTargets.unshift(r[p][1][x])}let c=this._propagateEventTargets.length,d=!1;for(let p=0;p<c&&(i.atlasTarget=this._propagateEventTargets[p],i.atlasWorld=this,d=this._propagateEventTargets[p].dispatchEvent(t,i)||d,!l);p++);return d&&this.triggerRepaint(),this._propagateEventTargets}appendChild(t){let i=this.appendWorldObject(t);this.renderOrder.push(i/5)}removeChild(t){let i=this.objects.indexOf(t);if(i===-1){for(let r of this.objects)if(r&&r.id===t.id){this.removeChild(r);return}return}this.objects[i]=null,this.renderOrder=this.renderOrder.filter(r=>r!==i),this.points[i*5]=0,this.triggerRepaint(),this.needsRecalculate=!0}insertBefore(t,i){let r=this.objects.indexOf(i);if(r===-1)return;let n=this.appendWorldObject(t);this.renderOrder.splice(r-1,0,n/5)}hideInstance(){}asWorldObject(){return null}addZone(t){this.zones.push(t)}selectZone(t){if(typeof t=="string"){let i=this.zones.length;for(let r=0;r<i;r++)if(this.zones[r].id===t){this.selectedZone=r,this.trigger("zone-changed");return}}else this.zones[t]&&(this.selectedZone=t,this.trigger("zone-changed"))}deselectZone(){this.selectedZone=void 0}getActiveZone(){if(this.selectedZone)return this.zones[this.selectedZone]}hasActiveZone(){return typeof this.selectedZone<"u"}checkResizeInternalBuffer(){if(qC(this.points)===this.objects.length){let t=this.points,i=Re(this.points.length*2);i.set(t,0),this.points=i}}appendWorldObject(t){this.checkResizeInternalBuffer();let i=this.objects.length*5,r=t.points;return t.points=this.points.subarray(this.objects.length*5,this.objects.length*5+5),t.points[1]=r[1],t.points[2]=r[2],t.points[3]=r[3],t.points[4]=r[4],this.objects.push(t),this.filteredPointsBuffer=Re(this.objects.length*5),this.needsRecalculate=!0,this.triggerRepaint(),i}recalculateWorldSize(){let t=!1;if(this.needsRecalculate){let i=new Int32Array(this.objects.length),r=new Int32Array(this.objects.length),n=this.renderOrder.length;for(let u=0;u<n;u++){let c=this.renderOrder[u];this.objects[c]&&(i[u]=this.points[c*5+3],r[u]=this.points[c*5+4])}let a=Math.max(...i);a!==this._width&&(this._width=a,t=!0);let l=Math.max(...r);l!==this._height&&(this._height=l,t=!0),t&&this.trigger("recalculate-world-size",{width:a,height:l}),this.needsRecalculate=!1}return t}addObjectAt(t,i){i.width&&!i.height?i.height=i.width/t.width*t.height:i.height&&!i.width&&(i.width=i.height/t.height*t.width),(!i||!i.width||!i.height)&&(i.width=t.width,i.height=t.height);let{width:r,x:n,y:a}=i,l=r/t.width;this.checkResizeInternalBuffer(),this.points.set(st.singleBox(t.width,t.height,0,0),this.objects.length*5);let u=new Ma(t);return u.points=this.points.subarray(this.objects.length*5,this.objects.length*5+5),this.objects.push(u),this.scaleWorldObject(this.objects.length-1,l),this.translateWorldObject(this.objects.length-1,n,a),this.filteredPointsBuffer=Re(this.points.length*2),this.triggerRepaint(),this.needsRecalculate=!0,u}scaleWorldObject(t,i){Ar(this.points.subarray(t*5,t*5+5),Ra(i,this.points[t*5+1],this.points[t*5+2]));let r=this.objects[t];r&&(r.atScale(i),this.triggerRepaint())}translateWorldObject(t,i,r){Ar(this.points.subarray(t*5,t*5+5),Li(i,r));let n=this.objects[t];n&&(n.translate(i,r),this.triggerRepaint())}resize(t,i){return this._width=t,this._height=i,this.aspectRatio=t/i,this.triggerRepaint(),this}getObjects(){return this.objects}getPoints(){return this.points}getPointsFromViewer(t,i){let r=st.singleBox(t.width,t.height,t.x,t.y);return this.getPointsAt(r,i,t.scale)}addLayoutSubscriber(t){return this.subscriptions.push(t),()=>{this.subscriptions.splice(this.subscriptions.indexOf(t),1)}}getScheduledUpdates(t,i){let r=Ia(this.points,t,this.filteredPointsBuffer),n=this.objects.length;this._updatedList=[];for(let a=0;a<n;a++)if(r[a*5]!==0){if(!this.objects[a])continue;this._updatedList.push(...this.objects[a].getScheduledUpdates(t,i))}return this._updatedList}getObjectsAt(t,i=!1){let r=this.getActiveZone(),n=Ia(this.points,t,this.filteredPointsBuffer),a=this.renderOrder.length,l=[];for(let u=0;u<a;u++){let c=this.renderOrder[u];if(n[c*5]!==0){let d=this.objects[c];if(!d||r&&r.objects.indexOf(d)===-1)continue;if(d.type!=="world-object"){l.push([d,[d]]);continue}i?l.push([d,d.getObjectsAt(t,i)]):l.push([d,this.emptyPaintables])}}return l}getPointsAt(t,i,r=1){let n=this.getObjectsAt(t),a=Qr(gn(r),Li(-t[1],-t[2]),this.translationBuffer),l=i?Qr(i,a,this.aggregateBuffer):a,u=n.length,c=[];for(let d=0;d<u;d++)n[d]&&c.push(...n[d][0].getAllPointsAt(t,l,r));return c}flushSubscriptions(){if(this.triggerQueue.length){this._alreadyFlushed=[];let t=this.triggerQueue.length;for(let i=0;i<t;i++){if(this._alreadyFlushed.indexOf(this.triggerQueue[i][0])!==-1)continue;typeof this.triggerQueue[i][1]>"u"&&this._alreadyFlushed.push(this.triggerQueue[i][0]);let r=this.subscriptions.length;for(let n=0;n<r;n++)this.subscriptions[n].apply(null,this.triggerQueue[i])}this.triggerQueue=[]}}trigger(t,i){this.triggerQueue.push([t,i])}triggerEventActivation(){this.trigger("event-activation")}triggerRepaint(){this.trigger("repaint")}gotoRegion(t){this.trigger("goto-region",t)}goHome(t=!1){this.trigger("go-home",{immediate:t})}zoomTo(t,i,r){this.trigger("zoom-to",{point:i,factor:t,stream:r})}zoomIn(t){this.trigger("zoom-to",{point:t,factor:.5})}zoomOut(t){this.trigger("zoom-to",{point:t,factor:2})}constraintBounds(t){this.trigger("constrain-bounds",{immediate:t})}},vl=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,bl={},dT=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],Hs=class extends kr{constructor(){super(),M(this,"id"),M(this,"type","spacial-content"),M(this,"points"),M(this,"hoverEvents",!1),M(this,"activeEvents",!1),M(this,"display",{x:0,y:0,scale:1,width:-1,height:-1,points:Re(5)}),M(this,"_parsed",{border:{id:null,match:[]},outline:{id:null,match:[]}}),M(this,"hovering"),M(this,"pressing"),M(this,"props",{}),M(this,"addHover",()=>{this.hovering=!0,this.__revision++}),M(this,"removeHover",()=>{this.hovering=!1,this.pressing=!1,this.__revision++}),M(this,"addPress",()=>{this.pressing=!0,this.__revision++}),M(this,"removePress",()=>{this.pressing=!1,this.__revision++}),this.id=fl(12),this.points=Re(5)}getAllPointsAt(e,t){return[[this,this.points,t]]}applyProps(e={}){let t=!1;if(e.interactive!==this.props.interactive&&(t=!0,this.props.interactive=e.interactive),e.style){let i=e.border||e.style.border;if(i!==this._parsed.border.id)if(!i)this._parsed.border.id=null,this._parsed.border.match=[];else{let r=bl[i]||vl.exec(i)||vl.exec(i);r&&(this._parsed.border.id=i,this._parsed.border.match=bl[i]=r)}if(this._parsed.border.id&&(e.style.borderWidth=this._parsed.border.match[1],e.style.borderStyle="solid",e.style.borderColor=this._parsed.border.match[4]),e.style.outline!==this._parsed.outline.id)if(!e.style.outline)this._parsed.outline.id=null,this._parsed.outline.match=[];else{let r=bl[e.style.outline]||vl.exec(e.style.outline)||vl.exec(e.style.outline);r&&(this._parsed.outline.id=e.style.outline,this._parsed.outline.match=bl[e.style.outline]=r)}this._parsed.outline.id&&(e.style.outlineWidth=this._parsed.outline.match[1],e.style.outlineStyle="solid",e.style.outlineColor=this._parsed.outline.match[4]),this.props.style=e.style,e.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.backgroundColor,t=!0),e.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.style.background,t=!0);for(let r of dT)if(this.props.style[r]!==e.style[r]){t=!0;break}e.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=e.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t=!0),e.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=e.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0)}e.href!==this.props.href&&(this.props.href=e.href,t=!0),e.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=e.hrefTarget,t=!0),e.title!==this.props.title&&(this.props.title=e.title,t=!0),e.className!==this.props.className&&(this.props.className=e.className,e.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0),e.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=e.relativeSize,t=!0),e.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=e.relativeStyle,t=!0),e.html!==this.props.html&&(this.props.html=e.html,t=!0),e.target&&(e.target.width!==this.display.width||e.target.height!==this.display.height||e.target.x!==this.points[1]||e.target.y!==this.points[2])&&(t=!0,this.points=st.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.points=st.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.width=e.target.width,this.display.height=e.target.height),t&&this.__revision++}},La=class extends kr{constructor(){super(),M(this,"type","spacial-content"),M(this,"id"),M(this,"points"),M(this,"color","#000"),M(this,"backgroundColor"),M(this,"hovering"),M(this,"pressing"),M(this,"text",""),M(this,"display",{x:0,y:0,scale:1,width:100,height:100,points:Re(5)}),M(this,"className"),M(this,"html"),M(this,"interactive",!1),M(this,"props",{font:"18px Arial, sans-serif",lineHeight:1,textAlign:"left",verticalAlign:"top",paddingX:0,paddingY:0,fitParent:!1,lineBreak:"auto",strokeText:!1,sizeToFill:!1,maxFontSizeToFill:void 0,allowNewLine:!0,justifyLines:!1,renderHDPI:!1,textDecoration:"none",interactive:!1,relativeSize:!1}),this.id="",this.points=Re(5)}getAllPointsAt(e,t){return[[this,this.points,t]]}applyProps(e){var t=e,{id:i,target:r,text:n,color:a,backgroundColor:l,fontSize:u=18,interactive:c,fontFamily:d="Arial, sans-serif"}=t,p=le(t,["id","target","text","color","backgroundColor","fontSize","interactive","fontFamily"]);p.font=`${u}px ${d}`,this.interactive=c||!1,typeof n<"u"&&(this.text=n||""),a&&(this.color=a),l&&(this.backgroundColor=l),i&&(this.id=i),r&&(this.points=st.singleBox(r.width,r.height,r.x,r.y),this.display.points=this.points,this.display.width=r.width,this.display.height=r.height),this.props=C(C({},this.props),p),this.__revision++}},$t=Math.pow,wl=Math.sqrt,$a=Math.sin,Ky=Math.cos,Na=Math.PI,xl=1.70158,_l=xl*1.525,Jy=xl+1,ev=2*Na/3,tv=2*Na/4.5,Sl=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},Pr={linear:e=>e,easeInQuad:function(e){return e*e},easeOutQuad:function(e){return 1-(1-e)*(1-e)},easeInOutQuad:function(e){return e<.5?2*e*e:1-$t(-2*e+2,2)/2},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return 1-$t(1-e,3)},easeInOutCubic:function(e){return e<.5?4*e*e*e:1-$t(-2*e+2,3)/2},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1-$t(1-e,4)},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-$t(-2*e+2,4)/2},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1-$t(1-e,5)},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1-$t(-2*e+2,5)/2},easeInSine:function(e){return 1-Ky(e*Na/2)},easeOutSine:function(e){return $a(e*Na/2)},easeInOutSine:function(e){return-(Ky(Na*e)-1)/2},easeInExpo:function(e){return e===0?0:$t(2,10*e-10)},easeOutExpo:function(e){return e===1?1:1-$t(2,-10*e)},easeInOutExpo:function(e){return e===0?0:e===1?1:e<.5?$t(2,20*e-10)/2:(2-$t(2,-20*e+10))/2},easeInCirc:function(e){return 1-wl(1-$t(e,2))},easeOutCirc:function(e){return wl(1-$t(e-1,2))},easeInOutCirc:function(e){return e<.5?(1-wl(1-$t(2*e,2)))/2:(wl(1-$t(-2*e+2,2))+1)/2},easeInBack:function(e){return Jy*e*e*e-xl*e*e},easeOutBack:function(e){return 1+Jy*$t(e-1,3)+xl*$t(e-1,2)},easeInOutBack:function(e){return e<.5?$t(2*e,2)*((_l+1)*2*e-_l)/2:($t(2*e-2,2)*((_l+1)*(e*2-2)+_l)+2)/2},easeInElastic:function(e){return e===0?0:e===1?1:-$t(2,10*e-10)*$a((e*10-10.75)*ev)},easeOutElastic:function(e){return e===0?0:e===1?1:$t(2,-10*e)*$a((e*10-.75)*ev)+1},easeInOutElastic:function(e){return e===0?0:e===1?1:e<.5?-($t(2,20*e-10)*$a((20*e-11.125)*tv))/2:$t(2,-20*e+10)*$a((20*e-11.125)*tv)/2+1},easeInBounce:function(e){return 1-Sl(1-e)},easeOutBounce:Sl,easeInOutBounce:function(e){return e<.5?(1-Sl(1-2*e))/2:(1+Sl(2*e-1))/2}},fT=class{constructor(e){M(this,"runtime"),M(this,"pendingTransition"),this.runtime=e,this.pendingTransition={from:Re(5),to:Re(5),elapsed_time:0,done:!0,total_time:0,timingFunction:Pr.easeInOutQuad,constrain:!1}}hasPending(){return!this.pendingTransition.done}getPendingTransition(){return this.pendingTransition}getPendingFrom(){return this.pendingTransition.from}customTransition(e){e(this.pendingTransition)}stopTransition(){this.pendingTransition.from=Re(this.runtime.target),this.pendingTransition.to=Re(this.runtime.target),this.pendingTransition.done=!0,this.pendingTransition.elapsed_time=0,this.pendingTransition.total_time=0}runTransition(e,t){if(!this.pendingTransition.done){let i=this.pendingTransition,r=i.total_time===0?0:(i.elapsed_time+t)/i.total_time,n=i.total_time===0?1:r===0?0:i.timingFunction(r);e[1]=i.from[1]+(i.to[1]-i.from[1])*n,e[2]=i.from[2]+(i.to[2]-i.from[2])*n,e[3]=i.from[3]+(i.to[3]-i.from[3])*n,e[4]=i.from[4]+(i.to[4]-i.from[4])*n,this.pendingTransition.elapsed_time+=t,this.pendingTransition.elapsed_time>=this.pendingTransition.total_time&&(this.pendingTransition.done=!0,this.pendingTransition.constrain&&this.constrainBounds({transition:{duration:this.pendingTransition.total_time===0?0:500,easing:Pr.easeOutExpo}}))}}zoomTo(e,{origin:t,stream:i=!1,transition:r}={}){let n=this.runtime.getZoomedPosition(e,{origin:t}),a=Math.abs(1-e);this.applyTransition(n,r,{duration:2e3*a,easing:Pr.easeOutExpo,constrain:!0},{stream:!1})}constrainBounds({transition:e,panPadding:t=0}={}){let[i,r]=this.runtime.constrainBounds(this.runtime.target,{panPadding:t});i&&(this.applyTransition(r,e,{duration:500,easing:Pr.easeOutQuart,constrain:!1}),this.runtime.updateNextFrame())}applyTransition(e,t,i,{stream:r}={}){this.pendingTransition.from=Re(this.runtime.target),this.pendingTransition.to=e,r||(this.pendingTransition.elapsed_time=0),this.pendingTransition.done=!1,this.pendingTransition.total_time=typeof(t==null?void 0:t.duration)<"u"?t.duration:typeof(i==null?void 0:i.duration)<"u"?i.duration:1e3,this.pendingTransition.constrain=typeof(t==null?void 0:t.constrain)<"u"?t.constrain:typeof(i==null?void 0:i.constrain)<"u"?i.constrain:!1,this.pendingTransition.timingFunction=(t==null?void 0:t.easing)||(i==null?void 0:i.easing)||Pr.easeInOutSine}goToRegion(e,{transition:t}={}){let i=this.runtime.clampRegion(e);this.applyTransition(st.singleBox(i.width,i.height,i.x,i.y),t,{duration:1e3,easing:Pr.easeOutExpo,constrain:!0}),this.runtime.updateNextFrame()}},El=class{constructor(e,t,i,r=[],n){M(this,"id",fl()),M(this,"ready",!1),M(this,"renderer"),M(this,"world"),M(this,"target"),M(this,"homePosition"),M(this,"manualHomePosition"),M(this,"manualFocalPosition"),M(this,"focalPosition"),M(this,"transitionManager"),M(this,"aggregate"),M(this,"transformBuffer",Re(500)),M(this,"lastTarget",Re(5)),M(this,"zoomBuffer",Re(5)),M(this,"logNextRender",!1),M(this,"pendingUpdate",!0),M(this,"isCommitting",!1),M(this,"firstRender",!0),M(this,"lastTime"),M(this,"stopId"),M(this,"mode","explore"),M(this,"controllers",[]),M(this,"controllersRunning",!1),M(this,"controllerStopFunctions",[]),M(this,"maxScaleFactor",1),M(this,"_viewerToWorld",{x:0,y:0}),M(this,"_lastGoodScale",1),M(this,"hooks",{useFrame:[],useBeforeFrame:[],useAfterPaint:[],useAfterFrame:[]}),M(this,"fpsLimit"),M(this,"options"),M(this,"hookOptions",{filters:{grayscale:0,contrast:0,brightness:0,saturate:0,sepia:0,invert:0,hueRotate:0,blur:0}}),M(this,"_viewport",{x:0,y:0,width:0,height:0}),M(this,"setViewport",a=>{let l=Math.round(typeof a.x>"u"?this.target[1]:a.x),u=Math.round(typeof a.y>"u"?this.target[2]:a.y);a.width?this.target[3]=l+a.width:this.target[3]=this.target[3]-this.target[1]+l,a.height?this.target[4]=u+a.height:this.target[4]=this.target[4]-this.target[2]+u,Math.abs(this.target[1]-l)>.01&&(this.target[1]=l),Math.abs(this.target[2]-u)>.01&&(this.target[2]=u),this.pendingUpdate=!0}),M(this,"render",a=>{let l=a-this.lastTime;if(this.isCommitting||this.fpsLimit&&l<1e3/this.fpsLimit){this.stopId=window.requestAnimationFrame(this.render);return}this.lastTime=a,this.world.flushSubscriptions(),this.stopId=window.requestAnimationFrame(this.render),this.hook("useFrame",l);let u=this.pendingUpdate,c=this.renderer.pendingUpdate();if(this.transitionManager.hasPending()&&(this.transitionManager.runTransition(this.target,l),this.pendingUpdate=!0,this.updateControllerPosition()),!this.firstRender&&!u&&!c&&this.target[0]===this.lastTarget[0]&&this.target[1]===this.lastTarget[1]&&this.target[2]===this.lastTarget[2]&&this.target[3]===this.lastTarget[3]&&this.target[4]===this.lastTarget[4])return;this.hook("useBeforeFrame",l),this.renderer.beforeFrame(this.world,l,this.target,this.hookOptions);let d=this.getScaleFactor(),p=this.renderer.getPointsAt(this.world,this.target,this.aggregate,d),y=p.length;for(let S=0;S<y;S++){let k=p[S][0],T=p[S][1],R=p[S][2],A=R?Vr(T,R,this.transformBuffer):T;this.renderer.prepareLayer(k,k.__parent&&R?Vr(k.__parent.crop||k.__parent.points,R):A);let $=A.length/5;for(let z=0;z<$;z++){let B=z*5;A[B]!==0&&(this.renderer.paint(k,z,A[B+1],A[B+2],A[B+3]-A[B+1],A[B+4]-A[B+2]),this.hook("useAfterPaint",k))}this.renderer.finishLayer(k,T)}this.renderer.afterFrame(this.world,l,this.target,this.hookOptions),this.hook("useAfterFrame",l),this.lastTarget[0]=this.target[0],this.lastTarget[1]=this.target[1],this.lastTarget[2]=this.target[2],this.lastTarget[3]=this.target[3],this.lastTarget[4]=this.target[4],this.firstRender=!1,this.pendingUpdate=!1,this.logNextRender=!1,this.renderer.isReady()&&(this.ready=!0,this.world.trigger("ready")),this.world.flushSubscriptions();let x=this.world.getScheduledUpdates(this.target,d),E=x.length;if(E>0)for(let S=0;S<E;S++){let k=x[E-S-1]();k?k.then(()=>{this.pendingUpdate=!0}):this.pendingUpdate=!0}}),this.renderer=e,this.world=t,this.options=C({maxOverZoom:1,maxUnderZoom:1,visibilityRatio:1.5},n||{}),this.target=st.projection(i),this.manualHomePosition=!1,this.pendingUpdate=!0,this.homePosition=st.projection(this.world),this.manualFocalPosition=!1,this.focalPosition=this.target,this.updateFocalPosition(),this.transitionManager=new fT(this),this.aggregate=gn(1),this.world.addLayoutSubscriber(a=>{a==="repaint"&&(this.pendingUpdate=!0),a==="recalculate-world-size"&&(this.manualHomePosition||(this.setHomePosition(),this.goHome()),this.updateFocalPosition())}),this.lastTime=performance.now(),this.controllers=r,this.render(this.lastTime),this.startControllers()}get x(){return this.target[1]}set x(e){this.target[1]=e}get y(){return this.target[2]}set y(e){this.target[2]=e}get x2(){return this.target[3]}set x2(e){this.target[3]=e}get y2(){return this.target[4]}set y2(e){this.target[4]=e}get width(){return this.target[3]-this.target[1]}set width(e){this.target[3]=this.target[1]+e}get height(){return this.target[4]-this.target[2]}set height(e){this.target[4]=this.target[2]=e}setHomePosition(e){this.homePosition.set(st.projection(e||this.world)),this.pendingUpdate=!0}startControllers(){if(!this.controllersRunning){for(let e of this.controllers)this.controllerStopFunctions.push(e.start(this));this.controllersRunning=!0}}stopControllers(){if(this.controllersRunning){for(let e of this.controllerStopFunctions)e();this.controllersRunning=!1,this.controllerStopFunctions=[]}}updateControllerPosition(){for(let e of this.controllers)e.updatePosition(this.x,this.y,this.width,this.height)}triggerResize(){this.renderer.triggerResize&&this.renderer.triggerResize(),this.pendingUpdate=!0}addController(e){this.controllers.push(e),this.controllersRunning&&e.start(this),this.pendingUpdate=!0}cover(){return this.goHome({cover:!0})}getRendererScreenPosition(){return this.renderer.getRendererScreenPosition()}updateRendererScreenPosition(){this.pendingUpdate=!0,this.renderer.resize()}setOptions(e){this.options=C(C({},this.options),e)}goHome(e={}){if(this.world.width<=0||this.world.height<=0)return;let t=this.getScaleFactor(),i=e.position?{x:e.position[1],y:e.position[2],width:e.position[3]-e.position[1],height:e.position[4]-e.position[2]}:{x:this.homePosition[1],y:this.homePosition[2],width:this.homePosition[3]-this.homePosition[1],height:this.homePosition[4]-this.homePosition[2]},r=this.width*t,n=this.height*t,a=i.width/r,l=i.height/n,u=r/n;if(e.cover?a>l:a<l){let c=u*i.height,d=(c-i.width)/2;this.target[1]=Math.round(-d+i.x),this.target[2]=Math.round(i.y),this.target[3]=Math.round(c-d+i.x),this.target[4]=Math.round(i.height+i.y)}else{let c=i.width/u,d=(c-i.height)/2;this.target[1]=Math.round(i.x),this.target[2]=Math.round(i.y-d),this.target[3]=Math.round(i.x+i.width),this.target[4]=Math.round(i.y+c-d)}this.constrainBounds(this.target),this.updateControllerPosition()}resize(e,t,i,r){this.updateFocalPosition(e-t,i-r);let n=t/e,a=r/i;this.target[3]=this.target[1]+(this.target[3]-this.target[1])*n,this.target[4]=this.target[2]+(this.target[4]-this.target[2])*a,this.goHome({position:this.focalPosition}),this.renderer.resize(t,r),this.pendingUpdate=!0}updateFocalPosition(e,t){if(!this.manualFocalPosition){let i=this.width,r=this.height,n=Math.min(i,r),a=0,l=0,u=this.x+a,c=this.y+l;if(i<r){let d=this.height-this.width;this.focalPosition=st.projection({x:u,y:c+d/2,width:n-a*2,height:n-l*2}),this.pendingUpdate=!0}else{let d=this.width-this.height;this.focalPosition=st.projection({x:u+d/2,y:c,width:n-a*2,height:n-l*2}),this.pendingUpdate=!0}}}getViewport(){return this._viewport.x=this.target[1],this._viewport.y=this.target[2],this._viewport.width=this.target[3]-this.target[1],this._viewport.height=this.target[4]-this.target[2],this._viewport}constrainBounds(e,{panPadding:t=0,ref:i=!1}={}){let{minX:r,maxX:n,minY:a,maxY:l}=this.getBounds({target:e,padding:t}),u=!1,c=i?e:Re(e),d=Math.round(e[3]-e[1]),p=Math.round(e[4]-e[2]);return r>e[1]&&(u=!0,c[1]=r,c[3]=r+d),a>e[2]&&(u=!0,c[2]=a,c[4]=a+p),n<e[1]&&(u=!0,c[1]=n,c[3]=n+d),l<e[2]&&(u=!0,c[2]=l,c[4]=l+p),[u,c]}getBounds(e){let t=e.target||this.target,i=e.padding,r=this.options.visibilityRatio,n=Math.abs(1-r);if(this.world.hasActiveZone()){let R=this.world.getActiveZone();if(R){let A=t[3]-t[1]<R.points[3]-R.points[1],$=t[4]-t[2]<R.points[4]-R.points[2];return{minX:A?R.points[1]-i:R.points[1]+(R.points[3]-R.points[1])/2-(t[3]-t[1])/2,maxX:$?R.points[2]-i:R.points[2]+(R.points[4]-R.points[2])/2-(t[4]-t[2])/2,minY:A?R.points[3]+i:R.points[1]+(R.points[3]-R.points[1])/2-(t[3]-t[1])/2,maxY:$?R.points[4]+i:R.points[2]+(R.points[4]-R.points[2])/2-(t[4]-t[2])/2}}}let a=t[3]-t[1],l=this.world.width,u=-a*n,c=l-a-u,d=t[4]-t[2],p=this.world.height,y=-d*n,x=p-d-y,E=Math.round(Math.max(u,c)),S=Math.round(Math.min(u,c)),k=Math.round(Math.max(y,x)),T=Math.round(Math.min(y,x));return{minX:S,maxX:E,minY:T,maxY:k}}getScaleFactor(e=!1){let t=this.renderer.getScale(this.target[3]-this.target[1],this.target[4]-this.target[2],e);return t===0?this._lastGoodScale:(this._lastGoodScale=t,t)}getZoomedPosition(e,{origin:t,fromPos:i}){var r;let n=i?{width:i[3]-i[1],height:i[4]-i[2]}:void 0,a=n?this.renderer.getScale(n.width,n.height):this.getScaleFactor(),l=n?n.width:this.width,u=n?n.height:this.height,c=(r=this.getRendererScreenPosition())==null?void 0:r.width,d=this.world.width,p=c?c/d:1,y=this.options.maxUnderZoom,x=Math.max(p||1,this.options.maxOverZoom),E=1/e,S=a*E;if(E<1){let T=l*a,R=u*a,A=this.world.width/T,$=this.world.height/R;if(A>$){let z=this.world.width*S,B=~~(l*a)*y;z<B&&(e=this.world.width*a/(l*a*y))}else{let z=this.world.height*S,B=~~(u*a)*y;z<B&&(e=this.world.height*a/(u*a*y))}}else S>x&&(e=a/x);let k=Vr(this.target,Ra(e,t?t.x:this.target[1]+(this.target[3]-this.target[1])/2,t?t.y:this.target[2]+(this.target[4]-this.target[2])/2),this.zoomBuffer);return this.constrainBounds(k,{ref:!0,panPadding:100}),k}clampRegion({x:e,y:t,width:i,height:r,padding:n=0}){let a=this.width,l=this.height,u=i/a<r/l,c=e-n,d=t-n,p=i+n*2,y=r+n*2;if(u){let E=y/l*a;return{x:c-(E-p)/2,y:d,width:E,height:y}}let x=p/a*l;return{x:c,y:d-(x-y)/2,width:p,height:x}}viewerToWorld(e,t){let i=this.getScaleFactor();return this._viewerToWorld.x=this.target[1]+e/i,this._viewerToWorld.y=this.target[2]+t/i,this._viewerToWorld}worldToViewer(e,t,i,r){let n=st.singleBox(i,r,e,t);return Ar(n,Qr(gn(this.getScaleFactor()),Li(-this.target[1],-this.target[2]))),{x:n[1],y:n[2],width:n[3]-n[1],height:n[4]-n[2],strand:n}}setScale(e,t){Ar(this.target,Ra(e,t?t.x:this.target[1]+(this.target[3]-this.target[1])/2,t?t.y:this.target[2]+(this.target[4]-this.target[2])/2)),this.pendingUpdate=!0}syncTo(e){let t=this.target;return this.target=e.target,this.pendingUpdate=!0,()=>{this.target=t}}stop(){return typeof this.stopId<"u"&&(window.cancelAnimationFrame(this.stopId),this.stopId=void 0),()=>{this.render(performance.now())}}reset(){this.renderer.reset()}selectZone(e){this.world.selectZone(e),this.pendingUpdate=!0}deselectZone(){this.world.deselectZone(),this.pendingUpdate=!0}hook(e,t){let i=this.hooks[e].length;if(i!==0)for(let r=0;r<i;r++)this.hooks[e][r](t)}registerHook(e,t){return this.hooks[e].push(t),()=>{this.hooks[e]=this.hooks[e].filter(i=>i!==t)}}updateNextFrame(){this.pendingUpdate=!0}},Al=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,kl={},pT=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],iv=class extends kr{constructor(){super(),M(this,"id"),M(this,"type","spacial-content"),M(this,"isShape",!0),M(this,"points"),M(this,"hoverEvents",!1),M(this,"activeEvents",!1),M(this,"display",{x:0,y:0,scale:1,width:-1,height:-1,points:Re(5)}),M(this,"boundingBox",null),M(this,"_parsed",{border:{id:null,match:[]},outline:{id:null,match:[]}}),M(this,"hovering"),M(this,"pressing"),M(this,"props",{}),M(this,"shape",{type:"none"}),M(this,"addHover",()=>{this.hovering=!0,this.__revision++}),M(this,"removeHover",()=>{this.hovering=!1,this.pressing=!1,this.__revision++}),M(this,"addPress",()=>{this.pressing=!0,this.__revision++}),M(this,"removePress",()=>{this.pressing=!1,this.__revision++}),this.id=fl(12),this.points=Re(5),this.shape={type:"none"}}updateBoundingBox(){if(this.shape.type==="none")return;let e=this.shape.points;if(this.shape.points.length>2){let t=Math.min(...e.map(a=>a[0])),i=Math.min(...e.map(a=>a[1])),r=Math.max(0,...e.map(a=>a[0])),n=Math.max(0,...e.map(a=>a[1]));this.boundingBox={x:t,y:i,width:r-t,height:n-i};return}this.boundingBox=null}intersects(e){if(!e||this.shape.type==="none")return!1;let[t,i]=e,r=this.shape.points,n=this.boundingBox;if(n||(this.updateBoundingBox(),n=this.boundingBox),!n||t<n.x||t>n.x+n.width||i<n.y||i>n.height+n.y)return!1;let a=!1;for(let l=0,u=r.length-1;l<r.length;u=l++)r[l][1]>i!=r[u][1]>i&&t<(r[u][0]-r[l][0])*(i-r[l][1])/(r[u][1]-r[l][1])+r[l][0]&&(a=!a);return a}getAllPointsAt(e,t){return e[3]-e[1]===1&&e[4]-e[2]===1?this.intersects([e[1],e[2]])?[[this,this.points,t]]:[]:[[this,this.points,t]]}applyProps(e={}){let t=!1;if(e.points)if(this.shape.type!=="polygon"||this.shape.points.length!==e.points.length)this.shape={type:"polygon",points:e.points,open:e.open},this.updateBoundingBox();else{let i=!1,r=e.points.length;for(let n=0;n<r;n++)if(e.points[n][0]!==this.shape.points[n][0]||e.points[n][1]!==this.shape.points[n][1]){i=!0;break}i&&(this.shape={type:"polygon",points:e.points,open:e.open},this.updateBoundingBox())}if(e.interactive!==this.props.interactive&&(t=!0,this.props.interactive=e.interactive),(e.open||e.open===!1)&&(t=!0,this.shape.open=e.open),e.style){let i=e.border||e.style.border;if(i!==this._parsed.border.id)if(!i)this._parsed.border.id=null,this._parsed.border.match=[];else{let r=kl[i]||Al.exec(i)||Al.exec(i);r&&(this._parsed.border.id=i,this._parsed.border.match=kl[i]=r)}if(this._parsed.border.id&&(e.style.borderWidth=this._parsed.border.match[1],e.style.borderStyle="solid",e.style.borderColor=this._parsed.border.match[4]),e.style.outline!==this._parsed.outline.id)if(!e.style.outline)this._parsed.outline.id=null,this._parsed.outline.match=[];else{let r=kl[e.style.outline]||Al.exec(e.style.outline)||Al.exec(e.style.outline);r&&(this._parsed.outline.id=e.style.outline,this._parsed.outline.match=kl[e.style.outline]=r)}this._parsed.outline.id&&(e.style.outlineWidth=this._parsed.outline.match[1],e.style.outlineStyle="solid",e.style.outlineColor=this._parsed.outline.match[4]),this.props.style=e.style,e.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.backgroundColor,t=!0),e.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.style.background,t=!0);for(let r of pT)if(this.props.style[r]!==e.style[r]){t=!0;break}e.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=e.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t=!0),e.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=e.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0)}e.href!==this.props.href&&(this.props.href=e.href,t=!0),e.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=e.hrefTarget,t=!0),e.title!==this.props.title&&(this.props.title=e.title,t=!0),e.className!==this.props.className&&(this.props.className=e.className,e.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0),e.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=e.relativeSize,t=!0),e.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=e.relativeStyle,t=!0),e.html!==this.props.html&&(this.props.html=e.html,t=!0),e.target&&(e.target.width!==this.display.width||e.target.height!==this.display.height||e.target.x!==this.points[1]||e.target.y!==this.points[2])&&(t=!0,this.points=st.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.points=st.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.width=e.target.width,this.display.height=e.target.height),t&&this.__revision++}},rv=/(-?[0-9]+(px|em)\s+|0\s+)(-?[0-9]+(px|em)\s+|0\s+)(-?[0-9]+(px|em)\s+|0\s+)?(-?[0-9]+(px|em)\s+|0\s+)?(.*)/g,nv={},gT=typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes("firefox"),Pl={},mT=class{constructor(e,t){M(this,"canvas"),M(this,"ctx"),M(this,"options"),M(this,"imagesPending",0),M(this,"imagesLoaded",0),M(this,"imageIdsLoaded",[]),M(this,"frameIsRendering",!1),M(this,"pendingDrawCall",!1),M(this,"firstMeaningfulPaint",!1),M(this,"parallelTasks",8),M(this,"frameTasks",0),M(this,"loadingQueueOrdered",!0),M(this,"loadingQueue",[]),M(this,"currentTask",Promise.resolve()),M(this,"tasksRunning",0),M(this,"stats"),M(this,"averageJobTime",64),M(this,"lastKnownScale",1),M(this,"visible",[]),M(this,"previousVisible",[]),M(this,"rendererPosition"),M(this,"dpi"),M(this,"drawCalls",[]),M(this,"lastPaintedObject"),M(this,"hostCache"),M(this,"invalidated",[]),M(this,"_worker",()=>{if(this.loadingQueue.length){let i=this.loadingQueue.pop();i&&(this.tasksRunning++,this.frameTasks++,this.currentTask=i.task().then(()=>{this.tasksRunning--}).catch(()=>{this.tasksRunning--}))}}),M(this,"_scheduled",0),M(this,"_doWork",()=>{this.loadingQueue.length===0&&this.tasksRunning===0&&this._scheduled&&(clearInterval(this._scheduled),this._scheduled=0);let i=this.parallelTasks||1;!this.firstMeaningfulPaint&&this.loadingQueue.length&&(i=this.loadingQueue.length);for(let r=0;r<=i;r++)this._worker()}),this.canvas=e,this.rendererPosition=e.getBoundingClientRect(),this.ctx=e.getContext("2d",{alpha:!0}),this.ctx.imageSmoothingEnabled=!0,this.options=t||{},this.canvas.style.opacity="0",this.canvas.style.transition="opacity .3s",this.dpi=(t==null?void 0:t.dpi)||1,this.hostCache=t!=null&&t.lruCache?new XC({maxSize:1024*512*512,dispose:(i,r,n)=>{this.invalidated.push(r),i.width=0,i.height=0},sizeCalculation:(i,r)=>i.width*i.height}):{store:{},get(i){return this.store[i]},set(i,r){this.store[i]=r}}}getCanvasDims(){return{width:this.canvas.width/this.dpi,height:this.canvas.height/this.dpi}}resize(){this.rendererPosition=this.canvas.getBoundingClientRect()}isReady(){return this.firstMeaningfulPaint}afterFrame(e){if(this.clearTransform(),this.lastPaintedObject=void 0,this.frameIsRendering=!1,this.imagesPending=Math.max(0,this.imagesPending-this.imagesLoaded),this.imagesLoaded=0,this.loadingQueueOrdered||(this.loadingQueue=this.loadingQueue.sort((t,i)=>t.network&&t.scale===i.scale?i.distance-t.distance:t.scale<i.scale?-1:1),this.loadingQueueOrdered=!0),this.previousVisible=this.visible,this.pendingDrawCall=!!this.drawCalls.length,this.pendingDrawCall)for(let t=0;t<this.drawCalls.length;t++){let i=this.drawCalls.shift();i&&i()}this.doOffscreenWork(),this.options.debug&&this.stats&&this.stats.end()}doOffscreenWork(){this.frameTasks=0,this.loadingQueue.length&&(this._worker(),this.loadingQueue.length&&(this._scheduled||(this._scheduled=setInterval(this._doWork,0))))}getScale(e,t,i){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let r=this.getCanvasDims(),n=r.width/e,a=r.height/t,l=(n<a?a:n)*(i&&this.dpi||1);return Number.isNaN(l)||(this.lastKnownScale=l),this.lastKnownScale}beforeFrame(e,t,i,r){var n;this.options.debug&&this.stats&&this.stats.begin(),this.frameIsRendering=!0,this.visible=[],this.options.beforeFrame&&this.options.beforeFrame(t);let a=this.getCanvasDims();if(this.ctx.globalAlpha=1,this.ctx.fillStyle=(n=this.canvas.dataset.background)!=null?n:"rgb(0, 0, 0)",this.ctx.fillRect(0,0,a.width,a.height),r.enableFilters&&(r.filters.brightness||r.filters.contrast||r.filters.grayscale||r.filters.invert||r.filters.sepia||r.filters.saturate||r.filters.hueRotate||r.filters.blur)){let l="";r.filters.brightness&&(l+=`brightness(${~~(100+r.filters.brightness*100)}%) `),r.filters.contrast&&(l+=`contrast(${~~(100+r.filters.contrast*100)}%) `),r.filters.grayscale&&(l+=`grayscale(${~~(r.filters.grayscale*100)}%) `),r.filters.invert&&(l+=`invert(${~~(r.filters.invert*100)}%) `),r.filters.sepia&&(l+=`sepia(${~~(r.filters.sepia*100)}%) `),r.filters.saturate&&(l+=`saturate(${~~(100+r.filters.saturate*100)}%) `),r.filters.hueRotate&&(l+=`hue-rotate(${r.filters.hueRotate}deg) `),r.filters.blur&&(l+=`blur(${r.filters.blur}px) `),this.ctx.filter=l}else this.ctx.filter="none"}applyTransform(e,t,i,r,n){let a=e.__owner.value;if(a&&a.rotation){this.ctx.save();let l=t+r/2,u=i+n/2;this.ctx.translate(l,u),this.ctx.rotate(a.rotation*Math.PI/180),this.ctx.translate(-l,-u),this.lastPaintedObject=a}}clearTransform(){this.lastPaintedObject&&(this.lastPaintedObject.rotation&&this.ctx.restore(),this.lastPaintedObject=void 0)}paint(e,t,i,r,n,a){let l=this.ctx.globalAlpha;if(e instanceof Gr||e instanceof is){if(e.display.rotation){this.ctx.save();let d=i+n/2,p=r+a/2;e.crop&&(d-=e.crop[t*5+1],p-=e.crop[t*5+2]),this.ctx.translate(d,p),this.ctx.rotate(e.display.rotation*Math.PI/180),this.ctx.translate(-d,-p)}if(this.visible.push(e),typeof e.style&&e.style.opacity!=="undefined"){if(!e.style.opacity)return;this.ctx.globalAlpha=e.style.opacity}try{let d=e.__host.canvas,p=this.getCanvasDims();if((d.indices.indexOf(t)===-1||this.invalidated.indexOf(d.canvases[t])!==-1)&&this.schedulePaintToCanvas(d,e,t,gl({x:i+n/2,y:r+n/2},{x:p.width/2,y:p.height/2})),!this.firstMeaningfulPaint)return;let y=this.hostCache.get(d.canvases[t]);if(y)if(e.crop&&e.cropData){if(e.crop[t*5]){let x=[e.crop[t*5+1]/e.display.scale-e.display.points[t*5+1],e.crop[t*5+2]/e.display.scale-e.display.points[t*5+2],1+(e.crop[t*5+3]-e.crop[t*5+1])/e.display.scale,1+(e.crop[t*5+4]-e.crop[t*5+2])/e.display.scale];x[0]+=e.cropData.x/e.display.scale,x[1]+=e.cropData.y/e.display.scale;let E=e.x*this.lastKnownScale,S=e.y*this.lastKnownScale,k=[i+E,r+S,n,a];k[0]+=E,k[1]+=S,this.ctx.drawImage(y,x[0],x[1],x[2],x[3],k[0],k[1],k[2]+1,k[3]+1)}}else gT?this.ctx.drawImage(y,0,0,e.display.points[t*5+3]-e.display.points[t*5+1],e.display.points[t*5+4]-e.display.points[t*5+2],i,r,n+1,a+1):this.ctx.drawImage(y,0,0,e.display.points[t*5+3]-e.display.points[t*5+1],e.display.points[t*5+4]-e.display.points[t*5+2],i,r,n+Number.MIN_VALUE+.5,a+Number.MIN_VALUE+.5)}catch{}e.display.rotation&&this.ctx.restore()}let u=e instanceof Hs&&this.options.box,c=e instanceof iv&&this.options.polygon;if((u||c)&&!e.props.className&&!e.props.html&&!e.props.href){if(this.visible.push(e),e.props.style){let d=Object.assign({},e.props.style||{},e.hovering?e.props.hoverStyles:{},e.pressing?e.props.pressStyles:{}),p=e.props.relativeStyle?1:n/e.width;typeof d.opacity<"u"&&(this.ctx.globalAlpha=d.opacity);let y=0;typeof d.borderWidth<"u"&&(y=parseInt(d.borderWidth,10)*p);let x=0;typeof d.outlineWidth<"u"&&(x=parseInt(d.outlineWidth,10)*p);let E=0;if(typeof d.outlineOffset<"u"&&(E=parseInt(d.outlineOffset,10)*p),d.borderColor&&(this.ctx.strokeStyle=d.borderColor),d.boxShadow){let S=d.boxShadow.split(/,(?![^(]*\))/);for(let k of S){let T=nv[k]||rv.exec(k)||rv.exec(k);nv[k]=T,T&&(this.ctx.save(),this.ctx.shadowOffsetX=parseInt(T[1])*this.dpi*p,this.ctx.shadowOffsetY=parseInt(T[3])*this.dpi*p,this.ctx.shadowBlur=parseInt(T[5])*this.dpi*p,this.ctx.shadowColor=T[9],this.ctx.fillStyle="rgba(0,0,0,1)",this.ctx.fillRect(i+y,r+y,n,a),this.ctx.restore())}}if(this.ctx.fillStyle=d.backgroundColor||"transparent",this.ctx.lineWidth=y,c){let S=e.shape,k=S.points||[],T=k.length;this.ctx.beginPath();for(let R=0;R<T;R++)this.ctx.lineTo(i+k[R][0]*this.lastKnownScale,r+k[R][1]*this.lastKnownScale);S.open||this.ctx.closePath(),y&&this.ctx.stroke(),S.open||this.ctx.fill()}else y&&this.ctx.strokeRect(i+y/2,r+y/2,n+y,a+y),this.ctx.fillRect(i+y,r+y,n,a);x&&(d.outlineColor&&(this.ctx.strokeStyle=d.outlineColor),this.ctx.lineWidth=x,this.ctx.strokeRect(i-x/2-E,r-x/2-E,n+y*2+x+E*2,a+y*2+x+E*2))}this.ctx.globalAlpha=l}}loadImage(e,t,i,r=!1){if(Pl[e]&&Pl[e].naturalWidth>0){t(Pl[e]);return}try{let n=!1;r||setTimeout(()=>{n||this.loadImage(e,t,i,!0)},3e3);let a=document.createElement("img");a.decoding="auto",a.onload=function(){n=!0,t(a),Pl[e]=a,a.onload=null},this.options.crossOrigin&&(a.crossOrigin="anonymous"),a.src=e,a.complete&&a.onload({}),a.width}catch(n){console.log("image error",n),i(n)}}schedulePaintToCanvas(e,t,i,r){this.imagesPending++,e.indices.push(i);let n=`${t.id}--${t.display.scale}-${i}`,a=this.invalidated.indexOf(n);a!==-1&&this.invalidated.splice(a,1),e.canvases[i]=n,t.__host.canvas.loading=!0,this.loadingQueueOrdered=!1,this.loadingQueue.push({id:n,scale:t.display.scale,network:!0,distance:r,task:()=>new Promise(l=>{if(this.visible.indexOf(t)===-1){this.imagesPending--,e.indices.splice(e.indices.indexOf(i),1),l();return}let u=t.getImageUrl(i);this.loadImage(u,c=>{this.loadingQueue.push({id:n,scale:t.display.scale,distance:r,task:()=>new Promise(d=>{this.imageIdsLoaded.includes(n)||(this.imagesLoaded++,this.imageIdsLoaded.push(n)),e.loaded.push(i),e.loaded.length===e.indices.length&&(e.loading=!1);let p=t.display.points.slice(i*5,i*5+5),y=document.createElement("canvas"),x=y.getContext("2d");y.width=p[3]-p[1],y.height=p[4]-p[2],this.hostCache.set(e.canvases[i],y),this.drawCalls.push(()=>{x.drawImage(c,0,0,p[3]-p[1],p[4]-p[2]),d()})})}),l()},c=>{this.imagesPending--,e.indices.splice(e.indices.indexOf(i),1),l()})})})}afterPaintLayer(e,t){}prepareLayer(e,t){e.__owner.value&&(e.cropData?(this.lastKnownScale*(1/e.display.scale),this.applyTransform(e,t[1],t[2],t[3]-t[1],t[4]-t[2])):this.applyTransform(e,t[1],t[2],t[3]-t[1],t[4]-t[2])),(!e.__host||!e.__host.canvas)&&(e instanceof Gr||e instanceof is)&&this.createImageHost(e)}finishLayer(){this.lastPaintedObject&&this.clearTransform()}createImageHost(e){e.__host=e.__host?e.__host:{},e.__host.canvas={canvas:void 0,canvases:[],indices:[],loaded:[],loading:!1}}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getViewportBounds(e,t,i){let r=e.getActiveZone();if(r){let n=t[3]-t[1]<r.points[3]-r.points[1],a=t[4]-t[2]<r.points[4]-r.points[2];return{x1:n?r.points[1]-i:r.points[1]+(r.points[3]-r.points[1])/2-(t[3]-t[1])/2,y1:a?r.points[2]-i:r.points[2]+(r.points[4]-r.points[2])/2-(t[4]-t[2])/2,x2:n?r.points[3]+i:r.points[1]+(r.points[3]-r.points[1])/2-(t[3]-t[1])/2,y2:a?r.points[4]+i:r.points[2]+(r.points[4]-r.points[2])/2-(t[4]-t[2])/2}}return null}pendingUpdate(){let e=!this.pendingDrawCall&&this.drawCalls.length===0&&this.imagesPending===0&&this.loadingQueue.length===0&&this.tasksRunning===0;return!e&&this.visible.length===0&&setTimeout(()=>{this.canvas.style.opacity="1",this.firstMeaningfulPaint=!0},500),!this.firstMeaningfulPaint&&e&&this.visible.length?(this.canvas.style.opacity="1",this.firstMeaningfulPaint=e,!0):this.options.debug?!0:!e}getRendererScreenPosition(){return this.rendererPosition}reset(){this.loadingQueue=[],this.drawCalls=[]}},sv=class{constructor(e){M(this,"renderers",[]),M(this,"length");for(let t of e)t&&this.renderers.push(t);this.length=this.renderers.length}afterFrame(e,t,i,r){for(let n=0;n<this.length;n++)this.renderers[n].afterFrame(e,t,i,r)}afterPaintLayer(e,t){for(let i=0;i<this.length;i++)this.renderers[i].afterPaintLayer(e,t)}beforeFrame(e,t,i,r){for(let n=0;n<this.length;n++)this.renderers[n].beforeFrame(e,t,i,r)}triggerResize(){for(let e=0;e<this.length;e++){let t=this.renderers[e];t.triggerResize&&t.triggerResize()}}getPointsAt(e,t,i,r){return this.renderers[0].getPointsAt(e,t,i,r)}getScale(e,t){return this.renderers[0].getScale(e,t)}getViewportBounds(e,t,i){return this.renderers[0].getViewportBounds(e,t,i)}getRendererScreenPosition(){return this.renderers[0].getRendererScreenPosition()}isReady(){for(let e=0;e<this.length;e++)if(!this.renderers[e].isReady())return!1;return!0}paint(e,t,i,r,n,a){for(let l=0;l<this.length;l++)this.renderers[l].paint(e,t,i,r,n,a)}pendingUpdate(){for(let e=0;e<this.length;e++)if(this.renderers[e].pendingUpdate())return!0;return!1}prepareLayer(e,t){for(let i=0;i<this.length;i++)this.renderers[i].prepareLayer(e,t)}finishLayer(e,t){for(let i=0;i<this.length;i++)this.renderers[i].finishLayer(e,t)}resize(e,t){for(let i=0;i<this.length;i++)this.renderers[i].resize(e,t)}reset(){for(let e=0;e<this.length;e++)this.renderers[e].reset()}},yT=class{constructor(e){M(this,"canvas"),M(this,"context"),M(this,"heightRatio",1),M(this,"widthRatio",1),M(this,"target",new Float32Array(5)),M(this,"initialWidth"),M(this,"initialHeight"),M(this,"bounds"),M(this,"aggregate"),M(this,"delta",0),M(this,"renderNextFrame",!0),this.canvas=e,this.initialWidth=e.width,this.initialHeight=e.height,this.context=e.getContext("2d"),this.context.globalAlpha=.5,this.aggregate=gn(1)}isReady(){return!0}resize(){this.initialWidth=this.canvas.width,this.initialHeight=this.canvas.height,this.renderNextFrame=!0}afterFrame(e,t,i){if(this.renderNextFrame){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);let r=this.initialWidth/e.width,n=this.initialHeight/e.height,a=this.widthRatio>this.heightRatio?r:n;if(this.target=i,this.bounds){let l=e.getPointsAt(this.bounds,this.aggregate,a);for(let[u,c]of l)if(u instanceof Gr&&u.__host.canvas){let d=c.length/5;for(let p=0;p<d;p++)u.__host.canvas.canvases[p]&&(c[p+1]*a,c[p+2]*a,(c[p+3]-c[p+1])*a,(c[p+4]-c[p+2])*a)}}e.getPoints().forEach((l,u,c)=>{if(u%5===0&&l){let d={x1:c[u+1]*a,y1:c[u+2]*a,x2:c[u+3]*a,y2:c[u+4]*a,width:(c[u+3]-c[u+1])*a,height:(c[u+4]-c[u+2])*a};this.context.strokeStyle="red",this.context.strokeRect(d.x1,d.y1,d.width,d.height)}}),i&&(this.context.strokeStyle="red",this.context.lineWidth=window.devicePixelRatio||1,this.context.strokeRect(i[1]*a,i[2]*a,(i[3]-i[1])*a,(i[4]-i[2])*a))}}getActiveZone(e){return null}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getScale(e,t){return 1}beforeFrame(e,t){this.bounds=st.singleBox(e.width,e.height)}drawImage(){}afterPaintLayer(e,t){}paint(e,t,i,r,n,a){this.renderNextFrame=!0}prepareLayer(e){}pendingUpdate(){return!1}hasActiveZone(){return!1}getViewportBounds(e,t,i){return null}getRendererScreenPosition(){return this.canvas.getBoundingClientRect()}finishLayer(){}reset(){}};function vT(e){return{x:e[1],y:e[2],width:e[3]-e[1],height:e[4]-e[2]}}var av="pan",ov="scroll",bT="gesture",wT={zoomOutFactor:.8,zoomInFactor:1.25,maxZoomFactor:1,minZoomFactor:.05,zoomDuration:300,zoomWheelConstant:20,zoomClamp:.6,panBounceStiffness:120,panBounceDamping:15,panTimeConstant:240,panPower:.1,nudgeDistance:100,panPadding:0,devicePixelRatio:1,enableWheel:!0,enableClickToZoom:!0,ignoreSingleFingerTouch:!1,enablePanOnWait:!1,requireMetaKeyForWheelZoom:!1,panOnWaitDelay:40,onPanInSketchMode:()=>{},parentElement:null},lv=(e={})=>({start:function(t){let{zoomWheelConstant:i,enableWheel:r,enableClickToZoom:n,ignoreSingleFingerTouch:a,enablePanOnWait:l,panOnWaitDelay:u,parentElement:c,requireMetaKeyForWheelZoom:d}=C(C({},wT),e),p={pointerStart:{x:0,y:0},isPressing:!1,mousemoveBuffer:Re(5)};t.world.activatedEvents.push("onMouseUp","onMouseDown","onMouseMove","onTouchStart","onTouchEnd","onTouchMove");function y(){k=0,R="",$(),$(void 0,"notice"),T=0}function x(){t.world.constraintBounds(),y()}function E(G){if(G.which>1){p.isPressing=!1;return}t.mode==="explore"&&(G.preventDefault(),p.pointerStart.x=G.atlas.x,p.pointerStart.y=G.atlas.y,t.transitionManager.stopTransition(),p.isPressing=!0)}function S(){y(),p.isPressing&&(t.mode==="explore"&&t.world.constraintBounds(),p.isPressing=!1)}let k=0,T=0,R="";function A(G){if(t.mode==="explore"){if(G.atlasTouches.length===1&&(T=performance.now(),a==!1&&G.preventDefault(),p.pointerStart.x=G.atlasTouches[0].x,p.pointerStart.y=G.atlasTouches[0].y),G.atlasTouches.length===2){R=bT,G.preventDefault();let ue=G.atlasTouches[0].x,ce=G.atlasTouches[1].x;p.pointerStart.x=(ue+ce)/2;let be=G.atlasTouches[0].y,re=G.atlasTouches[1].y;p.pointerStart.y=(be+re)/2,k=gl({x:G.touches[0].clientX,y:G.touches[0].clientY},{x:G.touches[1].clientX,y:G.touches[1].clientY})}t.transitionManager.stopTransition(),p.isPressing=!0}}function $(G,ue="intent"){c&&(c.dataset[ue]=G)}function z(G){let ue=null,ce=null,be=0;if(p.isPressing&&G.touches.length===2){let re=G.touches[0].clientX,Te=G.touches[1].clientX;ue=(re+Te)/2;let Oe=G.touches[0].clientY,qe=G.touches[1].clientY;ce=(Oe+qe)/2,be=gl({x:G.touches[0].clientX,y:G.touches[0].clientY},{x:G.touches[1].clientX,y:G.touches[1].clientY})}if($(R),p.isPressing&&G.touches.length===1){if(l&&(performance.now()-T<u&&R==""&&(R=ov),R==""&&(R=av)),$(R),R==""&&a==!0||R==ov){$("require-two-finger","notice");return}let re=G.touches[0];ue=re.clientX,ce=re.clientY}if(ue!==null&&ce!==null){let re=t.getRendererScreenPosition();if(re){let{x:Te,y:Oe}=t.viewerToWorld(ue-re.x,ce-re.y),qe=be&&k?be/k:1;t.transitionManager.customTransition(ne=>{ne.from=Re(t.target),ne.to=Vr(ne.from,Qr(Li(p.pointerStart.x-Te,p.pointerStart.y-Oe),Ra(1/qe,Te,Oe)),p.mousemoveBuffer),ne.elapsed_time=0,ne.total_time=0,ne.timingFunction=Pr.easeInOutExpo,ne.done=!1})}k=be}R==av&&G.preventDefault()}function B(G){if(p.isPressing){let ue=t.getRendererScreenPosition();if(ue){let{x:ce,y:be}=t.viewerToWorld(G.clientX-ue.x,G.clientY-ue.y);t.transitionManager.customTransition(re=>{re.from=Re(t.target),re.to=Vr(re.from,Li(p.pointerStart.x-ce,p.pointerStart.y-be),p.mousemoveBuffer),re.elapsed_time=0,re.total_time=0,re.timingFunction=Pr.easeInOutExpo,re.done=!1})}}}function H(G){t.mode==="explore"&&t.world.zoomIn(G.atlas)}function Y(G){let ue=1+(0,KC.default)(G).spinY/i;t.world.zoomTo(ue,G.atlas,!0)}function Q(G){return d&&G.metaKey==!1?($("meta-required","notice"),G.stopPropagation(),!1):!0}t.world.addEventListener("mouseup",x),t.world.addEventListener("touchend",x),t.world.addEventListener("touchstart",A),t.world.addEventListener("mousedown",E),window.addEventListener("touchend",S),window.addEventListener("mouseup",S),window.addEventListener("mousemove",B),c&&c.addEventListener("touchmove",z),n&&(t.world.activatedEvents.push("onClick"),t.world.addEventListener("click",H)),r&&(t.world.activatedEvents.push("onWheel"),d&&(c==null||c.addEventListener("wheel",Q,{passive:!0,capture:!0})),t.world.addEventListener("wheel",Y));let he=t.world.addLayoutSubscriber((G,ue)=>{if(G==="zone-changed"&&t.transitionManager.constrainBounds({transition:{duration:0}}),G==="zoom-to"&&ue&&t.transitionManager.zoomTo(ue.factor,{origin:ue.point,stream:ue.stream}),G==="go-home"){let ce=ue.immediate?{duration:0}:void 0;t.transitionManager.goToRegion(vT(t.homePosition),{transition:ce})}if(G==="goto-region"&&ue){let ce=ue.immediate?{duration:0}:{};t.transitionManager.goToRegion(ue,{transition:ce})}G==="constrain-bounds"&&t.transitionManager.constrainBounds({transition:ue!=null&&ue.immediate?{duration:0}:void 0})});return()=>{t.world.removeEventListener("mouseup",x),t.world.removeEventListener("touchend",x),t.world.removeEventListener("touchstart",A),t.world.removeEventListener("mousedown",E),window.removeEventListener("touchend",S),window.removeEventListener("mouseup",S),t.world.removeEventListener("mousemove",B),c&&(c.removeEventListener("touchmove",B),c.removeEventListener("wheel",Q,{passive:!0,capture:!0})),n&&t.world.removeEventListener("click",H),r&&t.world.removeEventListener("wheel",Y),he()}},updatePosition(){}}),Cl=te.createContext("explore");Cl.displayName="Mode";var gc=()=>Yt(Cl),Tl=te.createContext(null);Tl.displayName="Atlas";var Il=te.createContext(null);Il.displayName="Bounds";var Rl,xT=typeof performance=="object"&&typeof performance.now=="function";if(xT){let e=performance;Rl=()=>e.now()}else{let e=Date,t=e.now();Rl=()=>e.now()-t}var _T=16;function uv(e,t){e&&e.appendChild&&t&&e.appendChild(t)}function hv(e,t){e&&e.removeChild&&t&&e.removeChild(t)}function ST(e,t){return hv(e.world,t)}function ET(e,t,i){return cv(e.world,t,i)}function cv(e,t,i){e&&e instanceof El&&(e=e.world),e&&e.insertBefore&&e.insertBefore(t,i)}function mc(e,t,i){if(i&&(e.applyProps&&e.applyProps(i),e instanceof kr))for(let r of dl){let n=r.slice(2).toLowerCase();i[r]!==t[r]&&(t[r]&&e.removeEventListener(n,t[r]),e.addEventListener(n,i[r]))}}function yc(e,t){let i=Object.keys(t),r=!1;for(let n of i)if(dl.indexOf(n)!==-1){let a=Ws[n];if(a){if(e.activatedEvents.indexOf(a)!==-1)continue;r=!0,e.activatedEvents.push(a)}}r&&e.triggerEventActivation()}var Ol=new Map,dv={};function AT(e,t,i,r,n){var a=t,{args:l=[]}=a,u=le(a,["args"]);if(!(i instanceof El)&&n){let p=y=>y.return?p(y.return):y.stateNode&&y.stateNode.containerInfo;i=p(n)}let c,d=i.world;switch(e){case"world":c=rs.withProps({width:u.width,height:u.height,viewingDirection:"left-to-right"}),c.activatedEvents=d.activatedEvents,c.eventHandlers=d.eventHandlers,c.subscriptions=d.subscriptions,c.triggerEventActivation(),d=c;break;case"box":c=new Hs;break;case"shape":c=new iv;break;case"worldObject":case"world-object":c=new Ma;break;case"worldImage":case"world-image":c=new Gr;break;case"texture":c=new pl;break;case"compositeImage":case"composite-image":c=new pc({id:u.id,width:u.width,height:u.height,images:[],renderOptions:u.renderOptions});break;case"tiledImage":case"tiled-image":c=is.fromTile(u.uri,u.display,u.tile,u.scaleFactor,void 0,u.format);break;case"paragraph":c=new La,c.text=u.children;break;default:return}return yc(d,u),mc(c,{},u),c}function kT(e,t){if(t instanceof rs)e.world=t;else if(t instanceof Ma)e.world.appendChild(t);else if(t)throw new Error("Invalid root")}var za=(0,nT.default)({unstable_now:Rl,now:Rl,createInstance:AT,removeChild:hv,appendChild:uv,appendInitialChild:uv,insertBefore:cv,warnsIfNotActing:!0,supportsMutation:!0,isPrimaryRenderer:!1,scheduleTimeout:typeof setTimeout<"u"?setTimeout:void 0,cancelTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,setTimeout:typeof setTimeout<"u"?setTimeout:void 0,clearTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,noTimeout:-1,appendChildToContainer:kT,removeChildFromContainer:ST,createTextInstance(){},insertInContainerBefore:ET,prepareUpdate(e,t,i,r,n){return yc(n.world,r),r},commitUpdate(e,t,i,r,n,a){e.applyProps&&t&&mc(e,r,t)},finalizeInitialChildren(e){return e==null?void 0:e.__handlers},getChildHostContext(){return dv},getRootHostContext(){return dv},prepareForCommit(e){return e.isCommitting=!0,null},preparePortalMount(){},hideInstance(e){e&&e.points&&(e.points[0]=0)},unhideInstance(e,t){e&&e.points&&(e.points[0]=1)},getPublicInstance(e){return e},hideTextInstance(){throw new Error("Text is not allowed in the react-three-fibre tree. You may have extraneous whitespace between components.")},resetAfterCommit(e){e.isCommitting=!1,e.pendingUpdate=!0,e.world&&e.world.needsRecalculate&&(e.world.recalculateWorldSize(),e.world.triggerRepaint())},shouldSetTextContent(){return!1},clearContainer(){return!1},supportsHydration:!1,supportsPersistence:!1,detachDeletedInstance(e){},afterActiveInstanceBlur(){},beforeActiveInstanceBlur(){},getCurrentEventPriority(){return console.log("getCurrentEventPriority"),_T},getInstanceFromNode(e){throw console.log("getInstanceFromNode",e),new Error("Not implemented")},getInstanceFromScope(e){throw console.log("getInstanceFromScope",e),new Error("Not implemented")},prepareScopeUpdate(e,t){throw console.log("prepareScopeUpdate",e,t),new Error("Not implemented")},logRecoverableError(){},requestPostPaintCallback(){}});za.injectIntoDevTools({bundleType:0,version:Cs,rendererPackageName:"@atlas-viewer/atlas"});function vc(e,t){let i=Ol.get(e);i&&za.updateContainer(null,i,null,()=>{Ol.delete(e),t&&t(e)})}var fv={render(e,t){let i=Ol.get(t);if(i)za.updateContainer(e,i,null);else{let r=za.createContainer(t,0,null,!1,null,"",()=>{},null);za.updateContainer(e,r,null),Ol.set(t,r)}},unmountComponentAtNode(e,t){vc(e,t)}},pv,gv,Fa=typeof window<"u"&&((pv=window.document)!=null&&pv.createElement||((gv=window.navigator)==null?void 0:gv.product)==="ReactNative")?Et:fe,PT=te.memo(({children:e,setIsReady:t,onCreated:i,bounds:r,preset:n,mode:a="explore"})=>{let l=Qe(function(u){let c=xe(!1),d=()=>{t(!0)};return fe(()=>{if(n&&!c.current){n.runtime.goHome();let p=i&&i(n);return void(p&&p.then?p.then(d):d())}return()=>{}},[]),fe(()=>{c.current=!0},[]),u.children},[n]);return Fa(()=>{if(n){let u=n.runtime;a!==u.mode&&(u.mode=a),fv.render(Ke(te.StrictMode,{children:Ke(l,{children:Ke(Il.Provider,{value:r,children:Ke(Cl.Provider,{value:a,children:Ke(Tl.Provider,{value:n,children:e})})})})}),u)}},[n,a,e]),Fa(()=>{if(n){let u=n.runtime;return()=>{fv.unmountComponentAtNode(u)}}return()=>{}},[n]),null}),CT=class{constructor(e,t){M(this,"canvas"),M(this,"gl"),M(this,"program"),M(this,"fragmentShader"),M(this,"vertexShader"),M(this,"rectBuffer"),M(this,"fragmentShaderSource",`
    precision mediump float;

    uniform sampler2D u_image;
    varying vec2 v_texCoord;

    void main() {
        gl_FragColor = texture2D(u_image, v_texCoord);
    }
  `),M(this,"vertexShaderSource",`
    attribute vec2 a_position;
    uniform vec2 u_resolution;
    varying vec4 v_color;
    uniform sampler2D u_texture;

    attribute vec2 a_texCoord;
    varying vec2 v_texCoord;

    void main() {

        // convert the position from pixels to 0.0 to 1.0
        vec2 zeroToOne = a_position / u_resolution;

        // convert from 0->1 to 0->2
        vec2 zeroToTwo = zeroToOne * 2.0;

        // convert from 0->2 to -1->+1 (clip space)
        vec2 clipSpace = zeroToTwo - 1.0;

        gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
        
        v_texCoord = a_texCoord;
    }
  `),M(this,"attributes"),M(this,"uniforms"),M(this,"buffers"),M(this,"rendererPosition"),M(this,"dpi"),M(this,"lastResize",0),M(this,"lastKnownScale",1),this.canvas=e,this.rendererPosition=e.getBoundingClientRect(),this.gl=e.getContext("webgl2"),this.fragmentShader=this.createShader(this.gl.FRAGMENT_SHADER,this.fragmentShaderSource),this.vertexShader=this.createShader(this.gl.VERTEX_SHADER,this.vertexShaderSource),this.program=this.createProgram(this.vertexShader,this.fragmentShader),this.dpi=(t==null?void 0:t.dpi)||1,this.attributes={position:this.gl.getAttribLocation(this.program,"a_position"),texCoord:this.gl.getAttribLocation(this.program,"a_texCoord")},this.uniforms={resolution:this.gl.getUniformLocation(this.program,"u_resolution"),texture:this.gl.getUniformLocation(this.program,"u_texture")},this.buffers={position:this.createArrayBuffer(),texCoord:this.createArrayBuffer(new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]))},this.rectBuffer=new Float32Array(12),this.resize(),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.useProgram(this.program),this.gl.enableVertexAttribArray(this.attributes.position)}resize(){this.resizeCanvasToDisplaySize(),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.rendererPosition=this.canvas.getBoundingClientRect()}isReady(){return!0}beforeFrame(e,t,i){this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.vertexAttribPointer(this.attributes.position,2,this.gl.FLOAT,!1,0,0),this.gl.uniform2f(this.uniforms.resolution,this.gl.canvas.width,this.gl.canvas.height),this.lastResize>1e3&&(this.lastResize=0,this.resizeCanvasToDisplaySize()),this.lastResize+=t}prepareLayer(e){(!e.__host||!e.__host.webgl)&&((e instanceof Gr||e instanceof is)&&this.createImageHost(e),e instanceof pl&&this.createTextureHost(e))}createTextureHost(e){e.__host=e.__host?e.__host:{};let t=this.gl,i=this.gl.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1);let r;if(e instanceof pl){let n=e.getTexture();n.source&&t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n.source),r=n}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),e.__host.webgl={height:e.height,width:e.width,texture:i,lastImage:r}}createImageHost(e){let t=[...new Array(e.points.length/5)];e.__host=e.__host?e.__host:{},e.__host.webgl={height:e.height,width:e.width,textures:t,loading:[],loaded:[],lastLevelRendered:-1,onLoad:(i,r)=>{let n=this.gl,a=this.gl.createTexture();n.bindTexture(n.TEXTURE_2D,a),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.bindTexture(n.TEXTURE_2D,null),e.__host.webgl.textures[i]=a,e.__host.webgl.loaded.push(i)}}}paint(e,t,i,r,n,a){if(e.type==="spacial-content"&&e.__host&&e.__host.webgl){if(e.getTexture){let u=e==null?void 0:e.getTexture();if(u&&e.__host.webgl.lastImage!==u.hash&&u.source&&!e.__host.webgl.error)try{let c=this.gl.RGBA,d=this.gl.RGBA,p=this.gl.UNSIGNED_BYTE;this.gl.bindTexture(this.gl.TEXTURE_2D,e.__host.webgl.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,c,d,p,u.source),e.__host.webgl.lastImage=u.hash}catch(c){e.__host.webgl.error=c}}if(e.__host.webgl.loading&&e.__host.webgl.loading.indexOf(t)===-1&&e.getImageUrl){e.__host.webgl.loading.push(t);let u=document.createElement("img");u.decoding="async",u.crossOrigin="anonymous",u.src=e.getImageUrl(t),u.onload=()=>(u.onload=null,e.__host.webgl.onLoad(t,u))}let l=e.__host.webgl.texture?e.__host.webgl.texture:e.__host.webgl.textures[t];l&&(this.gl.enableVertexAttribArray(this.attributes.texCoord),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffers.texCoord),this.gl.enableVertexAttribArray(this.attributes.texCoord),this.gl.vertexAttribPointer(this.attributes.texCoord,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffers.position),this.gl.enableVertexAttribArray(this.attributes.position),this.gl.vertexAttribPointer(this.attributes.position,2,this.gl.FLOAT,!1,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,l),this.gl.uniform1i(this.uniforms.texture,0),this.setRectangle(i,r,n,a),this.gl.drawArrays(this.gl.TRIANGLES,0,6))}}afterPaintLayer(e,t){}pendingUpdate(){return!0}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}afterFrame(){}getScale(e,t,i){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let r=this.getCanvasDims(),n=r.width/e,a=r.height/t,l=(n<a?a:n)*(i&&this.dpi||1);return Number.isNaN(l)||(this.lastKnownScale=l),this.lastKnownScale}getCanvasDims(){return{width:this.canvas.width/this.dpi,height:this.canvas.height/this.dpi}}getViewportBounds(e,t,i){return null}createShader(e,t){let i=this.gl.createShader(e);if(i){if(this.gl.shaderSource(i,t),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS))return i;let r=this.gl.getShaderInfoLog(i);if(this.gl.deleteShader(i),r)throw new Error(r)}throw new Error("Invalid shader")}createProgram(e,t){let i=this.gl.createProgram();if(i){if(this.gl.attachShader(i,e),this.gl.attachShader(i,t),this.gl.linkProgram(i),this.gl.getProgramParameter(i,this.gl.LINK_STATUS))return i;let r=this.gl.getProgramInfoLog(i);if(this.gl.deleteProgram(i),r)throw new Error(r)}throw new Error("Invalid program")}resizeCanvasToDisplaySize(){let e=this.gl.canvas,t=e.clientWidth,i=e.clientHeight,r=e.width!==t||e.height!==i;return r&&(e.width=t,e.height=i),r}createArrayBuffer(e){let t=this.gl.createBuffer();if(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),e&&this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW),!t)throw new Error("Cannot create buffer");return t}setRectangle(e,t,i,r){this.gl.bufferData(this.gl.ARRAY_BUFFER,this.getRectangle(e,t,i,r),this.gl.STATIC_DRAW)}getRectangle(e,t,i,r){let n=e,a=e+i,l=t,u=t+r;return this.rectBuffer.set([n,l,a,l,n,u,n,u,a,l,a,u]),this.rectBuffer}getRendererScreenPosition(){return this.rendererPosition}finishLayer(){}reset(){}};function bc(e,t){let i=t?e:JSON.stringify(e),r=5381,n=i.length;for(;n;)r=r*33^i.charCodeAt(--n);let a=(r>>>0).toString(16);return a.length%2?"0"+a:a}var mv=class{constructor(e){M(this,"$element"),M(this,"stylesheetClasses"),M(this,"activeStylesheetClasses"),M(this,"sheetsDidUpdate"),M(this,"sheetPrefix"),M(this,"stylesheetEntries"),this.sheetPrefix=(e==null?void 0:e.sheetPrefix)||"a-",this.$element=document.createElement("style"),this.stylesheetClasses=[],this.activeStylesheetClasses=[],this.sheetsDidUpdate=!1,this.stylesheetEntries={}}getElement(){return this.$element}addStylesheet(e){let t=e.replace(/\s\s+/g," ").replace(/: /g,":").replace(/; /g,";").trim(),i=this.sheetPrefix+bc(t,!0);return this.stylesheetClasses.indexOf(i)!==-1||(this.stylesheetClasses.push(i),this.activeStylesheetClasses.push(i),this.stylesheetEntries[i]=t,this.sheetsDidUpdate=!0),i}removeStylesheet(e){let t=this.sheetPrefix+bc(e,!0);this.stylesheetClasses.indexOf(t)&&(this.stylesheetClasses=this.stylesheetClasses.filter(i=>i!==t)),this.sheetsDidUpdate=!0}clearClasses(){this.activeStylesheetClasses=[]}didUpdateActive(){if(this.activeStylesheetClasses.length){for(let e of this.activeStylesheetClasses)if(this.stylesheetClasses.indexOf(e)===-1)return!0;for(let e of this.stylesheetClasses)if(this.activeStylesheetClasses.indexOf(e)===-1)return!0}return!1}updateSheet(){(this.sheetsDidUpdate||this.didUpdateActive())&&(this.$element.innerText=this.activeStylesheetClasses.map(e=>`.${e}{${this.stylesheetEntries[e]}}`).join(""),this.sheetsDidUpdate=!1,this.stylesheetClasses=[...this.activeStylesheetClasses])}},yv=class{constructor(e,t){M(this,"htmlContainer"),M(this,"visible",[]),M(this,"previousVisible",[]),M(this,"htmlIds",[]),M(this,"firstMeaningfulPaint",!1),M(this,"rendererPosition"),M(this,"stylesheet"),M(this,"options"),M(this,"paintTx",1),M(this,"zIndex",0),M(this,"classes"),this.htmlContainer=e,this.htmlContainer.innerHTML="",this.rendererPosition=this.htmlContainer.getBoundingClientRect(),this.options=C({triggerResize:()=>{},box:!1,text:!1,sheetPrefix:"",inlineStyles:!1,background:""},t||{}),this.stylesheet=new mv({sheetPrefix:this.options.sheetPrefix}),this.options.inlineStyles||this.htmlContainer.appendChild(this.stylesheet.getElement()),this.options.background&&this.htmlContainer.classList.add(this.stylesheet.addStylesheet(`
        background: ${this.options.background};
      `)),this.classes={hostClassName:this.stylesheet.addStylesheet(`
        position: absolute;
        transform-origin: 0px 0px;
      `),interactive:this.stylesheet.addStylesheet("pointer-events: all"),nonInteractive:this.stylesheet.addStylesheet("pointer-events: none")},this.stylesheet.updateSheet()}createHtmlHost(e){if(this.htmlContainer&&(this.options.box||e.props.className||e.props.html||e.props.href)){let t=document.createElement(e.props.href?"a":"div");if(e.props.href){t.style.display="block",t.href=e.props.href;let i=e.props.hrefTarget||"_blank";t.target=i,i!=="_self"&&(t.rel="noopener noreferrer")}t.title=e.props.title||"",this.options.inlineStyles?(t.style.display="block",t.style.position="absolute",t.style.overflow="hidden",t.style.transformOrigin="0px 0px"):t.classList.add(this.classes.hostClassName),e.__host={element:t,revision:null,relative:!1},this.updateHtmlHost(e,e.width,e.height),e.__onCreate&&e.__onCreate()}}triggerResize(){this.options.triggerResize()}updateHtmlHost(e,t,i){if(e.__revision!==e.__host.revision){let r=e.__host.element,n=[this.classes.hostClassName];if(e.props.interactive?this.options.inlineStyles?r.style.pointerEvents="all":n.push(this.classes.interactive):this.options.inlineStyles?r.style.pointerEvents="none":n.push(this.classes.nonInteractive),e.props.href){r.style.display="block",r.href=e.props.href;let l=e.props.hrefTarget||"_blank";r.target=l,l!=="_self"?r.rel="noopener noreferrer":r.rel=""}else r.href&&r.removeAttribute("href");if(e.props.title&&(r.title=e.props.title||""),e.props.className&&(n.push(e.props.className),e.hovering&&n.push(`${e.props.className}--hover`),e.pressing&&n.push(`${e.props.className}--active`)),e.props.relativeStyle?(r.style.width=`${t||e.width}px`,r.style.height=`${i||e.height}px`):(r.style.width=`${e.width}px`,r.style.height=`${e.height}px`),e.props.style){Object.assign(r.style,e.props.style||{},e.hovering?e.props.hoverStyles||{}:{},e.pressing?e.props.pressStyles||{}:{});return}if(this.options.text&&e instanceof La){e.text&&(r.innerText=e.text),e.backgroundColor&&(r.style.backgroundColor=e.backgroundColor),e.color&&(r.style.color=e.color),e.props.font&&(r.style.font=e.props.font),e.props.textAlign&&(r.style.textAlign=e.props.textAlign),e.__host.revision=e.__revision;let l=n.join(" ");r.className=l,r.part=l}e instanceof Hs&&(this.options.box||e.props.className||e.props.html)&&(e.props.backgroundColor&&(r.style.backgroundColor=e.props.backgroundColor),e.props.border!==r.style.border&&(r.style.border=e.props.border));let a=n.join(" ");r.className=a,r.part=a}}afterFrame(e,t,i){this.stylesheet.updateSheet();for(let r of this.previousVisible)this.visible.indexOf(r)===-1&&this.htmlContainer&&r.__id&&this.htmlIds.indexOf(r.__id)!==-1&&this.htmlContainer.removeChild(r.__host.element);this.previousVisible=this.visible}afterPaintLayer(e,t){}beforeFrame(e,t,i){this.stylesheet.clearClasses(),this.paintTx++,this.zIndex=0,this.visible=[]}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getScale(e,t){let i=this.rendererPosition.width/e,r=this.rendererPosition.height/t;return i<r?r:i}getViewportBounds(e,t,i){return null}isReady(){return!1}paint(e,t,i,r,n,a){if(this.zIndex++,(this.options.text&&e instanceof La||e instanceof Hs&&(this.options.box||e.props.className||e.props.html))&&e.__host.tx!==this.paintTx&&(this.visible.push(e),e.__host.tx=this.paintTx,this.htmlContainer)){this.updateHtmlHost(e,n,a);let l=n/e.width,u=e.__host.element;u.style.zIndex=`${this.zIndex}`,e.props.relativeStyle?u.style.transform=`translate(${Math.round(i)}px, ${Math.round(r)}px)`:u.style.transform=`translate(${Math.round(i)}px, ${Math.round(r)}px) scale(${l})`,this.previousVisible.indexOf(e)===-1&&this.htmlContainer.appendChild(u),this.htmlIds.indexOf(e.__id)===-1&&this.htmlIds.push(e.__id)}}pendingUpdate(){return!1}prepareLayer(e){e.__host||(e instanceof La||e instanceof Hs)&&this.createHtmlHost(e)}resize(e,t){typeof e<"u"&&typeof t<"u"&&(this.htmlContainer.style.width=`${e}px`,this.htmlContainer.style.height=`${t}px`),this.rendererPosition=this.htmlContainer.getBoundingClientRect()}getRendererScreenPosition(){return this.rendererPosition}finishLayer(){}reset(){}},vv=class Nu{constructor(t,i,r){M(this,"element"),M(this,"runtime"),M(this,"unsubscribe"),M(this,"activatedEvents",[]),M(this,"eventHandlers",[]),M(this,"bounds"),M(this,"listening"),M(this,"pointerMoveEvent"),M(this,"pointerEventState",{isClicking:!1,isDragging:!1,isPressed:!1,mousedOver:[],itemsBeingDragged:[],mouseDownStart:{x:0,y:0},lastTouches:[]}),M(this,"options"),M(this,"_realPointerMove",a=>{this.pointerMoveEvent=a}),M(this,"onWheelEvent",a=>{a.preventDefault(),this.onPointerEvent(a)}),M(this,"onTouchEvent",a=>{let l=Ws[a.type],u=[],c=a.touches.length;for(let d=0;d<c;d++){let p=a.touches.item(d);if(!p)continue;let{x:y,y:x}=this.runtime.viewerToWorld(p.clientX-this.bounds.left,p.clientY-this.bounds.top),E={id:p.identifier,x:y,y:x};u.push(E)}u.length&&this.assignToEvent(a,u[0].x,u[0].y),l!=="onTouchEnd"?(this.pointerEventState.lastTouches=u,a.atlasTouches=u,this.runtime.world.propagateTouchEvent(l,a,u)):(a.atlasTouches=[],this.runtime.world.propagateTouchEvent(l,a,this.pointerEventState.lastTouches),this.pointerEventState.lastTouches=[])}),M(this,"onPointerEvent",a=>{let l=Ws[a.type];if(l&&this.runtime.world.activatedEvents.indexOf(l)!==-1){let{x:u,y:c}=this.runtime.viewerToWorld(a.clientX-this.bounds.left,a.clientY-this.bounds.top);this.assignToEvent(a,u,c),this.runtime.world.propagatePointerEvent(l,a,u,c)}}),M(this,"onPointerDown",a=>{this.pointerEventState.isPressed=!0,this.pointerEventState.isClicking=!0,this.pointerEventState.mouseDownStart.x=a.clientX,this.pointerEventState.mouseDownStart.y=a.clientY,setTimeout(()=>{this.runtime&&(this.pointerEventState.isClicking=!1)},250),setTimeout(()=>{if(this.runtime&&this.pointerEventState.isPressed&&!this.pointerEventState.isDragging){let l=this.runtime.viewerToWorld(this.pointerEventState.mouseDownStart.x-this.bounds.left,this.pointerEventState.mouseDownStart.y-this.bounds.top);this.pointerEventState.isDragging=!0,this.pointerEventState.itemsBeingDragged=this.runtime.world.propagatePointerEvent("onDragStart",a,l.x,l.y)}},800),this.onPointerEvent(a)}),M(this,"onPointerUp",a=>{if(this.pointerEventState.isClicking){let{x:l,y:u}=this.runtime.viewerToWorld(a.clientX-this.bounds.left,a.clientY-this.bounds.top);this.assignToEvent(a,l,u),this.runtime.world.propagatePointerEvent("onClick",a,l,u)}if(this.pointerEventState.isDragging){for(let l of this.pointerEventState.itemsBeingDragged)l.dispatchEvent("onDragEnd",a);this.pointerEventState.isDragging=!1}this.pointerEventState.isClicking=!1,this.pointerEventState.isPressed=!1,this.pointerEventState.itemsBeingDragged=[],this.onPointerEvent(a)}),M(this,"onPointerMove",a=>{this.pointerMoveEvent=void 0;let{x:l,y:u}=this.runtime.viewerToWorld(a.clientX-this.bounds.left,a.clientY-this.bounds.top);if(Number.isNaN(l)||Number.isNaN(u))return;this.assignToEvent(a,l,u),this.runtime.world.propagatePointerEvent("onPointerMove",a,l,u);let c=this.runtime.world.propagatePointerEvent("onMouseMove",a,l,u),d=[],p=[];for(let y of c)d.push(y.id),p.push(y),this.pointerEventState.mousedOver.indexOf(y)===-1&&(y.dispatchEvent("onMouseEnter",a),y.dispatchEvent("onPointerEnter",a),y.dispatchEvent("onMouseOver",a),y.dispatchEvent("onPointerOver",a));for(let y of this.pointerEventState.mousedOver)d.indexOf(y.id)===-1&&(y.dispatchEvent("onMouseLeave",a),y.dispatchEvent("onPointerLeave",a),y.dispatchEvent("onMouseOut",a),y.dispatchEvent("onPointerOut",a));if(this.pointerEventState.isDragging)for(let y of this.pointerEventState.itemsBeingDragged)y.dispatchEvent("onDrag",a);if(this.pointerEventState.isPressed&&!this.pointerEventState.isDragging&&gl(this.pointerEventState.mouseDownStart,{x:a.clientX,y:a.clientY})>50){let y=this.runtime.viewerToWorld(this.pointerEventState.mouseDownStart.x-this.bounds.left,this.pointerEventState.mouseDownStart.y-this.bounds.top);this.pointerEventState.isDragging=!0,this.pointerEventState.itemsBeingDragged=this.runtime.world.propagatePointerEvent("onDragStart",W(C({},a),{atlas:{x:y.x,y:y.y}}),y.x,y.y)}this.pointerEventState.mousedOver=p}),this.element=t,this.runtime=i,this.unsubscribe=i.world.addLayoutSubscriber(this.layoutSubscriber.bind(this)),this.bounds=t.getBoundingClientRect(),this.listening=!1,this.options=C({simulationRate:0},r||{});let n=0;i.registerHook("useFrame",a=>{n+=a,n>this.options.simulationRate&&this.pointerMoveEvent&&(n=0,i.updateNextFrame())}),i.registerHook("useBeforeFrame",()=>{this.pointerMoveEvent&&this.onPointerMove(this.pointerMoveEvent)}),this.activateEvents()}updateBounds(){this.bounds=this.element.getBoundingClientRect(),this.runtime.updateRendererScreenPosition()}layoutSubscriber(t){t==="event-activation"&&this.listening==!1&&this.activateEvents()}assignToEvent(t,i,r){Nu.eventPool.atlas.x=i,Nu.eventPool.atlas.y=r,t.atlas=Nu.eventPool.atlas}activateEvents(){this.listening=!0,this.element.addEventListener("pointermove",this._realPointerMove),this.element.addEventListener("pointerup",this.onPointerUp),this.element.addEventListener("pointerdown",this.onPointerDown),this.element.addEventListener("mousedown",this.onPointerEvent),this.element.addEventListener("mouseup",this.onPointerEvent),this.element.addEventListener("pointercancel",this.onPointerEvent),this.element.addEventListener("wheel",this.onWheelEvent),this.element.addEventListener("touchstart",this.onTouchEvent),this.element.addEventListener("touchcancel",this.onTouchEvent),this.element.addEventListener("touchend",this.onTouchEvent),this.element.addEventListener("touchmove",this.onTouchEvent)}normalizeEventName(t){return t.startsWith("on")?t.slice(2).toLowerCase():t.toLowerCase()}stop(){this.listening=!1,this.element.removeEventListener("pointermove",this._realPointerMove),this.element.removeEventListener("pointerup",this.onPointerUp),this.element.removeEventListener("pointerdown",this.onPointerDown),this.element.removeEventListener("mousedown",this.onPointerEvent),this.element.removeEventListener("mouseup",this.onPointerEvent),this.element.removeEventListener("pointercancel",this.onPointerEvent),this.element.removeEventListener("wheel",this.onWheelEvent),this.element.removeEventListener("touchstart",this.onTouchEvent),this.element.removeEventListener("touchcancel",this.onTouchEvent),this.element.removeEventListener("touchend",this.onTouchEvent),this.element.removeEventListener("touchmove",this.onTouchEvent),this.unsubscribe();for(let[t,i]of this.eventHandlers)this.element.removeEventListener(this.normalizeEventName(t),i)}};M(vv,"eventPool",{atlas:{x:0,y:0}});var bv=vv;function wv({interactive:e=!0,viewport:t,forceRefresh:i,canvasElement:r,overlayElement:n,controllerConfig:a,unstable_webglRenderer:l,dpi:u,debug:c,canvasBox:d=!0,polygon:p=!0,navigatorElement:y,runtimeOptions:x}){if(!r)throw new Error("Invalid container");r.style.userSelect="none";let E=e?lv(C({minZoomFactor:.5,maxZoomFactor:3,enableClickToZoom:!1,parentElement:r},a||{})):void 0,S=new sv([l?new CT(r,{dpi:u}):new mT(r,{dpi:u,debug:c,box:d,polygon:p}),n?new yv(n,{box:l||!d,text:!0,triggerResize:i}):void 0,y?new yT(y):void 0]),k=new El(S,new rs(1024,1024),t,E?[E]:[],x),T=new bv(r,k);return{name:"default-preset",em:T,runtime:k,renderer:S,controller:E,canvas:r,navigator:y,unmount(){vc(k),k.stopControllers(),k.stop(),k.reset(),T&&T.stop()}}}var yn=1+Number.MIN_VALUE,TT=class{constructor(e,t){M(this,"container"),M(this,"width"),M(this,"height"),M(this,"pending",!0),M(this,"options"),M(this,"stylesheet"),M(this,"zIndex",0),M(this,"lastKnownScale",1),M(this,"rendererPosition"),M(this,"currentlyVisible",[]),M(this,"previouslyVisible",[]),this.container=e,this.rendererPosition=e.getBoundingClientRect();let{width:i,height:r}=this.rendererPosition;this.width=i,this.height=r,this.options=C({addPart:!1,setDraggableFalse:!1,imageClass:"",widthStylesheet:!1,sheetPrefix:"position-",background:"#000"},t||{}),this.stylesheet=new mv({sheetPrefix:this.options.sheetPrefix}),this.container.classList.add(this.stylesheet.addStylesheet(`
        background: ${this.options.background};
      `)),this.options.widthStylesheet&&this.container.appendChild(this.stylesheet.getElement())}isReady(){return!0}resize(){this.rendererPosition=this.container.getBoundingClientRect(),this.width=this.rendererPosition.width,this.height=this.rendererPosition.height}getRendererScreenPosition(){return this.rendererPosition}afterFrame(e,t,i){this.stylesheet.updateSheet();for(let r of this.previouslyVisible)this.currentlyVisible.indexOf(r)===-1&&this.container.removeChild(r);for(let r of this.currentlyVisible)this.previouslyVisible.indexOf(r)===-1&&this.container.appendChild(r);this.previouslyVisible=this.currentlyVisible,this.currentlyVisible=[]}afterPaintLayer(e,t){}beforeFrame(e,t,i){this.stylesheet.clearClasses(),this.zIndex=0}getPointsAt(e,t,i,r){return e.getPointsAt(t,i,r)}getScale(e,t){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let i=this.width/e,r=this.height/t,n=i<r?r:i;return Number.isNaN(n)||(this.lastKnownScale=n),this.lastKnownScale}getViewportBounds(e,t,i){return null}createImage(){let e=document.createElement("img");return this.options.imageClass?(e.className=this.options.imageClass,this.options.addPart&&e.setAttribute("part",this.options.imageClass)):(e.style.position="absolute",e.style.pointerEvents="none",e.style.userSelect="none"),this.options.setDraggableFalse&&e.setAttribute("draggable","false"),e}paint(e,t,i,r,n,a){if(this.pending=!1,this.zIndex++,e instanceof Gr){if(!e.__host){let u=this.createImage();u.src=e.uri,e.__host=u,this.container.appendChild(e.__host)}let l=e.__host;this.currentlyVisible.push(l),l.style.zIndex=`${this.zIndex}`,l.style.opacity=`${e.style.opacity}`,this.options.widthStylesheet?l.className=this.options.imageClass+" "+this.stylesheet.addStylesheet(`width:${(n+yn).toFixed(2)}px;height:${(a+yn).toFixed(2)}px;`):(l.style.width=`${n+yn}px`,l.style.height=`${a+yn}px`),l.style.transform=`translate(${i}px, ${r}px)`}if(e instanceof is){if(e.__host||(e.__host={images:[]}),!e.__host.images[t]){let u=e.getImageUrl(t),c=this.createImage();c.src=u,e.__host.images[t]=c,this.container.appendChild(c)}let l=e.__host.images[t];l.style.zIndex=`${this.zIndex}`,l.style.opacity=`${e.style.opacity}`,this.currentlyVisible.push(l),this.options.widthStylesheet?l.className=this.options.imageClass+" "+this.stylesheet.addStylesheet(`width:${(n+yn).toFixed(2)}px;height:${(a+yn).toFixed(2)}px;`):(l.style.width=`${n+yn}px`,l.style.height=`${a+yn}px`),l.style.transform=`translate(${i}px, ${r}px)`}}pendingUpdate(){return this.pending}prepareLayer(e){}finishLayer(e){}reset(){}};function IT({interactive:e,viewport:t,forceRefresh:i,containerElement:r,overlayElement:n,controllerConfig:a}){if(!r)throw new Error("Invalid container");r.style.userSelect="none";let l=e?lv(C({minZoomFactor:.5,maxZoomFactor:3,enableClickToZoom:!1,parentElement:r},a||{})):void 0,u=new TT(r,{addPart:!1,setDraggableFalse:!1,imageClass:"atlas-static-image"}),c=n?new sv([u,new yv(n,{box:!0,text:!0,triggerResize:i})]):u,d=new El(c,new rs(1024,1024),t,l?[l]:[]),p=new bv(r,d);return{name:"static-preset",em:p,runtime:d,renderer:c,controller:l,container:r,overlay:n,unmount(){vc(d),d.stopControllers(),d.stop(),p&&p.stop()}}}var RT={"default-preset":wv,"static-preset":IT},OT={};function MT(e,t){let i=xe(),r=xe(),n=xe(),a=xe(),l=xe({width:t.width,height:t.height,didUpdate:!0}),[u="default-preset",c=OT]=Array.isArray(e)?e||[]:[e],[d,p]=je(null);Et(()=>{let x=r.current,E=a.current,S=i.current,k=n.current,T=(RT[u]||wv)(C({containerElement:E,canvasElement:x,overlayElement:S,navigatorElement:k,viewport:l.current,dpi:window.devicePixelRatio||1,forceRefresh:t.forceRefresh,unstable_webglRenderer:t.unstable_webglRenderer},c||{}));return p(T),()=>{T&&(T.unmount(),x&&(x.height=0,x.width=0),S&&(S.innerHTML=""),k&&(k.height=0,k.width=0))}},[u,c]);let y=Ae(()=>({canvas:r,overlay:i,container:a,navigator:n}),[]);return[u,d,l,y]}function LT(e){return Ae(()=>bc(e),e)}var Ba=te.forwardRef((e,t)=>Ke("div",W(C({},e),{ref:t,part:e.className}))),xv=["brightness","contrast","grayscale","hueRotate","invert","saturate","sepia","blur"],$T=e=>{var t=e,{htmlChildren:i,renderPreset:r,onCreated:n,mode:a="explore",resetWorldOnChange:l=!0,unstable_webglRenderer:u=!1,unstable_noReconciler:c=!1,hideInlineStyle:d=!1,controllerConfig:p,children:y,overlayStyle:x,containerStyle:E,enableNavigator:S,className:k,containerProps:T={},homePosition:R,homeOnResize:A,homeCover:$,background:z,runtimeOptions:B,debug:H,filters:Y}=t,Q=le(t,["htmlChildren","renderPreset","onCreated","mode","resetWorldOnChange","unstable_webglRenderer","unstable_noReconciler","hideInlineStyle","controllerConfig","children","overlayStyle","containerStyle","enableNavigator","className","containerProps","homePosition","homeOnResize","homeCover","background","runtimeOptions","debug","filters"]);let[he,G]=je(a),[ue,ce]=je(!1),be=xe(!1),re=Ae(()=>(typeof r=="string"&&(r=[r,{}]),H?r?[r[0],C({debug:H},r[1]||{})]:["default-preset",{debug:H}]:r||"default-preset"),[r,H]),[Te,Oe,qe]=Yy({scroll:!0}),ne=xe(),ke=Be=>{ne.current=Be,Te(Be)},[Le,J,Fe,Ve]=MT(re,{width:Q.width,height:Q.height,forceRefresh:qe,unstable_webglRenderer:u}),[Ze,Pt]=je("");fe(()=>{G(a)},[a]),fe(()=>{J&&J.em&&J.em.updateBounds()},[J,Oe]),fe(()=>{J==null||J.runtime.setOptions(B||{})},[B]),fe(()=>{J&&J.runtime&&(J.runtime.mode=he),ue&&J&&(J.ready=!0)},[J,ue,he]),fe(()=>{J&&($||(J.runtime.manualHomePosition=!!R,J.runtime.setHomePosition(R)))},[J,$,R]),fe(()=>{if(J){let Be=J.runtime;Be.resize(Fe.current.width,Q.width,Fe.current.height,Q.height),Fe.current.width=Q.width,Fe.current.height=Q.height,Be.updateNextFrame(),Fe.current.didUpdate=!0}},[J,Q.width,Q.height]),fe(()=>{if(Y&&J){let Be=J.runtime,ve=!1;Be.hookOptions.enableFilters=!0;for(let Pe of xv)Y[Pe]?Y[Pe]!==J.runtime.hookOptions.filters[Pe]&&(Be.hookOptions.filters[Pe]=Y[Pe],ve=!0):Be.hookOptions.filters[Pe]&&(Be.hookOptions.filters[Pe]=0,ve=!0);ve&&Be.updateNextFrame()}else if(J){let Be=J.runtime;for(let ve of xv)Be.hookOptions.filters[ve]=0;Be.hookOptions.enableFilters=!1,Be.updateNextFrame()}},[J,Y]),Fa(()=>{if(J&&(J.overlay&&(J.overlay.style.width=`${Oe.width}px`,J.overlay.style.height=`${Oe.height}px`),J.container&&(J.container.style.width=`${Oe.width}px`,J.container.style.height=`${Oe.height}px`),$)){let Be=J.runtime.world.width,ve=J.runtime.world.height,Pe=Be/ve,ot=Fe.current.width,yt=Fe.current.height,qt=ot/yt;if(Pe>qt){qt=yt/ot,J.runtime.manualHomePosition=!0;let Kt=(Be-ve/qt)/2;$==="start"&&(Kt=0),$==="end"&&(Kt=Be-ve/qt),J.runtime.setHomePosition({x:Kt,y:0,width:ve/qt,height:ve})}else{let Kt=(ve-Be/qt)/2;$==="start"&&(Kt=0),$==="end"&&(Kt=ve-Be/qt),J.runtime.manualHomePosition=!0,J.runtime.setHomePosition({x:0,y:Kt,width:Be,height:Be/qt})}A&&J.runtime.goHome({})}},[J,Oe.height,Oe.width,$]),Fa(()=>{let Be=()=>{if(J){let ve=J.runtime;Fe.current.width!==Q.width&&Fe.current.height!==Q.height&&(ve.resize(Fe.current.width,Q.width,Fe.current.height,Q.height),Fe.current.width=Q.width,Fe.current.height=Q.height,ve.updateNextFrame(),Fe.current.didUpdate=!0)}};return window.addEventListener("resize",Be),()=>window.removeEventListener("resize",Be)},[J,Q.height,Q.width]);let at={width:120},Xt=()=>{if(J&&J.navigator){let Be=J.runtime.world.height,ve=J.runtime.world.width,Pe=window.devicePixelRatio||1,ot=at.width,yt=at.width/ve*Be;J.navigator.width=ot*Pe,J.navigator.height=yt*Pe,J.navigator.style.width=ot+"px",J.navigator.style.height=yt+"px"}};Fa(()=>{if(J){Xt();let Be=J.runtime;return Be.world.addLayoutSubscriber(ve=>{ve==="recalculate-world-size"&&(Xt(),Be.resize(Fe.current.width,Q.width,Fe.current.height,Q.height))})}return()=>{}},[J,Q.width,Q.height]);let Ki=Qe(function(Be){let ve=()=>{ce(!0)};return fe(()=>{if(J){J.runtime.goHome();let Pe=n&&n(J);return void(Pe&&Pe.then?Pe.then(ve):ve())}else throw new Error("Invalid configuration - no runtime found")},[]),Be.children},[J]);fe(()=>{if(J){let Be=J.runtime;if(l)return Be.world.addLayoutSubscriber(ve=>{ve==="recalculate-world-size"&&Be.goHome()})}return()=>{}},[J,l]),fe(()=>J?J.runtime.registerHook("useBeforeFrame",()=>{var Be;if(Fe.current.didUpdate&&J.canvas){let ve=window.devicePixelRatio||1,Pe=Fe.current.width,ot=Fe.current.height;J.canvas.width=Pe*ve,J.canvas.height=ot*ve,J.canvas.style.width=Pe+"px",J.canvas.style.height=ot+"px",(Be=J.canvas.getContext("2d"))==null||Be.scale(ve,ve),J&&J.em&&J.em.updateBounds(),Fe.current.didUpdate=!1}}):()=>{},[J,l]),fe(()=>{let Be=()=>{J&&(G("sketch"),Pt("mode-sketch")),window.removeEventListener("keyup",Be)},ve=Pe=>{if(Pe.code==="Space"&&J&&J.runtime.mode==="sketch"){if(Pe.target&&Pe.target.tagName&&Pe.target.tagName.toLowerCase()==="input")return;Pe.preventDefault(),G("explore"),Pt("mode-explore"),window.addEventListener("keyup",Be)}};return window.addEventListener("keydown",ve),()=>{window.removeEventListener("keydown",ve),window.removeEventListener("keyup",Be)}},[J]),be.current=!0;let cr=Q,{height:Ir,width:mi}=cr,Wt=le(cr,["height","width"]),Ji=LT([Q.width,Q.height]),Ht=!0;return re&&Array.isArray(re)&&re.length>1&&re[1].interactive===!1&&(Ht=!1),z=z??"#000",ne.current&&(z=getComputedStyle(ne.current).getPropertyValue("--atlas-background")||z),Ke(Ba,{ref:ke,className:["atlas",d?"":`atlas-width-${Ji}`,Ze,k,`atlas-${Le}`].filter(Boolean).join(" ").trim(),style:C(C({},E),d?{}:{width:Q.width,height:Q.height}),children:[Le==="static-preset"?Ke(Ba,C({className:"atlas-static-container",ref:Ve.container,tabIndex:0},T)):Ke("canvas",W(C(C({className:"atlas-canvas",part:"atlas-canvas",tabIndex:0},Wt),T),{ref:Ve.canvas,"data-background":z})),Ke(Ba,{className:["atlas-overlay",Ht?"atlas-overlay--interactive":""].filter(Boolean).join(" ").trim(),style:C({},x||{}),ref:Ve.overlay,children:c?Ke(Ki,{children:Ke(Il.Provider,{value:Oe,children:Ke(Cl.Provider,{value:he,children:Ke(Tl.Provider,{value:J,children:y})})})}):Ke(PT,{bounds:Oe,preset:J,mode:he,setIsReady:ce,onCreated:n,children:y})}),S?Ke(Ba,{className:"atlas-navigator",children:Ke("canvas",{className:"atlas-navigator-canvas",part:"atlas-navigator-canvas",ref:Ve.navigator})}):null,d?Ke("style",{children:`.atlas-width-${Ji} { width: ${Q.width}px; height: ${Q.height}px; }`}):Ke("style",{children:`
        .atlas { position: relative; display: flex; background: ${z}; z-index: var(--atlas-z-index, 10); -webkit-touch-callout: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }
        .atlas-width-${Ji} { width: ${Q.width}px; height: ${Q.height}px; }
        .atlas-canvas { flex: 1 1 0px; }
        .atlas-canvas:focus, .atlas-static-container:focus { outline: none }
        .atlas-canvas:focus-visible, .atlas-canvas-container:focus-visible { outline: var(--atlas-focus, 2px solid darkorange) }
        .atlas-static-preset { touch-action: inherit; }
        .atlas-static-container { position: relative; overflow: hidden; flex: 1 1 0px; }
        .atlas-overlay { position: absolute; top: 0; left: 0; none; overflow: hidden; }
        /** setting the pointer events to none means that Atlas will own the touch and mousewheel events **/
        .atlas-overlay--interactive { pointer-events: none; }
        .atlas-static-image { position: absolute; user-select: none; transform-origin: 0px 0px; }
        .atlas-navigator { position: absolute; top: var(--atlas-navigator-top, 10px); right: var(--atlas-navigator-bottom, 10px); left: var(--atlas-navigator-left); bottom: var(--atlas-navigator-bottom); opacity: .8 }
        .atlas-navigator-canvas { width: 100%; }
      `}),i]})};function NT(e){return Number(e)==e?`${e}px`:e}var zT=e=>{var t=e,{resizeHash:i,aspectRatio:r,containerProps:n={}}=t,a=le(t,["resizeHash","aspectRatio","containerProps"]);let[l,u,c]=Yy(),d=a,{height:p,width:y}=d,x=le(d,["height","width"]);fe(()=>{c()},[y,p,i,c]);let E=Ae(()=>r?{width:u.width,height:u.width*(1/r)}:u,[u,r]);return Ke(Ba,W(C({ref:l,className:"atlas-container"},n),{children:[E.width?Ke($T,W(C({width:E.width||100,height:E.height||100},x),{children:a.children})):null,a.hideInlineStyle?null:Ke("style",{children:`
          .atlas-container { 
            display: var(--atlas-container-display, block);
            flex: var(--atlas-container-flex, none);
            width: var(--atlas-container-width, ${y?`${y}px`:"100%"});
            height: var(--atlas-container-height, ${NT(p||(r?E.height:512))})  
          }
      `}),a.htmlChildren]}))},Ml=()=>Yt(Tl),vn=()=>{let e=Ml();return e?e.runtime:void 0},wc=(e,t=[])=>{let i=vn();fe(()=>i?i.registerHook("useAfterFrame",e):()=>{},t)},xc=(e,t=[])=>{let i=vn();fe(()=>i?i.registerHook("useFrame",e):()=>{},t)},FT=()=>{let e=Ml();return e&&e.canvas?e.canvas:void 0};function _v(){return Yt(Il)}var Sv=({onCreate:e})=>{let t=xe({x:0,y:0}),i=FT(),r=_v(),n=vn(),[a,l]=je(),[u,c]=je(),d=gc();return xc(()=>{n&&a&&!u&&(n.pendingUpdate=!0)},[a,u]),wc(()=>{if(a&&i&&n){let p=i.getContext("2d");if(p){let{x:y,y:x,width:E,height:S}=n.worldToViewer(a.x,a.y,(u?u.x:t.current.x)-a.x,(u?u.y:t.current.y)-a.y);p.lineWidth=u?3:1,p.strokeStyle="#fff",p.strokeRect(y,x,E,S),p.lineWidth=u?3:1,p.strokeStyle="#000",p.strokeRect(y+1,x+1,E-2,S-2)}}},[a,u]),fe(()=>{let p=y=>{if(r&&n){let{x,y:E}=n.viewerToWorld(y.clientX-r.left,y.clientY-r.top);t.current.x=~~x,t.current.y=~~E}};return i?(i.addEventListener("mousemove",p),()=>i.removeEventListener("mousemove",p)):()=>{}},[r,i,n]),fe(()=>{let p=y=>{d==="sketch"&&(l({x:Math.round(t.current.x),y:Math.round(t.current.y)}),c(void 0))};return i?(i.addEventListener("mousedown",p),()=>i.removeEventListener("mousedown",p)):()=>{}},[i,d]),fe(()=>{let p=y=>{a&&!u&&c({x:Math.round(t.current.x),y:Math.round(t.current.y)})};return i?(i.addEventListener("mouseup",p),()=>i.removeEventListener("mouseup",p)):()=>{}},[i,a,u]),fe(()=>{a&&u&&e({x:Math.min(a.x,u.x),y:Math.min(a.y,u.y),width:Math.abs(u.x-a.x),height:Math.abs(u.y-a.y)})},[a,e,u]),null};async function BT(e,t,i){if(Cs.startsWith("18.")){let r=await Promise.resolve().then(()=>Ue(mh(),1)),n=r.default?r.default.createRoot:r.createRoot;i.current||(i.current=n(e)),i.current.render(t)}else if(typeof ReactDOM<"u"){let{render:r,unmountComponentAtNode:n}=ReactDOM;r(t,e),i.current={unmount(){n(e)}}}else{let r=await Promise.resolve().then(()=>(pe(),Ln)),n=r.default?r.default.render:r.render,a=r.default?r.default.unmountComponentAtNode:r.unmountComponentAtNode;n(t,e),i.current={unmount(){a(e)}}}}var jT=te.forwardRef((e,t)=>{var i=e,{children:r}=i,n=le(i,["children"]);let a=xe(),l=vn(),u=xe(0),c=xe(),d=xe();return xc(()=>{var p,y,x,E;if(n.relative){let S=a.current;if(S&&l){let k=l.getScaleFactor();u.current!==k&&(u.current=k,S.style.transformOrigin="0 0",S.style.transform=`scale(${1/u.current})`,S.style.width=`${u.current*100}%`,S.style.height=`${u.current*100}%`,a.current&&((y=(p=c.current)==null?void 0:p.__owner.value)!=null&&y.rotation)&&(S.style.transform=`scale(${1/u.current}) translate(50%, 50%) rotate(${((E=(x=c.current)==null?void 0:x.__owner.value)==null?void 0:E.rotation)||0}deg)  translate(-50%, -50%)`))}}},[n.relative]),Et(()=>{let p=c.current;t&&p&&(typeof t=="function"?t(p):t.current=p);async function y(){if(p&&p.__host){let x=n.relative?Ke("div",{ref:a,children:r}):r;await BT(p.__host.element,x,d)}}p&&p.__host?y():p&&(p.__onCreate=y)},[t,r,c,n.relative]),Et(()=>()=>{d.current&&setTimeout(()=>{d.current.unmount()},0)},[]),Ke("box",W(C({html:!0},n),{ref:c}))});jT.displayName="HTMLPortal";var Ev=(e,t,i=[])=>{let r=vn(),n=r?r.world:void 0;fe(()=>{if(r){let a=t,l=Ws[e];r.world.activatedEvents.push(l);let u=l.slice(2).toLowerCase();return r.world.addEventListener(u,a),()=>{r.world.removeEventListener(u,a)}}return()=>{}},[n,e,...i])};function Av(e,t){if(e===0)return[0,1];if(t===0)return[1,0];let i=Math.abs(e)/Math.abs(t);return[i,1-i]}function UT(){let e=xe({ctrl:!1,shift:!1,alt:!1});return Et(()=>{function t(r){r.key==="Shift"&&(e.current.shift=!0),r.key==="Control"&&(e.current.ctrl=!0),r.key==="Alt"&&(e.current.alt=!0)}function i(r){r.key==="Shift"&&(e.current.shift=!1),r.key==="Control"&&(e.current.ctrl=!1),r.key==="Alt"&&(e.current.alt=!1)}return window.addEventListener("keydown",t),window.addEventListener("keyup",i),()=>{window.removeEventListener("keydown",t),window.removeEventListener("keyup",i)}},[]),e}var DT=(e,t)=>{let i=gc(),r=vn(),n=_v(),a=xe(),l=xe(null),u=xe(),[c,d]=je(!1),p=xe(!1),y=xe({north:0,south:0,east:0,west:0}),x=UT(),E=Qe(A=>$=>{if(p.current=!0,d(!0),n&&r){let{top:z,left:B}=n,H=r.viewerToWorld($.pageX-B,$.pageY-z);u.current={x:H.x,y:H.y},a.current=A}},[n,r]),S=Ae(()=>e.width/e.height,[e.width,e.height]),k=Qe(A=>{if(!Math.abs(A.north-A.south+(A.east-A.west)))return;let $=-A.west+A.east,z=-A.north+A.south,B=e.width+$,H=e.height+z;if(B/H>=S){let Y=H*S,Q=B-Y,[he,G]=Av(A.east,A.west);A.west=A.west+Q*G,A.east=A.east-Q*he}else{let Y=B/S,Q=H-Y,[he,G]=Av(A.north,A.south);A.north=A.north+Q*he,A.south=A.south-Q*G}},[e.width,e.height,S]);xc(()=>{u&&r&&r.updateNextFrame()}),fe(()=>{r&&r.updateNextFrame()},[r,c]);let T=Qe(A=>{var $;if(!r||!n||r.mode!=="sketch")return;let{top:z,left:B}=n,H=r.viewerToWorld(A.pageX-B,A.pageY-z),Y=l.current,Q=!e.maintainAspectRatio&&x.current.alt,he=!Q&&x.current.shift&&(($=a.current)==null?void 0:$.indexOf("-"))!==-1;if((a.current==="translate"||a.current==="east"||a.current==="north-east"||a.current==="south-east")&&(y.current.east=H.x-(u.current?u.current.x:0),Q&&(y.current.west=-y.current.east)),(a.current==="translate"||a.current==="west"||a.current==="north-west"||a.current==="south-west")&&(y.current.west=H.x-(u.current?u.current.x:0),Q&&(y.current.east=-y.current.west)),(a.current==="translate"||a.current==="north"||a.current==="north-east"||a.current==="north-west")&&(y.current.north=H.y-(u.current?u.current.y:0),Q&&(y.current.south=-y.current.north)),(a.current==="translate"||a.current==="south"||a.current==="south-west"||a.current==="south-east")&&(y.current.south=H.y-(u.current?u.current.y:0),Q&&(y.current.north=-y.current.south)),(e.maintainAspectRatio||he)&&k(y.current),Y){let G=y.current.west,ue=y.current.north,ce=e.width+y.current.east,be=e.height+y.current.south;Y.points[1]=Math.min(G,ce),Y.points[2]=Math.min(ue,be),Y.points[3]=Math.max(G,ce),Y.points[4]=Math.max(ue,be),r.updateNextFrame()}},[r,e.width,e.height,e.maintainAspectRatio,n]);Ev("mousemove",T,[e.width,e.height,n]),Ev("pointermove",T,[e.width,e.height,n]);let R=xe();return fe(()=>{R.current=()=>{if(p.current){let A=y.current.west,$=y.current.north,z=e.width+y.current.east,B=e.height+y.current.south,H=Math.min(A,z),Y=Math.min($,B),Q=Math.max(A,z),he=Math.max($,B),G={x:(e.x||0)+H,y:(e.y||0)+Y,width:Q-H||1,height:he-Y||1};e.maintainAspectRatio,t(G),a.current=void 0,u.current=void 0,y.current.east=0,y.current.west=0,y.current.north=0,y.current.south=0,p.current=!1,d(!1)}}},[t,e.height,e.width,e.x,e.y]),fe(()=>{let A=()=>{R.current&&R.current()};return window.addEventListener("pointerup",A),window.addEventListener("touchend",A),()=>{window.removeEventListener("pointerup",A),window.removeEventListener("touchend",A)}},[]),{portalRef:l,mode:i,mouseEvent:E,onPointerMoveCallback:T,isEditing:c}};function kv(e,t){return e?t?W(C(C({},e),t||{}),{":hover":e[":hover"]?Object.assign(e[":hover"]||{},t[":hover"]||{}):t[":hover"],":active":e[":active"]?Object.assign(e[":active"]||{},t[":active"]||{}):t[":hover"]}):e:t}pe();function He(e,{parse:t,defaultValue:i}={}){let r=xe(),[n,a]=je(()=>t?t(e):e),l=Qe(u=>{let c=t?t(u):u;typeof i<"u"&&typeof c>"u"&&(c=i),(r.current||n)!==c&&(a(c),r.current=c)},[]);return Et(()=>{l(e)},[e]),[n,l,a,r]}function WT({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:a}){let l=[];return i&&l.push("^"),e?(l.push("max"),l.join("")):(r&&l.push("!"),t&&l.push(`pct:${t}`),n&&l.push(`${n}`),l.push(","),a&&l.push(`${a}`),l.join(""))}function HT(e){let t={upscaled:!1,max:!1,confined:!1};if(e[0]==="^"&&(t.upscaled=!0,e=e.slice(1)),(e==="max"||e==="full")&&(t.max=!0),e[0]==="!"&&(t.confined=!0,e=e.slice(1)),e[0]==="p")return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map(r=>r.trim());return i[0]!==""&&(t.width=parseInt(i[0],10)),i[1]!==""&&(t.height=parseInt(i[1],10)),t}function Ll(e){return e==null||e<0?0:e}function $l(e){return qT(typeof e=="string"?e:JSON.stringify(e))}function Nl(e,t){if(e=e.trim(),e[0]==="{")return JSON.parse(e);if(e.startsWith("http"))throw new Error("Cannot fetch remote fetch with async=false in parseContentState");return Nl(QT(e))}function qT(e){let t=encodeURIComponent(e);return(typeof btoa>"u"?Buffer.from(t,"utf-8").toString("base64"):btoa(t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function QT(e){let t=VT(e).replace(/-/g,"+").replace(/_/g,"/"),i=typeof atob>"u"?Buffer.from(t,"base64").toString("utf-8"):atob(t);return decodeURIComponent(i).trim()}function VT(e){let t=e.length%4;if(t===1)throw new Error("InvalidLengthError: Input base64url string is the wrong length to determine padding");return e+(t?"====".slice(0,4-t):"")}function qs(e){if(!e)throw new Error("Content state is empty");Array.isArray(e)||(e=[e]);let t="vault://virtual-annotation/"+new Date().getTime(),i=["contentState"],r=[];for(let n of e){if(typeof n=="string")throw new Error("Content state is a [String] type and cannot be inferred");if(n.type==="Annotation"){if(t=n.id,Array.isArray(n.motivation))for(let l of n.motivation)i.indexOf(l)===-1&&i.push(l);if(Array.isArray(n.target))for(let l of n.target){let u=qr(l);r.push(u)}else{let l=qr(n.target);r.push(l)}continue}let a=qr(n);r.push(a)}return{id:t,type:"Annotation",motivation:["contentState",...e.motivation||[]],target:r,extensions:{}}}function GT(e){if(!e)return[];typeof e=="string"&&(e=e.split("|")),Array.isArray(e)||(e=[e]);let t=[];for(let i of e)typeof i=="string"&&(i=HT(i)),t.push(i);return t}function _c(e){if(typeof e=="string"){let t=e.match(/^(pct|pixel|percent)?:?([0-9,\s]+)/);if(t)return _c({type:"FragmentSelector",value:`xywh=${t[1]?t[1]==="pixel"?"pixel:":"percent:":""}${t[2]}`})}return e?ol(e):void 0}function Pv(e){return e?Array.isArray(e)?e:e.indexOf(",")!==-1?e.split(",").map(t=>t.trim()):[e]:[]}function ZT(e){let t=Pv(e),i=[];for(let r of t){let[n,a]=r.split("#");if(a){let l=a.match(/opacity=([01]?\.[0-9]+)/);if(l){let u=parseFloat(l[1]);if(u<1&&u>=0){i.push({id:n,opacity:u});continue}}}i.push({id:n})}return i}function pt(e,t){return typeof e>"u"?t:typeof e=="string"?e.toLowerCase()==="true":t?typeof e>"u"?t:!1:e}function Cr(e,t){return typeof e>"u"||e===null||e===""?t:(typeof e=="string"&&(e=parseInt(""+e,10)),typeof e<"u"&&!Number.isNaN(e)?e:t)}function zl(e){if(!e)return null;if(typeof e=="string"&&e.startsWith("http"))return{type:"remote-content-state",id:e};try{return qs(typeof e=="string"?Nl(e):e)}catch{return null}}var YT=class{constructor(e,t){this._className="",this.onChange=e||(()=>{}),this.className=Array.isArray(t)?t.join(" "):t||""}set className(e){this._className=e}get className(){return this._className}add(e){this.className.split(" ").includes(e.trim())||(this.className+=" "+e.trim())}remove(e){this.className=this.className.split(" ").filter(t=>t&&t!==e).join(" ")}toggle(e,t){let i=this.className.split(" ");t&&!i.includes(e)&&(this.className+=" "+e.trim())}contains(e){return this.className.split(" ").includes(e.trim())}getClassName(){return this.className}};function Sc(e){return{addEventListener(t,i,r,n){if(t)return e.setMetaValue([t.id,"eventManager",i],a=>{let l=a||[];for(let u of l)if(u.callback===r)return l;return[...l,{callback:r,scope:n}]}),r},removeEventListener(t,i,r){!t||e.setMetaValue([t.id,"eventManager",i],n=>(n||[]).filter(a=>a.callback!==r))},getListenersAsProps(t,i){let r=typeof t=="string"?{id:t}:t;if(!r||!r.id)return{};let n=e.getResourceMeta(r.id,"eventManager"),a={};if(n&&r)for(let l of Object.keys(n))a[l]=u=>{let c=e.get(r);for(let{callback:d,scope:p}of n[l]||[])(!p||i&&p.indexOf(i)!==-1)&&d(u,c)};return a}}}function Ec(e){return{applyStyles(t,i,r){let n=typeof t=="string"?t:t.id;return e.setMetaValue([n,"styles",i],r)},getAppliedStyles(t){let i=typeof t=="string"?t:t.id;return e.getResourceMeta(i,"styles")}}}function ns(e){return e.endsWith("info.json")?e:e.endsWith("/")?`${e}info.json`:`${e}/info.json`}var XT="http://library.stanford.edu/iiif/image-api/compliance.html#level0",Cv="http://library.stanford.edu/iiif/image-api/compliance.html#level1",Tv="http://library.stanford.edu/iiif/image-api/compliance.html#level2",KT="http://library.stanford.edu/iiif/image-api/conformance.html#level0",Iv="http://library.stanford.edu/iiif/image-api/conformance.html#level1",Rv="http://library.stanford.edu/iiif/image-api/conformance.html#level2",JT="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",Ov="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",Mv="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",e2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",Lv="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",$v="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",t2="http://iiif.io/api/image/1/level0.json",i2="http://iiif.io/api/image/1/profiles/level0.json",Nv="http://iiif.io/api/image/1/level1.json",zv="http://iiif.io/api/image/1/profiles/level1.json",Fv="http://iiif.io/api/image/1/level2.json",Bv="http://iiif.io/api/image/1/profiles/level2.json",r2="http://iiif.io/api/image/2/level0.json",n2="http://iiif.io/api/image/2/profiles/level0.json",jv="http://iiif.io/api/image/2/level1.json",Uv="http://iiif.io/api/image/2/profiles/level1.json",Dv="http://iiif.io/api/image/2/level2.json",Wv="http://iiif.io/api/image/2/profiles/level2.json",s2="level0",Hv="level1",qv="level2",a2="http://iiif.io/api/image/2/level0",Qv="http://iiif.io/api/image/2/level1",Vv="http://iiif.io/api/image/2/level2",Gv=[Vv,Tv,Rv,Mv,$v,Fv,Bv,Dv,Wv,qv],Zv=[...Gv,Qv,Cv,Iv,Ov,Lv,Nv,zv,jv,Uv,Hv],o2=[a2,Qv,Vv,XT,Cv,Tv,KT,Iv,Rv,JT,Ov,Mv,e2,Lv,$v,t2,i2,Nv,zv,Fv,Bv,r2,n2,jv,Uv,Dv,Wv,s2,Hv,qv],l2={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},u2={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},h2={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function c2(e){return Gv.indexOf(e)!==-1?h2:Zv.indexOf(e)!==-1?u2:l2}function d2(e){let t=e?Array.isArray(e.profile)?e.profile:[e.profile]:[],i={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let r of t)if(typeof r=="string"&&(r=c2(r)),!!r){if(r.formats)for(let n of r.formats)i.extraFormats.indexOf(n)===-1&&i.extraFormats.push(n);if(r.qualities)for(let n of r.qualities)i.extraQualities.indexOf(n)===-1&&i.extraQualities.push(n);if(r.supports)for(let n of r.supports)i.extraFeatures.indexOf(n)===-1&&i.extraFeatures.push(n);if(r.maxHeight&&(i.maxHeight=r.maxHeight),r.maxWidth&&(i.maxWidth=r.maxWidth),r.maxArea&&(i.maxArea=r.maxArea),r.extraFormats)for(let n of r.extraFormats)i.extraFormats.indexOf(n)===-1&&i.extraFormats.push(n);if(r.extraQualities)for(let n of r.extraQualities)i.extraQualities.indexOf(n)===-1&&i.extraQualities.push(n);if(r.extraFeatures)for(let n of r.extraFeatures)i.extraFeatures.indexOf(n)===-1&&i.extraFeatures.push(n);r.maxHeight&&(i.maxHeight=r.maxHeight),r.maxWidth&&(i.maxWidth=r.maxWidth),r.maxArea&&(i.maxArea=r.maxArea)}if(e.extraFormats)for(let r of e.extraFormats)i.extraFormats.indexOf(r)===-1&&i.extraFormats.push(r);if(e.extraFeatures)for(let r of e.extraFeatures)i.extraFeatures.indexOf(r)===-1&&i.extraFeatures.push(r);if(e.extraQualities)for(let r of e.extraQualities)i.extraQualities.indexOf(r)===-1&&i.extraQualities.push(r);return i}function f2(e){try{if(e==="full")return{full:!0};if(e==="square")return{square:!0};let t=e.startsWith("pct:"),i=e.substr(t?4:0).split(",").map(r=>parseFloat(r));return{x:i[0],y:i[1],w:i[2],h:i[3],percent:t}}catch{throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+e)}}function p2(e){let t={upscaled:!1,max:!1,confined:!1};if(e[0]==="^"&&(t.upscaled=!0,e=e.slice(1)),e==="max"||e==="full")return t.max=!0,t.serialiseAsFull=e==="full",t;if(e[0]==="!"&&(t.confined=!0,e=e.slice(1)),e[0]==="p")return t.percentScale=parseFloat(e.slice(4)),t;let i=e.split(",").map(r=>r.trim());return i.length&&(i[0]!==""&&(t.width=parseInt(i[0],10)),i[1]!==""&&(t.height=parseInt(i[1],10))),t}function g2(e){let t={angle:0};if(e[0]==="!"&&(t.mirror=!0,e=e.substr(1)),t.angle=parseFloat(e)%360,Number.isNaN(t.angle))throw new Error(`Invalid rotation ${e}`);return t}function m2(e,t=""){let i=e.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!i)throw new Error(`Invalid or unknown input ${e}`);let r=i[2],n=i[3],a=i[4];if(a[0]==="/"&&(a=a.substr(1)),t.length>0){if(t[0]==="/"&&(t=t.substr(1)),t!==a.substr(0,t.length))throw new Error(`Path does not start with prefix (path: ${a}, prefix: ${t})`);a=a.substr(t.length)}return{scheme:r,server:n,path:a,prefix:t}}function y2(e,t=""){let{path:i,scheme:r,server:n,prefix:a}=m2(e,t),l=i.split("/").reverse(),[u,c,d,p,...y]=l,x=y.reverse().filter(Boolean).join("/");if(l.length===1||u==="")return{type:"base",scheme:r,server:n,prefix:a,identifier:x};if(u==="info.json"){let[,...S]=l;return{type:"info",scheme:r,server:n,prefix:a,identifier:S.reverse().filter(Boolean).join("/")}}let E=u.split(".");return{type:"image",scheme:r,server:n,prefix:a,identifier:x,originalPath:i,region:f2(p),size:p2(d),rotation:g2(c),quality:E[0],format:E[1]}}function v2(e){let t=y2(ns(e.id));if(t.type!=="info")throw new Error("Invalid service URL");let i=d2(e);return{identifier:t.identifier,originalPath:"",server:t.server,prefix:t.prefix,scheme:t.scheme,type:"image",quality:i.extraQualities.indexOf("default")===-1?i.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function b2(e,t,i){let r=i.length,n=[];for(let a=0;a<r;a++){let l=i[a].width;n.push(e/l)}return n}function w2(e,t,i){let r=i.length,n=[];for(let a=0;a<r;a++){let l=i[a];n.push({width:Math.floor(e/l),height:Math.floor(t/l)})}return n}function Dt(e){if(e["@id"])return e["@id"];if(e.id)return e.id}function Ac(e){if(!e||!e.profile||!Dt(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let i of t)if(typeof i=="string"&&o2.indexOf(i)!==-1)return!0;return!1}function x2(e){if(!Ac(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let i of t)if(typeof i=="string"){if(Zv.indexOf(i)!==-1)return!0}else{let r=[...i.supports||[],...i.extraFeatures||[]];if(r.indexOf("regionByPx")!==-1&&(r.indexOf("sizeByW")!==-1||r.indexOf("sizeByWh")!==-1))return!0}return!1}function _2(e){if(!x2(e))return[];let t=[],i=Array.isArray(e.profile)?e.profile:[e.profile],r=i.length;for(let n=0;n<r;n++){let a=i[n];if(typeof a!="string"&&(a.maxHeight||a.maxWidth))return[{id:Dt(e),type:"variable",minWidth:0,minHeight:0,maxHeight:a.maxHeight||a.maxWidth,maxWidth:a.maxWidth||a.maxHeight}]}if(e.tiles){let n=e.tiles.length;for(let a=0;a<n;a++){let l=e.tiles[a];(l.height||l.width)&&t.push({id:Dt(e),type:"variable",minHeight:0,minWidth:0,maxHeight:l.height||l.width,maxWidth:l.width})}}return t}function Yv(e){let t=/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/,i=e.match(t);if(i){let r=i[1],n=parseInt(i[4],10),a=parseInt(i[5],10),l=i[7];if((r==="max"||r==="full")&&n&&a&&l)return{type:"fixed",id:e,height:a,width:n}}return{type:"unknown",id:e}}function S2(e){if(e["@type"])return e["@type"];if(e.type)return e.type}function kc(e){if(typeof e=="string")return Yv(e);let t=S2(e);if(t!=="Image"&&t!=="sc:Image")return null;let i=e,r=Dt(i);return r?r&&i.width&&i.height?{id:r,type:"fixed",width:i.width,height:i.height,unsafe:!0}:Yv(r):null}function E2(e){return Ac(e)?(e&&e.sizes?e.sizes:[]).map(t=>({id:Dt(e),type:"fixed-service",height:t.height,width:t.width})):[]}function Xv(e){let t=[],i=e.length;for(let r=0;r<i;r++){let n=E2(e[r]);n.length&&t.push(...n);let a=_2(e[r]);a.length&&t.push(...a)}return t}function Kv(e){let t=e.service?Array.isArray(e.service)?e.service:[e.service]:[],i=t.length,r=[];for(let n=0;n<i;n++)Ac(t[n])&&r.push(t[n]);return r}function A2(e,t=!0,i){let r=[],n=kc(e);if(n===null)return r;let a=e;if(r.push(n),t&&a.width&&a.height){let l=[],u=Kv(a);for(let c of u){let d={id:Dt(c),width:a.width,height:a.height};if(i.canLoadSync(d)){let p=i.loadServiceSync(d);p&&(p.height||(p.height=a.height),p.width||(p.width=a.width),l.push(...Xv([p])))}}if(l.length)return r.push(...l),r}return a.service&&r.push(...Xv(a.service)),r}function k2({x:e=0,y:t=0,w:i,h:r,full:n,square:a,percent:l}){return"full"}function P2({max:e,percentScale:t,upscaled:i,confined:r,width:n,height:a,serialiseAsFull:l}){let u=[];return i&&u.push("^"),e?(u.push(l?"full":"max"),u.join("")):(r&&u.push("!"),t&&u.push(`pct:${t}`),n&&u.push(`${n}`),u.push(","),a&&u.push(`${a}`),u.join(""))}function C2(e){return`${e.mirror?"!":""}${(e.angle||0)%360}`}function T2(e,t){let i=e.prefix.startsWith("/")?e.prefix.substr(1):e.prefix,r=`${e.scheme}://${e.server}/${i?`${i}/`:""}${e.identifier}`,{region:n,size:a,rotation:l,format:u,quality:c}=e;return[r,k2(n),P2(a),C2(l),`${c}.${u}`].filter(Boolean).join("/")}function Pc(e,t,i){let r=v2({id:ns(Dt(e)),profile:"level2"});return r.size.max=!1,r.size.width=t,r.size.height=i,{id:T2(r),type:"fixed",width:t,height:i||e.height/(e.width||1)*t,unsafe:e.width>t}}function Qs(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,"");return t.indexOf("/")!==-1?t.split("/")[0]:t}function I2(e,t,i){let r=e.width?e.width:e.maxWidth;return i.height<=e.maxHeight&&i.width<=e.maxWidth&&i.height>=e.minHeight&&i.width>=e.minWidth&&(!t||Math.abs(i.width-r)<Math.abs(t.width-r))}function R2(e,t){let i=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},e),n=[],a=[],l=null,u=(d,p)=>{if(I2(r,p,d)){if(r.preferFixedSize&&d.unsafe){a.push(d);return}r.returnAllOptions&&p&&a.push(p),l=d}else r.returnAllOptions&&a.push(d)},c=t.length;for(let d=0;d<c;d++){let p=t[d](),y=p.length;for(let x=0;x<y;x++){let E=p[x];if(E.type==="unknown"&&r.atAnyCost&&n.push(E),E.type==="fixed"&&(E.unsafe?n.push(E):u(E,l)),E.type==="fixed-service")if(r.unsafeImageService){let S=Pc(E,r.width,r.height);u(S,l)}else{let S=Pc(E,E.width,E.height);u(S,l)}if(E.type==="variable"&&E.maxWidth){let S=Pc({id:E.id,width:E.maxWidth,height:E.maxWidth},E.maxWidth);u(S,l)}}if(l&&!r.returnAllOptions){if(l.unsafe||r.allowUnsafe)continue;break}}return r.atAnyCost&&a.length===0?{best:l||n[0],fallback:n.slice(1),log:i}:r.returnAllOptions?{best:r.atAnyCost?l||a[0]||n[0]:l||a[0],fallback:[...a,...n],log:i}:{best:l||a[0]||null,fallback:l?a:a.slice(1),log:i}}var O2=Object.defineProperty,M2=Object.defineProperties,L2=Object.getOwnPropertyDescriptors,Jv=Object.getOwnPropertySymbols,$2=Object.prototype.hasOwnProperty,N2=Object.prototype.propertyIsEnumerable,eb=(e,t,i)=>t in e?O2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,z2=(e,t)=>{for(var i in t||(t={}))$2.call(t,i)&&eb(e,i,t[i]);if(Jv)for(var i of Jv(t))N2.call(t,i)&&eb(e,i,t[i]);return e},F2=(e,t)=>M2(e,L2(t));function B2(e,t,i){let r=e>t?e:t,n=i.length,a=[];for(let l=0;l<n;l++){let u=i[l],c=u.scaleFactors[0],d=r/c,p=[c];for(;d>=u.width;)c=c*2,p.push(c),d=d/2;a.push(F2(z2({},u),{scaleFactors:p}))}return a}function j2(e,t){if(e.length!==t.length)return!1;if(e.length===0&&t.length===0)return!0;let i=e.length,r=!0;for(let a=0;a<i;a++){let l=e[a],u=t[a];if(l.width!==u.width||l.height!==u.height){r=!1;break}}if(r)return!0;let n=0;for(let a=0;a<i;a++)for(let l=0;l<i;l++)if(e[a].width===t[l].width&&e[a].height===t[l].height){n++;break}return n===i}function tb(e){if(e&&e.profile){let t=e.profile;if(t){let i=Array.isArray(t)?t:[t];return i.includes("level0")||i.includes("http://iiif.io/api/image/2/level0.json")||i.includes("http://iiif.io/api/image/1/level0.json")||i.includes("http://iiif.io/api/image/1/profiles/level0.json")}}return!1}var ss=(e,t,i)=>new Promise((r,n)=>{var a=c=>{try{u(i.next(c))}catch(d){n(d)}},l=c=>{try{u(i.throw(c))}catch(d){n(d)}},u=c=>c.done?r(c.value):Promise.resolve(c.value).then(a,l);u((i=i.apply(e,t)).next())}),U2=class{constructor(){this.config={verificationsRequired:1,approximateServices:!0,enableFetching:!0,disableThrottling:!1},this.fetchingCount=0,this.imageServices={},this.knownImageServers={}}setConfig(e){Object.assign(this.config,e)}sample(e,t,i=!0){let r=Qs(Dt(e)),n=ns(Dt(e)),a=this.knownImageServers[r];return this.imageServices[n]=Object.assign(e,{real:!0}),!a&&e.tiles&&!tb(e)?(this.knownImageServers[r]={verifications:0,malformed:!1,root:r,preLoaded:i,sampledId:Dt(e),verified:!1,server:null,result:{context:e["@context"]||[],sampledProfile:e.profile,resourceServiceRatio:t&&e.height?t.height/e.height:1,sampledSizes:e.sizes||[],sizeRatios:b2(e.width,e.height,e.sizes||[]),sampledTiles:e.tiles||[]}},!0):this.verify(e)}preLoad(e,t=!0){this.knownImageServers[e.root]=e,t&&(this.knownImageServers[e.root].malformed=!1,this.knownImageServers[e.root].verifications=this.config.verificationsRequired)}predict(e,t=!1,i=!1){let r=e==null?void 0:e.source,n=Qs(Dt(e)),a=this.knownImageServers[n];if(!a||!a.result||!i&&(a.malformed||a.verifications<this.config.verificationsRequired)||tb(e.source))return null;let l=ns(Dt(e));return this.imageServices[l]||(this.imageServices[l]={"@context":a.result.context,"@id":Dt(e),id:Dt(e),protocol:"http://iiif.io/api/image",tiles:(r==null?void 0:r.tiles)||B2(e.width,e.height,a.result.sampledTiles),sizes:(r==null?void 0:r.sizes)||w2(Math.round(e.width/a.result.resourceServiceRatio),Math.round(e.height/a.result.resourceServiceRatio),a.result.sizeRatios),profile:(r==null?void 0:r.profile)||a.result.sampledProfile,height:(r==null?void 0:r.height)||e.height,width:(r==null?void 0:r.width)||e.width,real:!1}),this.imageServices[l]}getThumbnailFromResource(e,t){return ss(this,arguments,function*(i,r,n=!0,a=[]){let l=yield this.getImageCandidates(i,n);return R2(r,[()=>a,()=>l])})}getImageCandidates(e,t=!0){return ss(this,null,function*(){let i=e;if(t&&i.height&&i.width){let r=Kv(i);for(let n of r){let a={id:Dt(n),width:n.width?n.width:i.width,height:n.height?n.height:i.height,source:n};yield this.loadService(a)}}return A2(e,t,this)})}verify(e){return ss(this,null,function*(){let t=this.predict(e,!1,!0),i=yield this.fetchService(Dt(e));if(!t)return!1;let r=t.height===i.height&&t.width===i.width&&t["@context"]===i["@context"]&&j2(t.sizes||[],i.sizes||[]);if(r){let n=Qs(Dt(e));this.knownImageServers[n].verifications+=1,this.knownImageServers[n].verifications>=this.config.verificationsRequired&&(this.knownImageServers[n].verified=!0)}return r})}canLoadSync(e){let t=typeof e=="string"?e:Dt(e),i=ns(t);if(this.imageServices[i])return!0;let r=this.knownImageServers[Qs(t)];return r&&!r.malformed&&r.verifications>=this.config.verificationsRequired}markAsMalformed(e){return ss(this,null,function*(){return this.knownImageServers[Qs(Dt(e))].malformed=!0,this.loadService(e,!0)})}fetchService(e,t=!1){return ss(this,null,function*(){let i=ns(e);if(this.imageServices[i]&&(!t||this.imageServices[i].real))return this.imageServices[i];if(!this.config.enableFetching)throw new Error("Fetching is not enabled");let r=yield this.fetch(i).then(n=>n.json());return!r.id&&r["@id"]&&(r.id=r["@id"]),r.id!==e&&(r.id=e,r["@id"]&&(r["@id"]=e)),this.imageServices[i]=Object.assign(r,{real:!0}),this.imageServices[i]})}fetch(e,t){return ss(this,null,function*(){return fetch(e,t)})}loadService(e,t=!1){return ss(this,null,function*(){if(!this.config.disableThrottling){let n=!0;for(;n;)if(this.fetchingCount>=this.config.verificationsRequired)yield new Promise(a=>setTimeout(a,500));else{n=!1;break}}let i=this.knownImageServers[Qs(Dt(e))];if(i&&!i.malformed&&!t){yield i.result;let n=this.loadServiceSync(e);if(n)return n}this.fetchingCount++;let r=yield this.fetchService(Dt(e),t);return this.fetchingCount--,r.real&&this.sample(r,e),r})}loadServiceSync(e){let t=ns(Dt(e));return this.imageServices[t]?this.imageServices[t]:this.predict(e)}};function D2(e,t={}){let i=t.imageServiceLoader||new U2;async function r(n,a,l,u=[],c){if(typeof n=="string")return{best:kc(n),fallback:[],log:[]};let d=e.get(n);if(typeof d=="string")return{best:kc(d),fallback:[],log:[]};switch(d.type){case"Annotation":{let p=d.body,y=e.get(p[0]);return c&&!y.width&&(y.width=c.width,y.height=c.height),await i.getThumbnailFromResource(y,a,l,u)}case"Canvas":{let p=d;if(p.thumbnail&&p.thumbnail.length){let y=e.get(p.thumbnail[0]),x=await i.getImageCandidates(y,l);x&&x.length&&u.push(...x)}return r(p.items[0],a,l,u,{width:p.width,height:p.height})}case"AnnotationPage":return r(d.items[0],a,l,u,c);case"Choice":return r(d.items[0],a,l,u,c);case"Collection":{let p=d.items[0];return r(p,a,l,u,c)}case"Manifest":{let p=d.items[0];return r(p,a,l,u,c)}case"SpecificResource":case"Image":case"Dataset":case"Sound":case"Text":case"TextualBody":case"Video":return c&&!d.width&&(d.width=c.width,d.height=c.height),i.getThumbnailFromResource(d,a,l,u);case"Service":case"Range":case"AnnotationCollection":case"CanvasReference":case"ContentResource":return{best:void 0,fallback:[],log:[]}}return{best:void 0,fallback:[],log:[]}}return{getBestThumbnailAtSize:r}}function W2(e,t,i=[],r=!1){if(!e||!t||t.length===0)return;if(t.length===1)return t[0];if(t.indexOf(e)!==-1)return e;let n=e.indexOf("-")!==-1?e.slice(0,e.indexOf("-")):null;if(n&&t.indexOf(n)!==-1)return n;for(let a of i)if(t.indexOf(a)!==-1)return a;if(!r){let a=t.map(l=>l.indexOf("-")!==-1?l.slice(0,l.indexOf("-")):null).indexOf(e);if(a!==-1)return t[a];for(let l of i){let u=l.indexOf("-")!==-1?l.slice(0,l.indexOf("-")):null,c=u?t.indexOf(u):-1;if(c!==-1)return t[c]}}return t.indexOf("none")!==-1?"none":t.indexOf("@none")!==-1?"@none":t[0]}function H2(e,t,i={}){let{strictFallback:r=!1,defaultText:n="",separator:a=`
`,fallbackLanguages:l=[],closest:u}=i,c=Object.keys(e||{}),d=u?t:W2(t,c,l,r);if(!e)return n;if(typeof e=="string")return e;let p=d?e[d]:void 0;return p?typeof p=="string"?p:p.join(a):""}function Tr(e,t={}){return H2(e,typeof navigator<"u"?navigator.language:void 0,t)}var q2=function(){function e(t,i){var r=[],n=!0,a=!1,l=void 0;try{for(var u=t[Symbol.iterator](),c;!(n=(c=u.next()).done)&&(r.push(c.value),!(i&&r.length===i));n=!0);}catch(d){a=!0,l=d}finally{try{!n&&u.return&&u.return()}finally{if(a)throw l}}return r}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),ja=Math.PI*2,Cc=function(e,t,i,r,n,a,l){var u=e.x,c=e.y;u*=t,c*=i;var d=r*u-n*c,p=n*u+r*c;return{x:d+a,y:p+l}},Q2=function(e,t){var i=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),r=Math.cos(e),n=Math.sin(e),a=Math.cos(e+t),l=Math.sin(e+t);return[{x:r-n*i,y:n+r*i},{x:a+l*i,y:l-a*i},{x:a,y:l}]},ib=function(e,t,i,r){var n=e*r-t*i<0?-1:1,a=e*i+t*r;return a>1&&(a=1),a<-1&&(a=-1),n*Math.acos(a)},V2=function(e,t,i,r,n,a,l,u,c,d,p,y){var x=Math.pow(n,2),E=Math.pow(a,2),S=Math.pow(p,2),k=Math.pow(y,2),T=x*E-x*k-E*S;T<0&&(T=0),T/=x*k+E*S,T=Math.sqrt(T)*(l===u?-1:1);var R=T*n/a*y,A=T*-a/n*p,$=d*R-c*A+(e+i)/2,z=c*R+d*A+(t+r)/2,B=(p-R)/n,H=(y-A)/a,Y=(-p-R)/n,Q=(-y-A)/a,he=ib(1,0,B,H),G=ib(B,H,Y,Q);return u===0&&G>0&&(G-=ja),u===1&&G<0&&(G+=ja),[$,z,he,G]},G2=function(e){var t=e.px,i=e.py,r=e.cx,n=e.cy,a=e.rx,l=e.ry,u=e.xAxisRotation,c=u===void 0?0:u,d=e.largeArcFlag,p=d===void 0?0:d,y=e.sweepFlag,x=y===void 0?0:y,E=[];if(a===0||l===0)return[];var S=Math.sin(c*ja/360),k=Math.cos(c*ja/360),T=k*(t-r)/2+S*(i-n)/2,R=-S*(t-r)/2+k*(i-n)/2;if(T===0&&R===0)return[];a=Math.abs(a),l=Math.abs(l);var A=Math.pow(T,2)/Math.pow(a,2)+Math.pow(R,2)/Math.pow(l,2);A>1&&(a*=Math.sqrt(A),l*=Math.sqrt(A));var $=V2(t,i,r,n,a,l,p,x,S,k,T,R),z=q2($,4),B=z[0],H=z[1],Y=z[2],Q=z[3],he=Math.abs(Q)/(ja/4);Math.abs(1-he)<1e-7&&(he=1);var G=Math.max(Math.ceil(he),1);Q/=G;for(var ue=0;ue<G;ue++)E.push(Q2(Y,Q)),Y+=Q;return E.map(function(ce){var be=Cc(ce[0],a,l,k,S,B,H),re=be.x,Te=be.y,Oe=Cc(ce[1],a,l,k,S,B,H),qe=Oe.x,ne=Oe.y,ke=Cc(ce[2],a,l,k,S,B,H),Le=ke.x,J=ke.y;return{x1:re,y1:Te,x2:qe,y2:ne,x:Le,y:J}})},Z2=X2,Tc={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},Y2=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function X2(e){var t=[];return e.replace(Y2,function(i,r,n){var a=r.toLowerCase();for(n=J2(n),a=="m"&&n.length>2&&(t.push([r].concat(n.splice(0,2))),a="l",r=r=="m"?"l":"L");;){if(n.length==Tc[a])return n.unshift(r),t.push(n);if(n.length<Tc[a])throw new Error("malformed path data");t.push([r].concat(n.splice(0,Tc[a])))}}),t}var K2=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function J2(e){var t=e.match(K2);return t?t.map(Number):[]}var eI=tI;function tI(e){var t=0,i=0,r=0,n=0;return e.map(function(a){a=a.slice();var l=a[0],u=l.toUpperCase();if(l!=u)switch(a[0]=u,l){case"a":a[6]+=r,a[7]+=n;break;case"v":a[1]+=n;break;case"h":a[1]+=r;break;default:for(var c=1;c<a.length;)a[c++]+=r,a[c++]+=n}switch(u){case"Z":r=t,n=i;break;case"H":r=a[1];break;case"V":n=a[1];break;case"M":r=t=a[1],n=i=a[2];break;default:r=a[a.length-2],n=a[a.length-1]}return a})}function iI(e){let t=Z2(e),i=eI(t),r,n=0,a=0,l=0,u=0,c,d,p=0,y=0,x=[];for(let E=0;E<i.length;E++){let S=i[E],k=S[0];switch(k){case"M":n=S[1],a=S[2];break;case"H":S=["L",S[1],a];break;case"V":S=["L",n,S[1]];break;case"S":{let T=p,R=y;(r==="C"||r=="S")&&(T+=T-l,R+=R-u),S=["C",T,R,S[1],S[2],S[3],S[4]]}break;case"T":r==="Q"||r=="T"?(c=p*2-c,d=y*2-d):(c=p,d=y),S=["Q",c,d,S[1],S[2]];break;case"Q":c=S[1],d=S[2];break;case"A":{let T=G2({px:p,py:y,cx:S[6],cy:S[7],rx:S[1],ry:S[2],xAxisRotation:S[3],largeArcFlag:S[4],sweepFlag:S[5]});if(!T.length)continue;for(let[R,A]of T.entries())S=["C",A.x1,A.y1,A.x2,A.y2,A.x,A.y],R<T.length-1&&x.push(S);S=S}break;case"Z":S=["L",n,a];break}r=k,p=S[S.length-2],y=S[S.length-1],["C","Q","A"].indexOf(k)>-1?(l=S[S.length-4],u=S[S.length-3]):(l=p,u=y),x.push(S)}return x}function rI(e,t,i,r=1){return new rb(e,t,i).subdivide(r)}function nI(e,t,i,r,n=1){return new nb(new Float64Array([e.x,e.y,t.x,t.y,i.x,i.y,r.x,r.y])).subdivide(n)}function sI(e){return e.x*e.x+e.y*e.y}function Ua(e){return e/(1-.67+Math.pow(Math.pow(.67,4)+.25*e*e,.25))}function Vs(e){return e*(1-.39+Math.sqrt(.39*.39+.25*e*e))}var rb=class{constructor(e,t,i){this.start=e,this.control=t,this.end=i}eval(e){let t=1-e;return{x:this.start.x*t*t+2*this.control.x*t*e+this.end.x*e*e,y:this.start.y*t*t+2*this.control.y*t*e+this.end.y*e*e}}mapToBasic(){let{x:e,y:t}=this.start,{x:i,y:r}=this.control,{x:n,y:a}=this.end,l=2*i-e-n,u=2*r-t-a,c=(i-e)*l+(r-t)*u,d=(n-i)*l+(a-r)*u,p=(n-e)*u-(a-t)*l,y=c/p,x=d/p,E=Math.abs(p)/(Math.hypot(l,u)*Math.abs(x-y));return{x0:e,x2:n,scale:E,cross:p}}subdivide(e){let t=this.mapToBasic(),i=Ua(t.x0),r=Ua(t.x2),n=.5*Math.abs(r-i)*Math.sqrt(t.scale/e),a=Math.ceil(n),l=Vs(i),u=Vs(r),c=[0];for(let d=1;d<a;d++){let p=(Vs(i+(r-i)*d/a)-l)/(u-l);c.push(p)}return c.push(1),c.map(d=>this.eval(d))}},nb=class{constructor(e){this.c=e}weightsum(e,t,i,r){let n=e*this.c[0]+t*this.c[2]+i*this.c[4]+r*this.c[6],a=e*this.c[1]+t*this.c[3]+i*this.c[5]+r*this.c[7];return{x:n,y:a}}eval(e){let t=1-e,i=t*t*t,r=3*t*t*e,n=3*t*e*e,a=e*e*e;return this.weightsum(i,r,n,a)}deriv(e){let t=1-e,i=-3*t*t,r=3*e*e,n=-6*e*t-i,a=6*e*t-r;return this.weightsum(i,n,a,r)}midpoint_quadbez(){let e=this.weightsum(-.25,.75,.75,-.25);return new rb({x:this.c[0],y:this.c[1]},e,{x:this.c[6],y:this.c[7]})}subsegment(e,t){let i=new Float64Array(8),r=this.eval(e),n=this.eval(t);i[0]=r.x,i[1]=r.y;let a=(t-e)/3,l=this.deriv(e);i[2]=r.x+a*l.x,i[3]=r.y+a*l.y;let u=this.deriv(t);return i[4]=n.x-a*u.x,i[5]=n.y-a*u.y,i[6]=n.x,i[7]=n.y,new nb(i)}subdivide(e){let t=.1*e,i=e-t,r=Math.sqrt(i),n=sI(this.weightsum(1,-3,3,-1)),a=Math.ceil(Math.pow(n/(432*t*t),1/6)),l=[],u=0;for(let E=0;E<a;E++){let S=E/a,k=(E+1)/a,T=this.subsegment(S,k).midpoint_quadbez(),R=T.mapToBasic(),A=Ua(R.x0),$=Ua(R.x2),z=Math.sqrt(R.scale),B=Math.abs($-A)*z;if(Math.sign(R.x0)!=Math.sign(R.x2)){let H=r/z,Y=r*Math.abs($-A)/Ua(H);B=Math.max(B,Y)}l.push({quad:T,a0:A,a2:$,val:B}),u+=B}let c=.5*u/r,d=Math.ceil(c),p=[{x:this.c[0],y:this.c[1]}],y=0,x=0;for(let E=1;E<d;E++){let S=u*E/d;for(;y+l[x].val<S;)y+=l[x].val,x++;let k=l[x].a0,T=l[x].a2,R=Vs(k),A=Vs(T),$=k+(T-k)*(S-y)/l[x].val,z=(Vs($)-R)/(A-R);p.push(l[x].quad.eval(z))}return p.push({x:this.c[6],y:this.c[7]}),p}},aI=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,oI=/&?(t=)(npt:)?([0-9]+(.[0-9]+)?)?(,([0-9]+(.[0-9]+)?))?/,sb=/^rgba\((\d+),(\d+),(\d+),([0-9.]+)\)$/;function Ic(e,{domParser:t,svgPreprocessor:i}={}){var r,n;if(Array.isArray(e))return e.reduce((a,l)=>{let{selector:u,selectors:c}=Ic(l);return u&&(a.selector||(a.selector=u),a.selectors.push(...c)),a},{selector:null,selectors:[]});if(!e)return{selector:null,selectors:[]};if(typeof e=="string"){let[a,l]=e.split("#");return l?Ic({type:"FragmentSelector",value:l}):{selector:null,selectors:[]}}if(e.type==="PointSelector"&&(e.t||e.t===0)){let a={type:"TemporalSelector",temporal:{startTime:e.t}};return{selector:a,selectors:[a]}}if(e.type==="FragmentSelector"){let a=aI.exec(e.value);if(a){let u={type:"BoxSelector",spatial:{unit:a[2]==="percent:"||a[2]==="pct:"?"percent":"pixel",x:parseFloat(a[3]),y:parseFloat(a[4]),width:parseFloat(a[5]),height:parseFloat(a[6])}};return{selector:u,selectors:[u]}}let l=e.value.match(oI);if(l){let u={type:"TemporalSelector",temporal:{startTime:l[4]?parseFloat(l[4]):0,endTime:l[7]?parseFloat(l[7]):void 0}};return{selector:u,selectors:[u]}}return{selector:null,selectors:[]}}if(e.type==="SvgSelector"&&"value"in e){t||(typeof window<"u"?t=new window.DOMParser:console.warn("No DOMParser available, cannot parse SVG selector, `points`, `spatial` and `style` will be unavailable and the SVG will not be normalized."));let a=[],l,u,c=(r=i==null?void 0:i(e.value))!=null?r:e.value,d;if(t){let y=t.parseFromString(e.value,"image/svg+xml").querySelector("svg");if(!y)return console.warn(`Illegal SVG selector: ${e.value}`),{selector:null,selectors:[]};let x=ab(y);x&&(a=x.points,d=x.shapeType,l=[Math.min(...a.map(E=>E[0])),Math.min(...a.map(E=>E[1])),Math.max(...a.map(E=>E[0])),Math.max(...a.map(E=>E[1]))],{style:u,svg:c}=(n=hI(x.element))!=null?n:{svg:c})}let p={type:"SvgSelector",svg:c,svgShape:d,style:u,points:a.length?a:void 0,spatial:l?{unit:"pixel",x:l[0],y:l[1],width:l[2]-l[0],height:l[3]-l[1]}:void 0};return{selector:p,selectors:[p]}}return{selector:null,selectors:[]}}function lI(e){let t=e.map(r=>r[0]).reduce((r,n)=>(r[n]+=1,r),{C:0,Q:0,L:0,M:0}),i=new Set(e.map(r=>r[0]));if(t.C>0||t.Q>0)return"path";if(t.L>0&&(i.size===1||i.size===2&&i.has("M"))){if(t.L===4)return"rect";let r=e.slice(-1)[0];return e[0][0]==="M"&&r[0]==="L"&&r[1]==e[0][1]&&r[2]===e[0][2]||r[1]===0&&r[2]===0?"polygon":"polyline"}return"path"}function ab(e){var t,i,r,n,a,l,u,c,d,p,y,x,E,S,k,T,R;for(let A of Array.from(e.children))switch(A==null?void 0:A.tagName.toLowerCase()){case"g":{let $=ab(A);if($)return $}continue;case"path":{let $=A.getAttribute("d");if(!$)continue;let z=iI($);return{element:A,points:uI(z),shapeType:lI(z)}}case"circle":{let $=parseFloat((t=A.getAttribute("cx"))!=null?t:"0"),z=parseFloat((i=A.getAttribute("cy"))!=null?i:"0"),B=parseFloat((r=A.getAttribute("r"))!=null?r:"0");if(!B)continue;let H=[];for(let Y=0;Y<=360;Y+=12){let Q=Y*Math.PI/180;H.push([$+B*Math.cos(Q),z+B*Math.sin(Q)])}return{element:A,points:H,shapeType:"circle"}}case"ellipse":{let $=parseFloat((n=A.getAttribute("cx"))!=null?n:"0"),z=parseFloat((a=A.getAttribute("cy"))!=null?a:"0"),B=parseFloat((l=A.getAttribute("rx"))!=null?l:"0"),H=parseFloat((u=A.getAttribute("ry"))!=null?u:"0");if(!B&&!H)continue;let Y=[];for(let Q=0;Q<=360;Q+=12){let he=Math.tan(Q/360*Math.PI),G=B*(1-he**2)/(1+he**2),ue=H*2*he/(1+he**2);Y.push([$+G,z+ue])}return{element:A,points:Y,shapeType:"ellipse"}}case"line":{let $=parseFloat((c=A.getAttribute("x0"))!=null?c:"0"),z=parseFloat((d=A.getAttribute("y0"))!=null?d:"0"),B=parseFloat((p=A.getAttribute("x1"))!=null?p:"0"),H=parseFloat((y=A.getAttribute("y1"))!=null?y:"0");if($===B&&z===H)continue;return{element:A,points:[[$,z],[B,H]],shapeType:"polyline"}}case"polygon":case"polyline":{let $=(E=(x=A.getAttribute("points"))==null?void 0:x.split(" ").map(B=>B.split(",").map(parseFloat)))!=null?E:[];if(!$.length)continue;let z="polyline";return A.tagName.toLowerCase()==="polygon"&&($.push($[0]),z="polygon"),{element:A,points:$,shapeType:z}}case"rect":{let $=parseFloat((S=A.getAttribute("x"))!=null?S:"0"),z=parseFloat((k=A.getAttribute("y"))!=null?k:"0"),B=parseFloat((T=A.getAttribute("width"))!=null?T:"0"),H=parseFloat((R=A.getAttribute("height"))!=null?R:"0");if(!B||!H)continue;return{element:A,points:[[$,z],[$+B,z],[$+B,z+H],[$,z+H],[$,z]],shapeType:"rect"}}default:continue}return null}function uI(e){var t;let i=[];for(let r=0;r<e.length;r++){let n=(t=i[i.length-1])!=null?t:[0,0],a=e[r];switch(a[0]){case"M":case"L":i.push([a[1],a[2]]);continue;case"C":i.push(...nI({x:n[0],y:n[1]},{x:a[1],y:a[2]},{x:a[3],y:a[4]},{x:a[5],y:a[6]}).map(l=>[l.x,l.y]).slice(1));continue;case"Q":i.push(...rI({x:n[0],y:n[1]},{x:a[1],y:a[2]},{x:a[3],y:a[4]}).map(l=>[l.x,l.y]).slice(1));continue}}return i}function hI(e){let t={};if(e.hasAttribute("fill")?(t.fill=e.getAttribute("fill"),e.removeAttribute("fill")):e.style.fill&&(t.fill=e.style.fill),t.fill){let r=sb.exec(t.fill);r&&(t.fillOpacity=parseFloat(r[4]),t.fill=`rgb(${r[1]}, ${r[2]}, ${r[3]})`)}if(e.hasAttribute("fill-opacity")?(t.fillOpacity=parseFloat(e.getAttribute("fill-opacity")),e.removeAttribute("fill-opacity")):e.style.fillOpacity&&(t.fillOpacity=parseFloat(e.style.fillOpacity)),e.hasAttribute("stroke")?(t.stroke=e.getAttribute("stroke"),e.removeAttribute("stroke")):e.style.stroke&&(t.stroke=e.style.stroke),t.stroke){let r=sb.exec(t.stroke);r&&(t.strokeOpacity=parseFloat(r[4]),t.stroke=`rgb(${r[1]}, ${r[2]}, ${r[3]})`)}e.hasAttribute("stroke-opacity")?(t.strokeOpacity=parseFloat(e.getAttribute("stroke-opacity")),e.removeAttribute("stroke-opacity")):e.style.strokeOpacity&&(t.strokeOpacity=parseFloat(e.style.strokeOpacity)),e.hasAttribute("stroke-width")?(t.strokeWidth=e.getAttribute("stroke-width"),e.removeAttribute("stroke-width")):e.style.strokeWidth&&(t.strokeWidth=e.style.strokeWidth),e.hasAttribute("stroke-dasharray")?(t.strokeDasharray=e.getAttribute("stroke-dasharray"),e.removeAttribute("stroke-dasharray")):e.style.strokeDasharray&&(t.strokeDasharray=e.style.strokeDasharray);let i=e;for(;i.tagName.toLowerCase()!=="svg";)if(i=i.parentElement,i===null)throw new Error("Could not find root SVG element");return{svg:i.outerHTML,style:Object.keys(t).length>0?t:void 0}}function cI(e){return e.type==="SpecificResource"?[e.source,{selector:e.selector}]:[e,{selector:null}]}function dI(e){function t(n){let a=n?typeof n=="string"?e.get(n):n:null;if(!a)return[];let l=e.get(a.items),u=[];for(let c of l)u.push(...e.get(c.items));return u}function i(n,a=[]){let l=Array.isArray(n)?n:t(n),u=[],c=null,d=[];for(let p of l){if(p.type!=="Annotation")throw new Error("getPaintables() accept either a canvas or list of annotations");let y=e.get(p.body);for(let x of y){let[E,{selector:S}]=cI(x),k=(E.type||"unknown").toLowerCase();if(k==="choice"){let T=e.get(E.items),R=a.length?a.map(A=>T.find($=>$.id===A)).filter(Boolean):[T[0]];R.length===0&&R.push(T[0]),c={type:"single-choice",items:T.map(A=>({id:A.id,label:A.label,selected:R.indexOf(A)!==-1})),label:x.label},y.push(...R);continue}u.indexOf(k)===-1&&u.push(k),d.push({type:k,resource:E,target:p.target,selector:S})}}return{types:u,items:d,choice:c}}function r(n){let{choice:a}=i(n);return a}return{getAllPaintingAnnotations:t,getPaintables:i,extractChoices:r}}function ob(e,t){for(let i of t.items){if(i.type==="Canvas")return i;if(i.type==="Range"){let r=ob(e,e.get(i));if(r)return r}}return null}function fI(e,t,i){for(let r of t.structures){let n=lb(e,e.get(r),i);if(n)return n}return null}function lb(e,t,i){var r;for(let n of t.items){let a=(r=n.id)==null?void 0:r.split("#")[0];if(n.type==="SpecificResource"&&n.source===i||n.type==="Canvas"&&i===a)return t;if(n.type==="Range"){let l=lb(e,e.get(n),i);if(l)return l}}return null}var pI=class{constructor(e){this.__vault=null,this.__eventsHelper=null,this.__stylesHelper=null,this.__e={},this.htmlProps={},this.handlers=[],this.__annotation=typeof e=="string"?{id:e,type:"Annotation"}:{id:e.id,type:"Annotation"},this.classList=new YT(t=>{this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",W(C({},this.htmlProps),{className:t}))}),this.source=e}get className(){return this.classList.getClassName()}set className(e){this.classList.className=e}set href(e){this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",{href:e}),this.htmlProps.href=e}set title(e){this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",{title:e}),this.htmlProps.title=e}set target(e){this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"html",{target:e}),this.htmlProps.target=e}applyStyle(e){this.style=kv(this.style,e),this.__stylesHelper&&this.__stylesHelper.applyStyles(this.__annotation,"atlas",this.style)}addEventListener(e,t){this.__eventsHelper&&this.__eventsHelper.addEventListener(this.__annotation,e,t),this.handlers.push([e,t])}removeEventListener(e,t){this.__eventsHelper&&this.__eventsHelper.removeEventListener(this.__annotation,e,t),this.handlers=this.handlers.filter(i=>i[0]===e&&i[1]===t)}bindToVault(e){this.__vault=e,this.__eventsHelper=Sc(e),this.__stylesHelper=Ec(e);for(let[t,i]of this.handlers)this.__eventsHelper.addEventListener(this.__annotation,t,i);this.__stylesHelper.applyStyles(this.__annotation,"atlas",this.style),this.__stylesHelper.applyStyles(this.__annotation,"html",W(C({},this.htmlProps),{className:this.classList.getClassName()}))}getSource(){return this.source}getAnnotation(){return this.__annotation}beforeRemove(){if(this.onBeforeRemove&&this.onBeforeRemove(),this.__vault){if(this.__eventsHelper)for(let[e,t]of this.handlers)this.__eventsHelper.removeEventListener(this.__annotation,e,t);this.__vault=null}}};pe();var gi=Ue(yh(),1),ub="@iiif/IMPORT_ENTITIES",hb="@iiif/MODIFY_ENTITY_FIELD",cb="@iiif/REORDER_ENTITY_FIELD",db="@iiif/ADD_REFERENCE",fb="@iiif/REMOVE_REFERENCE",pb=(0,gi.createAction)(ub)(),gI=(0,gi.createAction)(hb)(),mI=(0,gi.createAction)(cb)(),yI=(0,gi.createAction)(db)(),vI=(0,gi.createAction)(fb)(),bI={importEntities:pb,modifyEntityField:gI,reorderEntityField:mI,addReference:yI,removeReference:vI},gb="@iiif/ADD_MAPPING",mb="@iiif/ADD_MAPPINGS",wI=(0,gi.createAction)(gb)(),xI=(0,gi.createAction)(mb)(),yb="@iiif/SET_META_VALUE",vb="@iiif/SET_META_VALUE_DYNAMIC",bb="@iiif/UNSET_META_VALUE",_I=(0,gi.createAction)(yb)(),SI=(0,gi.createAction)(vb)(),EI=(0,gi.createAction)(bb)(),wb={setMetaValue:_I,setMetaValueDynamic:SI,unsetMetaValue:EI},Rc="RESOURCE_ERROR",xb="RESOURCE_LOADING",Oc="RESOURCE_READY",_b="@iiif/REQUEST_RESOURCE",Sb="@iiif/REQUEST_ERROR",Eb="@iiif/REQUEST_MISMATCH",Ab="@iiif/REQUEST_COMPLETE",kb="@iiif/REQUEST_OFFLINE_RESOURCE",AI=(0,gi.createAction)(_b)(),Pb=(0,gi.createAction)(Sb)(),kI=(0,gi.createAction)(Eb)(),PI=(0,gi.createAction)(Ab)();(0,gi.createAction)(kb)();var Mc="@iiif/BATCH",Cb="@iiif/BATCH_IMPORT",Lc=(0,gi.createAction)(Mc)();(0,gi.createAction)(Cb)();var CI=(e,t)=>{let{entities:i,resource:r,mapping:n}=um(t);if(r.id===void 0)return[Pb({id:e,message:"ID is not defined in resource."})];let a=[pb({entities:i}),xI({mapping:n})];return r.id!==e&&(a.push(wI({id:e,type:r.type})),a.push(kI({requestId:e,actualId:r.id}))),a.push(PI({id:e})),a},Tb=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function TI(e,t){return!!(e===t||Tb(e)&&Tb(t))}function Ib(e,t){if(!Array.isArray(e)||!Array.isArray(t))return e===t;if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!TI(e[i],t[i]))return!1;return!0}function $c(e,t){let i=e.iiif.requests[t],r=e.iiif.mapping[t];if(!(!r||!e.iiif.entities[r][i.resourceUri]))return e.iiif.entities[r][i.resourceUri]}function Rb(e,t,{waitTimeout:i=30}={}){return async(r,n)=>{let a=e.getState(),l=a.iiif.requests[r];if(l)switch(l.loadingState){case Rc:break;case xb:{let u,c=!1;try{let d=await Promise.race([new Promise((p,y)=>{c||(u=e.subscribe(()=>{let x=e.getState();if(x.iiif.requests[r].loadingState===Rc){y();return}if(x.iiif.requests[r].loadingState===Oc){let E=$c(x,r);E?p(E):y()}}))}),new Promise((p,y)=>setTimeout(()=>{c=!0,y()},i*60))]);if(u&&u(),d)return d}catch{u&&u();break}break}case Oc:{let u=$c(a,r);if(u)return u;break}}e.dispatch(AI({id:r}));try{let u=await t(r,n);!u.id&&!u["@id"]&&(u["@type"]&&(u["@id"]=r),u.id=r);let c=CI(r,u);return e.dispatch(Lc({actions:c})),$c(e.getState(),r)}catch(u){throw e.dispatch(Pb({id:r,message:u.toString()})),u}}}function II(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}var RI=(e={},t)=>{switch(t.type){case gb:return W(C({},e),{[t.payload.id]:t.payload.type});case mb:return C(C({},e),t.payload.mapping);default:return e}};function Nc(e,t,i,r){return!(!e[i]||!e[i][t]||!e[i][t][r]||!Array.isArray(e[i][t][r]))}function OI(e,t){let i={},r=[];for(let[n,a]of Object.entries(e||{})){r.push(n);let l=(t||{})[n];if(!l||l.length===0){i[n]=a;continue}i[n]=l}for(let[n,a]of Object.entries(t||{}))r.indexOf(n)===-1&&(i[n]=a);return i}var MI=(e=II(),t)=>{var i;switch(t.type){case hb:{if(!e[t.payload.type]||!e[t.payload.type][t.payload.id])return e;let r=e[t.payload.type][t.payload.id];return typeof r=="string"?e:W(C({},e),{[t.payload.type]:W(C({},e[t.payload.type]),{[t.payload.id]:W(C({},r),{[t.payload.key]:t.payload.value})})})}case cb:{if(!Nc(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id];if(typeof r=="string")return e;let n=Array.from(r[t.payload.key]),[a]=n.splice(t.payload.startIndex,1);return n.splice(t.payload.endIndex,0,a),W(C({},e),{[t.payload.type]:W(C({},e[t.payload.type]),{[t.payload.id]:W(C({},r),{[t.payload.key]:n})})})}case ub:{let r=Object.keys(t.payload.entities),n=C({},e);for(let a of r){let l=t.payload.entities[a],u=C({},e[a]||{}),c=!1,d=Object.keys(l||{})||[];if(l&&d){for(let p of d)c=!0,u[p]=e[a][p]?OI(e[a][p],l[p]):l[p];c&&(n[a]=u)}}return n}case db:{if(!Nc(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id],n=Array.from(r[t.payload.key]);return n.splice(t.payload.index||n.length+1,0,t.payload.reference),W(C({},e),{[t.payload.type]:W(C({},e[t.payload.type]),{[t.payload.id]:W(C({},r),{[t.payload.key]:n})})})}case fb:{if(!Nc(e,t.payload.id,t.payload.type,t.payload.key))return e;let r=e[t.payload.type][t.payload.id],n=Array.from(r[t.payload.key]),a=t.payload.index||n.findIndex(l=>l&&l.id===t.payload.reference.id);return a===-1||((i=n[a])==null?void 0:i.id)!==t.payload.reference.id?e:(n.splice(a,1),W(C({},e),{[t.payload.type]:W(C({},e[t.payload.type]),{[t.payload.id]:W(C({},r),{[t.payload.key]:n})})}))}default:return e}},LI=(e={},t)=>{switch(t.type){case _b:case kb:return W(C({},e),{[t.payload.id]:{requestUri:t.payload.id,loadingState:xb,uriMismatch:!1,resourceUri:t.payload.id}});case Eb:return W(C({},e),{[t.payload.requestId]:W(C({},e[t.payload.requestId]||{}),{uriMismatch:!0,resourceUri:t.payload.actualId}),[t.payload.actualId]:{requestUri:t.payload.requestId,loadingState:e[t.payload.requestId].loadingState,uriMismatch:!0,resourceUri:t.payload.actualId}});case Sb:return W(C({},e),{[t.payload.id]:W(C({},e[t.payload.id]||{}),{loadingState:Rc,error:t.payload.message})});case Ab:return W(C({},e),{[t.payload.id]:W(C({},e[t.payload.id]||{}),{loadingState:Oc,error:void 0})})}return e},$I=(e={},t)=>{let{id:i,updateValue:r,value:n,meta:a,key:l}=t&&t.payload||{};switch(t.type){case yb:return W(C({},e),{[i]:W(C({},e[i]||{}),{[a]:W(C({},e[i]?e[i][a]||{}:{}),{[l]:n})})});case vb:return W(C({},e),{[i]:W(C({},e[i]||{}),{[a]:W(C({},e[i]?e[i][a]||{}:{}),{[l]:e[i]&&e[i][a]?r(e[i][a][l]):r(void 0)})})});case bb:return e[i]&&e[i][a]&&e[i][a][l]?W(C({},e),{[i]:W(C({},e[i]||{}),{[a]:W(C({},e[i]?e[i][a]||{}:{}),{[l]:void 0})})}):e;default:return e}};function NI(e){return(t,i)=>i&&i.type===Mc?i.payload.actions.reduce(e,t):i&&i.type===Cb?i.payload.state:e(t,i)}var zI=Ko({mapping:RI,entities:MI,requests:LI,meta:$I}),FI=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Yn;function BI(e={}){let{enableDevtools:t=!0,iiifStoreName:i="iiif",defaultState:r={},extraMiddleware:n=[],customReducers:a={}}=e,l=Ko(C({[i]:zI},a));return Dh(NI(l),r,t?FI(Jo(...n)):Yn(Jo(...n)))}function jI(e){return{all:e=e||new Map,on:function(t,i){var r=e.get(t);r?r.push(i):e.set(t,[i])},off:function(t,i){var r=e.get(t);r&&(i?r.splice(r.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var r=e.get(t);r&&r.slice().map(function(n){n(i)}),(r=e.get("*"))&&r.slice().map(function(n){n(t,i)})}}}var UI=class{constructor(e,t){Je(this,"options"),Je(this,"store"),Je(this,"emitter"),Je(this,"isBatching",!1),Je(this,"batchQueue",[]),Je(this,"remoteFetcher"),Je(this,"staticFetcher"),Je(this,"defaultFetcher",i=>fetch(i).then(r=>r.json())),Je(this,"middleware",i=>r=>n=>{if(n.type===Mc){for(let u of n.payload.actions)this.emitter.emit(u.type,{realAction:u,state:i.getState()});let l=r(n);for(let u of n.payload.actions)this.emitter.emit(`after:${n.type}`,{action:n,state:l});return l}this.emitter.emit(n.type,{action:n,state:i.getState()});let a=r(n);return this.emitter.emit(`after:${n.type}`,{action:n,state:a}),a}),this.options=Object.assign({reducers:{},middleware:[],defaultState:{},customFetcher:this.defaultFetcher,enableDevtools:!0},e||{}),this.store=t||BI({customReducers:this.options.reducers,extraMiddleware:[...this.options.middleware,this.middleware],defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=jI(),this.remoteFetcher=Rb(this.store,this.options.customFetcher),this.staticFetcher=Rb(this.store,(i,r)=>r)}batch(e){this.isBatching=!0;try{e(this),this.store.dispatch(Lc({actions:this.batchQueue}))}catch(t){throw this.batchQueue=[],this.isBatching=!1,t}this.batchQueue=[],this.isBatching=!1}async asyncBatch(e){this.isBatching=!0;try{await e(this),this.store.dispatch(Lc({actions:this.batchQueue}))}catch(t){throw this.batchQueue=[],this.isBatching=!1,t}this.batchQueue=[],this.isBatching=!1}modifyEntityField(e,t,i){this.dispatch(bI.modifyEntityField({id:e.id,type:e.type,key:t,value:i}))}dispatch(e){this.isBatching?this.batchQueue.push(e):this.store.dispatch(e)}serialize(e,t){return cm(this.getState().iiif,e,t)}toPresentation2(e){return this.serialize(e,fm)}toPresentation3(e){return this.serialize(e,mm)}hydrate(e,t){return this.get(e,t,{skipSelfReturn:!1})}get(e,t,i={}){typeof t!="string"&&(i=t||{},t=void 0);let{skipSelfReturn:r=!0}=i||{};if(Array.isArray(e))return e.map(c=>this.get(c,i));let n=this.getState();if(typeof e=="string"){let c=t||n.iiif.mapping[e];if(!c)return r?null:{id:e,type:"unknown"};e={id:e,type:c}}let a=t||e.type,l=e.id,u=n.iiif.entities[a];if(!u){let c=n.iiif.requests[l];return c&&c.resourceUri!==l?this.get(c.resourceUri,i):r?null:e}return u[e.id]||(r?null:e)}select(e){return e(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}loadManifest(e,t){let i=typeof e=="string"?e:e.id;return this.load(i,t)}loadCollection(e,t){let i=typeof e=="string"?e:e.id;return this.load(i,t)}load(e,t){let i=typeof e=="string"?e:e.id;return t?this.staticFetcher(i,t):this.remoteFetcher(i)}areInputsEqual(e,t){return Ib(e,t)}subscribe(e,t,i){typeof i>"u"&&(typeof t>"u"||t===!1||t===!0)&&(i=t,t=e,e=n=>n);let r=i?null:e(this.store.getState());return i||t(r,this),this.store.subscribe(()=>{let n=this.store.getState(),a=e(n);r!==a&&!Ib(r,a)&&t(a,this),r=a})}async ensureLoaded(e){let t=typeof e=="string"?e:e.id;this.requestStatus(t)||await this.load(t)}requestStatus(e){return this.select(t=>t.iiif.requests[e])}getResourceMeta(e,t){let i=this.getState().iiif.meta[e];if(i)return t?i[t]:i}setMetaValue([e,t,i],r){this.dispatch(typeof r=="function"?wb.setMetaValueDynamic({id:e,meta:t,key:i,updateValue:r}):wb.setMetaValue({id:e,meta:t,key:i,value:r}))}};function DI(){return typeof self<"u"?self:typeof window<"u"?window:typeof $u<"u"?$u:{}}function zc(e){let t=DI();try{let r=t.IIIF_VAULT;if(r)return r}catch{}let i=new UI(e);try{t.IIIF_VAULT=i}catch{}return i}var as=WI();function WI(e){let t={},i=(n,a)=>{var l;return t[n]===void 0&&(t[n]=[]),(l=t[n])==null||l.push(a),()=>{r(n,a)}},r=(n,a)=>{var l,u,c;let d=(u=(l=t[n])==null?void 0:l.indexOf(a))!=null?u:-1;(c=t[n])==null||c.splice(d>>>0,1)};return{on:i,off:r,once:(n,a)=>{let l=u=>{a(u),r(n,l)};i(n,l)},emit:(n,a)=>{var l;(l=t[n])==null||l.forEach(u=>{try{u(a)}catch{}})}}}function Fl(e){let t=xe(),i=.75,r=1/.75,n=ll(),a=e.vault||n||zc(),l=uc(),u=xe({}),{isReady:c,isConfigBlocking:d,setIsReady:p,internalConfig:y}=WC(e.preset,(we,De)=>{t.current?t.current.dispatchEvent(new CustomEvent("media",{detail:{query:we,config:De}})):u.current[we]=De}),x=Ae(()=>Sc(a),[a]),E=Ae(()=>Ec(a),[a]),S=Ae(()=>D2(a,{imageServiceLoader:l}),[a,l]),[k]=He(e.nested||y.nested,{parse:pt,defaultValue:!1}),[T]=He(e.x||y.x,{parse:Cr,defaultValue:0}),[R]=He(e.y||y.y,{parse:Cr,defaultValue:0}),A=xe(),[$]=He(e.render||y.render,{defaultValue:"canvas"}),[z]=He(e.class),[B]=He(e.virtualSizes||y.virtualSizes,{parse:GT}),[H]=He(e.height||y.height,{parse:Cr}),[Y]=He(e.width||y.width,{parse:Cr}),[Q]=He(e.a11yRole||void 0),[he]=He(e.a11yTitle||void 0),[G]=He(e.interactive||y.interactive,{parse:pt,defaultValue:!0}),[ue]=He(e.background),[ce]=He(e.viewport||y.viewport,{parse:pt,defaultValue:!0}),[be]=He(e.responsive||y.responsive,{parse:pt,defaultValue:!0}),[re]=He(e.moveEvents||y.moveEvents,{parse:pt,defaultValue:!1}),[Te]=He(e.granularMoveEvents||y.granularMoveEvents,{parse:pt,defaultValue:!1}),[Oe]=He(e.clickToEnableZoom||e.clickToEnableZoom,{parse:pt,defaultValue:!0}),[qe]=He(e.disableKeyboardNavigation||y.disableKeyboardNavigation,{parse:pt,defaultValue:!1}),[ne]=He(e.debug||y.debug,{parse:pt}),[ke]=He(e.enablePanOnWait||y.enablePanOnWait,{parse:pt,defaultValue:void 0}),[Le]=He(e.ignoreSingleFingerTouch||y.ignoreSingleFingerTouch,{parse:pt,defaultValue:void 0}),[J]=He(e.requireMetaKeyForWheelZoom||y.requireMetaKeyForWheelZoom,{parse:pt,defaultValue:!1}),[Fe]=He(e.panOnWaitDelay||y.panOnWaitDelay,{parse:Cr,defaultValue:40}),[Ve]=He(e.enableNavigator||y.enableNavigator,{parse:pt}),[Ze,Pt,at,Xt]=He(e.target||e.region||y.target||y.region,{parse:_c}),[Ki,cr,,Ir]=He(e.rotation,{parse:Cr}),[mi,Wt,,Ji]=He(e.highlight||y.highlight,{parse:_c}),[Ht]=He(e.styleId||y.styleId),[Be]=He(e.highlightCssClass||y.highlightCssClass,{defaultValue:"canvas-panel-highlight"}),[ve,,,Pe]=He(e.preferredFormats||y.preferredFormats,{parse:Pv}),[ot]=He(e.homeCover,{parse:we=>we==="false"?!1:we==="true"?!0:we==="start"?"start":we==="end"?"end":!1}),[yt,qt]=He(e.atlasMode||y.atlasMode),[Kt,Zr]=je(""),[Dc,Wc]=je(""),[os]=He(e.stylesheet||y.stylesheet),Fi=xe({}),[Ul,Hc]=je("");function qc(we,De={}){return He(e[we]||y[we],De)}function Ha(){if(t.current&&A.current){let we=t.current.getBoundingClientRect(),De=A.current.world.height||1,bt=A.current.world.width||1;return bt/De<1?we.height/De:we.width/bt}return-1}let Zs=xe({});fe(()=>{let we=as.on("onResetSeen",()=>{Zs.current={}}),De=Nt=>{let Ct=Nt.choice;if(t!=null&&t.current&&Ct&&Ct.items){let ie=Ct.items;ie.sort((wt,ft)=>wt.id<ft.id?-1:wt.id>ft.id?1:0);let Me=ie.map(wt=>wt.id).join(""),lt=ie.map(wt=>wt.selected).join("");if(Zs.current[Me]&&Zs.current[Me]==lt)return;Zs.current[Me]=lt,Ct.partOf=Nt.partOf,t.current.dispatchEvent(new CustomEvent("choice",{detail:{choice:Ct}}))}},bt=as.on("onChoiceChange",De);return()=>{we(),bt()}},[]),fe(()=>{if(A.current&&t.current){let we=C({},qa(A.current));Kt=="queued"&&we&&(we==null?void 0:we.scaleFactor)<1&&we.scaleFactor>0&&t.current!=null&&(Zr("fired"),setTimeout(()=>{var De;(De=t.current)==null||De.dispatchEvent(new CustomEvent("world-ready",{detail:we}))},100))}},[c,t.current,Ul,Kt]),fe(()=>{var we;let De=A.current,bt=(we=A.current)==null?void 0:we.transitionManager;if(De&&bt&&c){let Nt=!1,Ct=0;return De.world.addLayoutSubscriber(async(ie,Me)=>{if(ie!=="repaint"&&t.current){if(["recalculate-world-size","zoom-to","go-home","goto-region"].includes(ie)){if(ie=="recalculate-world-size"&&Zr("queued"),bt.hasPending()){if(Nt)return;Nt=!0,await new Promise(Qc=>setTimeout(Qc,bt.pendingTransition.total_time-bt.pendingTransition.elapsed_time)),Nt=!1}let lt=Ha(),wt=Math.abs(lt-De._lastGoodScale)<2e-4;wt?Ct++:Ct=0;let ft={detail:C(W(C({source:ie,minZoomCount:Ct},qa(De)),{isMin:wt,isMax:Math.abs(De.maxScaleFactor-De._lastGoodScale)<2e-4}),Me||{})};t.current.dispatchEvent(new CustomEvent("zoom",ft));return}t.current.dispatchEvent(new CustomEvent(ie,{detail:Me}))}})}return()=>{}},[c,Ul]);function qa(we){let De=we._lastGoodScale,bt=Ha(),Nt=we.getZoomedPosition(r,{}),Ct=we.getZoomedPosition(i,{}),ie={width:Math.round(Ct[3]),height:Math.round(Ct[4])},Me={width:Math.round(Nt[3]),height:Math.round(Nt[4])},lt={width:Math.round(we.target[3]),height:Math.round(we.target[4])},wt=2,ft=lt.height+wt<Me.height&&lt.width+wt<Me.width;return{canZoomIn:lt.height>ie.height&&lt.width>ie.width,canZoomOut:ft,scaleFactor:we.getScaleFactor(),current:De,max:we.maxScaleFactor,min:bt,worldHeight:we.world.height,worldWidth:we.world.width}}fe(()=>{var we;let De=A.current,bt=(we=A.current)==null?void 0:we.transitionManager;if(c&&De&&re){let Nt=-1,Ct=-1,ie=!1;return De.registerHook("useAfterFrame",async()=>{if(t.current&&(De.target[1]!==Nt||De.target[2]!==Ct)){if(!Te&&bt){if(ie)return;bt.hasPending()&&(ie=!0,await new Promise(Me=>setTimeout(Me,bt.pendingTransition.total_time-bt.pendingTransition.elapsed_time)),ie=!1)}t.current.dispatchEvent(new CustomEvent("move",{detail:{x:De.x,y:De.y,width:De.width,height:De.height,points:De.target,lastX:Nt,lastY:Ct}})),Nt=De.x,Ct=De.y}})}return()=>{}},[c,re]);function Dl(we){Et(()=>{e.__registerPublicApi&&e.__registerPublicApi(we)},[])}return Dl(we=>{t.current=we;let De,bt,Nt=!1;if(Oe){De=Me=>{Me.stopPropagation()};let ie=()=>{De&&!Nt&&(Nt=!0,we.addEventListener("wheel",De,{capture:!0}),we.addEventListener("touchstart",De,{capture:!0}))};bt=()=>{De&&Nt&&(Nt=!1,we.removeEventListener("wheel",De,{capture:!0}),we.removeEventListener("touchstart",De,{capture:!0}))},ie(),document.addEventListener("click",Me=>{document.activeElement!==we&&ie()})}we.addEventListener("click",ie=>{bt&&bt();let Me=ie.composedPath()[0];Me&&we!==document.activeElement&&Me.focus()});let Ct=Object.keys(u.current);if(Ct.length){for(let ie of Ct)we.dispatchEvent(new CustomEvent("media",{detail:{query:ie,config:u.current[ie]}}));u.current={}}return{vault:a,events:x,styles:E,thumbnailHelper:S,imageServiceLoader:l,getRotation:()=>Ir.current,setRotation:ie=>{we.setAttribute("rotation",ie.toString())},getHighlight:()=>Ji.current,setHighlight:ie=>{typeof ie=="string"?we.setAttribute("highlight",ie):Wt(ie)},getTarget:()=>Xt.current,setTarget:ie=>{typeof ie=="string"?we.setAttribute("target",ie):Pt(ie)},setDefaultChoiceIds:ie=>{we.setAttribute("choice-id",ie.join(","))},getPosition(){var ie,Me,lt,wt;return{x:(ie=A.current)==null?void 0:ie.x,y:(Me=A.current)==null?void 0:Me.y,width:(lt=A.current)==null?void 0:lt.width,height:(wt=A.current)==null?void 0:wt.height}},getMaxZoom(){var ie;return((ie=A.current)==null?void 0:ie.maxScaleFactor)||1},getMinZoom(){return Ha()||0},makeChoice(ie,Me){as.emit("onMakeChoice",{id:ie,options:Me})},zoomIn(ie){A.current&&A.current.world.trigger("zoom-to",{point:ie,factor:i})},zoomOut(ie){A.current&&A.current.world.trigger("zoom-to",{point:ie,factor:r})},zoomBy(ie,Me){A.current&&A.current.world.trigger("zoom-to",{point:Me,factor:ie})},zoomTo(ie,Me,lt){A.current&&A.current.world.zoomTo(ie,Me,lt)},withAtlas(ie){A.current?ie(A.current):Fi.current=W(C({},Fi.current),{[new Date().getTime()]:Me=>ie(Me)})},goHome(ie=!1){A.current?A.current.world.goHome(ie):Fi.current=W(C({},Fi.current),{viewport:Me=>Me.world.goHome(ie)})},getZoom(){var ie;return(ie=A.current)==null?void 0:ie._lastGoodScale},getScaleInformation(){let ie=A.current;if(ie!=null)return C({},qa(ie))},goToTarget(ie,Me={}){A.current?A.current.world.gotoRegion(C(C({},ie),Me)):Fi.current=W(C({},Fi.current),{viewport:lt=>{lt.world.gotoRegion(C(C({},ie),Me))}})},setFps(ie){A.current?A.current.fpsLimit=ie:Fi.current=W(C({},Fi.current),{setFps:Me=>{Me.fpsLimit=ie}})},clearTarget(){Pt(void 0),A.current?A.current.world.goHome(!0):Fi.current=W(C({},Fi.current),{viewport:ie=>{ie.world.goHome(!0)}})},setPreferredFormats(ie){we.setAttribute("preferred-formats",ie.join(","))},getPreferredFormats(){return Pe.current||[]},setMode(ie){we.setAttribute("atlas-mode",ie)},applyStyles(ie,Me){E.applyStyles(typeof ie=="string"?{id:ie}:ie,"atlas",Me)},applyHTMLProperties(ie,Me){E.applyStyles(typeof ie=="string"?{id:ie}:ie,"html",Me)},setClassName(ie,Me){E.applyStyles(typeof ie=="string"?{id:ie}:ie,"html",{className:Me})},createAnnotationDisplay(ie){return new pI(ie)},getThumbnail(ie,Me,lt){return S.getBestThumbnailAtSize(ie,Me,lt)},addVaultEventListener(ie,Me,lt,wt){return x.addEventListener(ie,Me,lt,wt)},removeVaultEventListener(ie,Me,lt){x.removeEventListener(ie,Me,lt)},getListenersAsProps(ie,Me){return x.getListenersAsProps(ie,Me)}}}),fe(()=>{if(A.current){let we=Object.values(Fi.current);for(let De of we)De(A.current);Fi.current={}}},[c]),Et(()=>{if(Ht){let we=document.getElementById(Ht);we&&Wc(we.innerText)}},[c,Ht]),Et(()=>{if(t.current&&!qe){let we=bt=>{var Nt,Ct,ie;if(A.current&&A.current.transitionManager){let Me=A.current.transitionManager,lt=Me.pendingTransition.done?A.current.target:Me.pendingTransition.to,wt=Math.min(lt[3]-lt[1],lt[4]-lt[2])*.1,ft;switch(bt.key){case"=":{(Nt=A.current.world)==null||Nt.zoomIn();return}case"-":{(Ct=A.current.world)==null||Ct.zoomOut();return}case"0":{(ie=A.current.world)==null||ie.goHome();return}case"ArrowRight":{bt.preventDefault(),ft=lt.slice(0),ft[1]=ft[1]+wt,ft[3]=ft[3]+wt;break}case"ArrowLeft":{bt.preventDefault(),ft=lt.slice(0),ft[1]=ft[1]-wt,ft[3]=ft[3]-wt;break}case"ArrowUp":{bt.preventDefault(),ft=lt.slice(0),ft[2]=ft[2]-wt,ft[4]=ft[4]-wt;break}case"ArrowDown":{bt.preventDefault(),ft=lt.slice(0),ft[2]=ft[2]+wt,ft[4]=ft[4]+wt;break}}ft&&Me.applyTransition(ft,{duration:500,easing:Pr.easeOutExpo,constrain:!0})}},De=t.current;return De.addEventListener("keydown",we),()=>{De.removeEventListener("keydown",we)}}return()=>{}},[qe]),{atlasProps:Ae(()=>({children:null,nested:k,responsive:be,viewport:ce,enableNavigator:Ve,onCreated:we=>{Zr(""),p(!0),Hc(we.runtime.id),A.current=we.runtime},homePosition:Ze&&Ze.selector&&Ze.selector.type==="BoxSelector"?Ze.selector.spatial:void 0,renderPreset:$==="static"?["static-preset",{interactive:G}]:["default-preset",{interactive:G,unstable_webglRenderer:$==="webgl",controllerConfig:{ignoreSingleFingerTouch:Le,enablePanOnWait:ke,requireMetaKeyForWheelZoom:J,panOnWaitDelay:Fe}}],width:Y||void 0,height:H||(be?void 0:512),role:Q,title:he}),[be,ce,Ze,$,Ve,y,Q,he]),background:ue,isReady:c,isConfigBlocking:d,setIsReady:p,internalConfig:y,target:Ze,setParsedTarget:at,highlight:mi,highlightCssClass:Be,preferredFormats:ve,render:$,interactive:G,mode:yt,setMode:qt,virtualSizes:B,styleId:Ht,responsive:be,viewport:ce,debug:ne,enableNavigator:Ve,height:H,width:Y,className:z,inlineStyles:Dc,inlineStyleSheet:os,vault:a,nested:k,x:T,y:R,rotation:Ki,homeCover:ot,useProp:qc,useRegisterWebComponentApi:Dl,runtime:A,webComponent:t}}tt(),pe();var Fc=ri(!1);function HI(e){let t=Ml();return fe(()=>{t&&e.onCreated(t)},[t]),null}function Bc(e){var t=e,{children:i,onCreated:r,responsive:n,viewport:a,nested:l}=t,u=le(t,["children","onCreated","responsive","viewport","nested"]);let[c,d]=je(!1),p=Yt(Fc);return l||p?N(rt,null,r?N(HI,{onCreated:r}):null,i):N(Fc.Provider,{value:!0},N(zT,W(C({},u),{onCreated:y=>{if(d(!0),r)return y.runtime.updateNextFrame(),r(y)},unstable_noReconciler:!0}),N(Fc.Provider,{value:!0},c?i:null)))}tt();function Ob(e){var t=e,{children:i}=t,r=le(t,["children"]);let n=ll(),{setIsReady:a,atlasProps:l,isReady:u,className:c}=Fl(r);return N(dn,{vault:n},N(Bc,C({onCreated:()=>{a(!0)},viewport:!0,className:c||""},l),u?N("slot",null,i):null))}if(typeof window<"u"){let e={shadow:!0,onConstruct(t){t._props={__registerPublicApi:i=>{Object.assign(t,i(t))}}}};$n(Ob,"atlas-viewer",[],e),$n(Ob,"layout-container",[],e)}tt(),pe(),tt(),pe();var Mb=()=>()=>({}),jc=ri(Mb);function Da(e,t){let i=xe(),r=Yt(jc)||Mb;i.current!==t&&r(e),i.current=t}tt();var qI=Ue(Jf());pe(),tt(),tt(),pe();var Lb=ri(null);function bn({displayName:e,component:t,customConstructor:i}){let r=ci(function(n,a){var l=n,{children:u}=l,c=le(l,["children"]);let[d,p]=je(),y=Ml(),x=Yt(Lb),E=xe(c);return fe(()=>(y&&y.runtime&&p(i?i(c):new t),()=>{}),[]),fe(()=>{if(y&&y.runtime&&d){let S=y.runtime,k=y.runtime.world,T=x||k;T.appendChild(d),a&&(typeof a=="function"?a(d):a.current=d),d instanceof rs&&(S.world=d),d instanceof Ma||(S.pendingUpdate=!0,S.world&&S.world.needsRecalculate&&(S.world.recalculateWorldSize(),S.world.triggerRepaint()));let R=T,A=d;return()=>{A&&(R.removeChild(A),S.pendingUpdate=!0,S.world&&S.world.needsRecalculate&&(S.world.recalculateWorldSize(),S.world.triggerRepaint()))}}return()=>{}},[d,y==null?void 0:y.runtime]),fe(()=>{d&&y&&y.runtime&&(yc(y.runtime.world,c),mc(d,E.current,c),E.current=c,y.runtime.pendingUpdate=!0,y.runtime.world&&(y.runtime.world.needsRecalculate=!0,y.runtime.world.needsRecalculate&&(y.runtime.world.recalculateWorldSize(),y.runtime.world.triggerRepaint())))},[d,c]),d?N(Lb.Provider,{value:d},u):null});return r.displayName=e,rh(r)}tt(),pe();var QI=e=>{var t=e,{height:i,tiles:r,width:n,x:a,y:l,style:u,skipSizes:c=!1,skipThumbnail:d=!1,rotation:p=0,viewport:y,tileFormat:x,children:E}=t,S=le(t,["height","tiles","width","x","y","style","skipSizes","skipThumbnail","rotation","viewport","tileFormat","children"]);let k=n/r.width,T=r.imageService.tiles||[],R=r.imageService.sizes||[],A=r.imageService.id||r.imageService["@id"],$=Ae(()=>{let B=A;return B&&B.endsWith("/info.json")?B.slice(0,-1*10):B},[A]),z=u&&typeof u.opacity<"u"&&u.opacity!==1;return N(Gs,C({key:$,scale:k,height:r.height,width:r.width,x:a,rotation:p,y:l},S),N(VI,{key:"composite-"+$,id:$,width:r.width,height:r.height,renderOptions:z?{renderLayers:1,renderSmallestFallback:!1}:y?{renderLayers:1,renderSmallestFallback:!0}:{renderLayers:2,renderSmallestFallback:!0}},E,r.thumbnail&&!z&&!d?N(Wa,{uri:r.thumbnail.id,target:{width:r.width,height:r.height},display:{width:r.thumbnail.width,height:r.thumbnail.height},style:u}):null,c?null:R.map((B,H)=>{let{prefix:Y,server:Q,scheme:he,path:G}=my($);return N(Wa,{key:H,uri:_y({scheme:he,server:Q,prefix:Y,identifier:G,type:"image",region:{full:!0},size:{max:!1,upscaled:!1,confined:!1,width:B.width,height:B.height},rotation:{angle:0,mirror:!1},format:"jpg",quality:"default"},r.imageService),target:{width:r.width,height:r.height},display:{width:B.width,height:B.height},style:u})}),T.map(B=>(B.scaleFactors||[]).map(H=>N(GI,{key:`${B}-${H}`,uri:$,display:{width:r.width,height:r.height},tile:B,scaleFactor:H,style:u,format:x})))))};bn({displayName:"Atlas.World",component:rs,customConstructor:e=>new rs(e.width,e.height)});var Gs=bn({displayName:"Atlas.WorldObject",component:Ma}),$b=bn({displayName:"Atlas.Box",component:Hs}),Wa=bn({displayName:"Atlas.SingleImage",component:Gr});bn({displayName:"Atlas.ImageTexture",component:pl});var VI=bn({displayName:"Atlas.CompositeResource",component:pc,customConstructor:e=>new pc({id:e.id,width:e.width,height:e.height,images:[],renderOptions:e.renderOptions})}),GI=bn({displayName:"Atlas.TiledImage",component:is,customConstructor:e=>is.fromTile(e.uri,e.display,e.tile,e.scaleFactor,void 0,e.format)});bn({displayName:"Atlas.Text",component:La}),tt(),pe(),tt(),pe(),pe(),pe(),tt(),pe();var Uc=ci((e,t)=>{var i=e,{children:r}=i,n=le(i,["children"]);let a=xe(),l=vn(),u=xe(0),c=xe(),[d,p]=As(y=>y+1,0);return wc(()=>{if(n.relative){let y=a.current;if(y&&l){let x=l.getScaleFactor();u.current!==x&&(u.current=x,y.style.transformOrigin="0 0",y.style.transform=`scale(${1/u.current})`,y.style.width=`${u.current*100}%`,y.style.height=`${u.current*100}%`)}}},[n.relative]),Et(()=>{let y=c.current;if(!y){let x=setTimeout(p,100);return()=>{clearTimeout(x)}}return t&&y&&(typeof t=="function"?t(y):t.current=y),y&&y.__host?n.relative?Ps(N("div",{ref:a},r),y.__host.element):Ps(r,y.__host.element):y&&(y.__onCreate=()=>{n.relative?Ps(N("div",{ref:a},r),y.__host.element):Ps(r,y.__host.element)}),()=>{}},[d,t,r,c,n.relative]),N($b,C({html:!0,ref:c},n))});tt();var ZI=e=>{var t=e,{handleSize:i=9,resizable:r,onSave:n,children:a}=t,l=le(t,["handleSize","resizable","onSave","children"]);let{portalRef:u,mode:c,mouseEvent:d,isEditing:p}=DT({x:l.x||0,y:l.y||0,width:l.width,height:l.height},n),y=Ae(()=>d("translate"),[d]),x=Ae(()=>d("east"),[d]),E=Ae(()=>d("west"),[d]),S=Ae(()=>d("south"),[d]),k=Ae(()=>d("north"),[d]),T=Ae(()=>d("south-east"),[d]),R=Ae(()=>d("south-west"),[d]),A=Ae(()=>d("north-east"),[d]),$=Ae(()=>d("north-west"),[d]);return N(rt,null,N(Gs,C({},l),a,N(Uc,{ref:u,target:{x:0,y:0,height:l.height,width:l.width},relative:!0,interactive:!1},c==="sketch"&&r?N(rt,null,N("div",{onMouseDown:y,onTouchStart:y,style:{display:"block",width:"100%",height:"100%",border:"1px dashed #999",boxSizing:"border-box",pointerEvents:p?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"east",onTouchStart:x,onMouseDown:x,style:{cursor:"e-resize",position:"absolute",background:"#fff",height:i*2,width:i,right:0,top:"50%",transform:`translate(${i/2}px, -${i}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:p?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"west",onMouseDown:E,style:{cursor:"w-resize",position:"absolute",background:"#fff",height:i*2,width:i,left:0,top:"50%",transform:`translate(-${i/2}px, -${i}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:p?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"north",onMouseDown:k,style:{cursor:"n-resize",position:"absolute",background:"#fff",height:i,width:i*2,left:"50%",top:0,transform:`translate(-${i}px, -${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid rgba(0,0,0,.5)",pointerEvents:p?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"south",onMouseDown:S,style:{cursor:"s-resize",position:"absolute",background:"#fff",height:i,width:i*2,left:"50%",bottom:0,transform:`translate(-${i}px, ${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:p?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"north-east",onMouseDown:A,style:{cursor:"ne-resize",position:"absolute",background:"#fff",height:i,width:i,right:0,top:0,transform:`translate(${i/2}px, -${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:p?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"south-east",onMouseDown:T,style:{cursor:"se-resize",position:"absolute",background:"#fff",height:i,width:i,bottom:0,right:0,transform:`translate(${i/2}px, ${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:p?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"south-west",onMouseDown:R,style:{cursor:"sw-resize",position:"absolute",background:"#fff",height:i,width:i,bottom:0,left:0,transform:`translate(-${i/2}px, ${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:p?"none":c==="sketch"?"initial":"none"}}),N("div",{title:"north-west",onMouseDown:$,style:{cursor:"nw-resize",position:"absolute",background:"#fff",height:i,width:i,top:0,left:0,transform:`translate(-${i/2}px, -${i/2}px)`,zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.5)",border:"1px solid #999",pointerEvents:p?"none":c==="sketch"?"initial":"none"}})):null)))};tt();var Bl=e=>{var t=e,{children:i,interactive:r,region:n,onClick:a,onSave:l,isEditing:u,className:c,style:d}=t,p=le(t,["children","interactive","region","onClick","onSave","isEditing","className","style"]);let y=gc(),x=Qe(E=>{l&&l(C({id:n.id,x:n.x,y:n.y,height:n.height,width:n.width},E))},[l,n.id,n.x,n.y,n.height,n.width]);return N(ZI,{x:n.x,y:n.y,width:n.width,height:n.height,resizable:u,onSave:x,onClick:y==="explore"&&a?E=>{a(n)}:()=>{}},N($b,C({html:!0,className:c,interactive:!0,relativeStyle:!0,target:{x:0,y:0,width:n.width,height:n.height},style:d},p)),i)};tt(),pe(),tt();function Nb({annotationId:e,interactive:t,relative:i}){var r;let n=ac({id:e}),a={fill:"rgba(0,0,0,0)"},l={fill:"rgba(0,0,0,0)"};if(!((r=n==null?void 0:n.motivation)!=null&&r.includes("supplementing"))||!n.body)return null;let u=(Array.isArray(n.body)?n.body:[n.body]).filter(d=>d.type==="TextualBody"),c=n.target.selector;return c?N(rt,null,N("rect",{x:i?0:c.spatial.x,y:i?0:c.spatial.y,width:c.spatial.width,height:c.spatial.height,style:l}),N("text",{x:i?0:c.spatial.x,y:(i?0:c.spatial.y)+c.spatial.height*.75,textLength:c.spatial.width,fontSize:`${c.spatial.height}px`,lengthAdjust:"spacingAndGlyphs",className:"text-line-segment",part:"text-line-segment",style:W(C({},a),{pointerEvents:t?"initial":void 0})},u[0].value||"")):null}function YI({annotation:e,textSelectionEnabled:t}){var i;let r=Ut();return!((i=e==null?void 0:e.motivation)!=null&&i.includes("supplementing"))||!e.body?null:N(Uc,{target:W(C({},e.target.selector.spatial),{x:0,y:0}),interactive:t},N(dn,{vault:r},N("svg",{height:e.target.selector.spatial.height,width:e.target.selector.spatial.width,style:{userSelect:t?"text":void 0}},N(Nb,{annotationId:e.id,interactive:t,relative:!0}))))}var XI=({id:e,style:t,className:i,interactive:r,textSelectionEnabled:n})=>{let a=ac({id:e}),l=ts(a,"atlas"),u=ts(a,"html"),c=al(a,["atlas"]),d=pn(),p=Ae(()=>kv(t,l),[t,l]);return d&&a&&a.target&&a.target.selector&&a.target.selector.type==="BoxSelector"&&a.target.source&&a.target.source.id===d.id?N(Bl,C({id:a.id,isEditing:!0,region:a.target.selector.spatial,style:p,className:(u==null?void 0:u.className)||i,interactive:!!(u!=null&&u.href||r),href:(u==null?void 0:u.href)||null,title:(u==null?void 0:u.title)||null,hrefTarget:(u==null?void 0:u.target)||null},c),N(YI,{annotation:a,textSelectionEnabled:n})):null},zb=({className:e,page:t,textSelectionEnabled:i})=>{var r;let n=ts(t,"atlas"),a=ts(t,"html");return Ai(l=>t.id?l.iiif.entities.AnnotationPage[t.id]:null,[]),N(rt,null,(r=t.items)==null?void 0:r.map(l=>N(XI,{key:l.id,id:l.id,style:n,className:(a==null?void 0:a.className)||e,textSelectionEnabled:i})))};tt(),pe();function KI(){let e=vn(),[t,i]=je(),[r,n]=je();return wc(()=>{e&&(!t||e.focalPosition[1]!==t[1]||e.focalPosition[2]!==t[2]||e.focalPosition[3]!==t[3]||e.focalPosition[4]!==t[4])&&i(new Float32Array(e.focalPosition)),e&&(!r||e.homePosition[1]!==r[1]||e.homePosition[2]!==r[2]||e.homePosition[3]!==r[3]||e.homePosition[4]!==r[4])&&n(new Float32Array(e.homePosition))},[t,r]),N(rt,null,t?N(Bl,{id:"focal",onClick:()=>{},onSave:()=>{},isEditing:!1,className:"test",region:{id:"focal",x:t[1],y:t[2],width:t[3]-t[1],height:t[4]-t[2]},style:{backgroundColor:"rgba(0, 0, 244, 0.5)"}}):null,r?N(Bl,{id:"home",onClick:()=>{},onSave:()=>{},isEditing:!1,className:"test",region:{id:"home",x:r[1],y:r[2],width:r[3]-r[1],height:r[4]-r[2]},style:{backgroundColor:"rgba(0, 200, 0, 0.5)"}}):null)}pe(),tt();function JI(e,t){let i=cn(e.id||e["@id"]||"").slice(0,-10);return!i||t.percentScale||!t.width||t.confined||!e.height||!e.width?[null,{height:0,width:0}]:[[i,"full",WT(t),"0","default.jpg"].join("/"),{width:t.width||1,height:t.confined?e.height/e.width*t.width:t.height||e.height/e.width*t.width}]}pe(),pe();function Fb({id:e,image:t,thumbnail:i,isStatic:r,virtualSizes:n=[],x:a=0,y:l=0,rotation:u=0,annotations:c,tileFormat:d,skipSizes:p,annotationId:y,skipThumbnail:x}){var E,S,k,T;let R=ts(y?{id:y,type:"Annotation"}:void 0,"atlas"),A=ts({id:e,type:"ContentResource"},"atlas"),$=Ae(()=>C(C({},R),A),[R,A]),z=al(y?{id:y,type:"Annotation"}:void 0,["atlas"]),B=al({id:e,type:"ContentResource"},["atlas"]);return N(te.Fragment,null,t.service?N(rt,{key:"service"},N(QI,C(C({viewport:r,tiles:{id:t.service.id,height:t.height!==t.service.height?t.service.height:t.height,width:t.width!==t.service.width?t.service.width:t.width,imageService:t.service,thumbnail:!x&&i&&i.type==="fixed"?i:void 0},skipSizes:p,skipThumbnail:x,x:((E=t.target)==null?void 0:E.spatial.x)+a,y:((S=t.target)==null?void 0:S.spatial.y)+l,rotation:u,width:(k=t.target)==null?void 0:k.spatial.width,height:(T=t.target)==null?void 0:T.spatial.height,style:$,tileFormat:d},z),B),t.service&&n.map(H=>{if(t.service){let[Y,{height:Q,width:he}]=JI(t.service,H);return Y?N(Wa,{priority:!0,style:$,key:Y,uri:Y,target:t.target.spatial,display:{height:Q,width:he}}):null}return null})),c):N(rt,{key:"no-service"},N(Wa,C(C({style:$,uri:t.id,target:t.target.spatial,display:t.width&&t.height?{width:t.width,height:t.height}:void 0},z),B)),c))}tt(),pe();function eR(){let[e,{addAnnotation:t,removeAnnotation:i}]=tC(),r=Ut(),n=UC(),a=xe([]),l=e==null?void 0:e.id,u=Ae(()=>Sc(r),[r]);return Da(()=>({annotations:{add(c){t(c)},get(c){if(l){let d=(r.get({id:l,type:"AnnotationPage"}).items||[]).find(p=>p.id===c);return d?r.get(d):null}return null},getSource(c){return a.current[c]||null},getAll(){if(l){let c=r.get({id:l,type:"AnnotationPage"});return c?r.get(c.items)||[]:[]}return[]},remove(c){i(c)},applyStyles(c){l&&n.applyStyles(l,"atlas",c)},addEventListener(c,d){if(l)return u.addEventListener({id:l,type:"AnnotationPage"},c,d)},applyHTMLProperties(c){l&&n.applyStyles(l,"html",c)}}}),l),[e,{addAnnotation:t,removeAnnotation:i}]}pe();var Bb=ri(null);function tR(){let e=Yt(Bb);return[e.fullPage,{addAnnotation:e.addAnnotation,removeAnnotation:e.removeAnnotation}]}function jb({children:e}){let[t,{addAnnotation:i,removeAnnotation:r}]=eR();return N(Bb.Provider,{value:Ae(()=>({fullPage:t,addAnnotation:i,removeAnnotation:r}),[t])},e)}tt();function iR({media:e,children:t}){let[{element:i,currentTime:r,progress:n},a,l]=Hy({duration:e.duration});return Da(u=>(u.mediaActions=l,u.mediaElement=i,u.setMediaProgressElement=c=>{n.current=c},u.dispatchEvent(new Event("media-displayed")),u.dispatchEvent(new Event("audio-displayed")),{}),e.url),N(NC,{state:a,actions:l,currentTime:r,progress:n,element:i},N("video",{ref:i,src:e.url}),t)}tt();function rR({media:e}){let[{element:t,currentTime:i,progress:r},n,a]=Hy({duration:e.duration}),l=a.playPause;return Da(u=>(u.mediaActions=a,u.mediaElement=t,u.setMediaProgressElement=c=>{r.current=c},u.dispatchEvent(new Event("media-displayed")),u.dispatchEvent(new Event("audio-displayed")),{}),e.url),N("div",{className:"video-container",part:"video-container",onClick:l},N("style",null,`
            .video-container {
              position: absolute;
              top: 0;
              bottom: 0;
              left: 0;
              right: 0;
              background: #000;
              z-index: 13;
              display: flex;
              justify-content: center;
              pointer-events: visible;
            }
          `),N("video",{ref:t,src:e.url,style:{width:"100%",objectFit:"contain"}}))}tt();function nR({annotationPageId:e,selectionEnabled:t}){let i=jC({id:e}),r=pn(),n=Ut(),a=ts(i,"text-lines");return!i||!i.items||!r?null:N(Gs,C({},{x:0,y:0,width:r.width,height:r.height}),N(Uc,{target:{x:0,y:0,width:r.width,height:r.height}},N(dn,{vault:n},N("svg",{tabindex:0,"aria-name":"","aria-live":"off","aria-atomic":"true","aria-relevant":"all","aria-expanded":"true",role:"article",style:W(C({},a),{userSelect:"text"}),width:r.width,height:r.height},i.items.map(l=>N(Nb,{key:`line-${l.id}`,annotationId:l.id,interactive:t}))))))}function sR(e,t){let i=[],r={};for(let n of e){let a={},l=[],u=t.get(n),c=(u==null?void 0:u.items)||[];for(let d of c){let p=t.get(d);if(p.motivation)for(let y of p.motivation)l.includes(y)||l.push(y),a[y]=a[y]?a[y]:[],a[y].push(p.id)}i.push({typeMap:a,allTypes:l,id:n});for(let d of l)r[d]=r[d]||[],r[d].push(n)}return{pagesWithTypes:i,pageMapping:r}}function Ub({x:e,y:t,highlight:i,annoMode:r,onCreated:n,debug:a,virtualSizes:l,highlightCssClass:u,defaultChoices:c,isStatic:d,textSelectionEnabled:p,textEnabled:y,disableThumbnail:x,skipSizes:E,rotation:S}){var k;let T=fn(),R=pn(),A=al(R,["deep-zoom"]),[$]=tR(),z=Ut(),B=Ae(()=>Ec(z),[z]),[H,Y]=kC({strategies:["images","media"],defaultChoices:c==null?void 0:c.map(({id:re})=>re)}),Q=lc((T==null?void 0:T.id)||(R==null?void 0:R.id)),he=Ai((re,Te)=>Q.availablePageIds.map(Oe=>Te.get(Oe)),[...Q.availablePageIds]);fe(()=>{let re=dI(z);if(R!=null&&R.id){let Te=(c==null?void 0:c.map(({id:qe})=>qe))||[],Oe=re.getAllPaintingAnnotations(R.id);for(let qe of Oe){if(qe.type!=="Annotation")throw new Error("getPaintables() accept either a canvas or list of annotations");let ne=Array.from(Array.isArray(qe.body)?qe.body:[qe.body]);for(let ke of ne){let[Le,{selector:J}]=By(ke),Fe=z.get(Le);if((Fe.type||"unknown").toLowerCase()!=="choice")continue;let Ve=z.get(Fe.items),Ze=Te.length?Te.map(at=>Ve.find(Xt=>Xt.id===at)).filter(Boolean):[Ve[0]];Ze.length===0&&Ze.push(Ve[0]);let Pt={type:"single-choice",items:Ve.map(at=>({id:at.id,label:at.label,selected:Ze.indexOf(at)!==-1})),label:Le.label};as.emit("onChoiceChange",{choice:Pt,partOf:{canvasId:R.id,choiceId:Fe.id,manifestId:T==null?void 0:T.id}})}}re.extractChoices(R.id)}},[R==null?void 0:R.id,Y,c]);let G=Ae(()=>sR(Q.availablePageIds,z),he),ue=(k=G.pageMapping.supplementing)!=null&&k.length?G.pageMapping.supplementing[0]:null;fe(()=>{let re=as.on("onMakeChoice",Te=>{Y.makeChoice(Te.id,Te.options)});return()=>{re()}},[Y]),fe(()=>{if(y){let re=[];for(let Te of Q.availablePageIds)z.requestStatus(Te)||re.push(z.load(Te))}},[R==null?void 0:R.id,y]),fe(()=>{if(c)for(let re of c)typeof re.opacity<"u"&&B.applyStyles({id:re.id},"atlas",{opacity:re.opacity})},[c]);let ce=TC({maxWidth:256,maxHeight:256});if(!R)return null;if(H.type==="media"){if(H.media.type!=="Sound"&&H.media.type!=="Video")throw new Error("Unknown media type");return N(Gs,C({key:H.type,height:R.height||1e3,width:R.width||1e3,x:e,y:t},A),H.media.type==="Sound"?N(iR,{media:H.media}):null,H.media.type==="Video"?N(rR,{media:H.media}):null)}if(H.type==="unknown"){if(ce&&ce.type==="fixed")return N(Gs,{height:R.height,width:R.width,x:e,y:t},N(Wa,{uri:ce.id,target:{x:0,y:0,width:R.width,height:R.height},display:ce.width&&ce.height?{width:ce.width,height:ce.height}:void 0}));throw new Error("Unknown image strategy")}let be=N(rt,null,r?N(Sv,{onCreate:re=>{n&&n(re)}}):null,i&&i.selector&&i.selector.type==="BoxSelector"?N(Bl,{id:"highlight",isEditing:!0,onClick:()=>{},onSave:()=>{},region:i.selector.spatial,style:u?void 0:{border:"3px solid red"},className:u}):null,$?N(zb,{page:$,textSelectionEnabled:p}):null,H.annotations&&H.annotations.pages?H.annotations.pages.map(re=>N(zb,{key:re.id,page:re,textSelectionEnabled:p})):null,a?N(KI,null):null,y&&ue?N(nR,{annotationPageId:ue,selectionEnabled:p}):null);return N(Gs,C({key:H.type,height:R.height,width:R.width,x:e,y:t},A),H.type==="images"?H.images.map((re,Te)=>N(Fb,{isStatic:d,key:re.id,image:re,id:re.id,rotation:S,annotationId:re.annotationId,thumbnail:Te===0&&!x?ce:void 0,virtualSizes:l,annotations:be,skipSizes:E,skipThumbnail:x})):null)}pe(),tt(),pe();function jl({error:e,resetErrorBoundary:t,aspectRatio:i,height:r=512,width:n}){let a=i?{paddingTop:`${i*100}%`}:{height:r,width:n};return fe(()=>{console.error(e)},[e]),N("slot",{name:"fallback"},N("div",{role:"alert",style:C({background:"#000",color:"#fff",display:"flex",flexDirection:"column",alignContent:"center",justifyContent:"center",fontFamily:"monospace"},a)},N("div",{style:{padding:"1em",textAlign:"center"}},N("img",{className:"img-oops",part:"image-oops",width:11*3,height:8*3,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAICAYAAAAvOAWIAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAC6ADAAQAAAABAAAACAAAAADGHiDWAAAAO0lEQVQYGWP4DwQMQACjQWxkABOH0TgVwjRhKIQLwFRAaZg4jEaTphKXEWYOPmsYgQCmjnQPwnXiYQAAP/M3zvinPKAAAAAASUVORK5CYII="}),N("h2",null,"Unable to load image"),N("pre",null,e==null?void 0:e.message),t?N("button",{style:{color:"#fff",border:"2px solid #fff",background:"#000",fontFamily:"monospace",padding:"0.25em 1em"},onClick:t},"Try again"):null,N("style",null,".img-oops { border: 3px solid white; padding: 15px; image-rendering: auto; image-rendering: crisp-edges; image-rendering: pixelated; margin-bottom: 10px; }"))))}function aR(e,t){var i=e,{unit:r}=i,n=le(i,["unit"]);return r==="percent"?{x:t.width*(n.x/100),y:t.height*(n.y/100),width:t.width*(n.width/100),height:t.height*(n.height/100)}:n}tt(),pe();var oR=ic;function lR(e){let t=Iy(),i=RP(),r=nc(),n=xe(!1),a=xe();Da(c=>(a.current=c,c.sequence=i,n.current||(n.current=!0,c.dispatchEvent(new CustomEvent("sequence",{detail:i}))),{}),[i]),fe(()=>{a.current&&(as.emit("onResetSeen"),a.current.dispatchEvent(new CustomEvent("sequence-change",{detail:{index:i.currentSequenceIndex,total:i.sequence.length}})))},[i.currentSequenceIndex,r]);let l=0,u=t.map((c,d)=>{let p=l;return l+=c.width+(e.margin||0),N(oR,{key:c.id,canvas:c.id},N(Ub,W(C({key:c.id},e),{x:p})))});return N(rt,null,u)}var uR=qI.ErrorBoundary;function Db(e){let t=Ut(),i=es(),r=pn(),n=fn(),a=lc((n==null?void 0:n.id)||(r==null?void 0:r.id)),[l,u]=je(!1),c=e.rotation||0,d=!e.displayOptions.viewport&&r?e.displayOptions.homePosition?e.displayOptions.homePosition.width/e.displayOptions.homePosition.height:r.width/r.height:void 0;Da(S=>a?(S.annotationPageManager||(S.annotationPageManager={}),S.annotationPageManager.availablePageIds=a.availablePageIds,S.annotationPageManager.enabledPageIds=a.enabledPageIds,S.annotationPageManager.setPageEnabled=a.setPageEnabled,S.annotationPageManager.setPageDisabled=a.setPageDisabled,{}):{},[a.availablePageIds,a.enabledPageIds,a.setPageEnabled,a.setPageDisabled].join("/")),Et(()=>{e.followAnnotations!==!1&&a.availablePageIds.map(S=>{t.requestStatus(S)||t.load(S)})},[a.availablePageIds,e.followAnnotations]),Ai(S=>i.canvas?S.iiif.entities.Canvas[i.canvas]:null,[]);let[p,y]=Ae(()=>{let S=e.displayOptions,{width:k,height:T,homePosition:R,containerProps:A}=S,$=le(S,["width","height","homePosition","containerProps"]),z=e.displayOptions.homePosition&&r?aR(e.displayOptions.homePosition,r):null;return z&&($.homePosition=z),k&&($.width=k),T&&($.height=T),[$,A]},[e.displayOptions,r]),x=S=>{S.altKey&&S.code==="KeyB"&&u(!0)},E=e.renderMultiple?lR:Ub;return N(uR,{fallbackRender:S=>N(jl,C({height:p.height,width:p.width,aspectRatio:d},S))},N(Bc,W(C({key:e.renderMultiple?"":r==null?void 0:r.id,aspectRatio:d,containerProps:C({onKeyDown:x},y||{}),className:e.className,background:e.background},p),{mode:l?"sketch":e.mode,homeCover:e.homeCover,homeOnResize:!!e.homeCover}),N(E,{isStatic:!e.interactive,debug:e.debug,virtualSizes:e.virtualSizes,highlight:e.highlight,highlightCssClass:e.highlightCssClass,annoMode:l,defaultChoices:e.defaultChoices,disableThumbnail:e.disableThumbnail,skipSizes:e.skipSizes,rotation:c,onCreated:S=>{n&&r&&S&&navigator.clipboard.writeText($l({id:`${r.id}#xywh=${S.x},${S.y},${S.width},${S.height}`,type:"Canvas",partOf:[{id:n.id,type:"Manifest"}]})),u(!1)},x:e.x,y:e.y,textSelectionEnabled:e.textSelectionEnabled,textEnabled:e.textEnabled,margin:e.margin}),e.children))}tt();function hR(e){return N("svg",C({width:"1em",height:"1em",viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",stroke:"#000"},e),N("g",{transform:"translate(1 1)",strokeWidth:2,fill:"none",fillRule:"evenodd"},N("circle",{strokeOpacity:.5,cx:18,cy:18,r:18}),N("path",{d:"M36 18c0-9.94-8.06-18-18-18"},N("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"1s",repeatCount:"indefinite"}))))}tt(),pe();var cR=({manifestId:e,children:t})=>{let{manifest:i,isLoaded:r,error:n}=nl(e,{});return fe(()=>{n&&console.error(n)},[n]),n?N(jl,{error:new Error(`Unable to load Manifest: ${e} 
 
 ${n.toString()}`)}):!r||!i?N(hR,null):N(sl,{manifest:i.id},t)};pe();var Wb=["width","height","target","region","highlight","highlight-css-class","disable-keyboard-navigation","click-to-enable-zoom","preferred-formats","atlas-mode","style-id","debug","preset","responsive","interactive","class","move-events","granular-move-events","a11y-title","a11y-role"],dR=[...Wb,"manifest-id","canvas-id","choice-id","text-selection-enabled","disable-thumbnail","text-enabled","follow-annotations","iiif-content","home-cover","rotation","background"],fR=e=>{let{vault:t,webComponent:i,runtime:r,atlasProps:n,isConfigBlocking:a,setParsedTarget:l,highlight:u,highlightCssClass:c,virtualSizes:d,viewport:p,debug:y,mode:x,interactive:E,x:S,y:k,homeCover:T,className:R,inlineStyles:A,inlineStyleSheet:$,useProp:z,useRegisterWebComponentApi:B,setMode:H,background:Y}=Fl(e),[Q,he]=je(void 0),G=xe([]),[ue,ce]=je(),[be,,re]=z("iiifContent",{parse:zl}),[Te,Oe,,qe]=z("canvasId"),[ne,ke,,Le]=z("rotation",{parse:Cr,defaultValue:0}),[J,Fe,,Ve]=z("manifestId"),[Ze]=z("followAnnotations",{parse:pt,defaultValue:!0}),[Pt,,,at]=z("choiceId",{parse:ZT}),[Xt]=z("textSelectionEnabled",{parse:pt,defaultValue:!0}),[Ki]=z("disableThumbnail",{parse:pt,defaultValue:!1}),[cr]=z("skipSizes",{parse:pt,defaultValue:!1}),[Ir]=z("textEnabled",{parse:pt,defaultValue:!1}),mi=be&&be.type!=="remote-content-state"?be:null,Wt=be&&be.type==="remote-content-state"?be.id:null,Ji=Qe(ve=>{i.current&&(as.emit("onResetSeen"),i.current.dispatchEvent(new CustomEvent("canvas-change",{detail:{canvas:ve}})))},[]),Ht=Qe(ve=>{if(Q){let Pe={id:`${Te}#xywh=${Ll(ve.x)},${Ll(ve.y)},${ve.width},${ve.height}`,type:"Canvas",partOf:[{id:J,type:"Manifest"}]},ot={contentState:Pe,normalisedContentState:qs(Pe),encodedContentState:$l(Pe),selection:{type:"BoxSelector",spatial:ve}};G.current.push(ot),Q(ot)}},[Q,J,Te]);if(B(ve=>({vault:t,setCanvas:Pe=>{ve.setAttribute("canvas-id",Pe)},setManifest:Pe=>{ve.setAttribute("manifest-id",Pe)},setDefaultChoiceIds:Pe=>{ve.setAttribute("choice-id",Pe.join(","))},getDefaultChoiceIds(){return(at.current||[]).map(({id:Pe})=>Pe)},getCanvasId(){return qe.current},getContentState(){var Pe,ot,yt,qt;let Kt=Ve!=null&&Ve.current?Ve==null?void 0:Ve.current:J,Zr={id:`${qe!=null&&qe.current?qe==null?void 0:qe.current:Te}#xywh=${(Pe=r.current)==null?void 0:Pe.x},${(ot=r.current)==null?void 0:ot.y},${(yt=r.current)==null?void 0:yt.width},${(qt=r.current)==null?void 0:qt.height}`,type:"Canvas",partOf:[{id:Kt,type:"Manifest"}]};return{contentState:Zr,normalisedContentState:qs(Zr),encodedContentState:$l(Zr)}},getPosition(){var Pe,ot,yt,qt;return{x:(Pe=r.current)==null?void 0:Pe.x,y:(ot=r.current)==null?void 0:ot.y,width:(yt=r.current)==null?void 0:yt.width,height:(qt=r.current)==null?void 0:qt.height}},getManifestId(){return Ve.current},disableTextSelection(){ve.setAttribute("text-selection-enabled","false")},enableTextSelection(){ve.setAttribute("text-selection-enabled","true")},enableText(){ve.setAttribute("text-enabled","true")},disableText(){ve.setAttribute("text-enabled","true")},easingFunctions(){return Pr},getContentStateStack(){return G.current},transition(Pe){var ot,yt;(ot=r.current)!=null&&ot.transitionManager&&Pe((yt=r.current)==null?void 0:yt.transitionManager)},enableContentStateSelection(Pe){H("sketch"),he(ot=>ot||Pe)},disableContentStateSelection(){he(void 0),H("explore"),G.current=[]},setContentStateFromText(Pe,ot=!1){if(Pe==null||Pe.trim()==="")return;let yt=qs(Nl(Pe));yt.immediate=ot;let qt=yt.target[0];qe.current===qt.source.id?r.current&&yt.target&&yt.target[0]&&yt.target[0].selector&&yt.target[0].selector.type==="BoxSelector"&&r.current.world.gotoRegion(W(C({},yt.target[0].selector.spatial),{immediate:ot})):re(yt)}})),Et(()=>{Wt&&!ue&&fetch(Wt).then(ve=>ve.json()).then(ve=>{re(zl(ve))}).catch(ve=>{console.error(ve),ce(new Error(`Failed to load content state from ${Wt} 

 ${ve.toString()}`))})},[Wt,ue]),Et(()=>{if(mi&&mi.target.length){let ve=mi.target[0];if(ve.type==="SpecificResource"&&ve.source.type==="Canvas"){let Pe=(ve.source.partOf||[]).find(ot=>ot.type==="Manifest");if(Oe(ve.source.id),Pe&&Fe(Pe.id),ve.selector&&r.current&&i.current)if(ve.selector.type==="BoxSelector"){let{x:ot,y:yt,width:qt,height:Kt}=ve.selector.spatial;r.current.world.gotoRegion({x:ot,y:yt,width:qt,height:Kt,immediate:mi.immediate})}else l(ve)}}},[mi]),fe(()=>{Ji(Te)},[Te]),a)return null;if(ue)return N(jl,{error:ue,resetErrorBoundary:()=>ce(null)});let Be=Te?N(ic,{canvas:Te},N(Db,{key:`${Te}-${p?"v1":"v0"}`,interactive:E,defaultChoices:Pt,followAnnotations:Ze,className:R,highlight:u,debug:y,background:Y,virtualSizes:d,highlightCssClass:c,canvasId:Te,displayOptions:n,mode:x,rotation:ne||0,x:S,y:k,textEnabled:Ir,textSelectionEnabled:Xt,disableThumbnail:Ki,skipSizes:cr,homeCover:T},N("slot",{name:"atlas"}),Q?N(Sv,{onCreate:Ht}):null),N("slot",null)):null;return N(jc.Provider,{value:e.__registerPublicApi},N(dn,{vault:t},N(jb,null,J?N(cR,{manifestId:J},Be):Be)),A?N("style",null,A):null,$?N("link",{rel:"stylesheet",href:$}):null)};typeof window<"u"&&$n(fR,"canvas-panel",dR,{shadow:!0,onConstruct(e){Object.defineProperty(e,"vault",{get(){return e._props.vault},set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),tt(),pe();var pR=Ue(Jf()),gR=pR.ErrorBoundary;function mR(e){let{atlasProps:t,isConfigBlocking:i,setIsReady:r,virtualSizes:n,height:a,width:l,className:u,inlineStyles:c,inlineStyleSheet:d,viewport:p,vault:y,useProp:x,interactive:E,x:S,y:k,homeCover:T,background:R}=Fl(e),[A]=x("src"),[$]=x("nested",{parse:pt}),[z]=x("rotation",{parse:Cr}),[B,H]=x("tileFormat"),[Y]=x("skipSizes",{parse:pt}),[Q]=x("disableThumbnail",{parse:pt}),[he,G]=Dy(),ue=G[A],ce=Ae(()=>{let re=he({id:A},{});return re&&re.preferredFormats&&re.preferredFormats.length===1&&H(re.preferredFormats[0]),re&&re.height&&re.width&&ue!=="loading"?{id:A,width:re.width,height:re.height,service:re,type:"Image",selector:{type:"BoxSelector",spatial:{x:0,y:0,width:re.width,height:re.height}},target:{type:"BoxSelector",spatial:{x:0,y:0,width:re.width,height:re.height}}}:null},[he,A,G]);if(!ce||!ce.height||!ce.width||i)return null;let be=p?void 0:t.homePosition?t.homePosition.width/t.homePosition.height:ce.width/ce.height;return N(gR,{fallbackRender:re=>N(jl,C({height:a,width:l,aspectRatio:be},re))},N(dn,{vault:y},N(Bc,C({onCreated:()=>{r(!0)},viewport:!0,aspectRatio:be,className:u,nested:$,homeCover:T,background:R,homeOnResize:!!T,rotation:z},t),N(Fb,{key:ce.id,image:ce,id:ce.id,isStatic:!E,virtualSizes:n,skipSizes:Y,skipThumbnail:Q,x:S,y:k,rotation:z,tileFormat:B}))),c?N("style",null,c):null,d?N("link",{rel:"stylesheet",href:d}):null,e.children?N("slot",null,e.children):null)}function yR(e){let t=Ae(()=>new il,[]);return N(Uy.Provider,{value:t},N(mR,C({},e)))}typeof window<"u"&&$n(yR,"image-service",["src","nested","x","y","width","height","target","region","highlight","highlight-css-class","text-selection-enabled","disable-keyboard-navigation","click-to-enable-zoom","preferred-formats","atlas-mode","style-id","debug","preset","responsive","interactive","iiif-content","class","choice-id","move-events","granular-move-events","home-cover","tile-format","rotation","background"],{shadow:!0,onConstruct(e){e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),tt(),pe();var vR=[...Wb,"manifest-id","range-id","start-canvas","paging-enabled","text-selection-enabled","text-enabled","follow-annotations","margin","background"];function bR(e){let{vault:t,webComponent:i,runtime:r,atlasProps:n,isConfigBlocking:a,highlight:l,highlightCssClass:u,virtualSizes:c,viewport:d,debug:p,mode:y,interactive:x,className:E,inlineStyles:S,inlineStyleSheet:k,useProp:T,useRegisterWebComponentApi:R,background:A}=Fl(e),[$,z,,B]=T("manifestId"),[H,,,Y]=T("rangeId"),[Q,he,,G]=T("startCanvas"),[ue]=T("margin",{parse:Cr,defaultValue:0}),[ce]=T("pagingEnabled",{parse:pt,defaultValue:!0}),[be]=T("textSelectionEnabled",{parse:pt,defaultValue:!0}),[re]=T("textEnabled",{parse:pt,defaultValue:!1}),[Te]=T("followAnnotations",{parse:pt,defaultValue:!0}),[Oe,,qe]=T("iiifContent",{parse:zl}),ne=Oe&&Oe.type!=="remote-content-state"?Oe:null,ke=Oe&&Oe.type==="remote-content-state"?Oe.id:null,[Le,J]=je(),[Fe]=T("skipSizes",{parse:pt,defaultValue:!1});return R(Ve=>({vault:t,setManifest:Ze=>{Ve.setAttribute("manifest-id",Ze)},setRange:Ze=>{Ve.setAttribute("range-id",Ze)},getRangeId(){return Y.current},getContentState(){let Ze=B!=null&&B.current?B==null?void 0:B.current:$,Pt=i.current.sequence,at=Pt.items[Pt.sequence[Pt.currentSequenceIndex][0]].id,{x:Xt,y:Ki,width:cr,height:Ir}=(r==null?void 0:r.current)||{},mi={id:`${at}#xywh=${Ll(Xt)},${Ll(Ki)},${cr},${Ir}`,type:"Canvas",partOf:[{id:Ze,type:"Manifest"}]};return{contentState:mi,normalisedContentState:qs(mi),encodedContentState:$l(mi)}},setContentStateFromText(Ze,Pt=!1){if(Ze==null||Ze.trim()==="")return;let at=qs(Nl(Ze));at.immediate=Pt,qe(at)},getManifestId(){return B.current},disableTextSelection(){Ve.setAttribute("text-selection-enabled","false")},enableTextSelection(){Ve.setAttribute("text-selection-enabled","true")},enableText(){Ve.setAttribute("text-enabled","true")},disableText(){Ve.setAttribute("text-enabled","true")}})),Et(()=>{ke&&!Le&&fetch(ke).then(Ve=>Ve.json()).then(Ve=>{qe(zl(Ve))}).catch(Ve=>{console.error(Ve),J(new Error(`Failed to load content state from ${ke} 

 ${Ve.toString()}`))})},[ke,Le]),Et(()=>{var Ve;if(ne&&ne.target.length){let Ze=ne.target[0];if(Ze.type==="SpecificResource"&&Ze.source.type==="Canvas"){let Pt=(Ze.source.partOf||[]).find(at=>at.type==="Manifest");if(i.current.sequence.setCurrentCanvasId(Ze.source.id),Pt&&z(Pt.id),Ze.selector&&Ze.selector.type==="BoxSelector"){let{x:at,y:Xt,width:Ki,height:cr}=Ze.selector.spatial;(Ve=r==null?void 0:r.current)==null||Ve.world.gotoRegion({x:at,y:Xt,width:Ki,height:cr,immediate:ne.immediate})}}}},[ne]),!$||a?null:N(jc.Provider,{value:e.__registerPublicApi},N(dn,{vault:t},N(jb,null,N(IP,{manifest:$,startCanvas:Q,rangeId:H,pagingEnabled:ce},N(Db,{renderMultiple:!0,key:`${Q}-${d?"v1":"v0"}`,background:A,interactive:x,followAnnotations:Te,className:E,highlight:l,debug:p,virtualSizes:c,highlightCssClass:u,displayOptions:n,mode:y,textEnabled:re,skipSizes:Fe,textSelectionEnabled:be,margin:ue},N("slot",{name:"atlas"})),N("slot",null)))),S?N("style",null,S):null,k?N("link",{rel:"stylesheet",href:k}):null)}typeof window<"u"&&$n(bR,"sequence-panel",vR,{shadow:!0,onConstruct(e){Object.defineProperty(e,"vault",{get(){return e._props.vault},set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),tt(),pe(),tt();var wR=({metadata:e=[],config:t,variation:i="table",labelWidth:r=16,bordered:n,labelStyle:a,showEmptyMessage:l,allowHtml:u,separator:c})=>{let d={separator:c},p=Ae(()=>{let y=(t||[]).reduce((E,S)=>[...E,...S.keys],[]),x={};for(let E of e){let S=E&&E.label?Object.values(E.label):[];for(let k of S)if(k&&k.length&&(y.indexOf(`metadata.${k[0]}`)!==-1||y.length===0)&&E){let T=`metadata.${k[0]}`;x[T]=x[T]?x[T]:[],x[T].push(E);break}}return x},[t,e]);return Object.keys(p).length===0&&l?N("slot",{name:"empty"}):t&&t.length?N("table",{"data-variation":i,"data-label-style":a,"data-bordered":n},N("slot",{slot:"header"}),N("tbody",null,t.map((y,x)=>{let E=[];for(let S of y.keys)for(let k of p[S]||[])E.push(N("div",{key:x+"__"+S},u?N("span",{dangerouslySetInnerHTML:{__html:Tr(k.value,d)}}):Tr(k.value,d)));return E.length===0?null:N("tr",{className:"metadata-row",key:x},N("td",{className:"metadata-key",style:r?{minWidth:r}:{}},u?N("span",{dangerouslySetInnerHTML:{__html:Tr(y.label,d)}}):Tr(y.label,d)),N("td",{className:"metadata-value"},E))})),N("slot",{name:"footer"})):N("table",{"data-variation":i,"data-label-style":a,"data-bordered":n},N("slot",{name:"header"}),N("tbody",null,e&&e.length?e.map((y,x)=>y?N("tr",{className:"metadata-row",key:x},N("td",{className:"metadata-key",style:r?{minWidth:r}:{}},u?N("span",{dangerouslySetInnerHTML:{__html:Tr(y.label,d)}}):Tr(y.label,d)),N("td",{className:"metadata-value"},u?N("span",{dangerouslySetInnerHTML:{__html:Tr(y.value,d)}}):Tr(y.value,d))):null):N("slot",{name:"empty-table"})),N("slot",{name:"footer"}))};function xR(e){let t=ll(),i=e.vault||t||zc(),[r]=He(e.manifestId),[n]=He(e.variation),[a]=He(e.labelStyle),[l]=He(e.separator),[u]=He(e.labelWidth,{parse:Cr}),[c]=He(e.bordered,{parse:pt,defaultValue:!1}),[d]=He(e.allowHtml,{parse:pt,defaultValue:!1}),[p]=He(e.showEmptyMessage,{parse:pt,defaultValue:!1});return r?N(rt,null,N(dn,{vault:i},N(sl,{manifest:r},N(_R,{manifestId:r,variation:n,labelStyle:a,labelWidth:u,bordered:c,showEmptyMessage:p,allowHtml:d,separator:l})))):N("slot",{name:"no-manifest"})}function _R(e){let{manifest:t}=nl(e.manifestId);return N(wR,W(C({},e),{metadata:t==null?void 0:t.metadata}))}var SR=["manifest-id","config-id","variation","label-style","label-width","bordered","show-empty-message"];typeof window<"u"&&$n(xR,"metadata-panel",SR,{shadow:!1,onConstruct(e){Object.defineProperty(e,"vault",{get(){return e._props.vault},set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}}),tt(),pe(),tt();function Hb(e){var t;let i=nc(),r=Ut(),n=Ae(()=>i==null?void 0:i.items.find(c=>c.type==="Canvas"),[i]),a=Ae(()=>!!(i!=null&&i.items.find(c=>c.type==="Range")),[i]),l=e.selected&&e.selected===(i==null?void 0:i.id);function u(){var c,d;if(i&&e.onRangeClick){let p={isLeaf:!a};if(n){let[y,x]=(c=n.id)==null?void 0:c.split("#");p.selector=n.id,p.canvasId=y,p.fragment=x}else if(i){let y=ob(r,i);if(y){let[x,E]=(d=y.id)==null?void 0:d.split("#");p.selector=y.id,p.canvasId=x,p.fragment=E}}if(p.selector)try{p.parsedSelector=Ic(p.selector)}catch{}e.onRangeClick(i,p)}}return i?N("ul",{className:"range-item-container","data-leaf":!a,"data-selected":l,"data-with-selector":((t=n==null?void 0:n.id)==null?void 0:t.indexOf("#"))!==-1,"data-range-id":i.id},i.label?N("li",{className:"range-split",onClick:u},N("span",{className:"range-label"},Tr(i.label))):null,a?N("div",{className:"range-nested-container"},i.items.map(c=>c.type==="Canvas"||c.type==="SpecificResource"||!c.id?null:N(rc,{key:c.id,range:c.id},N(Hb,{onRangeClick:e.onRangeClick,selected:e.selected})))):null):null}tt(),pe();function ER(e){let t=fn(),i=Ut();if(!t)throw new Error("No manifest");let r=e.canvasId?fI(i,t,e.canvasId):e.selectedRange?i.get(e.selectedRange):void 0;return Et(()=>{if(r&&e.autoScroll){let n=document.querySelector(`[data-range-id="${r.id}"]`);n&&n.scrollIntoView({block:"nearest",behavior:"auto"})}},[r]),!t||!t.structures.length?N("slot",{name:"no-range"}):N(rt,null,r?N("div",{className:"range-current"},Tr(r.label)):null,t.structures.map(n=>N(rc,{key:n.id,range:n.id},N(Hb,{selected:r==null?void 0:r.id,onRangeClick:e.onRangeClick}))))}pe();function AR(e){let t=ll(),i=e.vault||t||zc(),[r]=He(e.manifestId),[n]=He(e.canvasId),[a]=He(e.selectedRange),[l]=He(e.autoScroll,{parse:pt,defaultValue:!0}),[u,c]=je();if(Et(()=>{e.__registerPublicApi&&e.__registerPublicApi(p=>(c(p),{}))},[]),!r)return N("slot",{name:"no-manifest"});function d(p,y){u&&u.dispatchEvent(new CustomEvent("range-change",{detail:{range:p,isLeaf:y.isLeaf,canvasId:y.canvasId,fragment:y.fragment,selector:y.selector,parsedSelector:y.parsedSelector}}))}return N(rt,null,N(dn,{vault:i},N(kR,{manifestId:r,canvasId:n,selectedRange:a,autoScroll:l,onRangeClick:d})))}function kR(e){let{manifest:t,isLoaded:i}=nl(e.manifestId);return!t||!i?null:N(sl,{manifest:t.id},N(ER,C({},e)))}var PR=["manifest-id","config-id","canvas-id","auto-scroll","selected-range"];typeof window<"u"&&$n(AR,"range-panel",PR,{shadow:!1,onConstruct(e){Object.defineProperty(e,"vault",{get(){return e._props.vault},set(t){e._props.vault=t}}),e._props={__registerPublicApi:t=>{Object.assign(e,t(e))}}}})})();/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *//**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *//**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *//**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 *//** Code to "flatten" quadratic and cubic Bzier curves to polylines.
 *
 * All code in this module is based on JavaScript code by Raph Levien, published on his blog at
 * https://raphlinus.github.io/.
 * I merely changed the structure a bit, removed some unneeded parts and added some comments and type hints.
 *
 * Flattening of quadratic Bzier curves:
 * - Article: https://raphlinus.github.io/graphics/curves/2019/12/23/flatten-quadbez.html
 * - Code: https://github.com/raphlinus/raphlinus.github.io/blob/master/_posts/2019-12-23-flatten-quadbez.md?plain=1#L73-L212
 *
 * Flattening of cubic Bzier curves: https://levien.com/tmp/flatten.html
 *
 * Note that the code in this module has a different license than the rest of the package,
 * due to the inclusion of Apache-licensed third party code.
 *
 * @license
 * Copyright 2022 Johannes Baiter <johannes.baiter@gmail.com>
 * Copyright 2019, 2022 Raph Levien <raph.levien@gmail.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */return Nw}WO();/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const zu=globalThis,_f=zu.ShadowRoot&&(zu.ShadyCSS===void 0||zu.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Sf=Symbol(),Fw=new WeakMap;let tx=class{constructor(w,g,v){if(this._$cssResult$=!0,v!==Sf)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=w,this.t=g}get styleSheet(){let w=this.o;const g=this.t;if(_f&&w===void 0){const v=g!==void 0&&g.length===1;v&&(w=Fw.get(g)),w===void 0&&((this.o=w=new CSSStyleSheet).replaceSync(this.cssText),v&&Fw.set(g,w))}return w}toString(){return this.cssText}};const HO=L=>new tx(typeof L=="string"?L:L+"",void 0,Sf),qO=(L,...w)=>{const g=L.length===1?L[0]:w.reduce((v,_,P)=>v+(O=>{if(O._$cssResult$===!0)return O.cssText;if(typeof O=="number")return O;throw Error("Value passed to 'css' function must be a 'css' function result: "+O+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(_)+L[P+1],L[0]);return new tx(g,L,Sf)},QO=(L,w)=>{if(_f)L.adoptedStyleSheets=w.map(g=>g instanceof CSSStyleSheet?g:g.styleSheet);else for(const g of w){const v=document.createElement("style"),_=zu.litNonce;_!==void 0&&v.setAttribute("nonce",_),v.textContent=g.cssText,L.appendChild(v)}},Bw=_f?L=>L:L=>L instanceof CSSStyleSheet?(w=>{let g="";for(const v of w.cssRules)g+=v.cssText;return HO(g)})(L):L;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:VO,defineProperty:GO,getOwnPropertyDescriptor:ZO,getOwnPropertyNames:YO,getOwnPropertySymbols:XO,getPrototypeOf:KO}=Object,Rn=globalThis,jw=Rn.trustedTypes,JO=jw?jw.emptyScript:"",of=Rn.reactiveElementPolyfillSupport,po=(L,w)=>L,pf={toAttribute(L,w){switch(w){case Boolean:L=L?JO:null;break;case Object:case Array:L=L==null?L:JSON.stringify(L)}return L},fromAttribute(L,w){let g=L;switch(w){case Boolean:g=L!==null;break;case Number:g=L===null?null:Number(L);break;case Object:case Array:try{g=JSON.parse(L)}catch{g=null}}return g}},ix=(L,w)=>!VO(L,w),Uw={attribute:!0,type:String,converter:pf,reflect:!1,hasChanged:ix};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),Rn.litPropertyMetadata??(Rn.litPropertyMetadata=new WeakMap);class ca extends HTMLElement{static addInitializer(w){this._$Ei(),(this.l??(this.l=[])).push(w)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(w,g=Uw){if(g.state&&(g.attribute=!1),this._$Ei(),this.elementProperties.set(w,g),!g.noAccessor){const v=Symbol(),_=this.getPropertyDescriptor(w,v,g);_!==void 0&&GO(this.prototype,w,_)}}static getPropertyDescriptor(w,g,v){const{get:_,set:P}=ZO(this.prototype,w)??{get(){return this[g]},set(O){this[g]=O}};return{get(){return _==null?void 0:_.call(this)},set(O){const F=_==null?void 0:_.call(this);P.call(this,O),this.requestUpdate(w,F,v)},configurable:!0,enumerable:!0}}static getPropertyOptions(w){return this.elementProperties.get(w)??Uw}static _$Ei(){if(this.hasOwnProperty(po("elementProperties")))return;const w=KO(this);w.finalize(),w.l!==void 0&&(this.l=[...w.l]),this.elementProperties=new Map(w.elementProperties)}static finalize(){if(this.hasOwnProperty(po("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(po("properties"))){const g=this.properties,v=[...YO(g),...XO(g)];for(const _ of v)this.createProperty(_,g[_])}const w=this[Symbol.metadata];if(w!==null){const g=litPropertyMetadata.get(w);if(g!==void 0)for(const[v,_]of g)this.elementProperties.set(v,_)}this._$Eh=new Map;for(const[g,v]of this.elementProperties){const _=this._$Eu(g,v);_!==void 0&&this._$Eh.set(_,g)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(w){const g=[];if(Array.isArray(w)){const v=new Set(w.flat(1/0).reverse());for(const _ of v)g.unshift(Bw(_))}else w!==void 0&&g.push(Bw(w));return g}static _$Eu(w,g){const v=g.attribute;return v===!1?void 0:typeof v=="string"?v:typeof w=="string"?w.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var w;this._$ES=new Promise(g=>this.enableUpdating=g),this._$AL=new Map,this._$E_(),this.requestUpdate(),(w=this.constructor.l)==null||w.forEach(g=>g(this))}addController(w){var g;(this._$EO??(this._$EO=new Set)).add(w),this.renderRoot!==void 0&&this.isConnected&&((g=w.hostConnected)==null||g.call(w))}removeController(w){var g;(g=this._$EO)==null||g.delete(w)}_$E_(){const w=new Map,g=this.constructor.elementProperties;for(const v of g.keys())this.hasOwnProperty(v)&&(w.set(v,this[v]),delete this[v]);w.size>0&&(this._$Ep=w)}createRenderRoot(){const w=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return QO(w,this.constructor.elementStyles),w}connectedCallback(){var w;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(w=this._$EO)==null||w.forEach(g=>{var v;return(v=g.hostConnected)==null?void 0:v.call(g)})}enableUpdating(w){}disconnectedCallback(){var w;(w=this._$EO)==null||w.forEach(g=>{var v;return(v=g.hostDisconnected)==null?void 0:v.call(g)})}attributeChangedCallback(w,g,v){this._$AK(w,v)}_$EC(w,g){var P;const v=this.constructor.elementProperties.get(w),_=this.constructor._$Eu(w,v);if(_!==void 0&&v.reflect===!0){const O=(((P=v.converter)==null?void 0:P.toAttribute)!==void 0?v.converter:pf).toAttribute(g,v.type);this._$Em=w,O==null?this.removeAttribute(_):this.setAttribute(_,O),this._$Em=null}}_$AK(w,g){var P;const v=this.constructor,_=v._$Eh.get(w);if(_!==void 0&&this._$Em!==_){const O=v.getPropertyOptions(_),F=typeof O.converter=="function"?{fromAttribute:O.converter}:((P=O.converter)==null?void 0:P.fromAttribute)!==void 0?O.converter:pf;this._$Em=_,this[_]=F.fromAttribute(g,O.type),this._$Em=null}}requestUpdate(w,g,v){if(w!==void 0){if(v??(v=this.constructor.getPropertyOptions(w)),!(v.hasChanged??ix)(this[w],g))return;this.P(w,g,v)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(w,g,v){this._$AL.has(w)||this._$AL.set(w,g),v.reflect===!0&&this._$Em!==w&&(this._$Ej??(this._$Ej=new Set)).add(w)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(g){Promise.reject(g)}const w=this.scheduleUpdate();return w!=null&&await w,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var v;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[P,O]of this._$Ep)this[P]=O;this._$Ep=void 0}const _=this.constructor.elementProperties;if(_.size>0)for(const[P,O]of _)O.wrapped!==!0||this._$AL.has(P)||this[P]===void 0||this.P(P,this[P],O)}let w=!1;const g=this._$AL;try{w=this.shouldUpdate(g),w?(this.willUpdate(g),(v=this._$EO)==null||v.forEach(_=>{var P;return(P=_.hostUpdate)==null?void 0:P.call(_)}),this.update(g)):this._$EU()}catch(_){throw w=!1,this._$EU(),_}w&&this._$AE(g)}willUpdate(w){}_$AE(w){var g;(g=this._$EO)==null||g.forEach(v=>{var _;return(_=v.hostUpdated)==null?void 0:_.call(v)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(w)),this.updated(w)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(w){return!0}update(w){this._$Ej&&(this._$Ej=this._$Ej.forEach(g=>this._$EC(g,this[g]))),this._$EU()}updated(w){}firstUpdated(w){}}ca.elementStyles=[],ca.shadowRootOptions={mode:"open"},ca[po("elementProperties")]=new Map,ca[po("finalized")]=new Map,of==null||of({ReactiveElement:ca}),(Rn.reactiveElementVersions??(Rn.reactiveElementVersions=[])).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const go=globalThis,ju=go.trustedTypes,Dw=ju?ju.createPolicy("lit-html",{createHTML:L=>L}):void 0,rx="$lit$",In=`lit$${Math.random().toFixed(9).slice(2)}$`,nx="?"+In,eM=`<${nx}>`,xs=document,yo=()=>xs.createComment(""),vo=L=>L===null||typeof L!="object"&&typeof L!="function",Ef=Array.isArray,tM=L=>Ef(L)||typeof(L==null?void 0:L[Symbol.iterator])=="function",lf=`[ 	
\f\r]`,co=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Ww=/-->/g,Hw=/>/g,vs=RegExp(`>|${lf}(?:([^\\s"'>=/]+)(${lf}*=${lf}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),qw=/'/g,Qw=/"/g,sx=/^(?:script|style|textarea|title)$/i,iM=L=>(w,...g)=>({_$litType$:L,strings:w,values:g}),bo=iM(1),_s=Symbol.for("lit-noChange"),Qt=Symbol.for("lit-nothing"),Vw=new WeakMap,bs=xs.createTreeWalker(xs,129);function ax(L,w){if(!Ef(L)||!L.hasOwnProperty("raw"))throw Error("invalid template strings array");return Dw!==void 0?Dw.createHTML(w):w}const rM=(L,w)=>{const g=L.length-1,v=[];let _,P=w===2?"<svg>":w===3?"<math>":"",O=co;for(let F=0;F<g;F++){const U=L[F];let K,ae,C=-1,W=0;for(;W<U.length&&(O.lastIndex=W,ae=O.exec(U),ae!==null);)W=O.lastIndex,O===co?ae[1]==="!--"?O=Ww:ae[1]!==void 0?O=Hw:ae[2]!==void 0?(sx.test(ae[2])&&(_=RegExp("</"+ae[2],"g")),O=vs):ae[3]!==void 0&&(O=vs):O===vs?ae[0]===">"?(O=_??co,C=-1):ae[1]===void 0?C=-2:(C=O.lastIndex-ae[2].length,K=ae[1],O=ae[3]===void 0?vs:ae[3]==='"'?Qw:qw):O===Qw||O===qw?O=vs:O===Ww||O===Hw?O=co:(O=vs,_=void 0);const $e=O===vs&&L[F+1].startsWith("/>")?" ":"";P+=O===co?U+eM:C>=0?(v.push(K),U.slice(0,C)+rx+U.slice(C)+In+$e):U+In+(C===-2?F:$e)}return[ax(L,P+(L[g]||"<?>")+(w===2?"</svg>":w===3?"</math>":"")),v]};class wo{constructor({strings:w,_$litType$:g},v){let _;this.parts=[];let P=0,O=0;const F=w.length-1,U=this.parts,[K,ae]=rM(w,g);if(this.el=wo.createElement(K,v),bs.currentNode=this.el.content,g===2||g===3){const C=this.el.content.firstChild;C.replaceWith(...C.childNodes)}for(;(_=bs.nextNode())!==null&&U.length<F;){if(_.nodeType===1){if(_.hasAttributes())for(const C of _.getAttributeNames())if(C.endsWith(rx)){const W=ae[O++],$e=_.getAttribute(C).split(In),le=/([.?@])?(.*)/.exec(W);U.push({type:1,index:P,name:le[2],strings:$e,ctor:le[1]==="."?sM:le[1]==="?"?aM:le[1]==="@"?oM:Du}),_.removeAttribute(C)}else C.startsWith(In)&&(U.push({type:6,index:P}),_.removeAttribute(C));if(sx.test(_.tagName)){const C=_.textContent.split(In),W=C.length-1;if(W>0){_.textContent=ju?ju.emptyScript:"";for(let $e=0;$e<W;$e++)_.append(C[$e],yo()),bs.nextNode(),U.push({type:2,index:++P});_.append(C[W],yo())}}}else if(_.nodeType===8)if(_.data===nx)U.push({type:2,index:P});else{let C=-1;for(;(C=_.data.indexOf(In,C+1))!==-1;)U.push({type:7,index:P}),C+=In.length-1}P++}}static createElement(w,g){const v=xs.createElement("template");return v.innerHTML=w,v}}function da(L,w,g=L,v){var O,F;if(w===_s)return w;let _=v!==void 0?(O=g._$Co)==null?void 0:O[v]:g._$Cl;const P=vo(w)?void 0:w._$litDirective$;return(_==null?void 0:_.constructor)!==P&&((F=_==null?void 0:_._$AO)==null||F.call(_,!1),P===void 0?_=void 0:(_=new P(L),_._$AT(L,g,v)),v!==void 0?(g._$Co??(g._$Co=[]))[v]=_:g._$Cl=_),_!==void 0&&(w=da(L,_._$AS(L,w.values),_,v)),w}class nM{constructor(w,g){this._$AV=[],this._$AN=void 0,this._$AD=w,this._$AM=g}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(w){const{el:{content:g},parts:v}=this._$AD,_=((w==null?void 0:w.creationScope)??xs).importNode(g,!0);bs.currentNode=_;let P=bs.nextNode(),O=0,F=0,U=v[0];for(;U!==void 0;){if(O===U.index){let K;U.type===2?K=new xo(P,P.nextSibling,this,w):U.type===1?K=new U.ctor(P,U.name,U.strings,this,w):U.type===6&&(K=new lM(P,this,w)),this._$AV.push(K),U=v[++F]}O!==(U==null?void 0:U.index)&&(P=bs.nextNode(),O++)}return bs.currentNode=xs,_}p(w){let g=0;for(const v of this._$AV)v!==void 0&&(v.strings!==void 0?(v._$AI(w,v,g),g+=v.strings.length-2):v._$AI(w[g])),g++}}class xo{get _$AU(){var w;return((w=this._$AM)==null?void 0:w._$AU)??this._$Cv}constructor(w,g,v,_){this.type=2,this._$AH=Qt,this._$AN=void 0,this._$AA=w,this._$AB=g,this._$AM=v,this.options=_,this._$Cv=(_==null?void 0:_.isConnected)??!0}get parentNode(){let w=this._$AA.parentNode;const g=this._$AM;return g!==void 0&&(w==null?void 0:w.nodeType)===11&&(w=g.parentNode),w}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(w,g=this){w=da(this,w,g),vo(w)?w===Qt||w==null||w===""?(this._$AH!==Qt&&this._$AR(),this._$AH=Qt):w!==this._$AH&&w!==_s&&this._(w):w._$litType$!==void 0?this.$(w):w.nodeType!==void 0?this.T(w):tM(w)?this.k(w):this._(w)}O(w){return this._$AA.parentNode.insertBefore(w,this._$AB)}T(w){this._$AH!==w&&(this._$AR(),this._$AH=this.O(w))}_(w){this._$AH!==Qt&&vo(this._$AH)?this._$AA.nextSibling.data=w:this.T(xs.createTextNode(w)),this._$AH=w}$(w){var P;const{values:g,_$litType$:v}=w,_=typeof v=="number"?this._$AC(w):(v.el===void 0&&(v.el=wo.createElement(ax(v.h,v.h[0]),this.options)),v);if(((P=this._$AH)==null?void 0:P._$AD)===_)this._$AH.p(g);else{const O=new nM(_,this),F=O.u(this.options);O.p(g),this.T(F),this._$AH=O}}_$AC(w){let g=Vw.get(w.strings);return g===void 0&&Vw.set(w.strings,g=new wo(w)),g}k(w){Ef(this._$AH)||(this._$AH=[],this._$AR());const g=this._$AH;let v,_=0;for(const P of w)_===g.length?g.push(v=new xo(this.O(yo()),this.O(yo()),this,this.options)):v=g[_],v._$AI(P),_++;_<g.length&&(this._$AR(v&&v._$AB.nextSibling,_),g.length=_)}_$AR(w=this._$AA.nextSibling,g){var v;for((v=this._$AP)==null?void 0:v.call(this,!1,!0,g);w&&w!==this._$AB;){const _=w.nextSibling;w.remove(),w=_}}setConnected(w){var g;this._$AM===void 0&&(this._$Cv=w,(g=this._$AP)==null||g.call(this,w))}}class Du{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(w,g,v,_,P){this.type=1,this._$AH=Qt,this._$AN=void 0,this.element=w,this.name=g,this._$AM=_,this.options=P,v.length>2||v[0]!==""||v[1]!==""?(this._$AH=Array(v.length-1).fill(new String),this.strings=v):this._$AH=Qt}_$AI(w,g=this,v,_){const P=this.strings;let O=!1;if(P===void 0)w=da(this,w,g,0),O=!vo(w)||w!==this._$AH&&w!==_s,O&&(this._$AH=w);else{const F=w;let U,K;for(w=P[0],U=0;U<P.length-1;U++)K=da(this,F[v+U],g,U),K===_s&&(K=this._$AH[U]),O||(O=!vo(K)||K!==this._$AH[U]),K===Qt?w=Qt:w!==Qt&&(w+=(K??"")+P[U+1]),this._$AH[U]=K}O&&!_&&this.j(w)}j(w){w===Qt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,w??"")}}class sM extends Du{constructor(){super(...arguments),this.type=3}j(w){this.element[this.name]=w===Qt?void 0:w}}class aM extends Du{constructor(){super(...arguments),this.type=4}j(w){this.element.toggleAttribute(this.name,!!w&&w!==Qt)}}class oM extends Du{constructor(w,g,v,_,P){super(w,g,v,_,P),this.type=5}_$AI(w,g=this){if((w=da(this,w,g,0)??Qt)===_s)return;const v=this._$AH,_=w===Qt&&v!==Qt||w.capture!==v.capture||w.once!==v.once||w.passive!==v.passive,P=w!==Qt&&(v===Qt||_);_&&this.element.removeEventListener(this.name,this,v),P&&this.element.addEventListener(this.name,this,w),this._$AH=w}handleEvent(w){var g;typeof this._$AH=="function"?this._$AH.call(((g=this.options)==null?void 0:g.host)??this.element,w):this._$AH.handleEvent(w)}}class lM{constructor(w,g,v){this.element=w,this.type=6,this._$AN=void 0,this._$AM=g,this.options=v}get _$AU(){return this._$AM._$AU}_$AI(w){da(this,w)}}const uf=go.litHtmlPolyfillSupport;uf==null||uf(wo,xo),(go.litHtmlVersions??(go.litHtmlVersions=[])).push("3.2.1");const ox=(L,w,g)=>{const v=(g==null?void 0:g.renderBefore)??w;let _=v._$litPart$;if(_===void 0){const P=(g==null?void 0:g.renderBefore)??null;v._$litPart$=_=new xo(w.insertBefore(yo(),P),P,void 0,g??{})}return _._$AI(L),_};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let ws=class extends ca{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var g;const w=super.createRenderRoot();return(g=this.renderOptions).renderBefore??(g.renderBefore=w.firstChild),w}update(w){const g=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(w),this._$Do=ox(g,this.renderRoot,this.renderOptions)}connectedCallback(){var w;super.connectedCallback(),(w=this._$Do)==null||w.setConnected(!0)}disconnectedCallback(){var w;super.disconnectedCallback(),(w=this._$Do)==null||w.setConnected(!1)}render(){return _s}};var Xw;ws._$litElement$=!0,ws.finalized=!0,(Xw=globalThis.litElementHydrateSupport)==null||Xw.call(globalThis,{LitElement:ws});const hf=globalThis.litElementPolyfillSupport;hf==null||hf({LitElement:ws});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.1.1");/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const uM=L=>L.strings===void 0;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const lx={CHILD:2},ux=L=>(...w)=>({_$litDirective$:L,values:w});class hx{constructor(w){}get _$AU(){return this._$AM._$AU}_$AT(w,g,v){this._$Ct=w,this._$AM=g,this._$Ci=v}_$AS(w,g){return this.update(w,g)}update(w,g){return this.render(...g)}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const mo=(L,w)=>{var v;const g=L._$AN;if(g===void 0)return!1;for(const _ of g)(v=_._$AO)==null||v.call(_,w,!1),mo(_,w);return!0},Uu=L=>{let w,g;do{if((w=L._$AM)===void 0)break;g=w._$AN,g.delete(L),L=w}while((g==null?void 0:g.size)===0)},cx=L=>{for(let w;w=L._$AM;L=w){let g=w._$AN;if(g===void 0)w._$AN=g=new Set;else if(g.has(L))break;g.add(L),dM(w)}};function hM(L){this._$AN!==void 0?(Uu(this),this._$AM=L,cx(this)):this._$AM=L}function cM(L,w=!1,g=0){const v=this._$AH,_=this._$AN;if(_!==void 0&&_.size!==0)if(w)if(Array.isArray(v))for(let P=g;P<v.length;P++)mo(v[P],!1),Uu(v[P]);else v!=null&&(mo(v,!1),Uu(v));else mo(this,L)}const dM=L=>{L.type==lx.CHILD&&(L._$AP??(L._$AP=cM),L._$AQ??(L._$AQ=hM))};class fM extends hx{constructor(){super(...arguments),this._$AN=void 0}_$AT(w,g,v){super._$AT(w,g,v),cx(this),this.isConnected=w._$AU}_$AO(w,g=!0){var v,_;w!==this.isConnected&&(this.isConnected=w,w?(v=this.reconnected)==null||v.call(this):(_=this.disconnected)==null||_.call(this)),g&&(mo(this,w),Uu(this))}setValue(w){if(uM(this._$Ct))this._$Ct._$AI(w,this);else{const g=[...this._$Ct._$AH];g[this._$Ci]=w,this._$Ct._$AI(g,this,0)}}disconnected(){}reconnected(){}}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const pM=()=>new gM;class gM{}const cf=new WeakMap,mM=ux(class extends fM{render(L){return Qt}update(L,[w]){var v;const g=w!==this.Y;return g&&this.Y!==void 0&&this.rt(void 0),(g||this.lt!==this.ct)&&(this.Y=w,this.ht=(v=L.options)==null?void 0:v.host,this.rt(this.ct=L.element)),Qt}rt(L){if(this.isConnected||(L=void 0),typeof this.Y=="function"){const w=this.ht??globalThis;let g=cf.get(w);g===void 0&&(g=new WeakMap,cf.set(w,g)),g.get(this.Y)!==void 0&&this.Y.call(this.ht,void 0),g.set(this.Y,L),L!==void 0&&this.Y.call(this.ht,L)}else this.Y.value=L}get lt(){var L,w;return typeof this.Y=="function"?(L=cf.get(this.ht??globalThis))==null?void 0:L.get(this.Y):(w=this.Y)==null?void 0:w.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}}),yM=qO`
  :host {
    position: relative;
    display: flex;
    justify-content: center;
    max-height: 100vh;
    max-width: 100vw;
  }

  .image-sequence {
    height: 100vh;
    width: 100%;
  }

  .image-sequence.interactive {
    cursor: grab;
  }

  .image-sequence.interactive.loading {
    cursor: wait;
  }

  .overlay {
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    background: rgba(0,0,0,0);
    color: white;
    transition: all 0.25s linear;
    z-index: 9999;
    pointer-events: none;
  }

  .overlay.visible {
    opacity: 1;
    pointer-events: auto;
  }

  .overlay:not(.visible) {
    opacity: 0;
    display: none;
  }

  .overlay:hover {
    background: rgba(0,0,0,0.6);
  }

  .overlay.loading.visible {
    animation: loading-overlay 1s infinite alternate;
  }

  .buffering-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    border-radius: 5px;
    height: 15%;
    width: 15%;
    background: rgba(0,0,0,0.6);
  }

  @keyframes loading-overlay {
    from {
      opacity: 0.6;
    }
    to {
      opacity: 1;
    }
  }

  .description {
    display: flex;
    flex-direction: column;
    justify-content: space-around;
    align-items: center;
    opacity: 0;
    transition: opacity 0.25s linear;
  }

  .description__icon {
    fill: white;
    height: 2em;
  }

  .overlay:hover .description {
    opacity: 1;
  }

  canvas {
    display: none;
    pointer-events: none;
    user-select: none;
    object-fit: contain;
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
  }

  canvas.visible {
    display: block;
  }

  canvas.fade-in {
    animation: fade-in 0.25s 1 linear;          
  }

  @keyframes fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  slot[name='placeholder-image'] img {
    display: block;
    pointer-events: none;
    opacity: 0;
    height: 100%;
    width: 100%;
    margin: 0px auto 0px;
    transition: opacity 0.25s linear;
    object-fit: contain;
  }

  slot[name='placeholder-image'] img.loading {
    opacity: 1;
    filter: brightness(0.4);
    animation: loading-image 1s linear infinite alternate;
  }

  @keyframes loading-image {
    from {
      filter: brightness(0.4);
    }
    to {
      filter: brightness(0.2);
    }
  }`;var Vt,Fu,mf,yf,vf,bf,Bu;class gf extends ws{constructor(){super();$w(this,Vt);vr(this,"canvasRef",pM());this.description="Click and drag horizontally to rotate image",this.imageUrls=this.getAttribute("items").split(","),this.posterImageSrc=this.imageUrls.length>0?this.imageUrls[0]:"",this.isContinuous=this.getAttribute("continuous")==="true",this.isInteractive=this.getAttribute("interactive")==="true",this.didInteract=!1,this.isReversed=this.getAttribute("reverse")==="true",this.sequenceId=this.getAttribute("sequence-id");const g=.2;this.bufferSize=Math.ceil(this.imageUrls.length*g),this.blitting=null,this.images=Array(this.imageUrls.length).fill(null),this.requests=Array(this.imageUrls.length).fill(null),this.visible=!1,this.index=0,this.intrinsicHeight=0,this.intrinsicWidth=0,this.oldIndex=null,this.oldX=null,this.imageCount=this.imageUrls.length,this.isInteractive&&this.addEventListener("mousemove",this.handleMouseMove.bind(this))}get bufferedPct(){return Math.floor(this.images.filter((g,v)=>ha(this,Vt,Fu).includes(v)&&g!==null).length/this.bufferSize*100)}get someImagesLoaded(){return this.images.some(g=>g!==null)}connectedCallback(){super.connectedCallback();const g=(P,O)=>{P.forEach(F=>{F.isIntersecting&&(this.visible=!0,O.disconnect())})},v={root:null,threshold:.5};new IntersectionObserver(g,v).observe(this)}debounce(g,v=250,_=!1){let P=null;return function(){const O=this,F=arguments,U=function(){P=null,_||g.apply(O,F)},K=_&&!P;clearTimeout(P),P=setTimeout(U,v),K&&g.apply(O,F)}}handleMouseMove({buttons:g,clientX:v}){if(g){if(this.didInteract=!0,this.oldX){const _=v-this.oldX,P=Math.floor(Math.log(Math.abs(_)))||1;_>0?this.isReversed?this.previousImage(P):this.nextImage(P):_<0&&(this.isReversed?this.nextImage(P):this.previousImage(P))}this.oldX=v}else this.oldX=null}nextImage(g=1){const v=this.index+g>=this.imageCount?this.index+g-this.imageCount:this.index+g;this.index=v}willUpdate(g){if(g.has("rotateToIndex")&&this.rotateToIndex!==!1){const v=this.rotateToIndex-this.index+this.bufferSize/2,_=Array(v).fill(0).map((P,O)=>this.index+O+1);Br(this,Vt,Bu).call(this,_).then(this.animateRotation(this.rotateToIndex))}if(g.has("animationFrame")){if(!this.animationFrame||this.images[this.animationFrame]===null)return;Br(this,Vt,bf).call(this,this.images[this.animationFrame])}g.has("index")&&this.someImagesLoaded&&Br(this,Vt,Bu).call(this).then(()=>{this.animateRotation(this.index)}),g.has("visible")&&!this.visible&&Br(this,Vt,Bu).call(this).then(()=>Br(this,Vt,bf).call(this))}animateRotation(g){if(this.animationFrame===g)return;this.animationFrame=this.index;const v=setInterval(()=>{if(this.animationFrame===g&&(this.index=g,this.rotateToIndex=!1,this.synchronizeSequenceInstances()),this.rotateToIndex!==g){clearInterval(v);return}this.animationFrame+=1},this.transition)}previousImage(g=1){const v=this.index-g<0?this.imageCount+this.index-g:this.index-g;this.index=v}synchronizeSequenceInstances(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{document.querySelectorAll(`q-image-sequence[sequence-id="${this.sequenceId}"]`).forEach(v=>{parseInt(v.getAttribute("index"))!==this.index&&v.setAttribute("index",this.index)})},250)}render(){const g=this.isInteractive?bo`<div slot='overlay' class="overlay ${this.didInteract===!1?"visible":""}"><span class="description">
            <svg class="description__icon">
              <symbol id="rotation-icon" viewBox="0 0 24 24">
                <path d="M6.07426 4.68451L6.89234 4.68451L6.89234 6.34444C7.68861 5.65993 8.56396 5.09807 9.5184 4.65884C10.4728 4.21961 11.4791 4 12.5371 4C13.5952 4 14.6014 4.21106 15.5559 4.63317C16.5103 5.05528 17.3856 5.6086 18.1819 6.29311L18.1819 4.68451L19 4.68451L19 7.93593L15.8913 7.93593L15.8913 7.08029L17.7565 7.08029C16.9821 6.39578 16.1694 5.85388 15.3186 5.45458C14.4678 5.05528 13.5406 4.85564 12.5371 4.85564C11.5336 4.85564 10.6092 5.05528 9.76382 5.45458C8.91847 5.85388 8.10311 6.39578 7.31775 7.08029L9.18298 7.08029L9.18298 7.93593L6.07426 7.93593L6.07426 4.68451ZM6.09062 14.0794L7.8086 9.42473L9.05209 9.90389C9.24843 9.98375 9.42023 10.0978 9.56748 10.2461C9.71474 10.3945 9.81018 10.577 9.85381 10.7938L10.1156 12.1457L14.975 9.86966C15.3895 9.67572 15.8067 9.66431 16.2267 9.83544C16.6466 10.0066 16.9493 10.3089 17.1348 10.7424C17.3202 11.1759 17.3338 11.6123 17.1757 12.0515C17.0175 12.4908 16.7312 12.8073 16.3167 13.0013L13.7479 14.1992L13.9115 14.6099C13.9333 14.6555 13.9442 14.7069 13.9442 14.7639L13.9442 14.935L13.8461 17.7415C13.8352 18.0381 13.737 18.3005 13.5516 18.5287C13.3661 18.7569 13.1316 18.9109 12.848 18.9907L9.3466 19.9491C9.03027 20.0403 8.73031 20.009 8.4467 19.8549C8.1631 19.7009 7.95585 19.4699 7.82496 19.1619L6.12334 15.1575C6.04699 14.9864 6.00608 14.8067 6.00063 14.6184C5.99518 14.4302 6.02517 14.2505 6.09062 14.0794ZM6.97415 14.6099L8.83938 19.0079L12.848 17.9469L12.9953 14.4559L12.6189 13.6002L15.9076 12.0601C16.0931 11.9688 16.2185 11.8433 16.284 11.6836C16.3494 11.5239 16.3385 11.3471 16.2512 11.1531C16.164 10.9592 16.044 10.8308 15.8913 10.7681C15.7386 10.7053 15.5695 10.7196 15.3841 10.8109L9.41204 13.5831L8.88847 10.9478L8.38126 10.7595L6.97415 14.6099Z" />
              </symbol>
              <switch>
                <use xlink:href="#rotation-icon"></use>
              </switch>
            </svg>
            <span class="description__text">${this.description}</span>
          </span></div>`:"";return bo`<div class="image-sequence ${ha(this,Vt,mf)?"":"loading"} ${this.isInteractive?"interactive":""}">
        <slot name="loading-overlay">
          <div slot="loading-overlay" class='${ha(this,Vt,mf)?"":"visible"} loading overlay'>
            <div class="buffering-indicator">Loading Image Sequence&nbsp;(${this.bufferedPct}%)...</div>
            </div>
        </slot>
        <canvas ${mM(this.canvasRef)} height="${this.intrinsicHeight}" width="${this.intrinsicWidth}" class="${this.someImagesLoaded?"visible":""} ${this.didInteract?"":"fade-in"}" slot="images"></canvas>
        <slot name="overlay">
          ${g}
        </slot>
      </div>`}}Vt=new WeakSet,Fu=function(){const g=this.images.length,v=g+this.index-Math.round(this.bufferSize/2);return Array(this.bufferSize).fill(0).map((_,P)=>(v+P)%g)},mf=function(){return this.images.filter((g,v)=>ha(this,Vt,Fu).includes(v)&&g!==null).length===this.bufferSize},yf=function(g,v){if(this.requests[v])return;const _=new Request(g),P=fetch(_).then(O=>O.blob()).then(O=>window.createImageBitmap(O)).then(O=>{this.intrinsicHeight===0&&(this.intrinsicHeight=O.height,this.intrinsicWidth=O.width),this.images[v]=O}).then(()=>{this.requests[v]=null,this.requestUpdate()}).catch(O=>{console.error(O)});return this.requests[v]=P,P},vf=function(g){this.context.drawImage(g,0,0)},bf=function(g){if(this.canvasRef.value){if(this.context??(this.context=this.canvasRef.value.getContext("2d")),g){window.cancelAnimationFrame(this.blitting),this.blitting=window.requestAnimationFrame(()=>Br(this,Vt,vf).call(this,g));return}if(!this.images[this.index]){Br(this,Vt,yf).call(this,this.imageUrls[this.index],this.index);return}window.cancelAnimationFrame(this.blitting),this.blitting=window.requestAnimationFrame(()=>Br(this,Vt,vf).call(this,this.images[this.index]))}},Bu=function(g){if(!this.images.some(P=>P===null))return Promise.all([]);const v=g??ha(this,Vt,Fu),_=this.images.map((P,O)=>{if(!v.includes(O)||P!==null)return null;const F=this.imageUrls[O];return Br(this,Vt,yf).call(this,F,O)}).filter(P=>P);return Promise.all(_)},vr(gf,"styles",[yM]),vr(gf,"properties",{animationFrame:{type:Number,state:!0},bufferSize:{type:Number,state:!0},didInteract:{type:Boolean,state:!0},images:{type:Array,state:!0},imageUrls:{attribute:"image-urls",type:String},index:{type:Number},intrinsicHeight:{type:Number,state:!0},intrinsicWidth:{type:Number,state:!0},rotateToIndex:{attribute:"rotate-to-index",type:Number},transition:{type:Number},visible:{type:Boolean,state:!0}});customElements.define("q-image-sequence",gf);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class wf extends hx{constructor(w){if(super(w),this.it=Qt,w.type!==lx.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(w){if(w===Qt||w==null)return this._t=void 0,this.it=w;if(w===_s)return w;if(typeof w!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(w===this.it)return this._t;this.it=w;const g=[w];return g.raw=g,this._t={_$litType$:this.constructor.resultType,strings:g,values:[]}}}wf.directiveName="unsafeHTML",wf.resultType=1;const fo=ux(wf);class dx extends ws{setupStyles(){const w=this.querySelector('style[slot="lightbox-styles"]');w&&w.sheet&&(this.adoptedStyleSheets=[w.sheet])}constructor(){super(),this.setupStyles(),this.setupFiguresData(),this.setupFullscreenButton(),this.setupNavigationButtons(),this.setupKeyboardControls()}get counterCurrent(){return this.querySelector("[data-lightbox-counter-current]")}get counterTotal(){return this.querySelector("[data-lightbox-counter-total]")}get fullscreenButton(){return this.querySelector("[data-lightbox-fullscreen]")}get nextButton(){return this.querySelector("[data-lightbox-next]")}get previousButton(){return this.querySelector("[data-lightbox-previous]")}get slides(){return this.querySelectorAll(".q-lightbox-slides__slide")}get slideIds(){return Array.from(this.slides).map(w=>w.id)}get currentSlide(){if(this.slides.length)return this.currentId?this.slides[this.currentSlideIndex]:this.slides[0]}get currentSlideIndex(){if(this.slides.length)return this.currentId?this.slideIds.findIndex(w=>w===this.currentId):0}get fullscreen(){return document.fullscreen||this.wrapper.classList.contains("quire-entry__lightbox--fullscreen")}get wrapper(){return document.querySelector(".quire-entry__lightbox")}enterFullscreen(){const w=this.renderRoot.firstElementChild;w.requestFullscreen?w.requestFullscreen():(this.wrapper.classList.add("quire-entry__lightbox--fullscreen"),document.body.style.position="fixed",document.body.style.top=`-${window.scrollY}px`)}exitFullscreen(){document.exitFullscreen?document.exitFullscreen():(this.wrapper.classList.remove("quire-entry__lightbox--fullscreen"),document.body.style.position="",document.body.style.top="")}next(){if(!this.slides.length)return;const w=this.currentSlideIndex+1,g=this.slideIds[w%this.slides.length];this.currentId=g}previous(){if(!this.slides.length)return;const w=this.currentSlideIndex-1,g=this.slideIds.slice(w)[0];this.currentId=g}_alignSlideData(w){const{aspect_ratio:g="widescreen",mediaType:v}=w;return{...w,isAudio:v==="soundcloud",isVideo:v==="video"||v==="vimeo"||v==="youtube",aspectRatio:g}}_lightboxSlide(w){const{id:g,mediaType:v,figureElementContent:_,annotationsElementContent:P,aspectRatio:O,isVideo:F,isAudio:U,label:K,labelHtml:ae,caption:C,captionHtml:W,credit:$e,creditHtml:le}=w,xt=`q-lightbox-slides__element--${v}`,Ge=F?`q-lightbox-slides__element--video q-lightbox-slides__element--${O}`:"";return bo`<div class="q-lightbox-slides__slide" slot="slides" id="${g}">
      <div class="q-lightbox-slides__element ${xt} ${Ge} ${U?"q-lightbox-slides__element--audio":""}">
        ${fo(_)}
      </div>
      <div class="q-figure-slides__slide-ui">
        <div class="q-lightbox-slides__caption ${K||C||$e?"":"is-hidden"}">
          <span class="q-lightbox-slides__caption-label ${K?"":"is-hidden"}">${fo(ae)}</span>
          <span class="q-lightbox-slides__caption-content ${C||$e?"":"is-hidden"}">${W?fo(W):""} ${le?fo(le):""}</span>
        </div>
        ${fo(P??"")}
      </div>
    </div>`}setupFiguresData(){const w=this.querySelector('script[type="application/json"]'),g=JSON.parse(w.innerHTML);this.figures=g,g.forEach(v=>{console.log("Rendering",v.id);const _=this._alignSlideData(v),P=document.createElement("template");ox(this._lightboxSlide(_),P.content);const O=P.content.cloneNode(!0);this.appendChild(O)})}setupFullscreenButton(){this.fullscreenButton&&this.fullscreenButton.addEventListener("click",()=>{this.toggleFullscreen()})}setupNavigationButtons(){!this.nextButton||!this.previousButton||(this.nextButton.addEventListener("click",()=>{this.next()}),this.previousButton.addEventListener("click",()=>{this.previous()}))}setupKeyboardControls(){document.addEventListener("keyup",({code:w})=>{if(this.slides.length>1)switch(w){case"ArrowRight":this.next();break;case"ArrowLeft":this.previous();break}})}toggleFullscreen(){this.updateFullscreenButton(),this.fullscreen?this.exitFullscreen():this.enterFullscreen()}updateCounterElements(){!this.counterCurrent||!this.counterTotal||(this.counterCurrent.innerText=this.currentSlideIndex+1,this.counterTotal.innerText=this.slides.length)}updateCurrentSlideElement(){this.currentSlide&&(this.slides.forEach(w=>{w.id!==this.currentId&&delete w.dataset.lightboxCurrent,[this.preloadNextId,this.preloadPrevId].includes(w.id)?w.dataset.lightboxPreload=!0:delete w.dataset.lightboxPreload}),this.currentSlide.dataset.lightboxCurrent=!0)}updateFullscreenButton(){this.fullscreenButton&&(this.fullscreenButton.dataset.lightboxFullscreen=!this.fullscreen)}render(){return this.slides.length?(this.currentId=this.slideIds[this.currentSlideIndex],this.preloadNextId=this.currentSlideIndex+1<this.slideIds.length?this.slideIds[this.currentSlideIndex+1]:void 0,this.preloadPrevId=this.currentSlideIndex-1>=0?this.slideIds[this.currentSlideIndex-1]:void 0,this.updateCurrentSlideElement(),this.updateCounterElements(),bo`
      <div class="q-lightbox">
        <slot name="lightbox-styles"></slot>
        <slot name="data"></slot>
        <div class="q-lightbox-slides">
          <slot name="slides"></slot>
        </div>
        <slot name="ui"></slot>
      </div>
    `):""}}vr(dx,"properties",{currentId:{attribute:"current-id",type:String},preloadNextId:{attribute:"preload-next-id",type:String},preloadPrevId:{attribute:"preload-prev-id",type:String}});customElements.define("q-lightbox",dx);class fx extends ws{get closeButton(){return this.querySelector("[data-modal-close]")}get lightbox(){return this.querySelector("q-lightbox")}constructor(){super(),this.setupKeyboardControls(),this.setupModalTriggers()}close(){this.active=!1,this.currentId=null,this.updateLightboxCurrentId(),this.enableScrolling()}disableScrolling(){document.querySelector("html").style.overflow="hidden"}enableScrolling(){document.querySelector("html").style.overflow="auto"}getCurrentFigureId(w){const{target:g}=w;let v=g;for(;!v.matches("figure")&&!v.getAttribute("id");)v=v.parentNode;return v.getAttribute("id")}open(w){this.currentId=this.getCurrentFigureId(w),this.active=!0,this.updateLightboxCurrentId(),this.disableScrolling()}setupCloseButton(){this.closeButton&&this.closeButton.addEventListener("click",()=>{this.close()})}setupKeyboardControls(){document.addEventListener("keyup",({code:w})=>{this.active&&w==="Escape"&&this.close()})}setupModalTriggers(){document.querySelectorAll(".q-figure__modal-link").forEach(w=>{w.addEventListener("click",g=>{g.preventDefault(),this.open(g)})})}updateLightboxCurrentId(){this.lightbox&&this.lightbox.setAttribute("current-id",this.currentId)}render(){return this.dataset.modalActive=this.active,this.setupCloseButton(),bo`
      <div class="q-modal">
        <slot></slot>
      </div>
    `}}vr(fx,"properties",{active:{type:Boolean},currentId:{attribute:"current-id",type:String}});customElements.define("q-modal",fx);var px=px||{};px.Widget=function(L){function w(v){if(g[v])return g[v].exports;var _=g[v]={exports:{},id:v,loaded:!1};return L[v].call(_.exports,_,_.exports,w),_.loaded=!0,_.exports}var g={};return w.m=L,w.c=g,w.p="",w(0)}([function(L,w,g){function v(X){return!!(X===""||X&&X.charCodeAt&&X.substr)}function _(X){return!!(X&&X.constructor&&X.call&&X.apply)}function P(X){return!(!X||X.nodeType!==1||X.nodeName.toUpperCase()!=="IFRAME")}function O(X){var se,de=!1;for(se in rt)if(rt.hasOwnProperty(se)&&rt[se]===X){de=!0;break}return de}function F(X){var se,de,ee;for(se=0,de=qi.length;se<de&&(ee=X(qi[se]),ee!==!1);se++);}function U(X){var se,de,ee,Ie="";for(X.substr(0,2)==="//"&&(X=window.location.protocol+X),ee=X.split("/"),se=0,de=ee.length;se<de&&se<3;se++)Ie+=ee[se],se<2&&(Ie+="/");return Ie}function K(X){return X.contentWindow?X.contentWindow:X.contentDocument&&"parentWindow"in X.contentDocument?X.contentDocument.parentWindow:null}function ae(X){var se,de=[];for(se in X)X.hasOwnProperty(se)&&de.push(X[se]);return de}function C(X,se,de){de.callbacks[X]=de.callbacks[X]||[],de.callbacks[X].push(se)}function W(X,se){var de,ee=!0;return se.callbacks[X]=[],F(function(Ie){if(de=Ie.callbacks[X]||[],de.length)return ee=!1,!1}),ee}function $e(X,se,de){var ee,Ie,nt=K(de);return!!nt.postMessage&&(ee=de.getAttribute("src").split("?")[0],Ie=JSON.stringify({method:X,value:se}),ee.substr(0,2)==="//"&&(ee=window.location.protocol+ee),ee=ee.replace(/http:\/\/(w|wt).soundcloud.com/,"https://$1.soundcloud.com"),void nt.postMessage(Ie,ee))}function le(X){var se;return F(function(de){if(de.instance===X)return se=de,!1}),se}function xt(X){var se;return F(function(de){if(K(de.element)===X)return se=de,!1}),se}function Ge(X,se){return function(de){var ee=_(de),Ie=le(this),nt=!ee&&se?de:null,wi=ee&&!se?de:null;return wi&&C(X,wi,Ie),$e(X,nt,Ie.element),this}}function kt(X,se,de){var ee,Ie,nt;for(ee=0,Ie=se.length;ee<Ie;ee++)nt=se[ee],X[nt]=Ge(nt,de)}function We(X,se,de){return X+"?url="+se+"&"+Ue(de)}function Ue(X){var se,de,ee=[];for(se in X)X.hasOwnProperty(se)&&(de=X[se],ee.push(se+"="+(se==="start_track"?parseInt(de,10):de?"true":"false")));return ee.join("&")}function Zt(X,se,de){var ee,Ie,nt=X.callbacks[se]||[];for(ee=0,Ie=nt.length;ee<Ie;ee++)nt[ee].apply(X.instance,de);(O(se)||se===Mt.READY)&&(X.callbacks[se]=[])}function Je(X){var se,de,ee,Ie,nt;try{de=JSON.parse(X.data)}catch{return!1}return se=xt(X.source),ee=de.method,Ie=de.value,(!se||Bt(X.origin)===Bt(se.domain))&&(se?(ee===Mt.READY&&(se.isReady=!0,Zt(se,Yi),W(Yi,se)),ee!==Mt.PLAY||se.playEventFired||(se.playEventFired=!0),ee!==Mt.PLAY_PROGRESS||se.playEventFired||(se.playEventFired=!0,Zt(se,Mt.PLAY,[Ie])),nt=[],Ie!==void 0&&nt.push(Ie),void Zt(se,ee,nt)):(ee===Mt.READY&&ur.push(X.source),!1))}function Bt(X){return X.replace(ge,"")}var bi,N,Ri,br=g(1),rt=g(2),ei=g(3),Mt=br.api,Ni=br.bridge,ur=[],qi=[],Yi="__LATE_BINDING__",hr="http://wt.soundcloud.test:9200/",ge=/^http(?:s?)/;window.addEventListener?window.addEventListener("message",Je,!1):window.attachEvent("onmessage",Je),L.exports=Ri=function(X,se,de){if(v(X)&&(X=document.getElementById(X)),!P(X))throw new Error("SC.Widget function should be given either iframe element or a string specifying id attribute of iframe element.");se&&(de=de||{},X.src=We(hr,se,de));var ee,Ie,nt=xt(K(X));return nt&&nt.instance?nt.instance:(ee=ur.indexOf(K(X))>-1,Ie=new bi(X),qi.push(new N(Ie,X,ee)),Ie)},Ri.Events=Mt,window.SC=window.SC||{},window.SC.Widget=Ri,N=function(X,se,de){this.instance=X,this.element=se,this.domain=U(se.getAttribute("src")),this.isReady=!!de,this.callbacks={}},bi=function(){},bi.prototype={constructor:bi,load:function(X,se){if(X){se=se||{};var de=this,ee=le(this),Ie=ee.element,nt=Ie.src,wi=nt.substr(0,nt.indexOf("?"));ee.isReady=!1,ee.playEventFired=!1,Ie.onload=function(){de.bind(Mt.READY,function(){var gt,Ss=ee.callbacks;for(gt in Ss)Ss.hasOwnProperty(gt)&&gt!==Mt.READY&&$e(Ni.ADD_LISTENER,gt,ee.element);se.callback&&se.callback()})},Ie.src=We(wi,X,se)}},bind:function(X,se){var de=this,ee=le(this);return ee&&ee.element&&(X===Mt.READY&&ee.isReady?setTimeout(se,1):ee.isReady?(C(X,se,ee),$e(Ni.ADD_LISTENER,X,ee.element)):C(Yi,function(){de.bind(X,se)},ee)),this},unbind:function(X){var se,de=le(this);de&&de.element&&(se=W(X,de),X!==Mt.READY&&se&&$e(Ni.REMOVE_LISTENER,X,de.element))}},kt(bi.prototype,ae(rt)),kt(bi.prototype,ae(ei),!0)},function(L,w){w.api={LOAD_PROGRESS:"loadProgress",PLAY_PROGRESS:"playProgress",PLAY:"play",PAUSE:"pause",FINISH:"finish",SEEK:"seek",READY:"ready",OPEN_SHARE_PANEL:"sharePanelOpened",CLICK_DOWNLOAD:"downloadClicked",CLICK_BUY:"buyClicked",ERROR:"error"},w.bridge={REMOVE_LISTENER:"removeEventListener",ADD_LISTENER:"addEventListener"}},function(L,w){L.exports={GET_VOLUME:"getVolume",GET_DURATION:"getDuration",GET_POSITION:"getPosition",GET_SOUNDS:"getSounds",GET_CURRENT_SOUND:"getCurrentSound",GET_CURRENT_SOUND_INDEX:"getCurrentSoundIndex",IS_PAUSED:"isPaused"}},function(L,w){L.exports={PLAY:"play",PAUSE:"pause",TOGGLE:"toggle",SEEK_TO:"seekTo",SET_VOLUME:"setVolume",NEXT:"next",PREV:"prev",SKIP:"skip"}}]);const vM=(L,w,g={})=>{const v={root:document.querySelector(".quire-entry__content"),rootMargin:"-50% 0% -50% 0%",threshold:0,...g},_=O=>{O.forEach(F=>{F.isIntersecting&&w()})};new IntersectionObserver(_,v).observe(L)};var lr;const St=(lr=class{constructor(w){this.copyLinkButton=w.querySelector(".accordion-section__copy-link-button"),this.element=w,this.id=w.getAttribute("id"),this.globalExpand=document.querySelector(".global-accordion-expand-all"),this.globalCollapse=document.querySelector(".global-accordion-collapse-all"),this.tooltip=w.querySelector(".accordion-tooltip")}get parentAccordions(){return Array.from(St.elements).filter(w=>w.contains(this.element)&&w!==this.element)}static setGlobalControls(){if(!(!!St.globalCollapse&&!!St.globalExpand))return;const g=this.globalControlsState,v=St.elements.length,_=Array.from(St.elements).filter(O=>O.getAttribute("open")===null).length,P=()=>{let O;switch(!0){case _===v:O="allClosed";break;case _===0:O="allOpen";break;default:O="mixed";break}return O};if(g!==P())switch(this.globalControlsState=P(),this.globalControlsState){case"allClosed":St.globalExpand.classList.remove("visually-hidden"),St.globalCollapse.classList.add("visually-hidden");break;case"allOpen":St.globalExpand.classList.add("visually-hidden"),St.globalCollapse.classList.remove("visually-hidden");break;default:St.globalCollapse.classList.remove("visually-hidden"),St.globalExpand.classList.remove("visually-hidden");break}}static setup(){St.elements.length&&(St.elements.forEach(w=>{new St(w).init()}),St.setGlobalControls())}addEventListeners(){this.copyLinkButton.addEventListener("click",this.copyLink.bind(this)),this.element.addEventListener("toggle",St.setGlobalControls.bind(this)),St.globalExpand&&St.globalExpand.addEventListener("click",this.open.bind(this)),St.globalCollapse&&St.globalCollapse.addEventListener("click",this.close.bind(this))}close(){this.element.removeAttribute("open"),St.setGlobalControls()}copyLink(){if(this.copying)return;this.copying=!0;const w=this.copyLinkButton.getAttribute("value"),{origin:g,pathname:v}=window.location;this.tooltip.classList.add("accordion-tooltip--active");try{const _=new URL(v+w,g);navigator.clipboard.writeText(_),window.history.replaceState({},"",_),setTimeout(()=>{this.tooltip.classList.remove("accordion-tooltip--active"),this.copying=!1},2e3)}catch(_){console.error("Error copying heading link: ",_)}}init(){this.addEventListeners(),this.setStateFromUrl()}open(){this.element.setAttribute("open",!0),St.setGlobalControls()}setStateFromUrl(){const w=window.location.hash.replace(/^#/,"");if(!w)return;const g=document.querySelector(window.location.hash);(w===this.id||this.element.contains(g))&&(this.open(),this.parentAccordions&&this.parentAccordions.length&&this.parentAccordions.forEach(v=>v.setAttribute("open",!0)))}},vr(lr,"className","accordion-section"),vr(lr,"globalExpand",document.querySelector(".global-accordion-expand-all")),vr(lr,"globalCollapse",document.querySelector(".global-accordion-collapse-all")),vr(lr,"elements",document.querySelectorAll(`.${lr.className}`)),vr(lr,"partOfAccordion",w=>w.closest(`.${lr.className}`)),lr),bM=({callback:L,interval:w=200,maxTries:g=10,tries:v=0,validate:_})=>{const P=()=>{if(v===g){console.error("Polling reached maximum number of attempts");return}v++,_()?L():setTimeout(P,w)};P()};function wM(L,w=null,g=null){const v=document.querySelector(".quire-navbar"),_=7,P=v?L-v.clientHeight-_:L-_;[document.documentElement,document.body.parentNode,document.body].forEach(F=>{F.scrollTop=P})}const Af=L=>{if(!L)return;L=L.replace(":","\\:"),L=L.replace(".","\\.");const w=document.querySelector(L);if(w){St.partOfAccordion(w)&&new St(w.closest(`.${St.className}`)).setStateFromUrl();const g=w.getBoundingClientRect().top+window.scrollY;wM(g),setTimeout(()=>w.focus())}},gx=L=>({checked:L.checked,id:L.getAttribute("value"),input:L.getAttribute("type"),type:L.getAttribute("data-annotation-type")}),mx=L=>{if(!L)return;const w=L.querySelector("canvas-panel"),g=L.querySelector("q-image-sequence"),v=L.querySelector("image-service");if(w)return w.getAttribute("canvas-id");if(v)return v.getAttribute("src");if(g)return g.getAttribute("sequence-id")},Gw=L=>{const[w,g,v,_]=L.split(",").map(P=>parseInt(P.trim()));return{x:w,y:g,width:v,height:_}},xf=function({annotationIds:L=[],figureId:w,historyBehavior:g="push",region:v,sequence:_={}}){if(!w){console.error("goToFigureState called without an undefined figureId");return}const P=`#${w}`,O=`[slot="slides"][id="${w}"]`,F=document.querySelector(P),U=document.querySelector(O),K=mx(F||U);if(!F&&!U)return;const ae=U.closest("q-lightbox");if(ae.currentId=w,!K)return;const W=[...document.querySelectorAll(`#${w} .annotations-ui__input, [slot="slides"][id="${w}"] .annotations-ui__input`)].map(We=>{const Ue=We.getAttribute("data-annotation-id");return We.checked=L.includes(Ue),gx(We)});St.elements.forEach(We=>{We.contains(F)&&We.setAttribute("open",!0)}),yx(K,{annotations:W,region:v||"reset",sequence:_});const $e=new URL(window.location.pathname,window.location.origin);$e.hash=w,Af($e.hash);const le=new URLSearchParams(L.map(We=>["annotation-id",encodeURIComponent(We)]));v&&le.set("region",encodeURIComponent(v)),Number.isInteger(parseInt(_.index))&&le.set("sequence-index",encodeURIComponent(_.index));const xt=le.toString(),Ge=[$e.pathname];xt&&Ge.push(xt);const kt=[{},"",`${Ge.join("?")}${$e.hash}`];g==="replace"?window.history.replaceState(...kt):window.history.pushState(...kt)},Zw=L=>{const w=L.getAttribute("id"),g=mx(L.closest(".q-figure, .q-lightbox-slides__slide")),v=document.querySelector("q-lightbox").contains(L),_=gx(L),{checked:P,input:O,type:F}=_;if(v){const U=document.querySelector(`#${w.split("lightbox-")[1]}`);U&&(U.checked=L.checked)}else{const U=document.querySelector(`#${["lightbox",w].join("-")}`);U&&(U.checked=L.checked)}if(O==="checkbox"&&F==="choice"){const U=L.closest("form"),K=U.querySelectorAll(".annotations-ui__input[checked]");if(!P&&K.length===1&&K[0].setAttribute("disabled",!0),P){const ae=U.querySelector("[disabled]");ae&&ae.removeAttribute("disabled")}}yx(g,{annotations:[_]})},xM=(L,w)=>{const{checked:g,id:v,type:_}=w;switch(_){case"annotation":L.applyStyles(v,{opacity:+!!g});break;case"choice":bM({callback:()=>_M(L,w),validate:()=>!!L.makeChoice});break}},_M=(L,w)=>{const{checked:g,id:v,input:_}=w;L.setAttribute("choice-id",v),L.makeChoice(v,{deselect:!g,deselectOthers:_==="radio"})},SM=()=>{const L=document.querySelectorAll(".ref");for(const g of L){let v=g.getAttribute("data-annotation-ids");v=v.length?v.split(","):void 0;const _=g.getAttribute("data-figure-id"),P={index:parseInt(g.getAttribute("data-sequence-index")),transition:parseInt(g.getAttribute("data-sequence-transition"))},O=g.getAttribute("data-region");g.getAttribute("data-on-scroll")==="true"?vM(g,()=>xf({annotationIds:v,figureId:_,historyBehavior:"replace",region:O,sequence:P})):g.addEventListener("click",({target:U})=>xf({annotationIds:v,figureId:_,region:O,sequence:P}))}const w=document.querySelectorAll(".annotations-ui__input");for(const g of w)Zw(g),g.addEventListener("click",({target:v})=>Zw(v))},yx=(L,w)=>{const g=document.querySelectorAll(`canvas-panel[canvas-id="${L}"], image-service[src="${L}"], q-image-sequence[sequence-id="${L}"]`);g.length||console.error(`Failed to call update on canvas panel or image-service component with id ${L}. Element does not exist.`);const{annotations:v,region:_}=w;g.forEach(P=>{const O=P.tagName.toLowerCase()==="q-image-sequence";if(O&&EM(P,w),_&&!O){const F=Gw(_&&_!=="reset"?_:P.getAttribute("region")),U={easing:P.easingFunctions().easeOutExpo,duration:2e3};setTimeout((()=>{P.transition(ae=>{ae.goToRegion(F,{transition:U})})})(),500)}Array.isArray(v)&&v.forEach(F=>xM(P,F))})},EM=(L,{sequence:w={}})=>{const{index:g,transition:v}=w,_=parseInt(L.getAttribute("index")),P=parseInt(g);if(Number.isInteger(P)&&P>=0&&_!==P){if(v){L.setAttribute("transition",v),L.setAttribute("rotate-to-index",P);return}L.setAttribute("rotate-to-index",!1),L.setAttribute("index",P)}};var df={exports:{}};/**
 * lunr - http://lunrjs.com - A bit like Solr, but much smaller and not as bright - 2.3.9
 * Copyright (C) 2020 Oliver Nightingale
 * @license MIT
 */var Yw;function AM(){return Yw||(Yw=1,function(L,w){(function(){var g=function(v){var _=new g.Builder;return _.pipeline.add(g.trimmer,g.stopWordFilter,g.stemmer),_.searchPipeline.add(g.stemmer),v.call(_,_),_.build()};g.version="2.3.9";/*!
 * lunr.utils
 * Copyright (C) 2020 Oliver Nightingale
 */g.utils={},g.utils.warn=function(v){return function(_){v.console&&console.warn&&console.warn(_)}}(this),g.utils.asString=function(v){return v==null?"":v.toString()},g.utils.clone=function(v){if(v==null)return v;for(var _=Object.create(null),P=Object.keys(v),O=0;O<P.length;O++){var F=P[O],U=v[F];if(Array.isArray(U)){_[F]=U.slice();continue}if(typeof U=="string"||typeof U=="number"||typeof U=="boolean"){_[F]=U;continue}throw new TypeError("clone is not deep and does not support nested objects")}return _},g.FieldRef=function(v,_,P){this.docRef=v,this.fieldName=_,this._stringValue=P},g.FieldRef.joiner="/",g.FieldRef.fromString=function(v){var _=v.indexOf(g.FieldRef.joiner);if(_===-1)throw"malformed field ref string";var P=v.slice(0,_),O=v.slice(_+1);return new g.FieldRef(O,P,v)},g.FieldRef.prototype.toString=function(){return this._stringValue==null&&(this._stringValue=this.fieldName+g.FieldRef.joiner+this.docRef),this._stringValue};/*!
 * lunr.Set
 * Copyright (C) 2020 Oliver Nightingale
 */g.Set=function(v){if(this.elements=Object.create(null),v){this.length=v.length;for(var _=0;_<this.length;_++)this.elements[v[_]]=!0}else this.length=0},g.Set.complete={intersect:function(v){return v},union:function(){return this},contains:function(){return!0}},g.Set.empty={intersect:function(){return this},union:function(v){return v},contains:function(){return!1}},g.Set.prototype.contains=function(v){return!!this.elements[v]},g.Set.prototype.intersect=function(v){var _,P,O,F=[];if(v===g.Set.complete)return this;if(v===g.Set.empty)return v;this.length<v.length?(_=this,P=v):(_=v,P=this),O=Object.keys(_.elements);for(var U=0;U<O.length;U++){var K=O[U];K in P.elements&&F.push(K)}return new g.Set(F)},g.Set.prototype.union=function(v){return v===g.Set.complete?g.Set.complete:v===g.Set.empty?this:new g.Set(Object.keys(this.elements).concat(Object.keys(v.elements)))},g.idf=function(v,_){var P=0;for(var O in v)O!="_index"&&(P+=Object.keys(v[O]).length);var F=(_-P+.5)/(P+.5);return Math.log(1+Math.abs(F))},g.Token=function(v,_){this.str=v||"",this.metadata=_||{}},g.Token.prototype.toString=function(){return this.str},g.Token.prototype.update=function(v){return this.str=v(this.str,this.metadata),this},g.Token.prototype.clone=function(v){return v=v||function(_){return _},new g.Token(v(this.str,this.metadata),this.metadata)};/*!
 * lunr.tokenizer
 * Copyright (C) 2020 Oliver Nightingale
 */g.tokenizer=function(v,_){if(v==null||v==null)return[];if(Array.isArray(v))return v.map(function($e){return new g.Token(g.utils.asString($e).toLowerCase(),g.utils.clone(_))});for(var P=v.toString().toLowerCase(),O=P.length,F=[],U=0,K=0;U<=O;U++){var ae=P.charAt(U),C=U-K;if(ae.match(g.tokenizer.separator)||U==O){if(C>0){var W=g.utils.clone(_)||{};W.position=[K,C],W.index=F.length,F.push(new g.Token(P.slice(K,U),W))}K=U+1}}return F},g.tokenizer.separator=/[\s\-]+/;/*!
 * lunr.Pipeline
 * Copyright (C) 2020 Oliver Nightingale
 */g.Pipeline=function(){this._stack=[]},g.Pipeline.registeredFunctions=Object.create(null),g.Pipeline.registerFunction=function(v,_){_ in this.registeredFunctions&&g.utils.warn("Overwriting existing registered function: "+_),v.label=_,g.Pipeline.registeredFunctions[v.label]=v},g.Pipeline.warnIfFunctionNotRegistered=function(v){var _=v.label&&v.label in this.registeredFunctions;_||g.utils.warn(`Function is not registered with pipeline. This may cause problems when serialising the index.
`,v)},g.Pipeline.load=function(v){var _=new g.Pipeline;return v.forEach(function(P){var O=g.Pipeline.registeredFunctions[P];if(O)_.add(O);else throw new Error("Cannot load unregistered function: "+P)}),_},g.Pipeline.prototype.add=function(){var v=Array.prototype.slice.call(arguments);v.forEach(function(_){g.Pipeline.warnIfFunctionNotRegistered(_),this._stack.push(_)},this)},g.Pipeline.prototype.after=function(v,_){g.Pipeline.warnIfFunctionNotRegistered(_);var P=this._stack.indexOf(v);if(P==-1)throw new Error("Cannot find existingFn");P=P+1,this._stack.splice(P,0,_)},g.Pipeline.prototype.before=function(v,_){g.Pipeline.warnIfFunctionNotRegistered(_);var P=this._stack.indexOf(v);if(P==-1)throw new Error("Cannot find existingFn");this._stack.splice(P,0,_)},g.Pipeline.prototype.remove=function(v){var _=this._stack.indexOf(v);_!=-1&&this._stack.splice(_,1)},g.Pipeline.prototype.run=function(v){for(var _=this._stack.length,P=0;P<_;P++){for(var O=this._stack[P],F=[],U=0;U<v.length;U++){var K=O(v[U],U,v);if(!(K==null||K===""))if(Array.isArray(K))for(var ae=0;ae<K.length;ae++)F.push(K[ae]);else F.push(K)}v=F}return v},g.Pipeline.prototype.runString=function(v,_){var P=new g.Token(v,_);return this.run([P]).map(function(O){return O.toString()})},g.Pipeline.prototype.reset=function(){this._stack=[]},g.Pipeline.prototype.toJSON=function(){return this._stack.map(function(v){return g.Pipeline.warnIfFunctionNotRegistered(v),v.label})};/*!
 * lunr.Vector
 * Copyright (C) 2020 Oliver Nightingale
 */g.Vector=function(v){this._magnitude=0,this.elements=v||[]},g.Vector.prototype.positionForIndex=function(v){if(this.elements.length==0)return 0;for(var _=0,P=this.elements.length/2,O=P-_,F=Math.floor(O/2),U=this.elements[F*2];O>1&&(U<v&&(_=F),U>v&&(P=F),U!=v);)O=P-_,F=_+Math.floor(O/2),U=this.elements[F*2];if(U==v||U>v)return F*2;if(U<v)return(F+1)*2},g.Vector.prototype.insert=function(v,_){this.upsert(v,_,function(){throw"duplicate index"})},g.Vector.prototype.upsert=function(v,_,P){this._magnitude=0;var O=this.positionForIndex(v);this.elements[O]==v?this.elements[O+1]=P(this.elements[O+1],_):this.elements.splice(O,0,v,_)},g.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var v=0,_=this.elements.length,P=1;P<_;P+=2){var O=this.elements[P];v+=O*O}return this._magnitude=Math.sqrt(v)},g.Vector.prototype.dot=function(v){for(var _=0,P=this.elements,O=v.elements,F=P.length,U=O.length,K=0,ae=0,C=0,W=0;C<F&&W<U;)K=P[C],ae=O[W],K<ae?C+=2:K>ae?W+=2:K==ae&&(_+=P[C+1]*O[W+1],C+=2,W+=2);return _},g.Vector.prototype.similarity=function(v){return this.dot(v)/this.magnitude()||0},g.Vector.prototype.toArray=function(){for(var v=new Array(this.elements.length/2),_=1,P=0;_<this.elements.length;_+=2,P++)v[P]=this.elements[_];return v},g.Vector.prototype.toJSON=function(){return this.elements};/*!
 * lunr.stemmer
 * Copyright (C) 2020 Oliver Nightingale
 * Includes code from - http://tartarus.org/~martin/PorterStemmer/js.txt
 */g.stemmer=function(){var v={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},_={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},P="[^aeiou]",O="[aeiouy]",F=P+"[^aeiouy]*",U=O+"[aeiou]*",K="^("+F+")?"+U+F,ae="^("+F+")?"+U+F+"("+U+")?$",C="^("+F+")?"+U+F+U+F,W="^("+F+")?"+O,$e=new RegExp(K),le=new RegExp(C),xt=new RegExp(ae),Ge=new RegExp(W),kt=/^(.+?)(ss|i)es$/,We=/^(.+?)([^s])s$/,Ue=/^(.+?)eed$/,Zt=/^(.+?)(ed|ing)$/,Je=/.$/,Bt=/(at|bl|iz)$/,bi=new RegExp("([^aeiouylsz])\\1$"),N=new RegExp("^"+F+O+"[^aeiouwxy]$"),Ri=/^(.+?[^aeiou])y$/,br=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,rt=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,ei=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,Mt=/^(.+?)(s|t)(ion)$/,Ni=/^(.+?)e$/,ur=/ll$/,qi=new RegExp("^"+F+O+"[^aeiouwxy]$"),Yi=function(ge){var X,se,de,ee,Ie,nt,wi;if(ge.length<3)return ge;if(de=ge.substr(0,1),de=="y"&&(ge=de.toUpperCase()+ge.substr(1)),ee=kt,Ie=We,ee.test(ge)?ge=ge.replace(ee,"$1$2"):Ie.test(ge)&&(ge=ge.replace(Ie,"$1$2")),ee=Ue,Ie=Zt,ee.test(ge)){var gt=ee.exec(ge);ee=$e,ee.test(gt[1])&&(ee=Je,ge=ge.replace(ee,""))}else if(Ie.test(ge)){var gt=Ie.exec(ge);X=gt[1],Ie=Ge,Ie.test(X)&&(ge=X,Ie=Bt,nt=bi,wi=N,Ie.test(ge)?ge=ge+"e":nt.test(ge)?(ee=Je,ge=ge.replace(ee,"")):wi.test(ge)&&(ge=ge+"e"))}if(ee=Ri,ee.test(ge)){var gt=ee.exec(ge);X=gt[1],ge=X+"i"}if(ee=br,ee.test(ge)){var gt=ee.exec(ge);X=gt[1],se=gt[2],ee=$e,ee.test(X)&&(ge=X+v[se])}if(ee=rt,ee.test(ge)){var gt=ee.exec(ge);X=gt[1],se=gt[2],ee=$e,ee.test(X)&&(ge=X+_[se])}if(ee=ei,Ie=Mt,ee.test(ge)){var gt=ee.exec(ge);X=gt[1],ee=le,ee.test(X)&&(ge=X)}else if(Ie.test(ge)){var gt=Ie.exec(ge);X=gt[1]+gt[2],Ie=le,Ie.test(X)&&(ge=X)}if(ee=Ni,ee.test(ge)){var gt=ee.exec(ge);X=gt[1],ee=le,Ie=xt,nt=qi,(ee.test(X)||Ie.test(X)&&!nt.test(X))&&(ge=X)}return ee=ur,Ie=le,ee.test(ge)&&Ie.test(ge)&&(ee=Je,ge=ge.replace(ee,"")),de=="y"&&(ge=de.toLowerCase()+ge.substr(1)),ge};return function(hr){return hr.update(Yi)}}(),g.Pipeline.registerFunction(g.stemmer,"stemmer");/*!
 * lunr.stopWordFilter
 * Copyright (C) 2020 Oliver Nightingale
 */g.generateStopWordFilter=function(v){var _=v.reduce(function(P,O){return P[O]=O,P},{});return function(P){if(P&&_[P.toString()]!==P.toString())return P}},g.stopWordFilter=g.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]),g.Pipeline.registerFunction(g.stopWordFilter,"stopWordFilter");/*!
 * lunr.trimmer
 * Copyright (C) 2020 Oliver Nightingale
 */g.trimmer=function(v){return v.update(function(_){return _.replace(/^\W+/,"").replace(/\W+$/,"")})},g.Pipeline.registerFunction(g.trimmer,"trimmer");/*!
 * lunr.TokenSet
 * Copyright (C) 2020 Oliver Nightingale
 */g.TokenSet=function(){this.final=!1,this.edges={},this.id=g.TokenSet._nextId,g.TokenSet._nextId+=1},g.TokenSet._nextId=1,g.TokenSet.fromArray=function(v){for(var _=new g.TokenSet.Builder,P=0,O=v.length;P<O;P++)_.insert(v[P]);return _.finish(),_.root},g.TokenSet.fromClause=function(v){return"editDistance"in v?g.TokenSet.fromFuzzyString(v.term,v.editDistance):g.TokenSet.fromString(v.term)},g.TokenSet.fromFuzzyString=function(v,_){for(var P=new g.TokenSet,O=[{node:P,editsRemaining:_,str:v}];O.length;){var F=O.pop();if(F.str.length>0){var U=F.str.charAt(0),K;U in F.node.edges?K=F.node.edges[U]:(K=new g.TokenSet,F.node.edges[U]=K),F.str.length==1&&(K.final=!0),O.push({node:K,editsRemaining:F.editsRemaining,str:F.str.slice(1)})}if(F.editsRemaining!=0){if("*"in F.node.edges)var ae=F.node.edges["*"];else{var ae=new g.TokenSet;F.node.edges["*"]=ae}if(F.str.length==0&&(ae.final=!0),O.push({node:ae,editsRemaining:F.editsRemaining-1,str:F.str}),F.str.length>1&&O.push({node:F.node,editsRemaining:F.editsRemaining-1,str:F.str.slice(1)}),F.str.length==1&&(F.node.final=!0),F.str.length>=1){if("*"in F.node.edges)var C=F.node.edges["*"];else{var C=new g.TokenSet;F.node.edges["*"]=C}F.str.length==1&&(C.final=!0),O.push({node:C,editsRemaining:F.editsRemaining-1,str:F.str.slice(1)})}if(F.str.length>1){var W=F.str.charAt(0),$e=F.str.charAt(1),le;$e in F.node.edges?le=F.node.edges[$e]:(le=new g.TokenSet,F.node.edges[$e]=le),F.str.length==1&&(le.final=!0),O.push({node:le,editsRemaining:F.editsRemaining-1,str:W+F.str.slice(2)})}}}return P},g.TokenSet.fromString=function(v){for(var _=new g.TokenSet,P=_,O=0,F=v.length;O<F;O++){var U=v[O],K=O==F-1;if(U=="*")_.edges[U]=_,_.final=K;else{var ae=new g.TokenSet;ae.final=K,_.edges[U]=ae,_=ae}}return P},g.TokenSet.prototype.toArray=function(){for(var v=[],_=[{prefix:"",node:this}];_.length;){var P=_.pop(),O=Object.keys(P.node.edges),F=O.length;P.node.final&&(P.prefix.charAt(0),v.push(P.prefix));for(var U=0;U<F;U++){var K=O[U];_.push({prefix:P.prefix.concat(K),node:P.node.edges[K]})}}return v},g.TokenSet.prototype.toString=function(){if(this._str)return this._str;for(var v=this.final?"1":"0",_=Object.keys(this.edges).sort(),P=_.length,O=0;O<P;O++){var F=_[O],U=this.edges[F];v=v+F+U.id}return v},g.TokenSet.prototype.intersect=function(v){for(var _=new g.TokenSet,P=void 0,O=[{qNode:v,output:_,node:this}];O.length;){P=O.pop();for(var F=Object.keys(P.qNode.edges),U=F.length,K=Object.keys(P.node.edges),ae=K.length,C=0;C<U;C++)for(var W=F[C],$e=0;$e<ae;$e++){var le=K[$e];if(le==W||W=="*"){var xt=P.node.edges[le],Ge=P.qNode.edges[W],kt=xt.final&&Ge.final,We=void 0;le in P.output.edges?(We=P.output.edges[le],We.final=We.final||kt):(We=new g.TokenSet,We.final=kt,P.output.edges[le]=We),O.push({qNode:Ge,output:We,node:xt})}}}return _},g.TokenSet.Builder=function(){this.previousWord="",this.root=new g.TokenSet,this.uncheckedNodes=[],this.minimizedNodes={}},g.TokenSet.Builder.prototype.insert=function(v){var _,P=0;if(v<this.previousWord)throw new Error("Out of order word insertion");for(var O=0;O<v.length&&O<this.previousWord.length&&v[O]==this.previousWord[O];O++)P++;this.minimize(P),this.uncheckedNodes.length==0?_=this.root:_=this.uncheckedNodes[this.uncheckedNodes.length-1].child;for(var O=P;O<v.length;O++){var F=new g.TokenSet,U=v[O];_.edges[U]=F,this.uncheckedNodes.push({parent:_,char:U,child:F}),_=F}_.final=!0,this.previousWord=v},g.TokenSet.Builder.prototype.finish=function(){this.minimize(0)},g.TokenSet.Builder.prototype.minimize=function(v){for(var _=this.uncheckedNodes.length-1;_>=v;_--){var P=this.uncheckedNodes[_],O=P.child.toString();O in this.minimizedNodes?P.parent.edges[P.char]=this.minimizedNodes[O]:(P.child._str=O,this.minimizedNodes[O]=P.child),this.uncheckedNodes.pop()}};/*!
 * lunr.Index
 * Copyright (C) 2020 Oliver Nightingale
 */g.Index=function(v){this.invertedIndex=v.invertedIndex,this.fieldVectors=v.fieldVectors,this.tokenSet=v.tokenSet,this.fields=v.fields,this.pipeline=v.pipeline},g.Index.prototype.search=function(v){return this.query(function(_){var P=new g.QueryParser(v,_);P.parse()})},g.Index.prototype.query=function(v){for(var _=new g.Query(this.fields),P=Object.create(null),O=Object.create(null),F=Object.create(null),U=Object.create(null),K=Object.create(null),ae=0;ae<this.fields.length;ae++)O[this.fields[ae]]=new g.Vector;v.call(_,_);for(var ae=0;ae<_.clauses.length;ae++){var C=_.clauses[ae],W=null,$e=g.Set.empty;C.usePipeline?W=this.pipeline.runString(C.term,{fields:C.fields}):W=[C.term];for(var le=0;le<W.length;le++){var xt=W[le];C.term=xt;var Ge=g.TokenSet.fromClause(C),kt=this.tokenSet.intersect(Ge).toArray();if(kt.length===0&&C.presence===g.Query.presence.REQUIRED){for(var We=0;We<C.fields.length;We++){var Ue=C.fields[We];U[Ue]=g.Set.empty}break}for(var Zt=0;Zt<kt.length;Zt++)for(var Je=kt[Zt],Bt=this.invertedIndex[Je],bi=Bt._index,We=0;We<C.fields.length;We++){var Ue=C.fields[We],N=Bt[Ue],Ri=Object.keys(N),br=Je+"/"+Ue,rt=new g.Set(Ri);if(C.presence==g.Query.presence.REQUIRED&&($e=$e.union(rt),U[Ue]===void 0&&(U[Ue]=g.Set.complete)),C.presence==g.Query.presence.PROHIBITED){K[Ue]===void 0&&(K[Ue]=g.Set.empty),K[Ue]=K[Ue].union(rt);continue}if(O[Ue].upsert(bi,C.boost,function(Wu,wr){return Wu+wr}),!F[br]){for(var ei=0;ei<Ri.length;ei++){var Mt=Ri[ei],Ni=new g.FieldRef(Mt,Ue),ur=N[Mt],qi;(qi=P[Ni])===void 0?P[Ni]=new g.MatchData(Je,Ue,ur):qi.add(Je,Ue,ur)}F[br]=!0}}}if(C.presence===g.Query.presence.REQUIRED)for(var We=0;We<C.fields.length;We++){var Ue=C.fields[We];U[Ue]=U[Ue].intersect($e)}}for(var Yi=g.Set.complete,hr=g.Set.empty,ae=0;ae<this.fields.length;ae++){var Ue=this.fields[ae];U[Ue]&&(Yi=Yi.intersect(U[Ue])),K[Ue]&&(hr=hr.union(K[Ue]))}var ge=Object.keys(P),X=[],se=Object.create(null);if(_.isNegated()){ge=Object.keys(this.fieldVectors);for(var ae=0;ae<ge.length;ae++){var Ni=ge[ae],de=g.FieldRef.fromString(Ni);P[Ni]=new g.MatchData}}for(var ae=0;ae<ge.length;ae++){var de=g.FieldRef.fromString(ge[ae]),ee=de.docRef;if(Yi.contains(ee)&&!hr.contains(ee)){var Ie=this.fieldVectors[de],nt=O[de.fieldName].similarity(Ie),wi;if((wi=se[ee])!==void 0)wi.score+=nt,wi.matchData.combine(P[de]);else{var gt={ref:ee,score:nt,matchData:P[de]};se[ee]=gt,X.push(gt)}}}return X.sort(function(Ss,_o){return _o.score-Ss.score})},g.Index.prototype.toJSON=function(){var v=Object.keys(this.invertedIndex).sort().map(function(P){return[P,this.invertedIndex[P]]},this),_=Object.keys(this.fieldVectors).map(function(P){return[P,this.fieldVectors[P].toJSON()]},this);return{version:g.version,fields:this.fields,fieldVectors:_,invertedIndex:v,pipeline:this.pipeline.toJSON()}},g.Index.load=function(v){var _={},P={},O=v.fieldVectors,F=Object.create(null),U=v.invertedIndex,K=new g.TokenSet.Builder,ae=g.Pipeline.load(v.pipeline);v.version!=g.version&&g.utils.warn("Version mismatch when loading serialised index. Current version of lunr '"+g.version+"' does not match serialized index '"+v.version+"'");for(var C=0;C<O.length;C++){var W=O[C],$e=W[0],le=W[1];P[$e]=new g.Vector(le)}for(var C=0;C<U.length;C++){var W=U[C],xt=W[0],Ge=W[1];K.insert(xt),F[xt]=Ge}return K.finish(),_.fields=v.fields,_.fieldVectors=P,_.invertedIndex=F,_.tokenSet=K.root,_.pipeline=ae,new g.Index(_)};/*!
 * lunr.Builder
 * Copyright (C) 2020 Oliver Nightingale
 */g.Builder=function(){this._ref="id",this._fields=Object.create(null),this._documents=Object.create(null),this.invertedIndex=Object.create(null),this.fieldTermFrequencies={},this.fieldLengths={},this.tokenizer=g.tokenizer,this.pipeline=new g.Pipeline,this.searchPipeline=new g.Pipeline,this.documentCount=0,this._b=.75,this._k1=1.2,this.termIndex=0,this.metadataWhitelist=[]},g.Builder.prototype.ref=function(v){this._ref=v},g.Builder.prototype.field=function(v,_){if(/\//.test(v))throw new RangeError("Field '"+v+"' contains illegal character '/'");this._fields[v]=_||{}},g.Builder.prototype.b=function(v){v<0?this._b=0:v>1?this._b=1:this._b=v},g.Builder.prototype.k1=function(v){this._k1=v},g.Builder.prototype.add=function(v,_){var P=v[this._ref],O=Object.keys(this._fields);this._documents[P]=_||{},this.documentCount+=1;for(var F=0;F<O.length;F++){var U=O[F],K=this._fields[U].extractor,ae=K?K(v):v[U],C=this.tokenizer(ae,{fields:[U]}),W=this.pipeline.run(C),$e=new g.FieldRef(P,U),le=Object.create(null);this.fieldTermFrequencies[$e]=le,this.fieldLengths[$e]=0,this.fieldLengths[$e]+=W.length;for(var xt=0;xt<W.length;xt++){var Ge=W[xt];if(le[Ge]==null&&(le[Ge]=0),le[Ge]+=1,this.invertedIndex[Ge]==null){var kt=Object.create(null);kt._index=this.termIndex,this.termIndex+=1;for(var We=0;We<O.length;We++)kt[O[We]]=Object.create(null);this.invertedIndex[Ge]=kt}this.invertedIndex[Ge][U][P]==null&&(this.invertedIndex[Ge][U][P]=Object.create(null));for(var Ue=0;Ue<this.metadataWhitelist.length;Ue++){var Zt=this.metadataWhitelist[Ue],Je=Ge.metadata[Zt];this.invertedIndex[Ge][U][P][Zt]==null&&(this.invertedIndex[Ge][U][P][Zt]=[]),this.invertedIndex[Ge][U][P][Zt].push(Je)}}}},g.Builder.prototype.calculateAverageFieldLengths=function(){for(var v=Object.keys(this.fieldLengths),_=v.length,P={},O={},F=0;F<_;F++){var U=g.FieldRef.fromString(v[F]),K=U.fieldName;O[K]||(O[K]=0),O[K]+=1,P[K]||(P[K]=0),P[K]+=this.fieldLengths[U]}for(var ae=Object.keys(this._fields),F=0;F<ae.length;F++){var C=ae[F];P[C]=P[C]/O[C]}this.averageFieldLength=P},g.Builder.prototype.createFieldVectors=function(){for(var v={},_=Object.keys(this.fieldTermFrequencies),P=_.length,O=Object.create(null),F=0;F<P;F++){for(var U=g.FieldRef.fromString(_[F]),K=U.fieldName,ae=this.fieldLengths[U],C=new g.Vector,W=this.fieldTermFrequencies[U],$e=Object.keys(W),le=$e.length,xt=this._fields[K].boost||1,Ge=this._documents[U.docRef].boost||1,kt=0;kt<le;kt++){var We=$e[kt],Ue=W[We],Zt=this.invertedIndex[We]._index,Je,Bt,bi;O[We]===void 0?(Je=g.idf(this.invertedIndex[We],this.documentCount),O[We]=Je):Je=O[We],Bt=Je*((this._k1+1)*Ue)/(this._k1*(1-this._b+this._b*(ae/this.averageFieldLength[K]))+Ue),Bt*=xt,Bt*=Ge,bi=Math.round(Bt*1e3)/1e3,C.insert(Zt,bi)}v[U]=C}this.fieldVectors=v},g.Builder.prototype.createTokenSet=function(){this.tokenSet=g.TokenSet.fromArray(Object.keys(this.invertedIndex).sort())},g.Builder.prototype.build=function(){return this.calculateAverageFieldLengths(),this.createFieldVectors(),this.createTokenSet(),new g.Index({invertedIndex:this.invertedIndex,fieldVectors:this.fieldVectors,tokenSet:this.tokenSet,fields:Object.keys(this._fields),pipeline:this.searchPipeline})},g.Builder.prototype.use=function(v){var _=Array.prototype.slice.call(arguments,1);_.unshift(this),v.apply(this,_)},g.MatchData=function(v,_,P){for(var O=Object.create(null),F=Object.keys(P||{}),U=0;U<F.length;U++){var K=F[U];O[K]=P[K].slice()}this.metadata=Object.create(null),v!==void 0&&(this.metadata[v]=Object.create(null),this.metadata[v][_]=O)},g.MatchData.prototype.combine=function(v){for(var _=Object.keys(v.metadata),P=0;P<_.length;P++){var O=_[P],F=Object.keys(v.metadata[O]);this.metadata[O]==null&&(this.metadata[O]=Object.create(null));for(var U=0;U<F.length;U++){var K=F[U],ae=Object.keys(v.metadata[O][K]);this.metadata[O][K]==null&&(this.metadata[O][K]=Object.create(null));for(var C=0;C<ae.length;C++){var W=ae[C];this.metadata[O][K][W]==null?this.metadata[O][K][W]=v.metadata[O][K][W]:this.metadata[O][K][W]=this.metadata[O][K][W].concat(v.metadata[O][K][W])}}}},g.MatchData.prototype.add=function(v,_,P){if(!(v in this.metadata)){this.metadata[v]=Object.create(null),this.metadata[v][_]=P;return}if(!(_ in this.metadata[v])){this.metadata[v][_]=P;return}for(var O=Object.keys(P),F=0;F<O.length;F++){var U=O[F];U in this.metadata[v][_]?this.metadata[v][_][U]=this.metadata[v][_][U].concat(P[U]):this.metadata[v][_][U]=P[U]}},g.Query=function(v){this.clauses=[],this.allFields=v},g.Query.wildcard=new String("*"),g.Query.wildcard.NONE=0,g.Query.wildcard.LEADING=1,g.Query.wildcard.TRAILING=2,g.Query.presence={OPTIONAL:1,REQUIRED:2,PROHIBITED:3},g.Query.prototype.clause=function(v){return"fields"in v||(v.fields=this.allFields),"boost"in v||(v.boost=1),"usePipeline"in v||(v.usePipeline=!0),"wildcard"in v||(v.wildcard=g.Query.wildcard.NONE),v.wildcard&g.Query.wildcard.LEADING&&v.term.charAt(0)!=g.Query.wildcard&&(v.term="*"+v.term),v.wildcard&g.Query.wildcard.TRAILING&&v.term.slice(-1)!=g.Query.wildcard&&(v.term=""+v.term+"*"),"presence"in v||(v.presence=g.Query.presence.OPTIONAL),this.clauses.push(v),this},g.Query.prototype.isNegated=function(){for(var v=0;v<this.clauses.length;v++)if(this.clauses[v].presence!=g.Query.presence.PROHIBITED)return!1;return!0},g.Query.prototype.term=function(v,_){if(Array.isArray(v))return v.forEach(function(O){this.term(O,g.utils.clone(_))},this),this;var P=_||{};return P.term=v.toString(),this.clause(P),this},g.QueryParseError=function(v,_,P){this.name="QueryParseError",this.message=v,this.start=_,this.end=P},g.QueryParseError.prototype=new Error,g.QueryLexer=function(v){this.lexemes=[],this.str=v,this.length=v.length,this.pos=0,this.start=0,this.escapeCharPositions=[]},g.QueryLexer.prototype.run=function(){for(var v=g.QueryLexer.lexText;v;)v=v(this)},g.QueryLexer.prototype.sliceString=function(){for(var v=[],_=this.start,P=this.pos,O=0;O<this.escapeCharPositions.length;O++)P=this.escapeCharPositions[O],v.push(this.str.slice(_,P)),_=P+1;return v.push(this.str.slice(_,this.pos)),this.escapeCharPositions.length=0,v.join("")},g.QueryLexer.prototype.emit=function(v){this.lexemes.push({type:v,str:this.sliceString(),start:this.start,end:this.pos}),this.start=this.pos},g.QueryLexer.prototype.escapeCharacter=function(){this.escapeCharPositions.push(this.pos-1),this.pos+=1},g.QueryLexer.prototype.next=function(){if(this.pos>=this.length)return g.QueryLexer.EOS;var v=this.str.charAt(this.pos);return this.pos+=1,v},g.QueryLexer.prototype.width=function(){return this.pos-this.start},g.QueryLexer.prototype.ignore=function(){this.start==this.pos&&(this.pos+=1),this.start=this.pos},g.QueryLexer.prototype.backup=function(){this.pos-=1},g.QueryLexer.prototype.acceptDigitRun=function(){var v,_;do v=this.next(),_=v.charCodeAt(0);while(_>47&&_<58);v!=g.QueryLexer.EOS&&this.backup()},g.QueryLexer.prototype.more=function(){return this.pos<this.length},g.QueryLexer.EOS="EOS",g.QueryLexer.FIELD="FIELD",g.QueryLexer.TERM="TERM",g.QueryLexer.EDIT_DISTANCE="EDIT_DISTANCE",g.QueryLexer.BOOST="BOOST",g.QueryLexer.PRESENCE="PRESENCE",g.QueryLexer.lexField=function(v){return v.backup(),v.emit(g.QueryLexer.FIELD),v.ignore(),g.QueryLexer.lexText},g.QueryLexer.lexTerm=function(v){if(v.width()>1&&(v.backup(),v.emit(g.QueryLexer.TERM)),v.ignore(),v.more())return g.QueryLexer.lexText},g.QueryLexer.lexEditDistance=function(v){return v.ignore(),v.acceptDigitRun(),v.emit(g.QueryLexer.EDIT_DISTANCE),g.QueryLexer.lexText},g.QueryLexer.lexBoost=function(v){return v.ignore(),v.acceptDigitRun(),v.emit(g.QueryLexer.BOOST),g.QueryLexer.lexText},g.QueryLexer.lexEOS=function(v){v.width()>0&&v.emit(g.QueryLexer.TERM)},g.QueryLexer.termSeparator=g.tokenizer.separator,g.QueryLexer.lexText=function(v){for(;;){var _=v.next();if(_==g.QueryLexer.EOS)return g.QueryLexer.lexEOS;if(_.charCodeAt(0)==92){v.escapeCharacter();continue}if(_==":")return g.QueryLexer.lexField;if(_=="~")return v.backup(),v.width()>0&&v.emit(g.QueryLexer.TERM),g.QueryLexer.lexEditDistance;if(_=="^")return v.backup(),v.width()>0&&v.emit(g.QueryLexer.TERM),g.QueryLexer.lexBoost;if(_=="+"&&v.width()===1||_=="-"&&v.width()===1)return v.emit(g.QueryLexer.PRESENCE),g.QueryLexer.lexText;if(_.match(g.QueryLexer.termSeparator))return g.QueryLexer.lexTerm}},g.QueryParser=function(v,_){this.lexer=new g.QueryLexer(v),this.query=_,this.currentClause={},this.lexemeIdx=0},g.QueryParser.prototype.parse=function(){this.lexer.run(),this.lexemes=this.lexer.lexemes;for(var v=g.QueryParser.parseClause;v;)v=v(this);return this.query},g.QueryParser.prototype.peekLexeme=function(){return this.lexemes[this.lexemeIdx]},g.QueryParser.prototype.consumeLexeme=function(){var v=this.peekLexeme();return this.lexemeIdx+=1,v},g.QueryParser.prototype.nextClause=function(){var v=this.currentClause;this.query.clause(v),this.currentClause={}},g.QueryParser.parseClause=function(v){var _=v.peekLexeme();if(_!=null)switch(_.type){case g.QueryLexer.PRESENCE:return g.QueryParser.parsePresence;case g.QueryLexer.FIELD:return g.QueryParser.parseField;case g.QueryLexer.TERM:return g.QueryParser.parseTerm;default:var P="expected either a field or a term, found "+_.type;throw _.str.length>=1&&(P+=" with value '"+_.str+"'"),new g.QueryParseError(P,_.start,_.end)}},g.QueryParser.parsePresence=function(v){var _=v.consumeLexeme();if(_!=null){switch(_.str){case"-":v.currentClause.presence=g.Query.presence.PROHIBITED;break;case"+":v.currentClause.presence=g.Query.presence.REQUIRED;break;default:var P="unrecognised presence operator'"+_.str+"'";throw new g.QueryParseError(P,_.start,_.end)}var O=v.peekLexeme();if(O==null){var P="expecting term or field, found nothing";throw new g.QueryParseError(P,_.start,_.end)}switch(O.type){case g.QueryLexer.FIELD:return g.QueryParser.parseField;case g.QueryLexer.TERM:return g.QueryParser.parseTerm;default:var P="expecting term or field, found '"+O.type+"'";throw new g.QueryParseError(P,O.start,O.end)}}},g.QueryParser.parseField=function(v){var _=v.consumeLexeme();if(_!=null){if(v.query.allFields.indexOf(_.str)==-1){var P=v.query.allFields.map(function(U){return"'"+U+"'"}).join(", "),O="unrecognised field '"+_.str+"', possible fields: "+P;throw new g.QueryParseError(O,_.start,_.end)}v.currentClause.fields=[_.str];var F=v.peekLexeme();if(F==null){var O="expecting term, found nothing";throw new g.QueryParseError(O,_.start,_.end)}switch(F.type){case g.QueryLexer.TERM:return g.QueryParser.parseTerm;default:var O="expecting term, found '"+F.type+"'";throw new g.QueryParseError(O,F.start,F.end)}}},g.QueryParser.parseTerm=function(v){var _=v.consumeLexeme();if(_!=null){v.currentClause.term=_.str.toLowerCase(),_.str.indexOf("*")!=-1&&(v.currentClause.usePipeline=!1);var P=v.peekLexeme();if(P==null){v.nextClause();return}switch(P.type){case g.QueryLexer.TERM:return v.nextClause(),g.QueryParser.parseTerm;case g.QueryLexer.FIELD:return v.nextClause(),g.QueryParser.parseField;case g.QueryLexer.EDIT_DISTANCE:return g.QueryParser.parseEditDistance;case g.QueryLexer.BOOST:return g.QueryParser.parseBoost;case g.QueryLexer.PRESENCE:return v.nextClause(),g.QueryParser.parsePresence;default:var O="Unexpected lexeme type '"+P.type+"'";throw new g.QueryParseError(O,P.start,P.end)}}},g.QueryParser.parseEditDistance=function(v){var _=v.consumeLexeme();if(_!=null){var P=parseInt(_.str,10);if(isNaN(P)){var O="edit distance must be numeric";throw new g.QueryParseError(O,_.start,_.end)}v.currentClause.editDistance=P;var F=v.peekLexeme();if(F==null){v.nextClause();return}switch(F.type){case g.QueryLexer.TERM:return v.nextClause(),g.QueryParser.parseTerm;case g.QueryLexer.FIELD:return v.nextClause(),g.QueryParser.parseField;case g.QueryLexer.EDIT_DISTANCE:return g.QueryParser.parseEditDistance;case g.QueryLexer.BOOST:return g.QueryParser.parseBoost;case g.QueryLexer.PRESENCE:return v.nextClause(),g.QueryParser.parsePresence;default:var O="Unexpected lexeme type '"+F.type+"'";throw new g.QueryParseError(O,F.start,F.end)}}},g.QueryParser.parseBoost=function(v){var _=v.consumeLexeme();if(_!=null){var P=parseInt(_.str,10);if(isNaN(P)){var O="boost must be numeric";throw new g.QueryParseError(O,_.start,_.end)}v.currentClause.boost=P;var F=v.peekLexeme();if(F==null){v.nextClause();return}switch(F.type){case g.QueryLexer.TERM:return v.nextClause(),g.QueryParser.parseTerm;case g.QueryLexer.FIELD:return v.nextClause(),g.QueryParser.parseField;case g.QueryLexer.EDIT_DISTANCE:return g.QueryParser.parseEditDistance;case g.QueryLexer.BOOST:return g.QueryParser.parseBoost;case g.QueryLexer.PRESENCE:return v.nextClause(),g.QueryParser.parsePresence;default:var O="Unexpected lexeme type '"+F.type+"'";throw new g.QueryParseError(O,F.start,F.end)}}},function(v,_){L.exports=_()}(this,function(){return g})})()}(df)),df.exports}var kM=AM();const PM=DO(kM);class CM{constructor(w){this.contentList=w,this.index=this.buildIndex(w)}buildIndex(w){return PM(function(){this.field("abstract"),this.field("content"),this.field("contributor"),this.field("subtitle"),this.field("title"),this.field("url"),this.ref("url"),w.forEach(g=>{this.add(g)})})}search(w){return this.index.search(w).map(v=>this.contentList.find(({url:_})=>_===v.ref))}}window.toggleMenu=()=>{const L=document.getElementById("site-menu"),w=document.querySelector(".side-by-side > .quire-entry__image-wrap > .quire-entry__image"),g=L.getAttribute("aria-expanded");L.classList.toggle("is-expanded",!L.classList.contains("is-expanded")),g==="true"?(w&&w.classList.remove("menu_open"),L.setAttribute("aria-expanded","false")):(w&&w.classList.add("menu_open"),L.setAttribute("aria-expanded","true"))};window.toggleSearch=()=>{const L=document.getElementById("js-search"),w=document.getElementById("js-search-input"),g=L.getAttribute("aria-expanded");L.classList.toggle("is-active",!L.classList.contains("is-active")),g==="true"?L.setAttribute("aria-expanded","false"):(w.focus(),L.setAttribute("aria-expanded","true"))};window.search=()=>{const w=document.getElementById("js-search-input").value,g=window.QUIRE_SEARCH,v=document.getElementById("js-search-results-list"),_=document.getElementById("js-search-results-template");if(w.length>=3){const F=g.search(w);O(F)}function P(){v.innerText=""}function O(F){P(),F.forEach(U=>{const K=document.importNode(_.content,!0),ae=K.querySelector(".js-search-results-item"),C=K.querySelector(".js-search-results-item-title"),W=K.querySelector(".js-search-results-item-type"),$e=K.querySelector(".js-search-results-item-length");ae.href=U.url,C.textContent=U.title,W.textContent=U.type,$e.textContent=U.length,v.appendChild(K)})}};function TM(L){const w=L.target.closest("a"),g=w.hash;w.pathname.includes(window.location.pathname)&&(L.preventDefault(),window.location.hash=g),Af(g)}function IM(){const w='a[href*="#"]'+['[href="#"]','[href="#0"]',".accordion-section__heading-link",".q-figure__modal-link"].map(v=>`:not(${v})`).join("");document.querySelectorAll(w).forEach(v=>{v.addEventListener("click",TM)})}function RM(){document.getElementById("container").classList.remove("no-js"),navigator.userAgent.match(/(iPad|iPhone|iPod)/i),navigator.userAgent.match(/android/i),OM(),IM()}function OM(){const L=document.getElementById("js-search").dataset.searchIndex;if(!L){console.warn("Search data url is undefined");return}fetch(L).then(async w=>{const{ok:g,statusText:v,url:_}=w;if(!g){console.warn(`Search data ${v.toLowerCase()} at ${_}`);return}const P=await w.json();window.QUIRE_SEARCH=new CM(P)})}function MM(L){const w={month:"long"},g=L.getMonth();let v;[4,5,6].includes(g)?v=L.toLocaleDateString("en-US",w).replace(/[^A-Za-z]+/,""):(v=v===8?"Sept":L.toLocaleDateString("en-US",w).slice(0,3),v+=".");const _=L.getDate(),P=L.getFullYear();return[_,v,P].join(" ")}function LM(){const L=document.querySelectorAll(".cite-current-date"),w=MM(new Date);L.forEach(g=>{g.innerHTML=w})}function $M(L,w){const g=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--gap")),v=L.getBoundingClientRect(),_=w.getBoundingClientRect(),P=_.left-v.left,O=v.right-_.right,F=v.width/2;O>0?L.style.transform=`translateX(-${F+O+g}px)`:P>0&&(L.style.transform=`translateX(-${F-P-g}px)`)}function NM(){const L=document.querySelectorAll(".expandable [aria-expanded]");for(let w=0;w<L.length;w++)L[w].addEventListener("click",g=>{g.stopPropagation(),g.target.getAttribute("aria-expanded")==="false"?g.target.setAttribute("aria-expanded","true"):g.target.setAttribute("aria-expanded","false");const _=g.target.parentNode.querySelector(".quire-citation__content");_&&(_.getAttribute("hidden"),typeof _.getAttribute("hidden")=="string"?_.removeAttribute("hidden"):_.setAttribute("hidden","hidden"),$M(_,document.documentElement))});document.addEventListener("click",w=>{const g=w.target.parentNode;if(g&&!(g.classList.contains("quire-citation")||g.classList.contains("quire-citation__content"))){const v=document.querySelectorAll(".quire-citation__button"),_=document.querySelectorAll(".quire-citation__content");if(!_)return;for(let P=0;P<_.length;P++){if(!v[P])return;v[P].setAttribute("aria-expanded","false"),_[P].setAttribute("hidden","hidden")}}})}function zM(){LM(),NM()}function FM(){const L=new URL(window.location),w=[...new Set(L.searchParams.keys())];return Object.fromEntries(w.map(g=>[g,L.searchParams.getAll(g).map(decodeURIComponent)]))}RM();window.addEventListener("load",()=>{zM(),Af(window.location.hash);const L=FM();St.setup(),SM(),window.location.hash&&xf({figureId:window.location.hash.replace(/^#/,""),annotationIds:L["annotation-id"],region:L.region?L.region[0]:null,sequence:{index:L["sequence-index"]?L["sequence-index"][0]:null}})});
//# sourceMappingURL=index-CSInm4KS.js.map
